# xavyo

> Unified identity platform for humans, machines, and AI agents. Built in Rust with multi-tenant PostgreSQL.

## Documentation

- [Architecture](docs/ARCHITECTURE.md): System overview and design principles
- [Crate Index](docs/crates/index.md): All 32 crates organized by layer
- [Maturity Matrix](docs/crates/maturity-matrix.md): Crate stability assessment
- [Dependency Graph](docs/crates/dependency-graph.md): How crates relate

## Maturity Legend

- ðŸŸ¢ **stable** â€” Production-ready, well-tested
- ðŸŸ¡ **beta** â€” Functional, may have gaps
- ðŸ”´ **alpha** â€” Experimental, incomplete

## Crate Layers

### Foundation (6 crates)
- [xavyo-core](crates/xavyo-core/CRATE.md): ðŸŸ¢ Shared types (TenantId, UserId, errors)
- [xavyo-auth](crates/xavyo-auth/CRATE.md): ðŸŸ¢ JWT, password hashing, JWKS
- [xavyo-db](crates/xavyo-db/CRATE.md): ðŸŸ¢ PostgreSQL with RLS
- [xavyo-tenant](crates/xavyo-tenant/CRATE.md): ðŸŸ¢ Multi-tenant middleware
- [xavyo-events](crates/xavyo-events/CRATE.md): ðŸŸ¢ Kafka event bus
- [xavyo-nhi](crates/xavyo-nhi/CRATE.md): ðŸŸ¢ Non-human identity types and traits

### Domain (8 crates)
- [xavyo-connector](crates/xavyo-connector/CRATE.md): ðŸŸ¢ Connector framework
- [xavyo-provisioning](crates/xavyo-provisioning/CRATE.md): ðŸŸ¡ Sync engine
- [xavyo-governance](crates/xavyo-governance/CRATE.md): ðŸŸ¡ IGA logic
- [xavyo-authorization - Authorization engine (PDP) ðŸŸ¡ Policy engine
- [xavyo-webhooks](crates/xavyo-webhooks/CRATE.md): ðŸŸ¡ Event delivery
- [xavyo-siem](crates/xavyo-siem/CRATE.md): ðŸŸ¡ Audit export
- [xavyo-secrets](crates/xavyo-secrets/CRATE.md): ðŸŸ¢ Secret providers
- [xavyo-scim-client](crates/xavyo-scim-client/CRATE.md): ðŸŸ¡ Outbound SCIM

### Connectors (4 crates)
- [xavyo-connector-ldap](crates/xavyo-connector-ldap/CRATE.md): ðŸŸ¢ LDAP/AD
- [xavyo-connector-entra](crates/xavyo-connector-entra/CRATE.md): ðŸŸ¡ Microsoft Entra
- [xavyo-connector-rest](crates/xavyo-connector-rest/CRATE.md): ðŸ”´ REST APIs
- [xavyo-connector-database](crates/xavyo-connector-database/CRATE.md): ðŸ”´ Databases

### API (14 crates)
- [xavyo-api-auth](crates/xavyo-api-auth/CRATE.md): ðŸŸ¢ Auth endpoints
- [xavyo-api-oauth](crates/xavyo-api-oauth/CRATE.md): ðŸŸ¢ OAuth2/OIDC provider
- [xavyo-api-users](crates/xavyo-api-users/CRATE.md): ðŸŸ¡ User management
- [xavyo-api-scim](crates/xavyo-api-scim/CRATE.md): ðŸŸ¡ SCIM provisioning
- [xavyo-api-saml](crates/xavyo-api-saml/CRATE.md): ðŸŸ¡ SAML IdP
- [xavyo-api-social](crates/xavyo-api-social/CRATE.md): ðŸŸ¡ Social login
- [xavyo-api-agents](crates/xavyo-api-agents/CRATE.md): ðŸŸ¢ AI agent security
- [xavyo-api-governance](crates/xavyo-api-governance/CRATE.md): ðŸŸ¢ IGA API
- [xavyo-api-connectors](crates/xavyo-api-connectors/CRATE.md): ðŸŸ¡ Connector API
- [xavyo-api-tenants](crates/xavyo-api-tenants/CRATE.md): ðŸŸ¢ Tenant management
- [xavyo-api-authorization](crates/xavyo-api-authorization/CRATE.md): ðŸ”´ Authz API
- [xavyo-api-import](crates/xavyo-api-import/CRATE.md): ðŸ”´ Bulk import
- [xavyo-api-oidc-federation](crates/xavyo-api-oidc-federation/CRATE.md): ðŸŸ¡ OIDC federation
- [xavyo-api-nhi](crates/xavyo-api-nhi/CRATE.md): ðŸŸ¡ Non-human identity API

## Quick Reference

### Multi-Tenancy Pattern
Every handler extracts tenant from JWT claims:
```rust
use xavyo_auth::JwtClaims;
use axum::Extension;

async fn handler(Extension(claims): Extension<JwtClaims>) -> Result<...> {
    let tenant_id = claims.tenant_id()?.as_uuid();
    // Use tenant_id in all DB queries
}
```

### Error Handling
All crates use `thiserror` with domain-specific error types.

### Database Queries
Always include `tenant_id` in WHERE clauses:
```sql
SELECT * FROM resources WHERE tenant_id = $1 AND id = $2;
```

### Feature Flags
Common flags across crates:
- `kafka` - Enable Kafka event streaming
- `openapi` - Generate OpenAPI/utoipa documentation
- `test-utils` - Include test helpers
