{"responses":{"200":{"description":"List of NHIs","content":{"application/json":{"schema":{"type":"object","description":"Paginated list of NHIs.","required":["items","total","limit","offset"],"properties":{"items":{"type":"array","items":{"type":"object","description":"NHI (Non-Human Identity) response with full lifecycle details.","required":["id","user_id","name","purpose","owner_id","status","needs_rotation","is_inactive","is_in_grace_period","needs_certification","created_at","updated_at"],"properties":{"backup_owner_id":{"type":"string","format":"uuid","description":"Backup owner (secondary contact).","nullable":true},"certified_by":{"type":"string","format":"uuid","description":"Who performed the last certification.","nullable":true},"created_at":{"type":"string","format":"date-time","description":"Creation timestamp."},"days_since_last_use":{"type":"integer","format":"int64","description":"Days since last use.","nullable":true},"days_until_expiry":{"type":"integer","format":"int64","description":"Days until expiration (if applicable).","nullable":true},"expires_at":{"type":"string","format":"date-time","description":"When this NHI expires (if applicable).","nullable":true},"grace_period_ends_at":{"type":"string","format":"date-time","description":"When the grace period ends (after inactivity warning).","nullable":true},"id":{"type":"string","format":"uuid","description":"NHI ID (same as service account ID)."},"inactivity_threshold_days":{"type":"integer","format":"int32","description":"Inactivity threshold in days (default: 90).","nullable":true},"is_in_grace_period":{"type":"boolean","description":"Whether in grace period."},"is_inactive":{"type":"boolean","description":"Whether the NHI is inactive (beyond threshold)."},"last_certified_at":{"type":"string","format":"date-time","description":"When ownership was last certified.","nullable":true},"last_rotation_at":{"type":"string","format":"date-time","description":"When credentials were last rotated.","nullable":true},"last_used_at":{"type":"string","format":"date-time","description":"When the NHI was last used.","nullable":true},"name":{"type":"string","description":"Display name for the NHI."},"needs_certification":{"type":"boolean","description":"Whether certification is due."},"needs_rotation":{"type":"boolean","description":"Whether credential rotation is needed."},"owner_id":{"type":"string","format":"uuid","description":"Primary owner responsible for this NHI."},"purpose":{"type":"string","description":"Purpose/justification for the NHI."},"rotation_interval_days":{"type":"integer","format":"int32","description":"Credential rotation interval in days.","nullable":true},"status":{"type":"string","description":"Status of a service account.","enum":["active","expired","suspended"],"title":"ServiceAccountStatus"},"suspension_reason":{"allOf":[{"type":"string","description":"Reason why an NHI was suspended.","enum":["expired","inactive","certification_revoked","emergency","manual"],"title":"NhiSuspensionReason"}],"nullable":true},"updated_at":{"type":"string","format":"date-time","description":"Last update timestamp."},"user_id":{"type":"string","format":"uuid","description":"The linked user ID."}},"title":"NhiResponse"},"description":"List of NHIs."},"limit":{"type":"integer","format":"int64","description":"Limit used for query."},"offset":{"type":"integer","format":"int64","description":"Offset used for query."},"total":{"type":"integer","format":"int64","description":"Total count matching the filter."}},"title":"NhiListResponse"}}}},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}}}