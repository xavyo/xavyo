{
  "openapi": "3.0.3",
  "info": {
    "title": "xavyo API",
    "description": "Identity Provider API for xavyo",
    "contact": {
      "name": "xavyo Team"
    },
    "license": {
      "name": "BSL-1.1",
      "url": "https://github.com/xavyo/xavyo/blob/master/LICENSE"
    },
    "version": "0.1.0"
  },
  "servers": [
    {
      "url": "http://localhost:8080",
      "description": "Development server"
    },
    {
      "url": "https://idp.xavyo.net",
      "description": "Production server"
    }
  ],
  "paths": {
    "/.well-known/agents/{id}": {
      "get": {
        "tags": [
          "AI Agent Discovery"
        ],
        "summary": "GET /.well-known/agents/{id} - A2A `AgentCard` discovery.",
        "description": "Returns the `AgentCard` for the specified agent in A2A Protocol v0.3 format.\nThis endpoint is publicly accessible for agent discovery.",
        "operationId": "getAgentCard",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "AgentCard",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentCard"
                }
              }
            }
          },
          "404": {
            "description": "Agent not found"
          },
          "410": {
            "description": "Agent not active"
          }
        }
      }
    },
    "/.well-known/jwks.json": {
      "get": {
        "tags": [
          "OIDC Discovery"
        ],
        "summary": "Returns the JSON Web Key Set containing public keys for token verification.",
        "operationId": "jwks_handler",
        "responses": {
          "200": {
            "description": "JSON Web Key Set",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JwkSet"
                }
              }
            }
          }
        }
      }
    },
    "/.well-known/openid-configuration": {
      "get": {
        "tags": [
          "OIDC Discovery"
        ],
        "summary": "Returns the `OpenID` Connect Discovery document.",
        "operationId": "discovery_handler",
        "responses": {
          "200": {
            "description": "OIDC Discovery document",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OpenIdConfiguration"
                }
              }
            }
          }
        }
      }
    },
    "/a2a/tasks": {
      "get": {
        "tags": [
          "A2A Tasks"
        ],
        "summary": "GET /a2a/tasks - List tasks created by the authenticated agent.",
        "operationId": "listA2aTasks",
        "parameters": [
          {
            "name": "state",
            "in": "query",
            "description": "Filter by task state",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "target_agent_id",
            "in": "query",
            "description": "Filter by target agent",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of tasks",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/A2aTaskListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "A2A Tasks"
        ],
        "summary": "POST /a2a/tasks - Create a new asynchronous task.",
        "operationId": "createA2aTask",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateA2aTaskRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Task created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateA2aTaskResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/A2aErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Target agent not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/A2aErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/a2a/tasks/{id}": {
      "get": {
        "tags": [
          "A2A Tasks"
        ],
        "summary": "GET /a2a/tasks/{id} - Get task status.",
        "operationId": "getA2aTask",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Task ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Task details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/A2aTaskResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Task not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/A2aErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/a2a/tasks/{id}/cancel": {
      "post": {
        "tags": [
          "A2A Tasks"
        ],
        "summary": "POST /a2a/tasks/{id}/cancel - Cancel a task.",
        "operationId": "cancelA2aTask",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Task ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Task cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CancelA2aTaskResponse"
                }
              }
            }
          },
          "400": {
            "description": "Task cannot be cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/A2aErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Task not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/A2aErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/attribute-definitions": {
      "get": {
        "tags": [
          "Attribute Definitions"
        ],
        "summary": "List attribute definitions for the tenant.",
        "operationId": "list_attribute_definitions",
        "parameters": [
          {
            "name": "is_active",
            "in": "query",
            "description": "Filter by active status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "data_type",
            "in": "query",
            "description": "Filter by data type (string, number, boolean, date, json).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Attribute definitions listed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttributeDefinitionListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Attribute Definitions"
        ],
        "summary": "Create a new attribute definition.",
        "operationId": "create_attribute_definition",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAttributeDefinitionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Attribute definition created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttributeDefinitionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "409": {
            "description": "Name already exists in tenant"
          },
          "422": {
            "description": "Limit exceeded"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/attribute-definitions/audit/missing-required": {
      "get": {
        "tags": [
          "Attribute Audit"
        ],
        "summary": "Audit users missing required custom attributes.",
        "operationId": "audit_missing_required_attributes",
        "parameters": [
          {
            "name": "attribute_name",
            "in": "query",
            "description": "Filter to a specific attribute name.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Pagination offset (default: 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Page size (default: 20, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Audit results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MissingAttributeAuditResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/attribute-definitions/seed-wellknown": {
      "post": {
        "tags": [
          "Attribute Definitions"
        ],
        "summary": "Seed well-known enterprise attributes for the tenant (F081).",
        "operationId": "seed_wellknown",
        "responses": {
          "200": {
            "description": "Well-known attributes seeded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SeedWellKnownResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/attribute-definitions/{id}": {
      "get": {
        "tags": [
          "Attribute Definitions"
        ],
        "summary": "Get an attribute definition by ID.",
        "operationId": "get_attribute_definition",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Attribute definition ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Attribute definition found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttributeDefinitionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Attribute definition not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Attribute Definitions"
        ],
        "summary": "Update an attribute definition.",
        "operationId": "update_attribute_definition",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Attribute definition ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateAttributeDefinitionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Attribute definition updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttributeDefinitionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Attribute definition not found"
          },
          "422": {
            "description": "Data type change rejected"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Attribute Definitions"
        ],
        "summary": "Delete an attribute definition.",
        "operationId": "delete_attribute_definition",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Attribute definition ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "force",
            "in": "query",
            "description": "Force delete even if user data exists (default: false).",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Attribute definition deleted"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Attribute definition not found"
          },
          "409": {
            "description": "Attribute definition in use (use force=true)"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/authorization/bulk-check": {
      "post": {
        "tags": [
          "Authorization - Query"
        ],
        "summary": "Perform multiple authorization checks at once.",
        "description": "Admin-only endpoint. Maximum 100 checks per request.",
        "operationId": "bulk_check_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkCheckRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Bulk authorization decisions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkCheckResponse"
                }
              }
            }
          },
          "400": {
            "description": "Too many checks (max 100)"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/admin/authorization/check": {
      "get": {
        "tags": [
          "Authorization - Query"
        ],
        "summary": "Check if a specified user can perform an action on a resource type.",
        "description": "Admin-only endpoint for checking authorization on behalf of another user.",
        "operationId": "admin_check_handler",
        "parameters": [
          {
            "name": "user_id",
            "in": "query",
            "description": "The user to check authorization for.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "action",
            "in": "query",
            "description": "The action to check.",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "resource_type",
            "in": "query",
            "description": "The resource type to check.",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "resource_id",
            "in": "query",
            "description": "Optional specific resource instance ID.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Authorization decision",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthorizationDecisionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/admin/authorization/mappings": {
      "get": {
        "tags": [
          "Authorization - Mappings"
        ],
        "summary": "List entitlement-action mappings with optional filters and pagination.",
        "operationId": "list_mappings",
        "parameters": [
          {
            "name": "entitlement_id",
            "in": "query",
            "description": "Filter by entitlement ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination (default: 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of mappings",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Authorization - Mappings"
        ],
        "summary": "Create a new entitlement-action mapping.",
        "operationId": "create_mapping",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateMappingRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Mapping created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          },
          "409": {
            "description": "Mapping already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/admin/authorization/mappings/{id}": {
      "get": {
        "tags": [
          "Authorization - Mappings"
        ],
        "summary": "Get an entitlement-action mapping by ID.",
        "operationId": "get_mapping",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Mapping ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Mapping details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Mapping not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Authorization - Mappings"
        ],
        "summary": "Delete an entitlement-action mapping.",
        "operationId": "delete_mapping",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Mapping ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Mapping deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          },
          "404": {
            "description": "Mapping not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/admin/authorization/policies": {
      "get": {
        "tags": [
          "Authorization - Policies"
        ],
        "summary": "List authorization policies with optional filters and pagination.",
        "operationId": "list_policies",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status (\"active\", \"inactive\").",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "effect",
            "in": "query",
            "description": "Filter by effect (\"allow\", \"deny\").",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination (default: 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of policies",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PolicyListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Authorization - Policies"
        ],
        "summary": "Create a new authorization policy.",
        "operationId": "create_policy",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePolicyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Policy created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PolicyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          },
          "409": {
            "description": "Policy name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/admin/authorization/policies/{id}": {
      "get": {
        "tags": [
          "Authorization - Policies"
        ],
        "summary": "Get an authorization policy by ID.",
        "operationId": "get_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Policy details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PolicyResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Authorization - Policies"
        ],
        "summary": "Update an authorization policy.",
        "operationId": "update_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePolicyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Policy updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PolicyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Authorization - Policies"
        ],
        "summary": "Deactivate an authorization policy.",
        "description": "Sets the policy status to \"inactive\" so it is no longer evaluated by the PDP.",
        "operationId": "deactivate_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Policy deactivated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PolicyResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/admin/branding": {
      "get": {
        "tags": [
          "Branding"
        ],
        "summary": "Get the current branding configuration for the tenant.",
        "operationId": "get_branding",
        "responses": {
          "200": {
            "description": "Branding configuration",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BrandingResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Branding"
        ],
        "summary": "Update the branding configuration for the tenant.",
        "operationId": "update_branding",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateBrandingRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Branding updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BrandingResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/branding/assets": {
      "get": {
        "tags": [
          "Branding Assets"
        ],
        "summary": "List all branding assets for the tenant.",
        "operationId": "list_assets",
        "parameters": [
          {
            "name": "asset_type",
            "in": "query",
            "description": "Filter by asset type (optional).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of assets",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AssetResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/branding/assets/upload": {
      "post": {
        "tags": [
          "Branding Assets"
        ],
        "summary": "Upload a branding asset (logo, favicon, background).",
        "operationId": "upload_asset",
        "responses": {
          "201": {
            "description": "Asset uploaded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AssetResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "413": {
            "description": "File too large"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/branding/assets/{id}": {
      "get": {
        "tags": [
          "Branding Assets"
        ],
        "summary": "Get a specific branding asset.",
        "operationId": "get_asset",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Asset ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Asset details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AssetResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Asset not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Branding Assets"
        ],
        "summary": "Delete a branding asset.",
        "operationId": "delete_asset",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Asset ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Asset deleted"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Asset not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/branding/email-templates": {
      "get": {
        "tags": [
          "Email Templates"
        ],
        "summary": "List all email templates for the tenant.",
        "operationId": "list_templates",
        "parameters": [
          {
            "name": "locale",
            "in": "query",
            "description": "Filter by locale (optional, defaults to \"en\").",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of templates",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/EmailTemplateSummaryResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/branding/email-templates/{template_type}": {
      "get": {
        "tags": [
          "Email Templates"
        ],
        "summary": "Get a specific email template.",
        "operationId": "get_template",
        "parameters": [
          {
            "name": "template_type",
            "in": "path",
            "description": "Template type",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "locale",
            "in": "query",
            "description": "Locale (optional, defaults to \"en\").",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Email template",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EmailTemplateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Template not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Email Templates"
        ],
        "summary": "Update an email template.",
        "operationId": "update_template",
        "parameters": [
          {
            "name": "template_type",
            "in": "path",
            "description": "Template type",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "locale",
            "in": "query",
            "description": "Locale (optional, defaults to \"en\").",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateEmailTemplateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Template updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EmailTemplateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Template not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/branding/email-templates/{template_type}/preview": {
      "post": {
        "tags": [
          "Email Templates"
        ],
        "summary": "Preview an email template with sample data.",
        "operationId": "preview_template",
        "parameters": [
          {
            "name": "template_type",
            "in": "path",
            "description": "Template type",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "locale",
            "in": "query",
            "description": "Locale (optional, defaults to \"en\").",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PreviewEmailTemplateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Template preview",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EmailTemplatePreviewResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Template not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/branding/email-templates/{template_type}/reset": {
      "post": {
        "tags": [
          "Email Templates"
        ],
        "summary": "Reset an email template to the default.",
        "operationId": "reset_template",
        "parameters": [
          {
            "name": "template_type",
            "in": "path",
            "description": "Template type",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "locale",
            "in": "query",
            "description": "Locale (optional, defaults to \"en\").",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Template reset to default",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EmailTemplateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Template not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/custom-attributes/bulk-update": {
      "post": {
        "tags": [
          "Bulk Operations"
        ],
        "summary": "Bulk update a custom attribute across multiple users.",
        "operationId": "bulk_update_custom_attribute",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkUpdateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Bulk update results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkUpdateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Attribute definition not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/delegation/assignments": {
      "get": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "List role assignments with optional filtering.",
        "operationId": "list_assignments",
        "parameters": [
          {
            "name": "user_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "template_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "include_expired",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean"
            }
          },
          {
            "name": "include_revoked",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean"
            }
          },
          {
            "name": "cursor",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of assignments",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AssignmentListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "Create a new role assignment for a user.",
        "operationId": "create_assignment",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAssignmentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Assignment created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AssignmentResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/delegation/assignments/{id}": {
      "get": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "Get a specific assignment with template details.",
        "operationId": "get_assignment",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Assignment ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Assignment details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AssignmentDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Assignment not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "Revoke an assignment (soft delete).",
        "operationId": "revoke_assignment",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Assignment ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Assignment revoked"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Assignment not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/delegation/audit-log": {
      "get": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "Get audit log entries with optional filtering.",
        "operationId": "get_audit_log",
        "parameters": [
          {
            "name": "admin_user_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "action",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "resource_type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "start_date",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "end_date",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "cursor",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Audit log entries",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditLogResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/delegation/check-permission": {
      "post": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "Check if a user has a specific permission.",
        "operationId": "check_permission",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CheckPermissionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Permission check result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CheckPermissionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/delegation/permissions": {
      "get": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "List all system-defined permissions with categories.",
        "description": "Requires authentication. Only accessible by authenticated admin users.",
        "operationId": "list_permissions",
        "responses": {
          "200": {
            "description": "List of permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PermissionListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/delegation/permissions/{category}": {
      "get": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "Get permissions for a specific category.",
        "description": "Requires authentication. Only accessible by authenticated admin users.",
        "operationId": "get_permissions_by_category",
        "parameters": [
          {
            "name": "category",
            "in": "path",
            "description": "Permission category",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Permissions for category",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/PermissionResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/delegation/role-templates": {
      "get": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "List all role templates.",
        "operationId": "list_role_templates",
        "parameters": [
          {
            "name": "include_system",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of role templates",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleTemplateListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "Create a new role template.",
        "operationId": "create_role_template",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateRoleTemplateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Role template created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleTemplateDetailResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/delegation/role-templates/{id}": {
      "get": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "Get a specific role template with its permissions.",
        "operationId": "get_role_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Role template details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleTemplateDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Template not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "Update an existing role template.",
        "operationId": "update_role_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateRoleTemplateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Role template updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleTemplateDetailResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Template not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "Delete a role template (system templates cannot be deleted).",
        "operationId": "delete_role_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Role template deleted"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Template not found"
          },
          "409": {
            "description": "Cannot delete system template"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/delegation/users/{user_id}/permissions": {
      "get": {
        "tags": [
          "Delegated Admin"
        ],
        "summary": "Get the effective permissions for a specific user.",
        "operationId": "get_user_permissions",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User's effective permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EffectivePermissions"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/federation/identity-providers": {
      "get": {
        "tags": [
          "OIDC Federation"
        ],
        "summary": "List identity providers for the tenant.",
        "operationId": "list_identity_providers",
        "parameters": [
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "is_enabled",
            "in": "query",
            "description": "Filter by enabled status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of identity providers",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdentityProviderListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "OIDC Federation"
        ],
        "summary": "Create a new identity provider.",
        "operationId": "create_identity_provider",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateIdentityProviderRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Identity provider created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdentityProviderResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/federation/identity-providers/{idp_id}": {
      "get": {
        "tags": [
          "OIDC Federation"
        ],
        "summary": "Get a specific identity provider.",
        "operationId": "get_identity_provider",
        "parameters": [
          {
            "name": "idp_id",
            "in": "path",
            "description": "Identity Provider ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Identity provider details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdentityProviderResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Identity provider not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "OIDC Federation"
        ],
        "summary": "Update an identity provider.",
        "operationId": "update_identity_provider",
        "parameters": [
          {
            "name": "idp_id",
            "in": "path",
            "description": "Identity Provider ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateIdentityProviderRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Identity provider updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdentityProviderResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Identity provider not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "OIDC Federation"
        ],
        "summary": "Delete an identity provider.",
        "operationId": "delete_identity_provider",
        "parameters": [
          {
            "name": "idp_id",
            "in": "path",
            "description": "Identity Provider ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Identity provider deleted"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Identity provider not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/federation/identity-providers/{idp_id}/domains": {
      "get": {
        "tags": [
          "OIDC Federation"
        ],
        "summary": "List domains for an identity provider.",
        "operationId": "list_domains",
        "parameters": [
          {
            "name": "idp_id",
            "in": "path",
            "description": "Identity Provider ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of domains",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DomainListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Identity provider not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "OIDC Federation"
        ],
        "summary": "Add a domain to an identity provider.",
        "operationId": "add_domain",
        "parameters": [
          {
            "name": "idp_id",
            "in": "path",
            "description": "Identity Provider ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateDomainRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Domain added",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DomainResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid domain"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Identity provider not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/federation/identity-providers/{idp_id}/domains/{domain_id}": {
      "delete": {
        "tags": [
          "OIDC Federation"
        ],
        "summary": "Remove a domain from an identity provider.",
        "operationId": "remove_domain",
        "parameters": [
          {
            "name": "idp_id",
            "in": "path",
            "description": "Identity Provider ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "domain_id",
            "in": "path",
            "description": "Domain ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Domain removed"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Domain or identity provider not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/federation/identity-providers/{idp_id}/toggle": {
      "post": {
        "tags": [
          "OIDC Federation"
        ],
        "summary": "Toggle identity provider enabled status.",
        "operationId": "toggle_identity_provider",
        "parameters": [
          {
            "name": "idp_id",
            "in": "path",
            "description": "Identity Provider ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ToggleIdentityProviderRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Identity provider toggled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdentityProviderResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Identity provider not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/federation/identity-providers/{idp_id}/validate": {
      "post": {
        "tags": [
          "OIDC Federation"
        ],
        "summary": "Validate an identity provider configuration.",
        "operationId": "validate_identity_provider",
        "parameters": [
          {
            "name": "idp_id",
            "in": "path",
            "description": "Identity Provider ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Validation result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationResultResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Identity provider not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/ip-restrictions/rules": {
      "get": {
        "tags": [
          "IP Restrictions"
        ],
        "summary": "List all IP restriction rules for the tenant.",
        "operationId": "list_ip_rules",
        "parameters": [
          {
            "name": "is_active",
            "in": "query",
            "description": "Filter by active status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "rule_type",
            "in": "query",
            "description": "Filter by rule type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/IpRuleType"
                }
              ],
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of IP rules",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListRulesResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "IP Restrictions"
        ],
        "summary": "Create a new IP restriction rule.",
        "operationId": "create_ip_rule",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateIpRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "IP rule created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IpRuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/ip-restrictions/rules/{id}": {
      "get": {
        "tags": [
          "IP Restrictions"
        ],
        "summary": "Get a specific IP restriction rule.",
        "operationId": "get_ip_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "IP rule retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IpRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Rule not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "IP Restrictions"
        ],
        "summary": "Update an existing IP restriction rule.",
        "operationId": "update_ip_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateIpRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "IP rule updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IpRuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Rule not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "IP Restrictions"
        ],
        "summary": "Delete an IP restriction rule.",
        "operationId": "delete_ip_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "IP rule deleted"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Rule not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/ip-restrictions/settings": {
      "get": {
        "tags": [
          "IP Restrictions"
        ],
        "summary": "Retrieve current IP restriction settings for the tenant.",
        "operationId": "get_ip_settings",
        "responses": {
          "200": {
            "description": "IP settings retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IpSettingsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "IP Restrictions"
        ],
        "summary": "Update IP restriction settings for the tenant.",
        "operationId": "update_ip_settings",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateIpSettingsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "IP settings updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IpSettingsResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/ip-restrictions/validate": {
      "post": {
        "tags": [
          "IP Restrictions"
        ],
        "summary": "Validate an IP address against current rules (for testing).",
        "operationId": "validate_ip",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ValidateIpRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "IP validation result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidateIpResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/keys": {
      "get": {
        "tags": [
          "Key Management"
        ],
        "summary": "GET /admin/keys",
        "description": "List all signing keys for the tenant.",
        "operationId": "list_keys_handler",
        "responses": {
          "200": {
            "description": "List of signing keys",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListKeysResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/KeyErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/KeyErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/keys/rotate": {
      "post": {
        "tags": [
          "Key Management"
        ],
        "summary": "POST /admin/keys/rotate",
        "description": "Generate a new signing key and retire the current active key.\nRequires admin role.",
        "operationId": "rotate_key_handler",
        "responses": {
          "200": {
            "description": "Key rotated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RotateKeyResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/KeyErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden (admin only)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/KeyErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/KeyErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/keys/{kid}": {
      "delete": {
        "tags": [
          "Key Management"
        ],
        "summary": "DELETE /admin/keys/:kid",
        "description": "Revoke a retiring key (remove from JWKS).\nOnly retiring keys can be revoked; active keys must be rotated first.",
        "operationId": "revoke_key_handler",
        "parameters": [
          {
            "name": "kid",
            "in": "path",
            "description": "Key ID to revoke",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Key revoked successfully"
          },
          "400": {
            "description": "Cannot revoke active key",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/KeyErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Key not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/KeyErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/KeyErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/oauth/clients": {
      "get": {
        "tags": [
          "OAuth2 Admin"
        ],
        "summary": "Lists all `OAuth2` clients for the current tenant.",
        "operationId": "list_clients_handler",
        "responses": {
          "200": {
            "description": "List of OAuth2 clients",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ClientListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "OAuth2 Admin"
        ],
        "summary": "Creates a new `OAuth2` client.",
        "operationId": "create_client_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateClientRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "OAuth2 client created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateClientResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/oauth/clients/{id}": {
      "get": {
        "tags": [
          "OAuth2 Admin"
        ],
        "summary": "Gets a single `OAuth2` client by ID.",
        "operationId": "get_client_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Client ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OAuth2 client",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ClientResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Client not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "OAuth2 Admin"
        ],
        "summary": "Updates an existing `OAuth2` client.",
        "operationId": "update_client_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Client ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateClientRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "OAuth2 client updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ClientResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Client not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "OAuth2 Admin"
        ],
        "summary": "Deactivates an `OAuth2` client (soft delete).",
        "operationId": "delete_client_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Client ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "OAuth2 client deactivated"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Client not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/oauth/clients/{id}/regenerate-secret": {
      "post": {
        "tags": [
          "OAuth2 Admin"
        ],
        "summary": "Regenerates the client secret for a confidential client.",
        "operationId": "regenerate_secret_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Client ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "New client secret",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegenerateSecretResponse"
                }
              }
            }
          },
          "400": {
            "description": "Client is not confidential"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Client not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/saml/certificates": {
      "get": {
        "tags": [
          "SAML Admin"
        ],
        "summary": "List all `IdP` certificates",
        "operationId": "list_certificates",
        "responses": {
          "200": {
            "description": "List of certificates",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CertificateListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "SAML Admin"
        ],
        "summary": "Upload a new `IdP` certificate",
        "operationId": "upload_certificate",
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UploadCertificateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Certificate uploaded"
          },
          "400": {
            "description": "Invalid certificate"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/saml/certificates/{cert_id}/activate": {
      "post": {
        "tags": [
          "SAML Admin"
        ],
        "summary": "Activate a certificate for signing",
        "operationId": "activate_certificate",
        "parameters": [
          {
            "name": "cert_id",
            "in": "path",
            "description": "Certificate ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Certificate activated"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Certificate not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/saml/service-providers": {
      "get": {
        "tags": [
          "SAML Admin"
        ],
        "summary": "List all service providers",
        "operationId": "list_service_providers",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "enabled",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of service providers",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServiceProviderListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "SAML Admin"
        ],
        "summary": "Create a new service provider",
        "operationId": "create_service_provider",
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateServiceProviderRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Service provider created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServiceProviderResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/saml/service-providers/{sp_id}": {
      "get": {
        "tags": [
          "SAML Admin"
        ],
        "summary": "Get a specific service provider",
        "operationId": "get_service_provider",
        "parameters": [
          {
            "name": "sp_id",
            "in": "path",
            "description": "Service Provider ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Service provider details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServiceProviderResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Service provider not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "SAML Admin"
        ],
        "summary": "Update a service provider",
        "operationId": "update_service_provider",
        "parameters": [
          {
            "name": "sp_id",
            "in": "path",
            "description": "Service Provider ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateServiceProviderRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Service provider updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServiceProviderResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Service provider not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "SAML Admin"
        ],
        "summary": "Delete a service provider",
        "operationId": "delete_service_provider",
        "parameters": [
          {
            "name": "sp_id",
            "in": "path",
            "description": "Service Provider ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Service provider deleted"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Service provider not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/scim-targets": {
      "get": {
        "tags": [
          "SCIM Targets"
        ],
        "summary": "GET /admin/scim-targets \u2014 List SCIM targets.",
        "operationId": "list_scim_targets",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of SCIM targets",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScimTargetListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "SCIM Targets"
        ],
        "summary": "POST /admin/scim-targets \u2014 Create a new SCIM target.",
        "operationId": "create_scim_target",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateScimTargetRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "SCIM target created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScimTargetResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/scim-targets/{target_id}": {
      "get": {
        "tags": [
          "SCIM Targets"
        ],
        "summary": "GET /admin/scim-targets/:id \u2014 Get a SCIM target by ID.",
        "operationId": "get_scim_target",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "SCIM target details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScimTargetResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "SCIM Targets"
        ],
        "summary": "PUT /admin/scim-targets/:id \u2014 Update a SCIM target.",
        "operationId": "update_scim_target",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateScimTargetRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "SCIM target updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScimTargetResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "SCIM Targets"
        ],
        "summary": "DELETE /admin/scim-targets/:id \u2014 Delete a SCIM target.",
        "operationId": "delete_scim_target",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "SCIM target deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/scim-targets/{target_id}/health-check": {
      "post": {
        "tags": [
          "SCIM Targets"
        ],
        "summary": "POST /admin/scim-targets/:id/health-check \u2014 Perform a health check.",
        "operationId": "health_check_scim_target",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Health check result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthCheckResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/scim-targets/{target_id}/log": {
      "get": {
        "tags": [
          "SCIM Target Logs"
        ],
        "summary": "GET /admin/scim-targets/:id/log \u2014 List provisioning log entries.",
        "operationId": "list_provisioning_log",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "resource_type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "operation_type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Provisioning log list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProvisioningLogListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/scim-targets/{target_id}/log/{log_id}": {
      "get": {
        "tags": [
          "SCIM Target Logs"
        ],
        "summary": "GET /admin/scim-targets/:id/log/:log_id \u2014 Get a single log entry with full details.",
        "operationId": "get_log_detail",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "log_id",
            "in": "path",
            "description": "Log entry ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Log entry details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScimProvisioningLog"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target or log entry not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/scim-targets/{target_id}/mappings": {
      "get": {
        "tags": [
          "SCIM Target Mappings"
        ],
        "summary": "GET /admin/scim-targets/:id/mappings \u2014 List attribute mappings for a target.",
        "operationId": "list_mappings",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "resource_type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of attribute mappings",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "SCIM Target Mappings"
        ],
        "summary": "PUT /admin/scim-targets/:id/mappings \u2014 Replace all attribute mappings for a target.",
        "operationId": "replace_mappings",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReplaceMappingsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Mappings replaced",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingListResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid mapping configuration"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/scim-targets/{target_id}/mappings/defaults": {
      "post": {
        "tags": [
          "SCIM Target Mappings"
        ],
        "summary": "POST /admin/scim-targets/:id/mappings/defaults \u2014 Reset mappings to defaults.",
        "operationId": "reset_mapping_defaults",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Mappings reset to defaults",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/scim-targets/{target_id}/provisioning-state": {
      "get": {
        "tags": [
          "SCIM Target Provisioning"
        ],
        "summary": "GET /admin/scim-targets/:id/provisioning-state \u2014 List provisioning state entries.",
        "operationId": "list_provisioning_state",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "resource_type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Provisioning state list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProvisioningStateListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/scim-targets/{target_id}/provisioning-state/{state_id}/retry": {
      "post": {
        "tags": [
          "SCIM Target Provisioning"
        ],
        "summary": "POST /admin/scim-targets/:id/provisioning-state/:state_id/retry \u2014 Retry a failed operation.",
        "operationId": "retry_provisioning",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "state_id",
            "in": "path",
            "description": "Provisioning state ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "202": {
            "description": "Retry initiated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RetryResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target or state not found"
          },
          "409": {
            "description": "State not in error status"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/scim-targets/{target_id}/reconcile": {
      "post": {
        "tags": [
          "SCIM Target Sync"
        ],
        "summary": "POST /admin/scim-targets/:id/reconcile \u2014 Trigger a reconciliation.",
        "description": "Returns 202 Accepted with `sync_run_id`, or 409 if a sync is already running.",
        "operationId": "trigger_reconciliation",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "202": {
            "description": "Reconciliation initiated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TriggerSyncResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target not found"
          },
          "409": {
            "description": "Sync already in progress"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/scim-targets/{target_id}/sync": {
      "post": {
        "tags": [
          "SCIM Target Sync"
        ],
        "summary": "POST /admin/scim-targets/:id/sync \u2014 Trigger a full sync.",
        "description": "Returns 202 Accepted with `sync_run_id`, or 409 if a sync is already running.",
        "operationId": "trigger_sync",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "202": {
            "description": "Full sync initiated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TriggerSyncResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target not found"
          },
          "409": {
            "description": "Sync already in progress"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/scim-targets/{target_id}/sync-runs": {
      "get": {
        "tags": [
          "SCIM Target Sync"
        ],
        "summary": "GET /admin/scim-targets/:id/sync-runs \u2014 List sync runs for a target.",
        "operationId": "list_sync_runs",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "run_type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of sync runs",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SyncRunListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/scim-targets/{target_id}/sync-runs/{run_id}": {
      "get": {
        "tags": [
          "SCIM Target Sync"
        ],
        "summary": "GET /admin/scim-targets/:id/sync-runs/:run_id \u2014 Get a specific sync run.",
        "operationId": "get_sync_run",
        "parameters": [
          {
            "name": "target_id",
            "in": "path",
            "description": "SCIM target ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "run_id",
            "in": "path",
            "description": "Sync run ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Sync run details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScimSyncRun"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Target or run not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/social-providers": {
      "get": {
        "tags": [
          "Social Login"
        ],
        "summary": "List all configured social providers for the tenant.",
        "operationId": "list_providers",
        "responses": {
          "200": {
            "description": "List of provider configurations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TenantProvidersListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/social-providers/{provider}": {
      "put": {
        "tags": [
          "Social Login"
        ],
        "summary": "Update or create a social provider configuration.",
        "operationId": "update_provider",
        "parameters": [
          {
            "name": "provider",
            "in": "path",
            "description": "Social provider (google, microsoft, apple)",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateProviderRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Provider configuration updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TenantProviderResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Social Login"
        ],
        "summary": "Disable a social provider.",
        "operationId": "disable_provider",
        "parameters": [
          {
            "name": "provider",
            "in": "path",
            "description": "Social provider to disable",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Provider disabled"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/tenants/{tenant_id}/webauthn-policy": {
      "get": {
        "tags": [
          "Admin - WebAuthn Policy"
        ],
        "summary": "GET /admin/tenants/:tenant_id/webauthn-policy",
        "description": "Get the `WebAuthn` policy for a tenant.",
        "operationId": "get_webauthn_policy",
        "parameters": [
          {
            "name": "tenant_id",
            "in": "path",
            "description": "Tenant ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "WebAuthn policy returned",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebAuthnPolicyResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      },
      "put": {
        "tags": [
          "Admin - WebAuthn Policy"
        ],
        "summary": "PUT /admin/tenants/:tenant_id/webauthn-policy",
        "description": "Update the `WebAuthn` policy for a tenant.",
        "operationId": "update_webauthn_policy",
        "parameters": [
          {
            "name": "tenant_id",
            "in": "path",
            "description": "Tenant ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateWebAuthnPolicyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "WebAuthn policy updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebAuthnPolicyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      }
    },
    "/admin/users/{user_id}/custom-attributes": {
      "get": {
        "tags": [
          "User Custom Attributes"
        ],
        "summary": "Get a user's custom attributes.",
        "operationId": "get_user_custom_attributes",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Custom attributes retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserCustomAttributesResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "User Custom Attributes"
        ],
        "summary": "Set (full replace) a user's custom attributes.",
        "operationId": "set_user_custom_attributes",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetCustomAttributesRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Custom attributes updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserCustomAttributesResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "patch": {
        "tags": [
          "User Custom Attributes"
        ],
        "summary": "Patch (merge) a user's custom attributes.",
        "operationId": "patch_user_custom_attributes",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PatchCustomAttributesRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Custom attributes patched",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserCustomAttributesResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/admin/users/{user_id}/webauthn/credentials": {
      "get": {
        "tags": [
          "Admin - WebAuthn Credentials"
        ],
        "summary": "GET /`admin/users/:user_id/webauthn/credentials`",
        "description": "Admin endpoint to list a user's `WebAuthn` credentials.",
        "operationId": "admin_list_user_credentials",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Credentials returned",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminCredentialListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "User not found"
          }
        }
      }
    },
    "/admin/users/{user_id}/webauthn/credentials/{credential_id}": {
      "delete": {
        "tags": [
          "Admin - WebAuthn Credentials"
        ],
        "summary": "DELETE /`admin/users/:user_id/webauthn/credentials/:credential_id`",
        "description": "Admin endpoint to revoke a user's `WebAuthn` credential.",
        "operationId": "admin_revoke_credential",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "credential_id",
            "in": "path",
            "description": "Credential ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Credential revoked"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "Credential not found"
          }
        }
      }
    },
    "/agents": {
      "get": {
        "tags": [
          "AI Agents"
        ],
        "summary": "GET /agents - List agents.",
        "operationId": "listAgents",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "agent_type",
            "in": "query",
            "description": "Filter by agent type.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "owner_id",
            "in": "query",
            "description": "Filter by owner ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "risk_level",
            "in": "query",
            "description": "Filter by risk level.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "name",
            "in": "query",
            "description": "Search by name prefix.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results. Default: 100.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination. Default: 0.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of agents",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "AI Agents"
        ],
        "summary": "POST /agents - Create a new agent.",
        "operationId": "createAgent",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAgentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Agent created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Authentication required"
          },
          "409": {
            "description": "Agent name already exists"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/agents/authorize": {
      "post": {
        "tags": [
          "AI Agent Authorization"
        ],
        "summary": "POST /agents/authorize - Make authorization decision.",
        "description": "Returns sub-100ms authorization decisions for agent tool invocations.",
        "operationId": "authorizeAgentAction",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AuthorizeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Authorization decision",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthorizeResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Authentication required"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/agents/thresholds": {
      "get": {
        "tags": [
          "Behavioral Anomaly Detection"
        ],
        "summary": "GET /agents/thresholds",
        "description": "Get tenant-wide default anomaly detection thresholds.",
        "operationId": "get_tenant_thresholds",
        "responses": {
          "200": {
            "description": "Tenant default thresholds",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThresholdsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ]
      },
      "put": {
        "tags": [
          "Behavioral Anomaly Detection"
        ],
        "summary": "PUT /agents/thresholds",
        "description": "Set tenant-wide default anomaly detection thresholds.",
        "operationId": "set_tenant_thresholds",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetThresholdsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tenant thresholds updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThresholdsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ]
      }
    },
    "/agents/{agent_id}/anomalies": {
      "get": {
        "tags": [
          "Behavioral Anomaly Detection"
        ],
        "summary": "GET /`agents/{agent_id}/anomalies`",
        "description": "List detected anomalies for an agent.",
        "operationId": "list_agent_anomalies",
        "parameters": [
          {
            "name": "agent_id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "since",
            "in": "query",
            "description": "Filter anomalies since this timestamp",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "anomaly_type",
            "in": "query",
            "description": "Filter by anomaly type",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "severity",
            "in": "query",
            "description": "Filter by severity",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Max results (default 50)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of anomalies",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AnomalyListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Agent not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ]
      }
    },
    "/agents/{agent_id}/baseline": {
      "get": {
        "tags": [
          "Behavioral Anomaly Detection"
        ],
        "summary": "GET /`agents/{agent_id}/baseline`",
        "description": "Get the current behavioral baseline for an agent.",
        "operationId": "get_agent_baseline",
        "parameters": [
          {
            "name": "agent_id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent baseline",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BaselineResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Agent not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ]
      }
    },
    "/agents/{agent_id}/security-assessment": {
      "get": {
        "tags": [
          "Security Assessment"
        ],
        "summary": "GET /agents/{id}/security-assessment",
        "description": "Performs a comprehensive security assessment of an AI agent based on the\narXiv:2511.03841 14-point vulnerability framework.\n\nReturns:\n- Overall security score (0-100)\n- Risk level (low, medium, high, critical)\n- All 14 vulnerability check results\n- Compliance status for OWASP Agentic, A2A Protocol, MCP OAuth\n- Actionable recommendations for failed/warning checks",
        "operationId": "get_agent_security_assessment",
        "parameters": [
          {
            "name": "agent_id",
            "in": "path",
            "description": "Agent ID to assess",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Security assessment completed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SecurityAssessment"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "404": {
            "description": "Agent not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ]
      }
    },
    "/agents/{agent_id}/thresholds": {
      "get": {
        "tags": [
          "Behavioral Anomaly Detection"
        ],
        "summary": "GET /`agents/{agent_id}/thresholds`",
        "description": "Get anomaly detection thresholds for an agent.",
        "operationId": "get_agent_thresholds",
        "parameters": [
          {
            "name": "agent_id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent thresholds",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThresholdsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Agent not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ]
      },
      "put": {
        "tags": [
          "Behavioral Anomaly Detection"
        ],
        "summary": "PUT /`agents/{agent_id}/thresholds`",
        "description": "Set anomaly detection thresholds for an agent.",
        "operationId": "set_agent_thresholds",
        "parameters": [
          {
            "name": "agent_id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetThresholdsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Thresholds updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThresholdsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Agent not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Behavioral Anomaly Detection"
        ],
        "summary": "DELETE /`agents/{agent_id}/thresholds`",
        "description": "Reset agent thresholds to tenant defaults.",
        "operationId": "reset_agent_thresholds",
        "parameters": [
          {
            "name": "agent_id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Thresholds reset to tenant defaults",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThresholdsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Agent not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ]
      }
    },
    "/agents/{id}": {
      "get": {
        "tags": [
          "AI Agents"
        ],
        "summary": "GET /agents/{id} - Get agent by ID.",
        "operationId": "getAgent",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Agent not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "AI Agents"
        ],
        "summary": "DELETE /agents/{id} - Delete agent.",
        "operationId": "deleteAgent",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Agent deleted"
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Agent not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "patch": {
        "tags": [
          "AI Agents"
        ],
        "summary": "PATCH /agents/{id} - Update agent.",
        "operationId": "updateAgent",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateAgentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Agent updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Agent not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/agents/{id}/audit": {
      "get": {
        "tags": [
          "AI Agent Audit"
        ],
        "summary": "GET /agents/{id}/audit - Query agent audit trail.",
        "operationId": "queryAgentAudit",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "start_time",
            "in": "query",
            "description": "Start time filter.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "end_time",
            "in": "query",
            "description": "End time filter.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "event_type",
            "in": "query",
            "description": "Filter by event type.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "decision",
            "in": "query",
            "description": "Filter by decision.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "tool_name",
            "in": "query",
            "description": "Filter by tool name.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results. Default: 100.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination. Default: 0.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Audit trail",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Agent not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/agents/{id}/permissions": {
      "get": {
        "tags": [
          "AI Agent Permissions"
        ],
        "summary": "GET /agents/{id}/permissions - List agent permissions.",
        "operationId": "listAgentPermissions",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results. Default: 100.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination. Default: 0.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PermissionListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Agent not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "AI Agent Permissions"
        ],
        "summary": "POST /agents/{id}/permissions - Grant permission to agent.",
        "operationId": "grantPermission",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GrantPermissionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Permission granted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PermissionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Agent or tool not found"
          },
          "409": {
            "description": "Permission already exists"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/agents/{id}/permissions/{tool_id}": {
      "delete": {
        "tags": [
          "AI Agent Permissions"
        ],
        "summary": "DELETE /`agents/{id}/permissions/{tool_id`} - Revoke permission.",
        "operationId": "revokePermission",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "tool_id",
            "in": "path",
            "description": "Tool ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Permission revoked"
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Permission not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/agents/{id}/reactivate": {
      "post": {
        "tags": [
          "AI Agents"
        ],
        "summary": "POST /agents/{id}/reactivate - Reactivate suspended agent.",
        "operationId": "reactivateAgent",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent reactivated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Agent not found"
          },
          "409": {
            "description": "Agent not suspended"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/agents/{id}/suspend": {
      "post": {
        "tags": [
          "AI Agents"
        ],
        "summary": "POST /agents/{id}/suspend - Suspend agent.",
        "operationId": "suspendAgent",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent suspended",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Agent not found"
          },
          "409": {
            "description": "Agent already suspended"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/approvals": {
      "get": {
        "tags": [
          "AI Agent Approvals"
        ],
        "summary": "GET /approvals - List approval requests.",
        "description": "Returns a paginated list of approval requests with optional filtering.\nSupports filtering by status (pending, approved, denied, expired) and `agent_id`.",
        "operationId": "listApprovals",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status: pending, approved, denied, expired",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "agent_id",
            "in": "query",
            "description": "Filter by agent ID",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default 50, max 100)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination (default 0)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of approval requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalListResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters"
          },
          "401": {
            "description": "Authentication required"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/approvals/{id}": {
      "get": {
        "tags": [
          "AI Agent Approvals"
        ],
        "summary": "GET /approvals/{id} - Get approval request details.",
        "description": "Returns the full details of an approval request including parameters,\ncontext, and decision information.",
        "operationId": "getApproval",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Approval request details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Approval request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/approvals/{id}/approve": {
      "post": {
        "tags": [
          "AI Agent Approvals"
        ],
        "summary": "POST /approvals/{id}/approve - Approve a pending request.",
        "description": "Approves a pending approval request. The user must be authorized\n(agent owner or team member) to approve. Optional conditions can\nbe attached to the approval.",
        "operationId": "approveRequest",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApproveRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Approval granted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Not authorized to approve this request"
          },
          "404": {
            "description": "Approval request not found"
          },
          "409": {
            "description": "Approval already decided or expired"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/approvals/{id}/deny": {
      "post": {
        "tags": [
          "AI Agent Approvals"
        ],
        "summary": "POST /approvals/{id}/deny - Deny a pending request.",
        "description": "Denies a pending approval request. A reason must be provided.\nThe user must be authorized (agent owner or team member) to deny.",
        "operationId": "denyRequest",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DenyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Approval denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request (reason required)"
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Not authorized to deny this request"
          },
          "404": {
            "description": "Approval request not found"
          },
          "409": {
            "description": "Approval already decided or expired"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/approvals/{id}/status": {
      "get": {
        "tags": [
          "AI Agent Approvals"
        ],
        "summary": "GET /approvals/{id}/status - Check approval status (lightweight).",
        "description": "Returns a minimal response with just the status for efficient polling.\nThis is the recommended endpoint for agents to poll while waiting.",
        "operationId": "checkApprovalStatus",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Approval status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalStatusResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Approval request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/auth/forgot-password": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Handle forgot password request.",
        "description": "Initiates password reset flow by generating a token and sending an email.\nAlways returns success to prevent email enumeration.",
        "operationId": "forgot_password_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ForgotPasswordRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Request processed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForgotPasswordResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid email format"
          },
          "429": {
            "description": "Rate limit exceeded"
          }
        }
      }
    },
    "/auth/login": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Handle user login.",
        "description": "Authenticates the user with email and password, then either issues\naccess and refresh tokens (if MFA is not enabled) or returns a\npartial token requiring MFA verification.",
        "operationId": "login_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "MFA required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MfaRequiredResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid credentials or account locked"
          },
          "403": {
            "description": "Account is inactive"
          },
          "429": {
            "description": "Rate limit exceeded"
          }
        }
      }
    },
    "/auth/logout": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Handle user logout.",
        "description": "Revokes the provided refresh token, preventing it from being\nused to obtain new access tokens.",
        "operationId": "logout_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LogoutRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "204": {
            "description": "Logout successful"
          },
          "400": {
            "description": "Missing refresh token"
          }
        }
      }
    },
    "/auth/mfa/webauthn/authenticate/finish": {
      "post": {
        "tags": [
          "WebAuthn MFA"
        ],
        "summary": "POST /auth/mfa/webauthn/authenticate/finish",
        "description": "Complete `WebAuthn` authentication for MFA.\nVerifies the authenticator assertion and returns full tokens on success.",
        "operationId": "finish_webauthn_authentication",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/FinishAuthenticationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Authentication successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthenticationSuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid authenticator response or verification failed"
          },
          "401": {
            "description": "Invalid or expired partial token"
          },
          "404": {
            "description": "Credential not found or challenge expired"
          },
          "429": {
            "description": "Too many failed attempts"
          }
        }
      }
    },
    "/auth/mfa/webauthn/authenticate/start": {
      "post": {
        "tags": [
          "WebAuthn MFA"
        ],
        "summary": "POST /auth/mfa/webauthn/authenticate/start",
        "description": "Start `WebAuthn` authentication for MFA.\nRequires a valid partial token from the login flow.\nReturns challenge and allowed credentials for `navigator.credentials.get()`.",
        "operationId": "start_webauthn_authentication",
        "responses": {
          "200": {
            "description": "Authentication options returned",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthenticationOptionsResponse"
                }
              }
            }
          },
          "400": {
            "description": "No WebAuthn credentials registered for this user"
          },
          "401": {
            "description": "Invalid or expired partial token"
          },
          "429": {
            "description": "Too many failed attempts"
          }
        }
      }
    },
    "/auth/mfa/webauthn/credentials": {
      "get": {
        "tags": [
          "WebAuthn MFA"
        ],
        "summary": "GET /auth/mfa/webauthn/credentials",
        "description": "List all `WebAuthn` credentials for the authenticated user.",
        "operationId": "list_webauthn_credentials",
        "responses": {
          "200": {
            "description": "List of credentials",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CredentialListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      }
    },
    "/auth/mfa/webauthn/credentials/{credential_id}": {
      "delete": {
        "tags": [
          "WebAuthn MFA"
        ],
        "summary": "DELETE /`auth/mfa/webauthn/credentials/{credential_id`}",
        "description": "Delete a `WebAuthn` credential.",
        "operationId": "delete_webauthn_credential",
        "parameters": [
          {
            "name": "credential_id",
            "in": "path",
            "description": "Credential ID to delete",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Credential deleted"
          },
          "401": {
            "description": "Not authenticated"
          },
          "404": {
            "description": "Credential not found"
          },
          "409": {
            "description": "Cannot delete last MFA method when tenant requires MFA"
          }
        }
      },
      "patch": {
        "tags": [
          "WebAuthn MFA"
        ],
        "summary": "PATCH /`auth/mfa/webauthn/credentials/{credential_id`}",
        "description": "Update (rename) a `WebAuthn` credential.",
        "operationId": "update_webauthn_credential",
        "parameters": [
          {
            "name": "credential_id",
            "in": "path",
            "description": "Credential ID to update",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateCredentialRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Credential updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UpdateCredentialResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "404": {
            "description": "Credential not found"
          }
        }
      }
    },
    "/auth/mfa/webauthn/register/finish": {
      "post": {
        "tags": [
          "WebAuthn MFA"
        ],
        "summary": "POST /auth/mfa/webauthn/register/finish",
        "description": "Complete `WebAuthn` credential registration.\nVerifies the authenticator response and stores the credential.",
        "operationId": "finish_webauthn_registration",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/FinishRegistrationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Credential registered successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegistrationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid authenticator response or verification failed"
          },
          "401": {
            "description": "Not authenticated"
          },
          "404": {
            "description": "No pending registration found or challenge expired"
          },
          "409": {
            "description": "Credential already registered"
          }
        }
      }
    },
    "/auth/mfa/webauthn/register/start": {
      "post": {
        "tags": [
          "WebAuthn MFA"
        ],
        "summary": "POST /auth/mfa/webauthn/register/start",
        "description": "Start `WebAuthn` credential registration for the authenticated user.\nReturns challenge and options for the browser's `navigator.credentials.create()` call.",
        "operationId": "start_webauthn_registration",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/StartRegistrationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Registration options returned",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegistrationOptionsResponse"
                }
              }
            }
          },
          "400": {
            "description": "Max credentials reached or WebAuthn disabled"
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      }
    },
    "/auth/password": {
      "put": {
        "tags": [
          "Authentication"
        ],
        "summary": "Handle password change request.",
        "description": "Allows authenticated users to change their password.",
        "operationId": "password_change_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PasswordChangeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Password changed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PasswordChangeResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation failed"
          },
          "401": {
            "description": "Invalid current password"
          },
          "403": {
            "description": "Password was recently used"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/auth/passwordless/email-otp": {
      "post": {
        "tags": [
          "Passwordless Authentication"
        ],
        "summary": "POST /auth/passwordless/email-otp",
        "description": "Request a 6-digit OTP code for passwordless login.\nAlways returns success to prevent email enumeration.",
        "operationId": "request_email_otp_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PasswordlessRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Email OTP request accepted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PasswordlessInitResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation error"
          },
          "429": {
            "description": "Rate limit exceeded"
          }
        }
      }
    },
    "/auth/passwordless/email-otp/verify": {
      "post": {
        "tags": [
          "Passwordless Authentication"
        ],
        "summary": "POST /auth/passwordless/email-otp/verify",
        "description": "Verify a 6-digit OTP code and return access/refresh tokens.",
        "operationId": "verify_email_otp_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EmailOtpVerifyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Authentication successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired code"
          },
          "401": {
            "description": "Account locked"
          }
        }
      }
    },
    "/auth/passwordless/magic-link": {
      "post": {
        "tags": [
          "Passwordless Authentication"
        ],
        "summary": "POST /auth/passwordless/magic-link",
        "description": "Request a magic link for passwordless login.\nAlways returns success to prevent email enumeration.",
        "operationId": "request_magic_link_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PasswordlessRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Magic link request accepted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PasswordlessInitResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation error"
          },
          "429": {
            "description": "Rate limit exceeded"
          }
        }
      }
    },
    "/auth/passwordless/magic-link/verify": {
      "post": {
        "tags": [
          "Passwordless Authentication"
        ],
        "summary": "POST /auth/passwordless/magic-link/verify",
        "description": "Verify a magic link token and return access/refresh tokens.",
        "operationId": "verify_magic_link_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MagicLinkVerifyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Authentication successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid, expired, or used token"
          },
          "401": {
            "description": "Account locked"
          }
        }
      }
    },
    "/auth/passwordless/methods": {
      "get": {
        "tags": [
          "Passwordless Authentication"
        ],
        "summary": "GET /auth/passwordless/methods",
        "description": "Get available passwordless methods for the tenant.\nThis is a public endpoint (no authentication required).",
        "operationId": "get_available_methods_handler",
        "responses": {
          "200": {
            "description": "Available methods",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AvailableMethodsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/auth/passwordless/policy": {
      "get": {
        "tags": [
          "Passwordless Policy"
        ],
        "summary": "GET /auth/passwordless/policy",
        "description": "Get the current passwordless policy for the tenant.\nRequires admin role.",
        "operationId": "get_passwordless_policy_handler",
        "responses": {
          "200": {
            "description": "Passwordless policy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PasswordlessPolicyResponse"
                }
              }
            }
          },
          "403": {
            "description": "Admin role required"
          }
        }
      },
      "put": {
        "tags": [
          "Passwordless Policy"
        ],
        "summary": "PUT /auth/passwordless/policy",
        "description": "Create or update the passwordless policy for the tenant.\nRequires admin role.",
        "operationId": "update_passwordless_policy_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePasswordlessPolicyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Policy updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PasswordlessPolicyResponse"
                }
              }
            }
          },
          "403": {
            "description": "Admin role required"
          },
          "422": {
            "description": "Validation error"
          }
        }
      }
    },
    "/auth/refresh": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Handle token refresh.",
        "description": "Validates the refresh token, revokes it (token rotation),\nand issues new access and refresh tokens.",
        "operationId": "refresh_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RefreshRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tokens refreshed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid or expired refresh token"
          },
          "403": {
            "description": "Token revoked or user inactive"
          }
        }
      }
    },
    "/auth/register": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Handle user registration.",
        "description": "Creates a new user account with the provided email and password.\nValidates input, checks for duplicate email within the tenant,\nand sends a verification email to the user.",
        "operationId": "register_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "User created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegisterResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid email or weak password"
          },
          "409": {
            "description": "Email already in use for this tenant"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/auth/resend-verification": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Handle resend verification request.",
        "description": "Resends the email verification link for unverified accounts.\nInvalidates any previous verification tokens.\nAlways returns success to prevent email enumeration.",
        "operationId": "resend_verification_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResendVerificationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Request processed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ResendVerificationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid email format"
          },
          "429": {
            "description": "Rate limit exceeded"
          }
        }
      }
    },
    "/auth/reset-password": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Handle reset password request.",
        "description": "Completes the password reset flow using the token from email.\nValidates the token, checks expiration, and updates the password.\nAlso invalidates all existing refresh tokens for the user.",
        "operationId": "reset_password_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResetPasswordRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Password reset successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ResetPasswordResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or weak password"
          },
          "401": {
            "description": "Invalid, expired, or already used token"
          }
        }
      }
    },
    "/auth/tokens/revoke": {
      "post": {
        "tags": [
          "Token Revocation"
        ],
        "summary": "POST /auth/tokens/revoke",
        "description": "Revoke a specific JWT access token by its JTI claim.\nAdmins can revoke any token. Users can only revoke their own.",
        "operationId": "revoke_token_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RevokeTokenRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Token revoked successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevocationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request (empty JTI or reason too long)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevocationErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized (missing or invalid token)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevocationErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Non-admin cannot revoke another user's token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevocationErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevocationErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/auth/tokens/revoke-user": {
      "post": {
        "tags": [
          "Token Revocation"
        ],
        "summary": "POST /auth/tokens/revoke-user",
        "description": "Revoke all active tokens for a user (\"sign out everywhere\").\nAdmins can revoke any user's tokens. Users can only revoke their own.",
        "operationId": "revoke_user_tokens_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RevokeUserTokensRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "All user tokens revoked successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserRevocationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized (missing or invalid token)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevocationErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Non-admin cannot revoke another user's tokens",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevocationErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevocationErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/auth/verify-email": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Handle verify email request.",
        "description": "Verifies the user's email address using the token from email.\nIdempotent - succeeds gracefully if already verified.",
        "operationId": "verify_email_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyEmailRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Email verified",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/VerifyEmailResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Invalid or expired token"
          }
        }
      }
    },
    "/authorization/can-i": {
      "get": {
        "tags": [
          "Authorization - Query"
        ],
        "summary": "Check if the current user can perform an action on a resource type.",
        "description": "Uses the caller's identity (from JWT) as the subject.",
        "operationId": "can_i_handler",
        "parameters": [
          {
            "name": "action",
            "in": "query",
            "description": "The action to check (e.g., \"read\", \"write\", \"delete\").",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "resource_type",
            "in": "query",
            "description": "The resource type to check (e.g., \"report\", \"user\").",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "resource_id",
            "in": "query",
            "description": "Optional specific resource instance ID.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Authorization decision",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthorizationDecisionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/connectors": {
      "get": {
        "tags": [
          "Connectors"
        ],
        "summary": "List connectors with optional filtering and pagination.",
        "operationId": "list_connectors",
        "parameters": [
          {
            "name": "connector_type",
            "in": "query",
            "description": "Filter by connector type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ConnectorType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ConnectorStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "name_contains",
            "in": "query",
            "description": "Filter by name (partial match).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of connectors",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConnectorListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Connectors"
        ],
        "summary": "Create a new connector.",
        "operationId": "create_connector",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateConnectorRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Connector created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConnectorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Connector name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/connectors/sync/status": {
      "get": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "Get sync status for all connectors.",
        "operationId": "get_all_sync_status",
        "responses": {
          "200": {
            "description": "All sync statuses",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/SyncStatusResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/mappings": {
      "get": {
        "tags": [
          "mappings"
        ],
        "summary": "List mappings for a connector.",
        "description": "GET /`connectors/{connector_id}/mappings`",
        "operationId": "list_mappings",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "object_class",
            "in": "query",
            "description": "Filter by object class",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Mappings list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/MappingResponse"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Connector not found"
          }
        }
      },
      "post": {
        "tags": [
          "mappings"
        ],
        "summary": "Create a new attribute mapping.",
        "description": "POST /`connectors/{connector_id}/mappings`",
        "operationId": "create_mapping",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateMappingRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Mapping created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "404": {
            "description": "Connector not found"
          }
        }
      }
    },
    "/connectors/{connector_id}/mappings/{mapping_id}": {
      "get": {
        "tags": [
          "mappings"
        ],
        "summary": "Get a specific mapping.",
        "description": "GET /`connectors/{connector_id}/mappings/{mapping_id`}",
        "operationId": "get_mapping",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "mapping_id",
            "in": "path",
            "description": "Mapping ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Mapping details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingResponse"
                }
              }
            }
          },
          "404": {
            "description": "Mapping not found"
          }
        }
      },
      "put": {
        "tags": [
          "mappings"
        ],
        "summary": "Update a mapping.",
        "description": "PUT /`connectors/{connector_id}/mappings/{mapping_id`}",
        "operationId": "update_mapping",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "mapping_id",
            "in": "path",
            "description": "Mapping ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateMappingRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Mapping updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "404": {
            "description": "Mapping not found"
          }
        }
      },
      "delete": {
        "tags": [
          "mappings"
        ],
        "summary": "Delete a mapping.",
        "description": "DELETE /`connectors/{connector_id}/mappings/{mapping_id`}",
        "operationId": "delete_mapping",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "mapping_id",
            "in": "path",
            "description": "Mapping ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Mapping deleted"
          },
          "404": {
            "description": "Mapping not found"
          }
        }
      }
    },
    "/connectors/{connector_id}/mappings/{mapping_id}/preview": {
      "post": {
        "tags": [
          "mappings"
        ],
        "summary": "Preview a mapping transformation.",
        "description": "POST /`connectors/{connector_id}/mappings/{mapping_id}/preview`",
        "operationId": "preview_mapping",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "mapping_id",
            "in": "path",
            "description": "Mapping ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PreviewMappingRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Preview result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PreviewMappingResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "404": {
            "description": "Mapping not found"
          }
        }
      }
    },
    "/connectors/{connector_id}/reconciliation/actions": {
      "get": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "List actions.",
        "operationId": "list_actions",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "discrepancy_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "action_type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "result",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "dry_run",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of remediation actions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListActionsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/discrepancies": {
      "get": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "List discrepancies.",
        "operationId": "list_discrepancies",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "run_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "discrepancy_type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "resolution_status",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "identity_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "external_uid",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of discrepancies",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListDiscrepanciesResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/discrepancies/bulk-remediate": {
      "post": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Bulk remediate discrepancies.",
        "operationId": "bulk_remediate_discrepancies",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkRemediateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Bulk remediation results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkRemediationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request (e.g., too many items)"
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/discrepancies/preview": {
      "post": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Preview remediation changes.",
        "operationId": "preview_remediation",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PreviewRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Preview of remediation changes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PreviewResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/discrepancies/{discrepancy_id}": {
      "get": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Get a discrepancy by ID.",
        "operationId": "get_discrepancy",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "discrepancy_id",
            "in": "path",
            "description": "Discrepancy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Discrepancy details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DiscrepancyResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Discrepancy not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/discrepancies/{discrepancy_id}/ignore": {
      "post": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Ignore a discrepancy.",
        "operationId": "ignore_discrepancy",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "discrepancy_id",
            "in": "path",
            "description": "Discrepancy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Discrepancy ignored"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Discrepancy not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/discrepancies/{discrepancy_id}/remediate": {
      "post": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Remediate a discrepancy.",
        "operationId": "remediate_discrepancy",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "discrepancy_id",
            "in": "path",
            "description": "Discrepancy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RemediateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Remediation result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemediationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Discrepancy not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/runs": {
      "get": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "List reconciliation runs.",
        "operationId": "list_reconciliation_runs",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "mode",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of reconciliation runs",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListRunsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/runs/{run_id}": {
      "get": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Get a reconciliation run by ID.",
        "operationId": "get_reconciliation_run",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "run_id",
            "in": "path",
            "description": "Reconciliation run ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Reconciliation run details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReconciliationRunResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Run not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/runs/{run_id}/cancel": {
      "post": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Cancel a reconciliation run.",
        "operationId": "cancel_reconciliation_run",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "run_id",
            "in": "path",
            "description": "Reconciliation run ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Run cancelled"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Run not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/runs/{run_id}/report": {
      "get": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Get report for a reconciliation run.",
        "operationId": "get_report",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "run_id",
            "in": "path",
            "description": "Reconciliation run ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Reconciliation report",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Run not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/runs/{run_id}/resume": {
      "post": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Resume a failed/cancelled reconciliation run.",
        "operationId": "resume_reconciliation_run",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "run_id",
            "in": "path",
            "description": "Reconciliation run ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Run resumed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReconciliationRunResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Run not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/schedule": {
      "get": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Get schedule for a connector.",
        "operationId": "get_schedule",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Schedule configuration",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScheduleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Schedule not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Update schedule for a connector.",
        "operationId": "update_schedule",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ScheduleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Schedule updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScheduleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Delete schedule for a connector.",
        "operationId": "delete_schedule",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Schedule deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Schedule not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/schedule/disable": {
      "post": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Disable schedule.",
        "operationId": "disable_schedule",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Schedule disabled"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Schedule not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/schedule/enable": {
      "post": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Enable schedule.",
        "operationId": "enable_schedule",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Schedule enabled"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Schedule not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/reconciliation/trigger": {
      "post": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Trigger a reconciliation run.",
        "operationId": "trigger_reconciliation",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TriggerReconciliationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "202": {
            "description": "Reconciliation run triggered",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReconciliationRunResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/sync/changes": {
      "get": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "List inbound changes.",
        "operationId": "list_changes",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of changes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListChangesResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/sync/changes/{change_id}": {
      "get": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "Get a specific inbound change.",
        "operationId": "get_change",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "change_id",
            "in": "path",
            "description": "Change ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Change details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InboundChangeResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Change not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/sync/changes/{change_id}/link": {
      "post": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "Manually link a change to a user.",
        "operationId": "link_change",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "change_id",
            "in": "path",
            "description": "Change ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LinkChangeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "204": {
            "description": "Change linked"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Change not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/sync/changes/{change_id}/retry": {
      "post": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "Retry processing a failed change.",
        "operationId": "retry_change",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "change_id",
            "in": "path",
            "description": "Change ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Retry initiated"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Change not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/sync/config": {
      "get": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "Get sync configuration for a connector.",
        "operationId": "get_sync_config",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Sync configuration",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SyncConfigResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "Update sync configuration.",
        "operationId": "update_sync_config",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSyncConfigRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Updated sync configuration",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SyncConfigResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/sync/conflicts": {
      "get": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "List sync conflicts.",
        "operationId": "list_sync_conflicts",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of conflicts",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListConflictsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/sync/conflicts/{conflict_id}/resolve": {
      "post": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "Resolve a sync conflict.",
        "operationId": "resolve_sync_conflict",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "conflict_id",
            "in": "path",
            "description": "Conflict ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResolveConflictRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "204": {
            "description": "Conflict resolved"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Conflict not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/sync/disable": {
      "post": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "Disable sync for a connector.",
        "operationId": "disable_sync",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Sync disabled"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/sync/enable": {
      "post": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "Enable sync for a connector.",
        "operationId": "enable_sync",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Sync enabled"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/sync/status": {
      "get": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "Get sync status for a connector.",
        "operationId": "get_sync_status",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Sync status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SyncStatusResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/sync/token": {
      "get": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "Get sync token for a connector.",
        "operationId": "get_sync_token",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Sync token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SyncTokenResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Token not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "Reset sync token (trigger full resync).",
        "operationId": "reset_sync_token",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Token reset"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{connector_id}/sync/trigger": {
      "post": {
        "tags": [
          "Connector Sync"
        ],
        "summary": "Trigger a sync cycle manually.",
        "operationId": "trigger_sync",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Sync triggered",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SyncTriggerResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/connectors/{id}": {
      "get": {
        "tags": [
          "Connectors"
        ],
        "summary": "Get a connector by ID.",
        "operationId": "get_connector",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Connector details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConnectorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Connectors"
        ],
        "summary": "Update a connector.",
        "operationId": "update_connector",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateConnectorRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Connector updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConnectorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          },
          "409": {
            "description": "Connector name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Connectors"
        ],
        "summary": "Delete a connector.",
        "operationId": "delete_connector",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Connector deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/connectors/{id}/activate": {
      "post": {
        "tags": [
          "Connectors"
        ],
        "summary": "Activate a connector.",
        "operationId": "activate_connector",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Connector activated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConnectorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/connectors/{id}/deactivate": {
      "post": {
        "tags": [
          "Connectors"
        ],
        "summary": "Deactivate a connector.",
        "operationId": "deactivate_connector",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Connector deactivated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConnectorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/connectors/{id}/health": {
      "get": {
        "tags": [
          "Connectors"
        ],
        "summary": "Get connector health status.",
        "operationId": "get_connector_health",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Connector health status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConnectorHealthResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          },
          "500": {
            "description": "Internal server error"
          },
          "501": {
            "description": "Health service not configured"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/connectors/{id}/schema": {
      "get": {
        "tags": [
          "Schema Discovery"
        ],
        "summary": "Get cached schema with optional version.",
        "description": "Returns the latest cached schema or a specific version if requested.",
        "operationId": "get_cached_schema",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "version",
            "in": "query",
            "description": "Specific version to retrieve (default is latest).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cached schema",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SchemaResponse"
                }
              }
            }
          },
          "404": {
            "description": "Schema not found"
          }
        }
      },
      "delete": {
        "tags": [
          "Schemas"
        ],
        "summary": "Clear schema cache for a connector.",
        "operationId": "clear_schema_cache",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Schema cache cleared"
          },
          "404": {
            "description": "Connector not found"
          }
        }
      }
    },
    "/connectors/{id}/schema/diff": {
      "get": {
        "tags": [
          "Schema Discovery"
        ],
        "summary": "Compare schema versions.",
        "description": "Computes diff between two schema versions, identifying added/removed/modified\nobject classes and attributes, and highlighting breaking changes.",
        "operationId": "diff_schema_versions",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "from_version",
            "in": "query",
            "description": "Source version for comparison.",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "to_version",
            "in": "query",
            "description": "Target version for comparison.",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Schema diff",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SchemaDiffResponse"
                }
              }
            }
          },
          "404": {
            "description": "One or both versions not found"
          }
        }
      }
    },
    "/connectors/{id}/schema/discover": {
      "post": {
        "tags": [
          "Schema Discovery"
        ],
        "summary": "Trigger schema discovery (async).",
        "description": "Initiates schema discovery for a connector. Returns immediately with status.\nReturns 409 if discovery is already in progress.",
        "operationId": "trigger_schema_discovery",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DiscoverSchemaRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "202": {
            "description": "Discovery started",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DiscoveryStatusResponse"
                }
              }
            }
          },
          "404": {
            "description": "Connector not found"
          },
          "409": {
            "description": "Discovery already in progress"
          }
        }
      }
    },
    "/connectors/{id}/schema/object-classes": {
      "get": {
        "tags": [
          "Schema Browsing"
        ],
        "summary": "List object classes.",
        "description": "Returns all object classes in the cached schema with summary info\nincluding attribute count and parent class hierarchy.",
        "operationId": "list_object_classes",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of object classes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ObjectClassListResponse"
                }
              }
            }
          },
          "404": {
            "description": "Schema not found"
          }
        }
      }
    },
    "/connectors/{id}/schema/object-classes/{name}": {
      "get": {
        "tags": [
          "Schema Browsing"
        ],
        "summary": "Get object class details.",
        "description": "Returns detailed information about a specific object class.",
        "operationId": "get_object_class_details",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "name",
            "in": "path",
            "description": "Object class name",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Object class details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ObjectClassResponse"
                }
              }
            }
          },
          "404": {
            "description": "Object class not found"
          }
        }
      }
    },
    "/connectors/{id}/schema/object-classes/{name}/attributes": {
      "get": {
        "tags": [
          "Schema Browsing"
        ],
        "summary": "List attributes for object class.",
        "description": "Returns all attributes for a specific object class with source info\nindicating whether each attribute is directly defined or inherited.\nUse `include_inherited=false` to exclude inherited attributes.",
        "operationId": "list_object_class_attributes",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "name",
            "in": "path",
            "description": "Object class name",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "include_inherited",
            "in": "query",
            "description": "Include inherited attributes (default true).",
            "required": false,
            "schema": {
              "type": "boolean"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of attributes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttributeListResponse"
                }
              }
            }
          },
          "404": {
            "description": "Object class not found"
          }
        }
      }
    },
    "/connectors/{id}/schema/schedule": {
      "get": {
        "tags": [
          "Schema Scheduling"
        ],
        "summary": "Get refresh schedule.",
        "description": "Returns the automatic refresh schedule configuration.",
        "operationId": "get_refresh_schedule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Schedule configuration",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RefreshScheduleResponse"
                }
              }
            }
          },
          "404": {
            "description": "No schedule configured"
          }
        }
      },
      "put": {
        "tags": [
          "Schema Scheduling"
        ],
        "summary": "Configure refresh schedule.",
        "description": "Creates or updates automatic refresh schedule.",
        "operationId": "set_refresh_schedule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RefreshScheduleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Schedule updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RefreshScheduleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid schedule configuration"
          }
        }
      },
      "delete": {
        "tags": [
          "Schema Scheduling"
        ],
        "summary": "Delete refresh schedule.",
        "description": "Removes automatic refresh schedule.",
        "operationId": "delete_refresh_schedule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Schedule deleted"
          },
          "404": {
            "description": "No schedule exists"
          }
        }
      }
    },
    "/connectors/{id}/schema/status": {
      "get": {
        "tags": [
          "Schema Discovery"
        ],
        "summary": "Get discovery status.",
        "description": "Returns the current discovery status for a connector.",
        "operationId": "get_discovery_status",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Discovery status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DiscoveryStatusResponse"
                }
              }
            }
          },
          "404": {
            "description": "Connector not found"
          }
        }
      }
    },
    "/connectors/{id}/schema/versions": {
      "get": {
        "tags": [
          "Schema Discovery"
        ],
        "summary": "List schema versions.",
        "description": "Returns a paginated list of all schema version snapshots.",
        "operationId": "list_schema_versions",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of items to return.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of items to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of schema versions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SchemaVersionListResponse"
                }
              }
            }
          },
          "404": {
            "description": "Connector not found"
          }
        }
      }
    },
    "/connectors/{id}/schema/{object_class}": {
      "get": {
        "tags": [
          "Schemas"
        ],
        "summary": "Get a specific object class from the schema.",
        "operationId": "get_object_class",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "object_class",
            "in": "path",
            "description": "Object class name",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Object class details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ObjectClassResponse"
                }
              }
            }
          },
          "404": {
            "description": "Object class not found"
          }
        }
      }
    },
    "/connectors/{id}/test": {
      "post": {
        "tags": [
          "Connectors"
        ],
        "summary": "Test a connector's connection.",
        "operationId": "test_connector",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Connection test result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConnectionTestResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/access-requests": {
      "get": {
        "tags": [
          "Governance - Access Requests"
        ],
        "summary": "List the current user's access requests.",
        "operationId": "list_my_requests",
        "parameters": [
          {
            "name": "entitlement_id",
            "in": "query",
            "description": "Filter by entitlement ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GovRequestStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "has_sod_warning",
            "in": "query",
            "description": "Filter by `SoD` warning presence.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of access requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessRequestListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Access Requests"
        ],
        "summary": "Submit a new access request.",
        "operationId": "create_request",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAccessRequestRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Access request created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessRequestCreatedResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Entitlement not found"
          },
          "409": {
            "description": "Request already exists or entitlement already assigned"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/access-requests/{id}": {
      "get": {
        "tags": [
          "Governance - Access Requests"
        ],
        "summary": "Get an access request by ID.",
        "operationId": "get_request",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Access Request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Access request details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessRequestResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Access request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/access-requests/{id}/approve": {
      "post": {
        "tags": [
          "Governance - Approvals"
        ],
        "summary": "Approve an access request.",
        "operationId": "approve_request",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Access Request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApproveRequestRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Request approved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalActionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Request is not pending"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Cannot approve own request or not authorized"
          },
          "404": {
            "description": "Access request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/access-requests/{id}/cancel": {
      "post": {
        "tags": [
          "Governance - Access Requests"
        ],
        "summary": "Cancel a pending access request.",
        "operationId": "cancel_request",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Access Request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Request cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessRequestResponse"
                }
              }
            }
          },
          "400": {
            "description": "Cannot cancel non-pending request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Not authorized to cancel this request"
          },
          "404": {
            "description": "Access request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/access-requests/{id}/reject": {
      "post": {
        "tags": [
          "Governance - Approvals"
        ],
        "summary": "Reject an access request.",
        "operationId": "reject_request",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Access Request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RejectRequestRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Request rejected",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalActionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Request is not pending or comments required"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Cannot reject own request or not authorized"
          },
          "404": {
            "description": "Access request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/access-requests/{request_id}/cancel-escalation": {
      "post": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Cancel pending escalation for an access request.",
        "description": "Stops the escalation timer but keeps the current assignee (the escalation\ntarget who received the work item). The request remains at its current\nescalation level for audit purposes.\n\nThis is useful when:\n- An external event makes escalation unnecessary\n- The current assignee needs more time without further escalation\n- Manual intervention is overriding the automatic process",
        "operationId": "cancel_escalation",
        "parameters": [
          {
            "name": "request_id",
            "in": "path",
            "description": "Access Request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Escalation cancelled successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CancelEscalationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Request has not been escalated"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Access request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/access-requests/{request_id}/escalation-history": {
      "get": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Get escalation history for a specific access request.",
        "description": "Returns all escalation events for the request in chronological order,\nalong with summary information about the current escalation state.",
        "operationId": "get_request_escalation_history",
        "parameters": [
          {
            "name": "request_id",
            "in": "path",
            "description": "Access Request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Escalation history for the request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EscalationHistoryResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Access request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/access-requests/{request_id}/reset-escalation": {
      "post": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Reset escalation to original approver.",
        "description": "Returns the work item to the original approver and restarts the escalation\ntimer from the beginning. The escalation level is reset to 0.\n\nThis is useful when:\n- The original approver is now available\n- A mistake was made in the escalation process\n- The request needs to start fresh with the original workflow",
        "operationId": "reset_escalation",
        "parameters": [
          {
            "name": "request_id",
            "in": "path",
            "description": "Access Request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Escalation reset successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ResetEscalationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Request has not been escalated or cannot determine original approver"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Access request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/access-snapshots": {
      "get": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "List access snapshots with optional filtering and pagination.",
        "operationId": "list_snapshots",
        "parameters": [
          {
            "name": "user_id",
            "in": "query",
            "description": "Filter by user ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "event_id",
            "in": "query",
            "description": "Filter by event ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "snapshot_type",
            "in": "query",
            "description": "Filter by snapshot type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/AccessSnapshotType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of access snapshots",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessSnapshotListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/access-snapshots/{id}": {
      "get": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Get an access snapshot by ID.",
        "operationId": "get_snapshot",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Snapshot ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Snapshot details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessSnapshotResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Snapshot not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/admin/tickets/sync": {
      "post": {
        "tags": [
          "Governance - Ticketing Admin"
        ],
        "summary": "Trigger a manual sync of all pending tickets for a tenant.",
        "description": "Admin endpoint to force synchronization of all pending external tickets.",
        "operationId": "trigger_ticket_sync",
        "responses": {
          "200": {
            "description": "Sync completed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TicketSyncResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/admin/tickets/{ticket_id}/sync": {
      "post": {
        "tags": [
          "Governance - Ticketing Admin"
        ],
        "summary": "Force sync a specific ticket.",
        "operationId": "sync_single_ticket",
        "parameters": [
          {
            "name": "ticket_id",
            "in": "path",
            "description": "Ticket ID to sync",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Ticket synced",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SingleTicketSyncResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Ticket not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/applications": {
      "get": {
        "tags": [
          "Governance - Applications"
        ],
        "summary": "List applications with optional filtering and pagination.",
        "operationId": "list_applications",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GovAppStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "app_type",
            "in": "query",
            "description": "Filter by application type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GovAppType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results to return.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of applications",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApplicationListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Applications"
        ],
        "summary": "Create a new application.",
        "operationId": "create_application",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateApplicationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Application created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApplicationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Application name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/applications/{id}": {
      "get": {
        "tags": [
          "Governance - Applications"
        ],
        "summary": "Get an application by ID.",
        "operationId": "get_application",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Application ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Application details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApplicationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Applications"
        ],
        "summary": "Update an application.",
        "operationId": "update_application",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Application ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateApplicationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Application updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApplicationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Application not found"
          },
          "409": {
            "description": "Application name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Applications"
        ],
        "summary": "Delete an application.",
        "operationId": "delete_application",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Application ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Application deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Application not found"
          },
          "412": {
            "description": "Cannot delete application with entitlements"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/approval-groups": {
      "get": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "List approval groups.",
        "operationId": "list_groups",
        "parameters": [
          {
            "name": "is_active",
            "in": "query",
            "description": "Filter by active status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of approval groups",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalGroupListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Create a new approval group.",
        "operationId": "create_group",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateApprovalGroupRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Group created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalGroupResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Group name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/approval-groups/{id}": {
      "get": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Get an approval group by ID.",
        "operationId": "get_group",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Approval group details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalGroupResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Group not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Update an approval group.",
        "operationId": "update_group",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateApprovalGroupRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Group updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalGroupResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Group not found"
          },
          "409": {
            "description": "Group name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Delete an approval group.",
        "operationId": "delete_group",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Group deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Group not found"
          },
          "412": {
            "description": "Group is in use by escalation rules"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/approval-groups/{id}/disable": {
      "post": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Disable an approval group.",
        "operationId": "disable_group",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Group disabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalGroupResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Group not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/approval-groups/{id}/enable": {
      "post": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Enable an approval group.",
        "operationId": "enable_group",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Group enabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalGroupResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Group not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/approval-groups/{id}/members": {
      "post": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Add members to an approval group.",
        "operationId": "add_members",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ModifyMembersRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Members added",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalGroupResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Group not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Remove members from an approval group.",
        "operationId": "remove_members",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ModifyMembersRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Members removed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalGroupResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Group not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/approval-steps/{step_id}/escalation": {
      "get": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Get escalation configuration for an approval step.",
        "operationId": "get_step_escalation",
        "parameters": [
          {
            "name": "step_id",
            "in": "path",
            "description": "Approval Step ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Step escalation configuration",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StepEscalationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Step not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Configure escalation for an approval step.",
        "operationId": "configure_step_escalation",
        "parameters": [
          {
            "name": "step_id",
            "in": "path",
            "description": "Approval Step ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ConfigureStepEscalationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Step escalation configured",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StepEscalationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Step not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Remove escalation configuration for an approval step.",
        "operationId": "remove_step_escalation",
        "parameters": [
          {
            "name": "step_id",
            "in": "path",
            "description": "Approval Step ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Step escalation configuration removed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Step not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/approval-steps/{step_id}/escalation/disable": {
      "post": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Disable escalation for an approval step.",
        "operationId": "disable_step_escalation",
        "parameters": [
          {
            "name": "step_id",
            "in": "path",
            "description": "Approval Step ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Escalation disabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StepEscalationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Step not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/approval-steps/{step_id}/escalation/enable": {
      "post": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Enable escalation for an approval step.",
        "operationId": "enable_step_escalation",
        "parameters": [
          {
            "name": "step_id",
            "in": "path",
            "description": "Approval Step ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Escalation enabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StepEscalationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Step not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/approval-workflows": {
      "get": {
        "tags": [
          "Governance - Approval Workflows"
        ],
        "summary": "List approval workflows.",
        "operationId": "list_workflows",
        "parameters": [
          {
            "name": "is_active",
            "in": "query",
            "description": "Filter by active status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "is_default",
            "in": "query",
            "description": "Filter by default status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of approval workflows",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalWorkflowListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Approval Workflows"
        ],
        "summary": "Create a new approval workflow.",
        "operationId": "create_workflow",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateApprovalWorkflowRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Workflow created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalWorkflowResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Workflow name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/approval-workflows/{id}": {
      "get": {
        "tags": [
          "Governance - Approval Workflows"
        ],
        "summary": "Get an approval workflow by ID.",
        "operationId": "get_workflow",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval Workflow ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Approval workflow details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalWorkflowResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Workflow not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Approval Workflows"
        ],
        "summary": "Update an approval workflow.",
        "operationId": "update_workflow",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval Workflow ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateApprovalWorkflowRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Workflow updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalWorkflowResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Workflow not found"
          },
          "409": {
            "description": "Workflow name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Approval Workflows"
        ],
        "summary": "Delete an approval workflow.",
        "operationId": "delete_workflow",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval Workflow ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Workflow deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Workflow not found"
          },
          "412": {
            "description": "Cannot delete workflow with pending requests"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/approval-workflows/{id}/set-default": {
      "post": {
        "tags": [
          "Governance - Approval Workflows"
        ],
        "summary": "Set a workflow as the default.",
        "operationId": "set_default_workflow",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval Workflow ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Workflow set as default",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalWorkflowResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Workflow not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/assignments": {
      "get": {
        "tags": [
          "Governance - Assignments"
        ],
        "summary": "List assignments with optional filtering and pagination.",
        "operationId": "list_assignments",
        "parameters": [
          {
            "name": "entitlement_id",
            "in": "query",
            "description": "Filter by entitlement ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "target_type",
            "in": "query",
            "description": "Filter by target type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GovAssignmentTargetType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "target_id",
            "in": "query",
            "description": "Filter by target ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GovAssignmentStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results to return.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of assignments",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AssignmentListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Assignments"
        ],
        "summary": "Create a new assignment.",
        "operationId": "create_assignment",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAssignmentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Assignment created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AssignmentResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or expiration date in past"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Entitlement not found"
          },
          "409": {
            "description": "Assignment already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/assignments/bulk": {
      "post": {
        "tags": [
          "Governance - Assignments"
        ],
        "summary": "Create multiple assignments at once.",
        "operationId": "bulk_create_assignments",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkCreateAssignmentsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Bulk assignment result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkAssignmentResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Entitlement not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/assignments/{assignment_id}": {
      "get": {
        "tags": [
          "Governance - Parametric Roles"
        ],
        "summary": "Get a parametric assignment by ID.",
        "operationId": "get_parametric_assignment",
        "parameters": [
          {
            "name": "assignment_id",
            "in": "path",
            "description": "Assignment ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Parametric assignment details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/crate.models.ParametricAssignmentResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Assignment not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/assignments/{assignment_id}/parameters": {
      "get": {
        "tags": [
          "Governance - Parametric Roles"
        ],
        "summary": "Get parameters for an assignment.",
        "operationId": "get_assignment_parameters",
        "parameters": [
          {
            "name": "assignment_id",
            "in": "path",
            "description": "Assignment ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Assignment parameters",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AssignmentParameterResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Assignment not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Parametric Roles"
        ],
        "summary": "Update parameters for an existing assignment.",
        "operationId": "update_assignment_parameters",
        "parameters": [
          {
            "name": "assignment_id",
            "in": "path",
            "description": "Assignment ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ValidateParametersRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Parameters updated",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AssignmentParameterResponse"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or validation failed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Assignment not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/assignments/{assignment_id}/parameters/audit": {
      "get": {
        "tags": [
          "Governance - Parametric Roles"
        ],
        "summary": "Get audit events for a specific assignment.",
        "operationId": "get_assignment_parameter_audit",
        "parameters": [
          {
            "name": "assignment_id",
            "in": "path",
            "description": "Assignment ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Assignment audit events",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ParameterAuditEventResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Assignment not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/assignments/{id}": {
      "get": {
        "tags": [
          "Governance - Assignments"
        ],
        "summary": "Get an assignment by ID.",
        "operationId": "get_assignment",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Assignment ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Assignment details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AssignmentResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Assignment not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Assignments"
        ],
        "summary": "Revoke (delete) an assignment.",
        "operationId": "revoke_assignment",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Assignment ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Assignment revoked"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Assignment not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/birthright-policies": {
      "get": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "List birthright policies with optional filtering and pagination.",
        "operationId": "list_policies",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/BirthrightPolicyStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of birthright policies",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BirthrightPolicyListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Create a new birthright policy.",
        "operationId": "create_policy",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateBirthrightPolicyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Policy created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BirthrightPolicyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Policy name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/birthright-policies/simulate": {
      "post": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Simulate all active policies against user attributes.",
        "operationId": "simulate_all_policies",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SimulatePolicyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Simulation result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SimulateAllPoliciesResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/birthright-policies/{id}": {
      "get": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Get a birthright policy by ID.",
        "operationId": "get_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Policy details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BirthrightPolicyResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Update a birthright policy.",
        "operationId": "update_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateBirthrightPolicyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Policy updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BirthrightPolicyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Policy not found"
          },
          "409": {
            "description": "Policy name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Archive (soft-delete) a birthright policy.",
        "operationId": "archive_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Policy archived",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BirthrightPolicyResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/birthright-policies/{id}/disable": {
      "post": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Disable a birthright policy.",
        "operationId": "disable_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Policy disabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BirthrightPolicyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Cannot disable policy in current state"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/birthright-policies/{id}/enable": {
      "post": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Enable a birthright policy.",
        "operationId": "enable_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Policy enabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BirthrightPolicyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Cannot enable policy in current state"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/birthright-policies/{id}/impact": {
      "post": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Analyze the impact of a policy on users.",
        "operationId": "analyze_policy_impact",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ImpactAnalysisRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Impact analysis result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ImpactAnalysisResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/birthright-policies/{id}/simulate": {
      "post": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Simulate a single policy against user attributes.",
        "operationId": "simulate_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SimulatePolicyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Simulation result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SimulatePolicyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/certification-campaigns": {
      "get": {
        "tags": [
          "Governance - Certification Campaigns"
        ],
        "summary": "List certification campaigns.",
        "operationId": "list_campaigns",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/CertCampaignStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of campaigns",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CampaignListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Certification Campaigns"
        ],
        "summary": "Create a new certification campaign.",
        "operationId": "create_campaign",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateCampaignRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Campaign created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CampaignResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Campaign name already exists"
          },
          "422": {
            "description": "Validation error"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/certification-campaigns/{campaign_id}/items": {
      "get": {
        "tags": [
          "Governance - Certification Items"
        ],
        "summary": "List certification items for a campaign.",
        "operationId": "list_campaign_items",
        "parameters": [
          {
            "name": "campaign_id",
            "in": "path",
            "description": "Campaign ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/CertItemStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "reviewer_id",
            "in": "query",
            "description": "Filter by reviewer.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of items",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ItemListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/certification-campaigns/{id}": {
      "get": {
        "tags": [
          "Governance - Certification Campaigns"
        ],
        "summary": "Get a certification campaign by ID.",
        "operationId": "get_campaign",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Campaign ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Campaign details with progress",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CampaignWithProgressResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Certification Campaigns"
        ],
        "summary": "Update a certification campaign (only allowed in draft status).",
        "operationId": "update_campaign",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Campaign ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateCampaignRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Campaign updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CampaignResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found"
          },
          "409": {
            "description": "Campaign not in draft status"
          },
          "422": {
            "description": "Validation error"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Certification Campaigns"
        ],
        "summary": "Delete a certification campaign (only allowed in draft status).",
        "operationId": "delete_campaign",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Campaign ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Campaign deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found"
          },
          "409": {
            "description": "Cannot delete non-draft campaign"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/certification-campaigns/{id}/cancel": {
      "post": {
        "tags": [
          "Governance - Certification Campaigns"
        ],
        "summary": "Cancel a certification campaign.",
        "operationId": "cancel_campaign",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Campaign ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Campaign cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CampaignResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found"
          },
          "409": {
            "description": "Campaign cannot be cancelled in current status"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/certification-campaigns/{id}/launch": {
      "post": {
        "tags": [
          "Governance - Certification Campaigns"
        ],
        "summary": "Launch a certification campaign.",
        "operationId": "launch_campaign",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Campaign ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Campaign launched",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CampaignWithProgressResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found"
          },
          "409": {
            "description": "Campaign not in draft status or no items to generate"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/certification-campaigns/{id}/progress": {
      "get": {
        "tags": [
          "Governance - Certification Campaigns"
        ],
        "summary": "Get campaign progress.",
        "operationId": "get_campaign_progress",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Campaign ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Campaign progress",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CampaignProgressResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/certification-items/{id}": {
      "get": {
        "tags": [
          "Governance - Certification Items"
        ],
        "summary": "Get a certification item by ID.",
        "operationId": "get_item",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Item ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Item details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ItemWithDetailsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Item not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/certification-items/{id}/decide": {
      "post": {
        "tags": [
          "Governance - Certification Items"
        ],
        "summary": "Submit a decision for a certification item.",
        "operationId": "decide_item",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Item ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DecisionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Decision recorded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ItemWithDecisionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Not authorized to decide on this item"
          },
          "404": {
            "description": "Item not found"
          },
          "409": {
            "description": "Item already decided or campaign not active"
          },
          "422": {
            "description": "Validation error"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/certification-items/{id}/reassign": {
      "post": {
        "tags": [
          "Governance - Certification Items"
        ],
        "summary": "Reassign a certification item to a different reviewer.",
        "operationId": "reassign_item",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Item ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReassignRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Item reassigned",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ItemResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Item not found"
          },
          "409": {
            "description": "Item not in pending status"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/connectors/{connector_id}/correlation/evaluate": {
      "post": {
        "tags": [
          "Governance - Correlation Engine"
        ],
        "summary": "Trigger correlation evaluation for a connector's uncorrelated accounts.",
        "description": "Accepts an optional list of account IDs to evaluate. If omitted, all\nuncorrelated accounts for the connector are evaluated. Returns a 202\nAccepted response with a job identifier for tracking progress.",
        "operationId": "trigger_correlation",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TriggerCorrelationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "202": {
            "description": "Correlation job accepted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationJobStatusResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/connectors/{connector_id}/correlation/jobs/{job_id}": {
      "get": {
        "tags": [
          "Governance - Correlation Engine"
        ],
        "summary": "Get the status of a correlation job.",
        "description": "Returns current progress including counts of auto-confirmed, review-queued,\nno-match, and errored accounts.",
        "operationId": "get_correlation_job_status",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "job_id",
            "in": "path",
            "description": "Correlation job ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Correlation job status retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationJobStatusResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Correlation job not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/connectors/{connector_id}/correlation/rules": {
      "get": {
        "tags": [
          "Governance - Correlation Engine"
        ],
        "summary": "List correlation rules for a connector.",
        "operationId": "list_correlation_rules",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "is_active",
            "in": "query",
            "description": "Filter by active status",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results to return",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Results to skip",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Correlation rules retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationRuleListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Correlation Engine"
        ],
        "summary": "Create a new correlation rule.",
        "operationId": "create_correlation_rule",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateCorrelationRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Correlation rule created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationRuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/connectors/{connector_id}/correlation/rules/validate-expression": {
      "post": {
        "tags": [
          "Governance - Correlation Engine"
        ],
        "summary": "Validate a correlation expression.",
        "operationId": "validate_expression",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ValidateExpressionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Expression validation result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidateExpressionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/connectors/{connector_id}/correlation/rules/{id}": {
      "get": {
        "tags": [
          "Governance - Correlation Engine"
        ],
        "summary": "Get a correlation rule by ID.",
        "operationId": "get_correlation_rule",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "id",
            "in": "path",
            "description": "Correlation rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Correlation rule retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Correlation rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Correlation Engine"
        ],
        "summary": "Delete a correlation rule.",
        "operationId": "delete_correlation_rule",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "id",
            "in": "path",
            "description": "Correlation rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Correlation rule deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Correlation rule not found"
          },
          "409": {
            "description": "Correlation rule is in use"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "patch": {
        "tags": [
          "Governance - Correlation Engine"
        ],
        "summary": "Update a correlation rule.",
        "operationId": "update_correlation_rule",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "id",
            "in": "path",
            "description": "Correlation rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateCorrelationRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Correlation rule updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationRuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Correlation rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/connectors/{connector_id}/correlation/statistics": {
      "get": {
        "tags": [
          "Governance - Correlation Statistics"
        ],
        "summary": "Get correlation statistics",
        "description": "Returns correlation statistics for a connector, including match rates,\nconfidence distributions, and performance metrics.",
        "operationId": "get_correlation_statistics",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "start_date",
            "in": "query",
            "description": "Start of the statistics period.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "end_date",
            "in": "query",
            "description": "End of the statistics period.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Correlation statistics retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationStatisticsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/connectors/{connector_id}/correlation/statistics/trends": {
      "get": {
        "tags": [
          "Governance - Correlation Statistics"
        ],
        "summary": "Get correlation trends",
        "description": "Returns time-series correlation trend data for a connector, showing how\ncorrelation metrics change over time.",
        "operationId": "get_correlation_trends",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "start_date",
            "in": "query",
            "description": "Start of the trend period (required).",
            "required": true,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          },
          {
            "name": "end_date",
            "in": "query",
            "description": "End of the trend period (required).",
            "required": true,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Correlation trends retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationTrendsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/connectors/{connector_id}/correlation/thresholds": {
      "get": {
        "tags": [
          "Governance - Correlation Engine"
        ],
        "summary": "Get correlation thresholds for a connector.",
        "operationId": "get_correlation_thresholds",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Correlation thresholds retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationThresholdResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Correlation Engine"
        ],
        "summary": "Upsert correlation thresholds for a connector.",
        "operationId": "upsert_correlation_thresholds",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpsertCorrelationThresholdRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Correlation thresholds upserted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationThresholdResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/connectors/{connector_id}/script-bindings": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "List all script hook bindings for a specific connector.",
        "operationId": "list_bindings_by_connector",
        "parameters": [
          {
            "name": "connector_id",
            "in": "path",
            "description": "Connector ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Script hook bindings for connector",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BindingListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/context/current": {
      "get": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Get current context for the authenticated user.",
        "operationId": "get_current_context",
        "responses": {
          "200": {
            "description": "Current context",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CurrentContextResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/context/sessions": {
      "get": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Get context session history.",
        "operationId": "list_context_sessions",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Session history",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ContextSessionListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/context/switch": {
      "post": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Switch to a persona context.",
        "operationId": "switch_context",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SwitchContextRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Switched to persona",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SwitchContextResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Persona does not belong to user"
          },
          "404": {
            "description": "Persona not found"
          },
          "409": {
            "description": "Cannot switch - persona not active or expired"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/context/switch-back": {
      "post": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Switch back to physical user context.",
        "operationId": "switch_back",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SwitchBackRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Switched back to physical user",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SwitchContextResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/correlation/audit": {
      "get": {
        "tags": [
          "Governance - Correlation Audit"
        ],
        "summary": "List correlation audit events",
        "operationId": "list_correlation_audit_events",
        "parameters": [
          {
            "name": "connector_id",
            "in": "query",
            "description": "Filter by connector.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "event_type",
            "in": "query",
            "description": "Filter by event type.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "outcome",
            "in": "query",
            "description": "Filter by outcome.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "start_date",
            "in": "query",
            "description": "Filter events on or after this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "end_date",
            "in": "query",
            "description": "Filter events on or before this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "actor_id",
            "in": "query",
            "description": "Filter by actor.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of items to return.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "default": 50,
              "nullable": true,
              "maximum": 100
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of items to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "default": 0,
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Correlation audit events retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationAuditListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/correlation/audit/{event_id}": {
      "get": {
        "tags": [
          "Governance - Correlation Audit"
        ],
        "summary": "Get a specific correlation audit event by ID",
        "operationId": "get_correlation_audit_event",
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "description": "Correlation audit event ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Correlation audit event retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationAuditEventResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Correlation audit event not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/correlation/cases": {
      "get": {
        "tags": [
          "Governance - Correlation Review"
        ],
        "summary": "List all correlation cases for manual review",
        "operationId": "list_correlation_cases",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by case status.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "connector_id",
            "in": "query",
            "description": "Filter by connector.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "assigned_to",
            "in": "query",
            "description": "Filter by assigned reviewer.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "trigger_type",
            "in": "query",
            "description": "Filter by trigger type.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "start_date",
            "in": "query",
            "description": "Filter cases created on or after this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "end_date",
            "in": "query",
            "description": "Filter cases created on or before this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "sort_by",
            "in": "query",
            "description": "Field to sort by (e.g., \"`created_at`\", \"`highest_confidence`\").",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "sort_order",
            "in": "query",
            "description": "Sort order (\"asc\" or \"desc\").",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of items to return.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "default": 50,
              "nullable": true,
              "maximum": 100
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of items to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "default": 0,
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Correlation cases retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationCaseListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/correlation/cases/{case_id}": {
      "get": {
        "tags": [
          "Governance - Correlation Review"
        ],
        "summary": "Get detailed information about a specific correlation case",
        "operationId": "get_correlation_case",
        "parameters": [
          {
            "name": "case_id",
            "in": "path",
            "description": "Correlation case ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Correlation case details retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationCaseDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Case not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/correlation/cases/{case_id}/confirm": {
      "post": {
        "tags": [
          "Governance - Correlation Review"
        ],
        "summary": "Confirm a correlation case by selecting a matching candidate",
        "operationId": "confirm_correlation_case",
        "parameters": [
          {
            "name": "case_id",
            "in": "path",
            "description": "Correlation case ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ConfirmCaseRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Correlation case confirmed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationCaseDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Case not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/correlation/cases/{case_id}/create-identity": {
      "post": {
        "tags": [
          "Governance - Correlation Review"
        ],
        "summary": "Create a new identity from a correlation case",
        "operationId": "create_identity_from_case",
        "parameters": [
          {
            "name": "case_id",
            "in": "path",
            "description": "Correlation case ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateIdentityFromCaseRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Identity created from case",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationCaseDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Case not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/correlation/cases/{case_id}/reassign": {
      "post": {
        "tags": [
          "Governance - Correlation Review"
        ],
        "summary": "Reassign a correlation case to another reviewer",
        "operationId": "reassign_correlation_case",
        "parameters": [
          {
            "name": "case_id",
            "in": "path",
            "description": "Correlation case ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReassignCaseRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Correlation case reassigned",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationCaseDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Case not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/correlation/cases/{case_id}/reject": {
      "post": {
        "tags": [
          "Governance - Correlation Review"
        ],
        "summary": "Reject a correlation case (no match found)",
        "operationId": "reject_correlation_case",
        "parameters": [
          {
            "name": "case_id",
            "in": "path",
            "description": "Correlation case ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RejectCaseRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Correlation case rejected",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationCaseDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Case not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/delegations": {
      "get": {
        "tags": [
          "Governance - Delegations"
        ],
        "summary": "List the current user's delegations.",
        "operationId": "list_my_delegations",
        "parameters": [
          {
            "name": "is_active",
            "in": "query",
            "description": "Filter by active status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "active_now",
            "in": "query",
            "description": "Filter to only currently active delegations.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status (F053): pending, active, expired, revoked.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of delegations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DelegationListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Delegations"
        ],
        "summary": "Create a new delegation.",
        "operationId": "create_delegation",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateDelegationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Delegation created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DelegationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or invalid scope references"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Cannot delegate to yourself"
          },
          "409": {
            "description": "Active delegation already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/delegations/{id}": {
      "get": {
        "tags": [
          "Governance - Delegations"
        ],
        "summary": "Get a delegation by ID.",
        "operationId": "get_delegation",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Delegation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Delegation details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DelegationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Delegation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/delegations/{id}/revoke": {
      "post": {
        "tags": [
          "Governance - Delegations"
        ],
        "summary": "Revoke a delegation.",
        "operationId": "revoke_delegation",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Delegation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Delegation revoked",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DelegationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Not authorized to revoke this delegation"
          },
          "404": {
            "description": "Delegation not found"
          },
          "412": {
            "description": "Delegation is not active"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/detection-rules": {
      "get": {
        "tags": [
          "Governance - Detection Rules"
        ],
        "summary": "List detection rules with optional filtering.",
        "operationId": "list_detection_rules",
        "parameters": [
          {
            "name": "rule_type",
            "in": "query",
            "description": "Filter by rule type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/DetectionRuleType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "is_enabled",
            "in": "query",
            "description": "Filter by enabled status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of detection rules",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DetectionRuleListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Detection Rules"
        ],
        "summary": "Create a new detection rule.",
        "operationId": "create_detection_rule",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateDetectionRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Detection rule created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DetectionRuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Rule with same name exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/detection-rules/seed-defaults": {
      "post": {
        "tags": [
          "Governance - Detection Rules"
        ],
        "summary": "Seed default detection rules for the tenant.",
        "operationId": "seed_default_rules",
        "responses": {
          "200": {
            "description": "Default rules seeded",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/DetectionRuleResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/detection-rules/{id}": {
      "get": {
        "tags": [
          "Governance - Detection Rules"
        ],
        "summary": "Get a detection rule by ID.",
        "operationId": "get_detection_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Detection rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Detection rule details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DetectionRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Detection Rules"
        ],
        "summary": "Update a detection rule.",
        "operationId": "update_detection_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Detection rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateDetectionRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Detection rule updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DetectionRuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Rule not found"
          },
          "409": {
            "description": "Rule with same name exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Detection Rules"
        ],
        "summary": "Delete a detection rule.",
        "operationId": "delete_detection_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Detection rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Detection rule deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/detection-rules/{id}/disable": {
      "post": {
        "tags": [
          "Governance - Detection Rules"
        ],
        "summary": "Disable a detection rule.",
        "operationId": "disable_detection_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Detection rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Detection rule disabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DetectionRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/detection-rules/{id}/enable": {
      "post": {
        "tags": [
          "Governance - Detection Rules"
        ],
        "summary": "Enable a detection rule.",
        "operationId": "enable_detection_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Detection rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Detection rule enabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DetectionRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/duplicates": {
      "get": {
        "tags": [
          "Governance - Identity Merge"
        ],
        "summary": "List duplicate candidates with filtering.",
        "operationId": "list_duplicates",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GovDuplicateStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "min_confidence",
            "in": "query",
            "required": false,
            "schema": {
              "type": "number",
              "format": "double",
              "nullable": true
            }
          },
          {
            "name": "max_confidence",
            "in": "query",
            "required": false,
            "schema": {
              "type": "number",
              "format": "double",
              "nullable": true
            }
          },
          {
            "name": "identity_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of duplicate candidates",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MergePaginatedResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/duplicates/{id}": {
      "get": {
        "tags": [
          "Governance - Identity Merge"
        ],
        "summary": "Get a duplicate candidate with detailed comparison.",
        "operationId": "get_duplicate",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Duplicate candidate ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Duplicate candidate details with comparison",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DuplicateDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Duplicate candidate not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/duplicates/{id}/dismiss": {
      "post": {
        "tags": [
          "Governance - Identity Merge"
        ],
        "summary": "Dismiss a duplicate candidate as a false positive.",
        "operationId": "dismiss_duplicate",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Duplicate candidate ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DismissDuplicateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Duplicate dismissed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Duplicate candidate not found"
          },
          "409": {
            "description": "Duplicate already dismissed or merged"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/entitlements": {
      "get": {
        "tags": [
          "Governance - Entitlements"
        ],
        "summary": "List entitlements with optional filtering and pagination.",
        "operationId": "list_entitlements",
        "parameters": [
          {
            "name": "application_id",
            "in": "query",
            "description": "Filter by application ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GovEntitlementStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "risk_level",
            "in": "query",
            "description": "Filter by risk level.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GovRiskLevel"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "owner_id",
            "in": "query",
            "description": "Filter by owner ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "classification",
            "in": "query",
            "description": "Filter by GDPR data protection classification.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/DataProtectionClassification"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results to return.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of entitlements",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EntitlementListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Entitlements"
        ],
        "summary": "Create a new entitlement.",
        "operationId": "create_entitlement",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateEntitlementRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Entitlement created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EntitlementResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Application not found"
          },
          "409": {
            "description": "Entitlement name already exists"
          },
          "412": {
            "description": "Application is inactive"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/entitlements/{id}": {
      "get": {
        "tags": [
          "Governance - Entitlements"
        ],
        "summary": "Get an entitlement by ID.",
        "operationId": "get_entitlement",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Entitlement ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Entitlement details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EntitlementResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Entitlement not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Entitlements"
        ],
        "summary": "Update an entitlement.",
        "operationId": "update_entitlement",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Entitlement ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateEntitlementRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Entitlement updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EntitlementResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Entitlement not found"
          },
          "409": {
            "description": "Entitlement name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Entitlements"
        ],
        "summary": "Delete an entitlement.",
        "operationId": "delete_entitlement",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Entitlement ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Entitlement deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Entitlement not found"
          },
          "412": {
            "description": "Cannot delete entitlement with assignments"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/entitlements/{id}/owner": {
      "put": {
        "tags": [
          "Governance - Entitlement Owners"
        ],
        "summary": "Set owner for an entitlement.",
        "operationId": "set_owner",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Entitlement ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetOwnerRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Owner set",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EntitlementResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Entitlement not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Entitlement Owners"
        ],
        "summary": "Remove owner from an entitlement.",
        "operationId": "remove_owner",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Entitlement ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Owner removed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EntitlementResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Entitlement not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/escalation-events": {
      "get": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "List escalation events with optional filters.",
        "description": "Supports filtering by:\n- `request_id`: Events for a specific access request\n- `original_approver_id`: Events where a specific user was the original approver\n- `escalation_target_id`: Events where a specific user received an escalation\n- reason: Filter by escalation reason (timeout, `manual_escalation`, `target_unavailable`)\n- `from_date/to_date`: Date range filtering",
        "operationId": "list_escalation_events",
        "parameters": [
          {
            "name": "request_id",
            "in": "query",
            "description": "Filter by request ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "original_approver_id",
            "in": "query",
            "description": "Filter by original approver ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "escalation_target_id",
            "in": "query",
            "description": "Filter by escalation target ID (any user who received an escalation).",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "reason",
            "in": "query",
            "description": "Filter by escalation reason.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/EscalationReason"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "from_date",
            "in": "query",
            "description": "Filter events from this date (inclusive).",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "to_date",
            "in": "query",
            "description": "Filter events to this date (inclusive).",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of escalation events",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EscalationEventListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/escalation-policies": {
      "get": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "List escalation policies.",
        "operationId": "list_policies",
        "parameters": [
          {
            "name": "is_active",
            "in": "query",
            "description": "Filter by active status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of escalation policies",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EscalationPolicyListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Create a new escalation policy.",
        "operationId": "create_policy",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateEscalationPolicyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Policy created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EscalationPolicyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Policy name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/escalation-policies/{id}": {
      "get": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Get an escalation policy by ID.",
        "operationId": "get_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Escalation Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Escalation policy details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EscalationPolicyResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Update an escalation policy.",
        "operationId": "update_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Escalation Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateEscalationPolicyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Policy updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EscalationPolicyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Policy not found"
          },
          "409": {
            "description": "Policy name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Delete an escalation policy.",
        "operationId": "delete_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Escalation Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Policy deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/escalation-policies/{id}/set-default": {
      "post": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Set a policy as the active default.",
        "operationId": "set_default_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Escalation Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Policy set as default",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EscalationPolicyResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/escalation-policies/{policy_id}/levels": {
      "post": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Add an escalation level to a policy.",
        "operationId": "add_level",
        "parameters": [
          {
            "name": "policy_id",
            "in": "path",
            "description": "Escalation Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateEscalationLevelRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Level added",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EscalationLevelResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/escalation-policies/{policy_id}/levels/{level_id}": {
      "delete": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Remove an escalation level.",
        "operationId": "remove_level",
        "parameters": [
          {
            "name": "policy_id",
            "in": "path",
            "description": "Escalation Policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "level_id",
            "in": "path",
            "description": "Escalation Level ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Level removed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Level not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-analytics/dashboard": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Get the license analytics dashboard.",
        "description": "Returns summary statistics, per-pool metrics, cost breakdowns by vendor,\nand recent audit events for the tenant's license portfolio.",
        "operationId": "get_dashboard",
        "responses": {
          "200": {
            "description": "License dashboard data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicenseDashboardResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-analytics/expiring": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Get expiring license pools.",
        "description": "Returns pools that will expire within the specified number of days,\nordered by soonest expiration first.",
        "operationId": "get_expiring_pools",
        "parameters": [
          {
            "name": "within_days",
            "in": "query",
            "description": "Number of days to look ahead (default: 90).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Expiring license pools",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExpiringLicensesResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-analytics/recommendations": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Get license optimization recommendations.",
        "description": "Analyzes the tenant's license portfolio and returns actionable\nrecommendations such as underutilized pools, high utilization warnings,\nexpiring licenses, and reclamation opportunities with potential savings.",
        "operationId": "get_recommendations",
        "responses": {
          "200": {
            "description": "License recommendations",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/LicenseRecommendation"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-assignments": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "List license assignments with optional filtering.",
        "operationId": "list_assignments",
        "parameters": [
          {
            "name": "license_pool_id",
            "in": "query",
            "description": "Filter by license pool",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "user_id",
            "in": "query",
            "description": "Filter by user",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status (active, reclaimed, expired, released)",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "source",
            "in": "query",
            "description": "Filter by source (manual, automatic, entitlement)",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results to return (default: 20, max: 100)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Results to skip for pagination",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "License assignments retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicenseAssignmentListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Assign a license from a pool to a user.",
        "operationId": "create_assignment",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AssignLicenseRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "License assigned",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicenseAssignmentResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Pool not found"
          },
          "409": {
            "description": "License already assigned or incompatibility conflict"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-assignments/bulk": {
      "post": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Assign licenses to multiple users at once.",
        "description": "Iterates over the user list, attempting to assign each one.\nCollects successes and failures rather than failing fast.",
        "operationId": "bulk_assign",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkAssignLicenseRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Bulk assignment completed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkOperationResult"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-assignments/bulk-reclaim": {
      "post": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Reclaim multiple license assignments.",
        "description": "Iterates over the assignment IDs, reclaiming each one with a manual reason.\nCollects successes and failures rather than failing fast.",
        "operationId": "bulk_reclaim",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkReclaimLicenseRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Bulk reclamation completed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkOperationResult"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-assignments/{id}": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Get a license assignment by ID.",
        "operationId": "get_assignment",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "License assignment ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "License assignment retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicenseAssignmentResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "License assignment not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Deallocate (release) a license assignment.",
        "description": "Marks the assignment as released and decrements the pool's allocated count.",
        "operationId": "deallocate_assignment",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "License assignment ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "License assignment deallocated"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "License assignment not found"
          },
          "409": {
            "description": "Assignment is not active"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-entitlement-links": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "List license-entitlement links with optional filtering.",
        "operationId": "list_links",
        "parameters": [
          {
            "name": "license_pool_id",
            "in": "query",
            "description": "Filter by license pool",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "entitlement_id",
            "in": "query",
            "description": "Filter by entitlement",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "enabled",
            "in": "query",
            "description": "Filter by enabled status",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results to return (default: 20, max: 100)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Results to skip for pagination",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Entitlement links retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EntitlementLinkListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Create a new license-entitlement link.",
        "description": "Links a license pool to an entitlement so that licenses are automatically\nallocated/deallocated when the entitlement is granted/revoked.",
        "operationId": "create_link",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateLicenseEntitlementLinkRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Entitlement link created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicenseEntitlementLinkResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Pool or entitlement not found"
          },
          "409": {
            "description": "Link already exists for this pool-entitlement pair"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-entitlement-links/{id}": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Get a license-entitlement link by ID.",
        "operationId": "get_link",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "License entitlement link ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Entitlement link retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicenseEntitlementLinkResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Entitlement link not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Delete a license-entitlement link.",
        "description": "Removes the link between a license pool and an entitlement.\nExisting assignments created via this link are not affected.",
        "operationId": "delete_link",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "License entitlement link ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Entitlement link deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Entitlement link not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-entitlement-links/{id}/enabled": {
      "put": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Enable or disable a license-entitlement link.",
        "description": "When disabled, the link will not be considered during automatic\nlicense allocation for the linked entitlement.",
        "operationId": "set_link_enabled",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "License entitlement link ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetLinkEnabledRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Entitlement link enabled/disabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicenseEntitlementLinkResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Entitlement link not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-incompatibilities": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "List license incompatibility rules.",
        "operationId": "list_incompatibilities",
        "parameters": [
          {
            "name": "pool_id",
            "in": "query",
            "description": "Filter by pool (matches either pool_a or pool_b)",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results to return (default: 20, max: 100)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Results to skip for pagination",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Incompatibility rules retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicenseIncompatibilityListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Create a new incompatibility rule.",
        "description": "Defines that two license pools cannot be assigned to the same user.",
        "operationId": "create_incompatibility",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateLicenseIncompatibilityRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Incompatibility rule created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicenseIncompatibilityResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Pool not found"
          },
          "409": {
            "description": "Rule already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-incompatibilities/{id}": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Get an incompatibility rule by ID.",
        "operationId": "get_incompatibility",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Incompatibility rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Incompatibility rule retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicenseIncompatibilityResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Incompatibility rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Delete an incompatibility rule.",
        "operationId": "delete_incompatibility",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Incompatibility rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Incompatibility rule deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Incompatibility rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-pools": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "List license pools with optional filtering.",
        "operationId": "list_license_pools",
        "parameters": [
          {
            "name": "vendor",
            "in": "query",
            "description": "Filter by vendor name",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "license_type",
            "in": "query",
            "description": "Filter by license type (named, concurrent)",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status (active, expired, archived)",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results to return (default: 20, max: 100)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Results to skip for pagination",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "License pools retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicensePoolListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Create a new license pool.",
        "operationId": "create_license_pool",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateLicensePoolRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "License pool created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicensePoolResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Pool name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-pools/{id}": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Get a license pool by ID.",
        "operationId": "get_license_pool",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "License pool ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "License pool retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicensePoolResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "License pool not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Update a license pool.",
        "operationId": "update_license_pool",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "License pool ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateLicensePoolRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "License pool updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicensePoolResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "License pool not found"
          },
          "409": {
            "description": "Pool name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Delete a license pool.",
        "description": "Only pools with no active assignments can be deleted.\nConsider archiving instead for pools with historical data.",
        "operationId": "delete_license_pool",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "License pool ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "License pool deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "License pool not found"
          },
          "409": {
            "description": "Pool has active assignments"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-pools/{id}/archive": {
      "post": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Archive a license pool.",
        "description": "Archived pools preserve all data but cannot accept new assignments.\nThis is the recommended approach for pools you no longer need but want to keep for audit purposes.",
        "operationId": "archive_license_pool",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "License pool ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "License pool archived",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LicensePoolResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "License pool not found"
          },
          "409": {
            "description": "Pool is already archived"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-reclamation-rules": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "List reclamation rules with optional filtering.",
        "operationId": "list_rules",
        "parameters": [
          {
            "name": "license_pool_id",
            "in": "query",
            "description": "Filter by license pool",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "trigger_type",
            "in": "query",
            "description": "Filter by trigger type (inactivity, lifecycle_state)",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "enabled",
            "in": "query",
            "description": "Filter by enabled status",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results to return (default: 20, max: 100)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Results to skip for pagination",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Reclamation rules retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReclamationRuleListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Create a new reclamation rule.",
        "description": "Defines when licenses should be automatically reclaimed from users\nbased on inactivity (no login for N days) or lifecycle state changes\n(e.g., user terminated).",
        "operationId": "create_rule",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateReclamationRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Reclamation rule created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReclamationRuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "License pool not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-reclamation-rules/{id}": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Get a reclamation rule by ID.",
        "operationId": "get_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Reclamation rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Reclamation rule retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReclamationRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Reclamation rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Update a reclamation rule.",
        "description": "Allows updating the threshold, lifecycle state, notification days,\nand enabled status of a reclamation rule.",
        "operationId": "update_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Reclamation rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateReclamationRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Reclamation rule updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReclamationRuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Reclamation rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Delete a reclamation rule.",
        "operationId": "delete_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Reclamation rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Reclamation rule deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Reclamation rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-reports/audit-trail": {
      "get": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Get the license audit trail.",
        "description": "Returns a paginated list of audit events for license management\noperations, filterable by pool, user, action, and date range.",
        "operationId": "get_audit_trail",
        "parameters": [
          {
            "name": "pool_id",
            "in": "query",
            "description": "Filter by license pool ID",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "user_id",
            "in": "query",
            "description": "Filter by user ID",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "action",
            "in": "query",
            "description": "Filter by audit action",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "from_date",
            "in": "query",
            "description": "Filter from date (inclusive)",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "to_date",
            "in": "query",
            "description": "Filter to date (inclusive)",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results to return (default: 20, max: 100)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Results to skip for pagination",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Audit trail retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditTrailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/license-reports/compliance": {
      "post": {
        "tags": [
          "Governance - License Management"
        ],
        "summary": "Generate a license compliance report.",
        "description": "Produces a point-in-time compliance snapshot covering pool utilization,\nassignment compliance status, expiration warnings, and audit summaries.\nAn optional JSON body can narrow the report to specific pools, vendors,\nor a date range.",
        "operationId": "generate_compliance_report",
        "requestBody": {
          "description": "Optional filters for the compliance report",
          "content": {
            "application/json": {
              "schema": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/ComplianceReportRequest"
                  }
                ],
                "nullable": true
              }
            }
          },
          "required": false
        },
        "responses": {
          "200": {
            "description": "Compliance report generated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ComplianceReport"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle-actions": {
      "get": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "List lifecycle actions with optional filtering and pagination.",
        "operationId": "list_actions",
        "parameters": [
          {
            "name": "event_id",
            "in": "query",
            "description": "Filter by event ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "action_type",
            "in": "query",
            "description": "Filter by action type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/LifecycleActionType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "assignment_id",
            "in": "query",
            "description": "Filter by assignment ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "pending",
            "in": "query",
            "description": "Filter for pending scheduled actions only.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of lifecycle actions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LifecycleActionListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle-actions/execute-due": {
      "post": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Execute due scheduled revocations (admin trigger).",
        "operationId": "execute_due_actions",
        "responses": {
          "200": {
            "description": "Due actions executed",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/LifecycleActionResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle-actions/{id}/cancel": {
      "post": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Cancel a scheduled revocation action.",
        "operationId": "cancel_action",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Action ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Action cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LifecycleActionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Cannot cancel this action"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Action not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle-events": {
      "get": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "List lifecycle events with optional filtering and pagination.",
        "operationId": "list_events",
        "parameters": [
          {
            "name": "user_id",
            "in": "query",
            "description": "Filter by user ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "event_type",
            "in": "query",
            "description": "Filter by event type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/LifecycleEventType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "from",
            "in": "query",
            "description": "Filter events created after this time.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "to",
            "in": "query",
            "description": "Filter events created before this time.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "processed",
            "in": "query",
            "description": "Filter by processed status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of lifecycle events",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LifecycleEventListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Create a lifecycle event (for testing/manual trigger).",
        "operationId": "create_event",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateLifecycleEventRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Event created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LifecycleEventResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle-events/trigger": {
      "post": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Create and immediately process a lifecycle event.",
        "operationId": "trigger_event",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateLifecycleEventRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Event created and processed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProcessEventResult"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle-events/{id}": {
      "get": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Get a lifecycle event by ID with its actions.",
        "operationId": "get_event",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Event ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Event details with actions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LifecycleEventWithActionsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Event not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle-events/{id}/process": {
      "post": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "Process a lifecycle event (trigger provisioning/deprovisioning).",
        "operationId": "process_event",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Event ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Event processed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProcessEventResult"
                }
              }
            }
          },
          "400": {
            "description": "Event already processed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Event not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/bulk-operations": {
      "get": {
        "tags": [
          "Bulk State Operations"
        ],
        "summary": "List bulk operations.",
        "description": "Returns a paginated list of bulk operations with optional filters.",
        "operationId": "list_bulk_operations",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/BulkOperationStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "transition_id",
            "in": "query",
            "description": "Filter by transition.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "requested_by",
            "in": "query",
            "description": "Filter by requester.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of bulk operations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkOperationListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Bulk State Operations"
        ],
        "summary": "Create a bulk state operation.",
        "description": "Creates a new bulk operation to transition multiple objects to a target state.\nMaximum of 1000 objects per operation.",
        "operationId": "create_bulk_operation",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateBulkOperationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "202": {
            "description": "Bulk operation created and queued for processing",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkOperationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or too many objects"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/bulk-operations/process": {
      "post": {
        "tags": [
          "Bulk State Operations"
        ],
        "summary": "Trigger processing of pending bulk operations.",
        "description": "This endpoint is typically called by a background job scheduler.\nProcesses pending bulk operations in order.",
        "operationId": "process_bulk_operations",
        "responses": {
          "200": {
            "description": "Processing triggered"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/bulk-operations/{operation_id}": {
      "get": {
        "tags": [
          "Bulk State Operations"
        ],
        "summary": "Get a bulk operation by ID.",
        "description": "Returns detailed information about a bulk operation including\nprogress and any failures.",
        "operationId": "get_bulk_operation",
        "parameters": [
          {
            "name": "operation_id",
            "in": "path",
            "description": "Bulk operation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Bulk operation details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkOperationDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Operation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/bulk-operations/{operation_id}/cancel": {
      "post": {
        "tags": [
          "Bulk State Operations"
        ],
        "summary": "Cancel a bulk operation.",
        "description": "Cancels a pending or in-progress bulk operation.\nObjects that have already been processed will remain in their new state.",
        "operationId": "cancel_bulk_operation",
        "parameters": [
          {
            "name": "operation_id",
            "in": "path",
            "description": "Bulk operation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Operation cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkOperationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Operation cannot be cancelled"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Operation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/configs": {
      "get": {
        "tags": [
          "Lifecycle Configuration"
        ],
        "summary": "List lifecycle configurations.",
        "description": "Returns a paginated list of lifecycle configurations with optional filtering.",
        "operationId": "list_configs",
        "parameters": [
          {
            "name": "object_type",
            "in": "query",
            "description": "Filter by object type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/LifecycleObjectType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "is_active",
            "in": "query",
            "description": "Filter by active status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of lifecycle configurations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LifecycleConfigListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Lifecycle Configuration"
        ],
        "summary": "Create a new lifecycle configuration.",
        "description": "Creates a configuration for managing the lifecycle of a specific object type.\nOnly one configuration per object type is allowed.",
        "operationId": "create_config",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateLifecycleConfigRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Lifecycle configuration created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LifecycleConfigResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Configuration already exists for this object type"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/configs/{config_id}": {
      "get": {
        "tags": [
          "Lifecycle Configuration"
        ],
        "summary": "Get a lifecycle configuration by ID.",
        "description": "Returns detailed information about a lifecycle configuration,\nincluding its states and transitions.",
        "operationId": "get_config",
        "parameters": [
          {
            "name": "config_id",
            "in": "path",
            "description": "Lifecycle configuration ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Lifecycle configuration details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LifecycleConfigDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Configuration not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Lifecycle Configuration"
        ],
        "summary": "Delete a lifecycle configuration.",
        "description": "Deletes a lifecycle configuration. This will also delete all associated\nstates and transitions. Fails if any objects are using this configuration.",
        "operationId": "delete_config",
        "parameters": [
          {
            "name": "config_id",
            "in": "path",
            "description": "Lifecycle configuration ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Lifecycle configuration deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Configuration not found"
          },
          "409": {
            "description": "Configuration is in use"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "patch": {
        "tags": [
          "Lifecycle Configuration"
        ],
        "summary": "Update a lifecycle configuration.",
        "description": "Updates the name, description, or active status of a configuration.",
        "operationId": "update_config",
        "parameters": [
          {
            "name": "config_id",
            "in": "path",
            "description": "Lifecycle configuration ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateLifecycleConfigRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Lifecycle configuration updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LifecycleConfigResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Configuration not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/configs/{config_id}/states": {
      "post": {
        "tags": [
          "Lifecycle Configuration"
        ],
        "summary": "Add a state to a lifecycle configuration.",
        "description": "Creates a new state that objects can be in within this lifecycle.",
        "operationId": "add_state",
        "parameters": [
          {
            "name": "config_id",
            "in": "path",
            "description": "Lifecycle configuration ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateLifecycleStateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Lifecycle state created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LifecycleStateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Configuration not found"
          },
          "409": {
            "description": "State name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/configs/{config_id}/states/{state_id}": {
      "delete": {
        "tags": [
          "Lifecycle Configuration"
        ],
        "summary": "Delete a lifecycle state.",
        "description": "Removes a state from the configuration. Fails if any objects are in this state\nor if transitions reference this state.",
        "operationId": "delete_state",
        "parameters": [
          {
            "name": "config_id",
            "in": "path",
            "description": "Lifecycle configuration ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "state_id",
            "in": "path",
            "description": "Lifecycle state ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Lifecycle state deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "State not found"
          },
          "409": {
            "description": "State is in use"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "patch": {
        "tags": [
          "Lifecycle Configuration"
        ],
        "summary": "Update a lifecycle state.",
        "description": "Updates properties of an existing state.",
        "operationId": "update_state",
        "parameters": [
          {
            "name": "config_id",
            "in": "path",
            "description": "Lifecycle configuration ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "state_id",
            "in": "path",
            "description": "Lifecycle state ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateLifecycleStateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Lifecycle state updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LifecycleStateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "State not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/configs/{config_id}/transitions": {
      "post": {
        "tags": [
          "Lifecycle Configuration"
        ],
        "summary": "Add a transition to a lifecycle configuration.",
        "description": "Creates a new transition defining how objects can move between states.",
        "operationId": "add_transition",
        "parameters": [
          {
            "name": "config_id",
            "in": "path",
            "description": "Lifecycle configuration ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateLifecycleTransitionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Lifecycle transition created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LifecycleTransitionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Configuration or states not found"
          },
          "409": {
            "description": "Transition already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/configs/{config_id}/transitions/{transition_id}": {
      "delete": {
        "tags": [
          "Lifecycle Configuration"
        ],
        "summary": "Delete a transition from a lifecycle configuration.",
        "description": "Removes a transition. This does not affect objects that have already\nused this transition.",
        "operationId": "delete_transition",
        "parameters": [
          {
            "name": "config_id",
            "in": "path",
            "description": "Lifecycle configuration ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "transition_id",
            "in": "path",
            "description": "Lifecycle transition ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Lifecycle transition deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Transition not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/objects/{object_type}/{object_id}": {
      "get": {
        "tags": [
          "State Transitions"
        ],
        "summary": "Get an object's lifecycle status.",
        "description": "Returns the current state of an object and available transitions.",
        "operationId": "get_object_state",
        "parameters": [
          {
            "name": "object_type",
            "in": "path",
            "description": "Object type (user, role, entitlement)",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "object_id",
            "in": "path",
            "description": "Object ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Object lifecycle status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ObjectLifecycleStatusResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Object not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/scheduled": {
      "get": {
        "tags": [
          "Scheduled Transitions"
        ],
        "summary": "List scheduled transitions.",
        "description": "Returns a paginated list of scheduled transitions with optional filters.",
        "operationId": "list_scheduled_transitions",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GovScheduleStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "scheduled_before",
            "in": "query",
            "description": "Only show schedules before this time.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "scheduled_after",
            "in": "query",
            "description": "Only show schedules after this time.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of scheduled transitions"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/scheduled/trigger-due": {
      "post": {
        "tags": [
          "Scheduled Transitions"
        ],
        "summary": "Trigger processing of due scheduled transitions.",
        "description": "This endpoint is typically called by a background job scheduler.\nProcesses all scheduled transitions that are due for execution.",
        "operationId": "trigger_due_transitions",
        "responses": {
          "200": {
            "description": "Due transitions processed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/scheduled/{schedule_id}": {
      "get": {
        "tags": [
          "Scheduled Transitions"
        ],
        "summary": "Get a scheduled transition by ID.",
        "description": "Returns detailed information about a scheduled transition.",
        "operationId": "get_scheduled_transition",
        "parameters": [
          {
            "name": "schedule_id",
            "in": "path",
            "description": "Scheduled transition ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Scheduled transition details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScheduledTransitionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Scheduled transition not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/scheduled/{schedule_id}/cancel": {
      "post": {
        "tags": [
          "Scheduled Transitions"
        ],
        "summary": "Cancel a scheduled transition.",
        "description": "Cancels a pending scheduled transition. Only pending transitions can be cancelled.",
        "operationId": "cancel_scheduled_transition",
        "parameters": [
          {
            "name": "schedule_id",
            "in": "path",
            "description": "Scheduled transition ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Scheduled transition cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScheduledTransitionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Transition cannot be cancelled (already executed or cancelled)"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Scheduled transition not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/transitions": {
      "post": {
        "tags": [
          "State Transitions"
        ],
        "summary": "Execute a state transition.",
        "description": "Initiates a state transition for an object. The transition may be executed\nimmediately or scheduled for later. If the transition requires approval,\nan approval request is created.",
        "operationId": "execute_transition",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ExecuteTransitionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Transition executed immediately",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TransitionRequestResponse"
                }
              }
            }
          },
          "202": {
            "description": "Transition scheduled or pending approval",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TransitionRequestResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or transition not allowed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Object or transition not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/transitions/audit": {
      "get": {
        "tags": [
          "State Transitions"
        ],
        "summary": "List transition audit records.",
        "description": "Returns a paginated list of transition audit records with optional filtering.",
        "operationId": "list_transition_audit",
        "parameters": [
          {
            "name": "object_id",
            "in": "query",
            "description": "Filter by object ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "object_type",
            "in": "query",
            "description": "Filter by object type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/LifecycleObjectType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "actor_id",
            "in": "query",
            "description": "Filter by actor.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "action_type",
            "in": "query",
            "description": "Filter by action type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/AuditActionType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "from_date",
            "in": "query",
            "description": "Only records after this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "to_date",
            "in": "query",
            "description": "Only records before this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of audit records",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TransitionAuditListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/transitions/audit/export": {
      "get": {
        "tags": [
          "State Transitions"
        ],
        "summary": "Export transition audit records.",
        "description": "Returns audit records in CSV or JSON format for download.",
        "operationId": "export_transition_audit",
        "parameters": [
          {
            "name": "object_id",
            "in": "query",
            "description": "Filter by object ID",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "object_type",
            "in": "query",
            "description": "Filter by object type",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "actor_id",
            "in": "query",
            "description": "Filter by actor",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "action_type",
            "in": "query",
            "description": "Filter by action type",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "from_date",
            "in": "query",
            "description": "Only records after this date",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "to_date",
            "in": "query",
            "description": "Only records before this date",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "format",
            "in": "query",
            "description": "Export format (json or csv)",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Audit records export"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/transitions/audit/{audit_id}": {
      "get": {
        "tags": [
          "State Transitions"
        ],
        "summary": "Get a transition audit record by ID.",
        "description": "Returns details about a specific audit record including before/after snapshots.",
        "operationId": "get_transition_audit",
        "parameters": [
          {
            "name": "audit_id",
            "in": "path",
            "description": "Audit record ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Audit record details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TransitionAuditResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Audit record not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/transitions/requests": {
      "get": {
        "tags": [
          "State Transitions"
        ],
        "summary": "List transition requests.",
        "description": "Returns a paginated list of transition requests with optional filtering.",
        "operationId": "list_transition_requests",
        "parameters": [
          {
            "name": "object_id",
            "in": "query",
            "description": "Filter by object ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "object_type",
            "in": "query",
            "description": "Filter by object type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/LifecycleObjectType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/TransitionRequestStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "requested_by",
            "in": "query",
            "description": "Filter by requester.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "rollback_available",
            "in": "query",
            "description": "Only show requests with rollback available.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of transition requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TransitionRequestListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/transitions/requests/{request_id}": {
      "get": {
        "tags": [
          "State Transitions"
        ],
        "summary": "Get a transition request by ID.",
        "description": "Returns details about a specific transition request.",
        "operationId": "get_transition_request",
        "parameters": [
          {
            "name": "request_id",
            "in": "path",
            "description": "Transition request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Transition request details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TransitionRequestResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/transitions/{request_id}/rollback": {
      "post": {
        "tags": [
          "State Transitions"
        ],
        "summary": "Rollback a transition within its grace period.",
        "description": "Reverts an executed transition back to its original state. Only available\nwhile the grace period is active.",
        "operationId": "rollback_transition",
        "parameters": [
          {
            "name": "request_id",
            "in": "path",
            "description": "Transition request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RollbackRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Transition rolled back",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TransitionRequestResponse"
                }
              }
            }
          },
          "400": {
            "description": "Rollback not available or grace period expired"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Transition request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/lifecycle/transitions/{transition_id}/affected-entitlements/{object_id}": {
      "get": {
        "tags": [
          "State Transitions"
        ],
        "summary": "Preview entitlements affected by a transition.",
        "description": "Returns a list of entitlements that would be affected (paused or revoked)\nif the specified transition is executed on the object.",
        "operationId": "get_affected_entitlements",
        "parameters": [
          {
            "name": "transition_id",
            "in": "path",
            "description": "Transition ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "object_id",
            "in": "path",
            "description": "Object ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Affected entitlements preview",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StateAffectedEntitlements"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Transition not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/manual-tasks": {
      "get": {
        "tags": [
          "Governance - Manual Provisioning Tasks"
        ],
        "summary": "List manual provisioning tasks.",
        "operationId": "list_manual_tasks",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status",
            "required": false,
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "nullable": true
            }
          },
          {
            "name": "application_id",
            "in": "query",
            "description": "Filter by application",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "user_id",
            "in": "query",
            "description": "Filter by target user",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "sla_breached",
            "in": "query",
            "description": "Filter by SLA breach status",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "assignee_id",
            "in": "query",
            "description": "Filter by assignee",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results to return",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Results to skip",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Manual tasks retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ManualTaskListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/manual-tasks/dashboard": {
      "get": {
        "tags": [
          "Governance - Manual Provisioning Tasks"
        ],
        "summary": "Get dashboard metrics for manual tasks.",
        "operationId": "get_manual_task_dashboard",
        "responses": {
          "200": {
            "description": "Dashboard metrics retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ManualTaskDashboardResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/manual-tasks/{id}": {
      "get": {
        "tags": [
          "Governance - Manual Provisioning Tasks"
        ],
        "summary": "Get a manual provisioning task by ID.",
        "operationId": "get_manual_task",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Task ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Manual task retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ManualTaskResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Task not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/manual-tasks/{id}/cancel": {
      "post": {
        "tags": [
          "Governance - Manual Provisioning Tasks"
        ],
        "summary": "Cancel a manual provisioning task.",
        "operationId": "cancel_manual_task",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Task ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Task cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ManualTaskResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Task not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/manual-tasks/{id}/claim": {
      "post": {
        "tags": [
          "Governance - Manual Provisioning Tasks"
        ],
        "summary": "Claim a manual task (assign to current user).",
        "operationId": "claim_manual_task",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Task ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Task claimed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ManualTaskResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Task not found"
          },
          "409": {
            "description": "Task already claimed"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/manual-tasks/{id}/confirm": {
      "post": {
        "tags": [
          "Governance - Manual Provisioning Tasks"
        ],
        "summary": "Confirm a manual provisioning task as completed.",
        "operationId": "confirm_manual_task",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Task ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ConfirmManualTaskRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Task confirmed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ManualTaskResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Task not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/manual-tasks/{id}/reject": {
      "post": {
        "tags": [
          "Governance - Manual Provisioning Tasks"
        ],
        "summary": "Reject a manual provisioning task.",
        "operationId": "reject_manual_task",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Task ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RejectManualTaskRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Task rejected",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ManualTaskResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Task not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/manual-tasks/{id}/start": {
      "post": {
        "tags": [
          "Governance - Manual Provisioning Tasks"
        ],
        "summary": "Start working on a manual task (set to `in_progress`).",
        "operationId": "start_manual_task",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Task ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Task started",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ManualTaskResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Task not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/merges": {
      "get": {
        "tags": [
          "Governance - Identity Merge"
        ],
        "summary": "List merge operations with filtering.",
        "operationId": "list_merge_operations",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "identity_id",
            "in": "query",
            "description": "Filter by identity ID",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Skip results",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of merge operations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MergePaginatedResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/merges/execute": {
      "post": {
        "tags": [
          "Governance - Identity Merge"
        ],
        "summary": "Execute a merge operation.",
        "operationId": "execute_merge",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MergeExecuteRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Merge executed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MergeOperationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Identity not found"
          },
          "409": {
            "description": "Merge already in progress or SoD violation"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/merges/preview": {
      "post": {
        "tags": [
          "Governance - Identity Merge"
        ],
        "summary": "Preview a merge operation.",
        "operationId": "preview_merge",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MergePreviewRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Merge preview with impact assessment",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MergePreviewResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request (same identity)"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Identity not found"
          },
          "409": {
            "description": "Merge already in progress"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/merges/{id}": {
      "get": {
        "tags": [
          "Governance - Identity Merge"
        ],
        "summary": "Get a merge operation by ID.",
        "operationId": "get_merge_operation",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Merge operation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Merge operation details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MergeOperationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Merge operation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles": {
      "get": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "List meta-roles with filtering.",
        "operationId": "list_meta_roles",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/MetaRoleStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "name",
            "in": "query",
            "description": "Filter by name (partial match).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "created_by",
            "in": "query",
            "description": "Filter by creator.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of meta-roles",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetaRoleListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Create a new meta-role.",
        "operationId": "create_meta_role",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateMetaRoleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Meta-role created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetaRoleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Conflict - name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/conflicts": {
      "get": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "List conflicts for a meta-role or across all meta-roles.",
        "operationId": "list_conflicts",
        "parameters": [
          {
            "name": "affected_role_id",
            "in": "query",
            "description": "Filter by affected role ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "meta_role_id",
            "in": "query",
            "description": "Filter by meta-role ID (involved in conflict).",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "conflict_type",
            "in": "query",
            "description": "Filter by conflict type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/MetaRoleConflictType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "resolution_status",
            "in": "query",
            "description": "Filter by resolution status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ResolutionStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of conflicts",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConflictListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/conflicts/{conflict_id}/resolve": {
      "post": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Resolve a conflict.",
        "operationId": "resolve_conflict",
        "parameters": [
          {
            "name": "conflict_id",
            "in": "path",
            "description": "Conflict ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResolveConflictRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Conflict resolved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConflictResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid resolution"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Conflict not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/events": {
      "get": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "List meta-role events (audit trail).",
        "operationId": "list_events",
        "parameters": [
          {
            "name": "meta_role_id",
            "in": "query",
            "description": "Filter by meta-role ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "event_type",
            "in": "query",
            "description": "Filter by event type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/MetaRoleEventType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "actor_id",
            "in": "query",
            "description": "Filter by actor ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "from_date",
            "in": "query",
            "description": "Filter events from this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "to_date",
            "in": "query",
            "description": "Filter events to this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of events",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EventListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/events/stats": {
      "get": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Get event statistics.",
        "operationId": "get_event_stats",
        "responses": {
          "200": {
            "description": "Event statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EventStatsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/{id}": {
      "get": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Get a meta-role by ID.",
        "operationId": "get_meta_role",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Meta-role details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetaRoleWithDetailsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Update a meta-role.",
        "operationId": "update_meta_role",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateMetaRoleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Meta-role updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetaRoleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role not found"
          },
          "409": {
            "description": "Conflict - name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Delete a meta-role.",
        "operationId": "delete_meta_role",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Meta-role deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role not found"
          },
          "409": {
            "description": "Cannot delete - has active inheritances"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/{id}/cascade": {
      "post": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Trigger a cascade update for a meta-role.",
        "operationId": "trigger_cascade",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TriggerCascadeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "202": {
            "description": "Cascade triggered",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CascadeStatusResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/{id}/constraints": {
      "post": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Add a constraint to a meta-role.",
        "operationId": "add_constraint",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AddMetaRoleConstraintRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Constraint added",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetaRoleConstraintResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/{id}/constraints/{constraint_id}": {
      "delete": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Remove a constraint from a meta-role.",
        "operationId": "remove_constraint",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "constraint_id",
            "in": "path",
            "description": "Constraint ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Constraint removed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role or constraint not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/{id}/criteria": {
      "post": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Add a criterion to a meta-role.",
        "operationId": "add_criteria",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateMetaRoleCriteriaRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Criterion added",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetaRoleCriteriaResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/{id}/criteria/{criteria_id}": {
      "delete": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Remove a criterion from a meta-role.",
        "operationId": "remove_criteria",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "criteria_id",
            "in": "path",
            "description": "Criteria ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Criterion removed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role or criterion not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/{id}/disable": {
      "post": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Disable a meta-role.",
        "operationId": "disable_meta_role",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Meta-role disabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetaRoleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/{id}/enable": {
      "post": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Enable a meta-role.",
        "operationId": "enable_meta_role",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Meta-role enabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetaRoleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/{id}/entitlements": {
      "post": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Add an entitlement to a meta-role.",
        "operationId": "add_entitlement",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AddMetaRoleEntitlementRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Entitlement added",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetaRoleEntitlementResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role or entitlement not found"
          },
          "409": {
            "description": "Entitlement already exists on meta-role"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/{id}/entitlements/{entitlement_id}": {
      "delete": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Remove an entitlement from a meta-role.",
        "operationId": "remove_entitlement",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "entitlement_id",
            "in": "path",
            "description": "Entitlement mapping ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Entitlement removed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role or entitlement not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/{id}/inheritances": {
      "get": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "List inheritance relationships for a meta-role.",
        "operationId": "list_inheritances",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "meta_role_id",
            "in": "query",
            "description": "Filter by meta-role ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "child_role_id",
            "in": "query",
            "description": "Filter by child role ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/InheritanceStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Inheritance relationships",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InheritanceListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/{id}/reevaluate": {
      "post": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Manually trigger re-evaluation of all roles against a meta-role.",
        "operationId": "reevaluate_meta_role",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Re-evaluation triggered",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetaRoleStatsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/meta-roles/{id}/simulate": {
      "post": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Simulate meta-role changes before applying.",
        "operationId": "simulate_changes",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Meta-role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SimulateMetaRoleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Simulation results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SimulationResultResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Meta-role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-cert-events": {
      "get": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Search micro-certification events across all certifications (audit trail).",
        "operationId": "search_events",
        "parameters": [
          {
            "name": "micro_certification_id",
            "in": "query",
            "description": "Filter by certification ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "event_type",
            "in": "query",
            "description": "Filter by event type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/MicroCertEventType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "actor_id",
            "in": "query",
            "description": "Filter by actor (user who performed action).",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "from_date",
            "in": "query",
            "description": "Filter events from this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "to_date",
            "in": "query",
            "description": "Filter events to this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of micro-certification events",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MicroCertEventListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-cert-triggers": {
      "get": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "List micro-certification trigger rules.",
        "operationId": "list_triggers",
        "parameters": [
          {
            "name": "trigger_type",
            "in": "query",
            "description": "Filter by trigger type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/MicroCertTriggerType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "scope_type",
            "in": "query",
            "description": "Filter by scope type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/MicroCertScopeType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "scope_id",
            "in": "query",
            "description": "Filter by scope ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "is_active",
            "in": "query",
            "description": "Filter by active status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "is_default",
            "in": "query",
            "description": "Filter by default status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of trigger rules",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TriggerRuleListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Create a new trigger rule.",
        "operationId": "create_trigger",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateTriggerRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Trigger created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TriggerRuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Trigger name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-cert-triggers/{id}": {
      "get": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Get a trigger rule by ID.",
        "operationId": "get_trigger",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Trigger Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Trigger rule details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TriggerRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Trigger not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Update a trigger rule.",
        "operationId": "update_trigger",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Trigger Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateTriggerRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Trigger updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TriggerRuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Trigger not found"
          },
          "409": {
            "description": "Trigger name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Delete a trigger rule.",
        "operationId": "delete_trigger",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Trigger Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Trigger deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Trigger not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-cert-triggers/{id}/disable": {
      "post": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Disable a trigger rule.",
        "operationId": "disable_trigger",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Trigger Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Trigger disabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TriggerRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Trigger not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-cert-triggers/{id}/enable": {
      "post": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Enable a trigger rule.",
        "operationId": "enable_trigger",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Trigger Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Trigger enabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TriggerRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Trigger not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-cert-triggers/{id}/set-default": {
      "post": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Set a trigger rule as the default for its type.",
        "operationId": "set_default",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Trigger Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Trigger set as default",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TriggerRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Trigger not found"
          },
          "412": {
            "description": "Trigger is not active"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-certifications": {
      "get": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "List micro-certifications with filtering.",
        "operationId": "list_certifications",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/MicroCertStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "reviewer_id",
            "in": "query",
            "description": "Filter by reviewer.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "user_id",
            "in": "query",
            "description": "Filter by user whose access is being certified.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "entitlement_id",
            "in": "query",
            "description": "Filter by entitlement.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "assignment_id",
            "in": "query",
            "description": "Filter by assignment.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "trigger_rule_id",
            "in": "query",
            "description": "Filter by trigger rule.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "from_date",
            "in": "query",
            "description": "Filter certifications created after this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "to_date",
            "in": "query",
            "description": "Filter certifications created before this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "escalated",
            "in": "query",
            "description": "Include escalated certifications only.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "past_deadline",
            "in": "query",
            "description": "Filter certifications past deadline only.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of micro-certifications",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MicroCertificationListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-certifications/bulk-decide": {
      "post": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Bulk decide on multiple micro-certifications.",
        "operationId": "bulk_decide",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkDecisionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Bulk decision result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDecisionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-certifications/my-pending": {
      "get": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Get micro-certifications pending for the current user.",
        "operationId": "my_pending",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Skip results",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "My pending micro-certifications",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MicroCertificationListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-certifications/stats": {
      "get": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Get statistics for micro-certifications.",
        "operationId": "get_stats",
        "responses": {
          "200": {
            "description": "Micro-certification statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MicroCertificationStatsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-certifications/trigger": {
      "post": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Manually trigger a micro-certification for a user's entitlement.",
        "operationId": "manual_trigger",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ManualTriggerRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Micro-certification created or existing returned",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ManualTriggerResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "User, entitlement, or trigger rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-certifications/{id}": {
      "get": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Get a micro-certification by ID.",
        "operationId": "get_certification",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Micro-certification ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Micro-certification details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MicroCertificationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Micro-certification not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-certifications/{id}/decide": {
      "post": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Make a decision on a micro-certification.",
        "operationId": "decide",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Micro-certification ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DecideMicroCertificationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Decision recorded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MicroCertificationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Not authorized to decide"
          },
          "404": {
            "description": "Micro-certification not found"
          },
          "409": {
            "description": "Already decided"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-certifications/{id}/delegate": {
      "post": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Delegate a micro-certification to another reviewer.",
        "operationId": "delegate",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Micro-certification ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DelegateMicroCertificationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Delegation recorded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MicroCertificationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Not authorized to delegate"
          },
          "404": {
            "description": "Micro-certification not found"
          },
          "409": {
            "description": "Already decided"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-certifications/{id}/events": {
      "get": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Get events for a micro-certification.",
        "operationId": "get_events",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Micro-certification ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Micro-certification events",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MicroCertEventListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Micro-certification not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/micro-certifications/{id}/skip": {
      "post": {
        "tags": [
          "Governance - Micro-certification"
        ],
        "summary": "Skip a micro-certification (when assignment is already deleted).",
        "operationId": "skip_certification",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Micro-certification ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SkipMicroCertificationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Micro-certification skipped",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MicroCertificationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request - reason required"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Micro-certification not found"
          },
          "409": {
            "description": "Already decided"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/my-approvals": {
      "get": {
        "tags": [
          "Governance - Approvals"
        ],
        "summary": "Get pending approvals for the current user.",
        "operationId": "list_pending_approvals",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of pending approvals",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PendingApprovalListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/my-certifications": {
      "get": {
        "tags": [
          "Governance - Certification Items"
        ],
        "summary": "Get pending certification items for the current user.",
        "operationId": "get_my_certifications",
        "parameters": [
          {
            "name": "campaign_id",
            "in": "query",
            "description": "Filter by campaign.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of pending items",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ItemListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/my-certifications/summary": {
      "get": {
        "tags": [
          "Governance - Certification Items"
        ],
        "summary": "Get certification summary for the current user.",
        "operationId": "get_my_certifications_summary",
        "responses": {
          "200": {
            "description": "Certification summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReviewerSummaryResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis": {
      "get": {
        "tags": [
          "Governance - NHIs"
        ],
        "summary": "List NHIs with optional filtering.",
        "operationId": "list_nhis",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ServiceAccountStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "owner_id",
            "in": "query",
            "description": "Filter by owner.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "expiring_within_days",
            "in": "query",
            "description": "Filter NHIs expiring within this many days.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true,
              "minimum": 1
            }
          },
          {
            "name": "needs_certification",
            "in": "query",
            "description": "Filter NHIs needing certification.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "needs_rotation",
            "in": "query",
            "description": "Filter NHIs needing rotation.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "inactive_only",
            "in": "query",
            "description": "Filter inactive NHIs.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of NHIs",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - NHIs"
        ],
        "summary": "Create a new NHI.",
        "operationId": "create_nhi",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateNhiRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "NHI created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "NHI name already exists or user already registered"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/certification/campaigns": {
      "get": {
        "tags": [
          "Governance - NHI Certification"
        ],
        "summary": "List NHI certification campaigns.",
        "operationId": "list_nhi_certification_campaigns",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/NhiCertCampaignStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "created_by",
            "in": "query",
            "description": "Filter by creator.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of campaigns",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCertificationCampaignListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - NHI Certification"
        ],
        "summary": "Create an NHI certification campaign.",
        "operationId": "create_nhi_certification_campaign",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateNhiCertificationCampaignRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Campaign created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCertificationCampaignResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/certification/campaigns/{campaign_id}": {
      "get": {
        "tags": [
          "Governance - NHI Certification"
        ],
        "summary": "Get an NHI certification campaign.",
        "operationId": "get_nhi_certification_campaign",
        "parameters": [
          {
            "name": "campaign_id",
            "in": "path",
            "description": "Campaign ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Campaign details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCertificationCampaignResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/certification/campaigns/{campaign_id}/cancel": {
      "post": {
        "tags": [
          "Governance - NHI Certification"
        ],
        "summary": "Cancel an NHI certification campaign.",
        "operationId": "cancel_nhi_certification_campaign",
        "parameters": [
          {
            "name": "campaign_id",
            "in": "path",
            "description": "Campaign ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Campaign cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCertificationCampaignResponse"
                }
              }
            }
          },
          "400": {
            "description": "Cannot cancel campaign"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/certification/campaigns/{campaign_id}/launch": {
      "post": {
        "tags": [
          "Governance - NHI Certification"
        ],
        "summary": "Launch an NHI certification campaign.",
        "operationId": "launch_nhi_certification_campaign",
        "parameters": [
          {
            "name": "campaign_id",
            "in": "path",
            "description": "Campaign ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Campaign launched",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCertificationCampaignResponse"
                }
              }
            }
          },
          "400": {
            "description": "Cannot launch campaign"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/certification/campaigns/{campaign_id}/summary": {
      "get": {
        "tags": [
          "Governance - NHI Certification"
        ],
        "summary": "Get campaign summary.",
        "operationId": "get_nhi_certification_campaign_summary",
        "parameters": [
          {
            "name": "campaign_id",
            "in": "path",
            "description": "Campaign ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Campaign summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCertificationSummary"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/certification/items": {
      "get": {
        "tags": [
          "Governance - NHI Certification"
        ],
        "summary": "List certification items.",
        "operationId": "list_nhi_certification_items",
        "parameters": [
          {
            "name": "campaign_id",
            "in": "query",
            "description": "Filter by campaign ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/NhiCertificationStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "reviewer_id",
            "in": "query",
            "description": "Filter by reviewer.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "owner_id",
            "in": "query",
            "description": "Filter by NHI owner.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "my_pending",
            "in": "query",
            "description": "Show only my pending items (current user is reviewer).",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of certification items",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCertificationItemListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/certification/items/bulk-decide": {
      "post": {
        "tags": [
          "Governance - NHI Certification"
        ],
        "summary": "Make the same decision on multiple certification items.",
        "operationId": "bulk_decide_nhi_certification",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkNhiCertificationDecisionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Bulk decision results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkNhiCertificationResult"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/certification/items/{item_id}": {
      "get": {
        "tags": [
          "Governance - NHI Certification"
        ],
        "summary": "Get a certification item.",
        "operationId": "get_nhi_certification_item",
        "parameters": [
          {
            "name": "item_id",
            "in": "path",
            "description": "Certification item ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Certification item details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCertificationItemResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Item not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/certification/items/{item_id}/decide": {
      "post": {
        "tags": [
          "Governance - NHI Certification"
        ],
        "summary": "Make a decision on a certification item.",
        "operationId": "decide_nhi_certification",
        "parameters": [
          {
            "name": "item_id",
            "in": "path",
            "description": "Certification item ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NhiCertificationDecisionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Decision recorded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCertificationItemResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid decision or already decided"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Not authorized to decide"
          },
          "404": {
            "description": "Item not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/certification/my-pending": {
      "get": {
        "tags": [
          "Governance - NHI Certification"
        ],
        "summary": "Get my pending certification items.",
        "operationId": "get_my_pending_nhi_certifications",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "My pending items",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCertificationItemListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/requests": {
      "get": {
        "tags": [
          "Governance - NHI Requests"
        ],
        "summary": "List NHI requests with filtering.",
        "operationId": "list_nhi_requests",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/NhiRequestStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "requester_id",
            "in": "query",
            "description": "Filter by requester.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "pending_only",
            "in": "query",
            "description": "Filter pending requests only.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of NHI requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - NHI Requests"
        ],
        "summary": "Submit a new NHI request.",
        "operationId": "submit_nhi_request",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SubmitNhiRequestRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Request submitted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Duplicate pending request exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/requests/my-pending": {
      "get": {
        "tags": [
          "Governance - NHI Requests"
        ],
        "summary": "Get my pending NHI requests (submitted by me).",
        "operationId": "get_my_pending_nhi_requests",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "My pending requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/requests/summary": {
      "get": {
        "tags": [
          "Governance - NHI Requests"
        ],
        "summary": "Get NHI request summary statistics.",
        "operationId": "get_nhi_request_summary",
        "responses": {
          "200": {
            "description": "Request summary statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestSummary"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/requests/{request_id}": {
      "get": {
        "tags": [
          "Governance - NHI Requests"
        ],
        "summary": "Get an NHI request by ID.",
        "operationId": "get_nhi_request",
        "parameters": [
          {
            "name": "request_id",
            "in": "path",
            "description": "NHI request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "NHI request details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/requests/{request_id}/approve": {
      "post": {
        "tags": [
          "Governance - NHI Requests"
        ],
        "summary": "Approve an NHI request (creates the NHI and initial credentials).",
        "operationId": "approve_nhi_request",
        "parameters": [
          {
            "name": "request_id",
            "in": "path",
            "description": "NHI request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApproveNhiRequestRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Request approved, NHI created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestApprovalResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or already decided"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/requests/{request_id}/cancel": {
      "post": {
        "tags": [
          "Governance - NHI Requests"
        ],
        "summary": "Cancel an NHI request (requester only).",
        "operationId": "cancel_nhi_request",
        "parameters": [
          {
            "name": "request_id",
            "in": "path",
            "description": "NHI request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Request cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or already decided"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Only requester can cancel"
          },
          "404": {
            "description": "Request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/requests/{request_id}/reject": {
      "post": {
        "tags": [
          "Governance - NHI Requests"
        ],
        "summary": "Reject an NHI request.",
        "operationId": "reject_nhi_request",
        "parameters": [
          {
            "name": "request_id",
            "in": "path",
            "description": "NHI request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RejectNhiRequestRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Request rejected",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or already decided"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/risk/batch-calculate": {
      "post": {
        "tags": [
          "Governance - NHI Risk"
        ],
        "summary": "Batch calculate risk scores for multiple NHIs.",
        "operationId": "batch_calculate_nhi_risk",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Risk scores calculated",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/NhiRiskScoreResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/risk/summary": {
      "get": {
        "tags": [
          "Governance - NHI Risk"
        ],
        "summary": "Get risk score summary by level.",
        "operationId": "get_nhi_risk_summary",
        "responses": {
          "200": {
            "description": "Risk summary retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskLevelSummary"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/staleness-report": {
      "get": {
        "tags": [
          "Governance - NHI Usage"
        ],
        "summary": "Get staleness report for all NHIs.",
        "operationId": "get_nhi_staleness_report",
        "parameters": [
          {
            "name": "min_inactive_days",
            "in": "query",
            "description": "Minimum days inactive to include in report.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true,
              "minimum": 1
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Staleness report",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StalenessReportResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/summary": {
      "get": {
        "tags": [
          "Governance - NHIs"
        ],
        "summary": "Get NHI summary statistics.",
        "operationId": "get_nhi_summary",
        "responses": {
          "200": {
            "description": "NHI summary statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiSummary"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/{id}": {
      "get": {
        "tags": [
          "Governance - NHIs"
        ],
        "summary": "Get an NHI by ID.",
        "operationId": "get_nhi",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "NHI details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - NHIs"
        ],
        "summary": "Update an NHI.",
        "operationId": "update_nhi",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateNhiRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "NHI updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "409": {
            "description": "NHI name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - NHIs"
        ],
        "summary": "Delete an NHI.",
        "operationId": "delete_nhi",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "NHI deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/{id}/certify": {
      "post": {
        "tags": [
          "Governance - NHIs"
        ],
        "summary": "Certify an NHI (confirm ownership and purpose are still valid).",
        "operationId": "certify_nhi",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "NHI certified",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CertifyNhiResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/{id}/credentials": {
      "get": {
        "tags": [
          "Governance - NHI Credentials"
        ],
        "summary": "List credentials for an NHI.",
        "operationId": "list_nhi_credentials",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "active_only",
            "in": "query",
            "description": "Only return active credentials",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of credentials",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCredentialListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/{id}/credentials/rotate": {
      "post": {
        "tags": [
          "Governance - NHI Credentials"
        ],
        "summary": "Rotate credentials for an NHI.",
        "description": "Creates a new credential and optionally keeps the old one active during a\ngrace period.",
        "operationId": "rotate_nhi_credentials",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RotateCredentialsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Credentials rotated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCredentialCreatedResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/{id}/reactivate": {
      "post": {
        "tags": [
          "Governance - NHIs"
        ],
        "summary": "Reactivate a suspended NHI.",
        "operationId": "reactivate_nhi",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReactivateNhiRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "NHI reactivated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or NHI not suspended"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/{id}/risk": {
      "get": {
        "tags": [
          "Governance - NHI Risk"
        ],
        "summary": "Get NHI risk score.",
        "operationId": "get_nhi_risk_score",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Risk score retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRiskScoreResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI or score not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/{id}/risk/calculate": {
      "post": {
        "tags": [
          "Governance - NHI Risk"
        ],
        "summary": "Calculate/recalculate NHI risk score.",
        "operationId": "calculate_nhi_risk_score",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Risk score calculated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRiskScoreResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/{id}/suspend": {
      "post": {
        "tags": [
          "Governance - NHIs"
        ],
        "summary": "Suspend an NHI.",
        "operationId": "suspend_nhi",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SuspendNhiRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "NHI suspended",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or NHI already suspended"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/{id}/transfer-ownership": {
      "post": {
        "tags": [
          "Governance - NHIs"
        ],
        "summary": "Transfer ownership of an NHI.",
        "operationId": "transfer_nhi_ownership",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TransferOwnershipRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Ownership transferred",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/{id}/usage": {
      "get": {
        "tags": [
          "Governance - NHI Usage"
        ],
        "summary": "List usage events for an NHI.",
        "operationId": "list_nhi_usage",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "target_resource",
            "in": "query",
            "description": "Filter by target resource (partial match).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "outcome",
            "in": "query",
            "description": "Filter by outcome.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/NhiUsageOutcome"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "start_date",
            "in": "query",
            "description": "Start date for time range.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "end_date",
            "in": "query",
            "description": "End date for time range.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 1000).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 1000,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of usage events",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiUsageListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - NHI Usage"
        ],
        "summary": "Record a usage event for an NHI.",
        "operationId": "record_nhi_usage",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RecordUsageRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Usage event recorded"
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/{id}/usage/summary": {
      "get": {
        "tags": [
          "Governance - NHI Usage"
        ],
        "summary": "Get usage summary for an NHI.",
        "operationId": "get_nhi_usage_summary",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "period_days",
            "in": "query",
            "description": "Period in days (default: 30)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Usage summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiUsageSummaryExtendedResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/{nhi_id}/credentials/{credential_id}": {
      "get": {
        "tags": [
          "Governance - NHI Credentials"
        ],
        "summary": "Get a specific credential by ID.",
        "operationId": "get_nhi_credential",
        "parameters": [
          {
            "name": "nhi_id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "credential_id",
            "in": "path",
            "description": "Credential ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Credential details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCredentialResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI or credential not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/nhis/{nhi_id}/credentials/{credential_id}/revoke": {
      "post": {
        "tags": [
          "Governance - NHI Credentials"
        ],
        "summary": "Revoke a credential.",
        "operationId": "revoke_nhi_credential",
        "parameters": [
          {
            "name": "nhi_id",
            "in": "path",
            "description": "NHI ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "credential_id",
            "in": "path",
            "description": "Credential ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RevokeCredentialRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Credential revoked",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCredentialResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or credential already revoked"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI or credential not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/object-templates": {
      "get": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "List object templates with filtering.",
        "operationId": "list_templates",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ObjectTemplateStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "object_type",
            "in": "query",
            "description": "Filter by object type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/TemplateObjectType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "name",
            "in": "query",
            "description": "Filter by name (partial match).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of object templates",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "Create a new object template.",
        "operationId": "create_template",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateTemplateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Object template created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Conflict - name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/object-templates/application-events/{object_type}/{object_id}": {
      "get": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "List application events by object type and ID.",
        "operationId": "list_application_events_by_object",
        "parameters": [
          {
            "name": "object_type",
            "in": "path",
            "description": "Object type",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/TemplateObjectType"
            }
          },
          {
            "name": "object_id",
            "in": "path",
            "description": "Object ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "object_type",
            "in": "query",
            "description": "Filter by object type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/TemplateObjectType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "object_id",
            "in": "query",
            "description": "Filter by object ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of application events",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApplicationEventListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/object-templates/{id}": {
      "get": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "Get an object template by ID with full details.",
        "operationId": "get_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Template details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "Update an object template.",
        "operationId": "update_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateTemplateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Template updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "409": {
            "description": "Conflict - name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "Delete an object template.",
        "operationId": "delete_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Template deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "409": {
            "description": "Conflict - template has active children"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/object-templates/{id}/activate": {
      "post": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "Activate a draft template.",
        "operationId": "activate_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Template activated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "409": {
            "description": "Conflict - template is not in draft status or has no scopes"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/object-templates/{id}/disable": {
      "post": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "Disable an active template.",
        "operationId": "disable_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Template disabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "409": {
            "description": "Conflict - template is not in active status"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/object-templates/{template_id}/application-events": {
      "get": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "List application events for a template.",
        "operationId": "list_application_events_by_template",
        "parameters": [
          {
            "name": "template_id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "object_type",
            "in": "query",
            "description": "Filter by object type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/TemplateObjectType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "object_id",
            "in": "query",
            "description": "Filter by object ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of application events",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApplicationEventListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/object-templates/{template_id}/events": {
      "get": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "List events for a template.",
        "operationId": "list_events",
        "parameters": [
          {
            "name": "template_id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "event_type",
            "in": "query",
            "description": "Filter by event type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/TemplateEventType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of events",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateEventListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/object-templates/{template_id}/rules": {
      "get": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "List rules for a template.",
        "operationId": "list_rules",
        "parameters": [
          {
            "name": "template_id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "rule_type",
            "in": "query",
            "description": "Filter by rule type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/TemplateRuleType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "target_attribute",
            "in": "query",
            "description": "Filter by target attribute.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "strength",
            "in": "query",
            "description": "Filter by strength.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/TemplateStrength"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 100, max: 500).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 500,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of rules",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RuleListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "Add a rule to a template.",
        "operationId": "add_rule",
        "parameters": [
          {
            "name": "template_id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Rule created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or expression"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "409": {
            "description": "Conflict - circular dependency detected"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/object-templates/{template_id}/rules/{rule_id}": {
      "get": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "Get a specific rule.",
        "operationId": "get_rule",
        "parameters": [
          {
            "name": "template_id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "rule_id",
            "in": "path",
            "description": "Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Rule details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template or rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "Update a rule.",
        "operationId": "update_rule",
        "parameters": [
          {
            "name": "template_id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "rule_id",
            "in": "path",
            "description": "Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Rule updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or expression"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template or rule not found"
          },
          "409": {
            "description": "Conflict - circular dependency detected"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "Remove a rule from a template.",
        "operationId": "remove_rule",
        "parameters": [
          {
            "name": "template_id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "rule_id",
            "in": "path",
            "description": "Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Rule removed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template or rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/object-templates/{template_id}/scopes": {
      "get": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "List scopes for a template.",
        "operationId": "list_scopes",
        "parameters": [
          {
            "name": "template_id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of scopes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScopeListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "Add a scope to a template.",
        "operationId": "add_scope",
        "parameters": [
          {
            "name": "template_id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateScopeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Scope added",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScopeResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/object-templates/{template_id}/scopes/{scope_id}": {
      "delete": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "Remove a scope from a template.",
        "operationId": "remove_scope",
        "parameters": [
          {
            "name": "template_id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "scope_id",
            "in": "path",
            "description": "Scope ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Scope removed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template or scope not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/object-templates/{template_id}/versions": {
      "get": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "List versions for a template.",
        "operationId": "list_versions",
        "parameters": [
          {
            "name": "template_id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of versions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/VersionListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/object-templates/{template_id}/versions/{version_id}": {
      "get": {
        "tags": [
          "Governance - Object Templates"
        ],
        "summary": "Get a specific version.",
        "operationId": "get_version",
        "parameters": [
          {
            "name": "template_id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "version_id",
            "in": "path",
            "description": "Version ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Version details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/VersionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template or version not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/orphan-detections": {
      "get": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "List orphan detections with optional filtering.",
        "operationId": "list_orphan_detections",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/OrphanStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "reason",
            "in": "query",
            "description": "Filter by detection reason.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/DetectionReason"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "run_id",
            "in": "query",
            "description": "Filter by reconciliation run.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "user_id",
            "in": "query",
            "description": "Filter by user.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "since",
            "in": "query",
            "description": "Filter detections since this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "until",
            "in": "query",
            "description": "Filter detections until this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of orphan detections",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrphanDetectionListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/orphan-detections/age-analysis": {
      "get": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Get age analysis for orphan detections.",
        "operationId": "get_age_analysis",
        "responses": {
          "200": {
            "description": "Orphan age analysis",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrphanAgeAnalysis"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/orphan-detections/bulk-remediate": {
      "post": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Bulk remediate multiple orphan detections.",
        "operationId": "bulk_remediate",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkRemediateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Bulk remediation results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkRemediateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/orphan-detections/export": {
      "get": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Export orphan detections to CSV.",
        "operationId": "export_orphans_csv",
        "responses": {
          "200": {
            "description": "CSV export of orphan detections"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/orphan-detections/risk-report": {
      "get": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Get risk report for orphan accounts.",
        "operationId": "get_risk_report",
        "responses": {
          "200": {
            "description": "Orphan risk report",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrphanRiskReport"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/orphan-detections/summary": {
      "get": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Get orphan detection summary statistics.",
        "operationId": "get_orphan_summary",
        "responses": {
          "200": {
            "description": "Orphan detection summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrphanSummaryResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/orphan-detections/{id}": {
      "get": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Get a single orphan detection by ID.",
        "operationId": "get_orphan_detection",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Orphan detection ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Orphan detection details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrphanDetectionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Detection not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/orphan-detections/{id}/delete": {
      "post": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Request deletion of an orphan account.",
        "operationId": "delete_orphan",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Orphan detection ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeleteOrphanRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Deletion requested",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeleteOrphanResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or state"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Detection not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/orphan-detections/{id}/disable": {
      "post": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Disable an orphan account.",
        "operationId": "disable_orphan",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Orphan detection ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DisableOrphanRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Account disabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrphanDetectionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid state"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Detection not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/orphan-detections/{id}/dismiss": {
      "post": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Dismiss an orphan detection as false positive.",
        "operationId": "dismiss_orphan",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Orphan detection ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DismissOrphanRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Detection dismissed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrphanDetectionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or state"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Detection not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/orphan-detections/{id}/reassign": {
      "post": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Reassign an orphan to a new owner.",
        "operationId": "reassign_orphan",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Orphan detection ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReassignOrphanRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Orphan reassigned",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrphanDetectionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or state"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Detection not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/orphan-detections/{id}/review": {
      "post": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Start review of an orphan detection.",
        "operationId": "start_review",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Orphan detection ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Review started",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OrphanDetectionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid state for review"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Detection not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/alerts": {
      "get": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "List outlier alerts.",
        "operationId": "list_alerts",
        "parameters": [
          {
            "name": "user_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "analysis_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "alert_type",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/OutlierAlertType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "severity",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/OutlierAlertSeverity"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "is_read",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "is_dismissed",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Alerts retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/alerts/summary": {
      "get": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Get alert summary.",
        "operationId": "get_alert_summary",
        "responses": {
          "200": {
            "description": "Alert summary retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AlertSummaryResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/alerts/{alert_id}/dismiss": {
      "post": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Dismiss an alert.",
        "operationId": "dismiss_alert",
        "parameters": [
          {
            "name": "alert_id",
            "in": "path",
            "description": "Alert ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Alert dismissed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AlertResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Alert not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/alerts/{alert_id}/read": {
      "post": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Mark alert as read.",
        "operationId": "mark_alert_read",
        "parameters": [
          {
            "name": "alert_id",
            "in": "path",
            "description": "Alert ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Alert marked as read",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AlertResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Alert not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/analyses": {
      "get": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "List outlier analysis runs.",
        "operationId": "list_analyses",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/OutlierAnalysisStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "triggered_by",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/OutlierTriggerType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Analysis list retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Trigger a new outlier analysis.",
        "operationId": "trigger_analysis",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TriggerAnalysisRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Analysis started",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutlierAnalysisResponse"
                }
              }
            }
          },
          "400": {
            "description": "Outlier detection is disabled"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Analysis already running"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/analyses/{analysis_id}": {
      "get": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Get analysis details.",
        "operationId": "get_analysis",
        "parameters": [
          {
            "name": "analysis_id",
            "in": "path",
            "description": "Analysis ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Analysis retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutlierAnalysisResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Analysis not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/analyses/{analysis_id}/cancel": {
      "post": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Cancel a running analysis.",
        "operationId": "cancel_analysis",
        "parameters": [
          {
            "name": "analysis_id",
            "in": "path",
            "description": "Analysis ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Analysis cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutlierAnalysisResponse"
                }
              }
            }
          },
          "400": {
            "description": "Analysis cannot be cancelled (not running)"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Analysis not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/config": {
      "get": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Get outlier detection configuration for the tenant.",
        "operationId": "get_config",
        "responses": {
          "200": {
            "description": "Configuration retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutlierConfigResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Update outlier detection configuration.",
        "operationId": "update_config",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateOutlierConfigRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Configuration updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutlierConfigResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid configuration"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/config/disable": {
      "post": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Disable outlier detection for the tenant.",
        "operationId": "disable_detection",
        "responses": {
          "200": {
            "description": "Outlier detection disabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutlierConfigResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/config/enable": {
      "post": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Enable outlier detection for the tenant.",
        "operationId": "enable_detection",
        "responses": {
          "200": {
            "description": "Outlier detection enabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutlierConfigResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/dispositions": {
      "get": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "List dispositions with filtering.",
        "operationId": "list_dispositions",
        "parameters": [
          {
            "name": "user_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/OutlierDispositionStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "reviewed_by",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "include_expired",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Dispositions retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/dispositions/summary": {
      "get": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Get disposition summary by status.",
        "operationId": "get_disposition_summary",
        "responses": {
          "200": {
            "description": "Disposition summary retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DispositionSummaryResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/dispositions/{disposition_id}": {
      "get": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Get disposition details.",
        "operationId": "get_disposition",
        "parameters": [
          {
            "name": "disposition_id",
            "in": "path",
            "description": "Disposition ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Disposition retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DispositionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Disposition not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Update disposition status.",
        "operationId": "update_disposition",
        "parameters": [
          {
            "name": "disposition_id",
            "in": "path",
            "description": "Disposition ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateDispositionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Disposition updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DispositionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid status transition"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Disposition not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/reports": {
      "post": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Generate outlier detection report.",
        "operationId": "generate_report",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GenerateOutlierReportRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Report generated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutlierReportResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid date range"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/results": {
      "get": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "List outlier results (dashboard view).",
        "operationId": "list_results",
        "parameters": [
          {
            "name": "analysis_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "user_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "classification",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/OutlierClassification"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "min_score",
            "in": "query",
            "required": false,
            "schema": {
              "type": "number",
              "format": "double",
              "nullable": true
            }
          },
          {
            "name": "max_score",
            "in": "query",
            "required": false,
            "schema": {
              "type": "number",
              "format": "double",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Results retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/results/{result_id}": {
      "get": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Get detailed result for a user.",
        "operationId": "get_result",
        "parameters": [
          {
            "name": "result_id",
            "in": "path",
            "description": "Result ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Result retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutlierResultResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Result not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/results/{result_id}/disposition": {
      "post": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Create disposition for an outlier result.",
        "operationId": "create_disposition",
        "parameters": [
          {
            "name": "result_id",
            "in": "path",
            "description": "Result ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateDispositionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Disposition created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DispositionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid disposition"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Result not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/summary": {
      "get": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Get outlier summary statistics.",
        "operationId": "get_summary",
        "responses": {
          "200": {
            "description": "Summary retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OutlierSummaryResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/outliers/users/{user_id}": {
      "get": {
        "tags": [
          "Governance - Outlier Detection"
        ],
        "summary": "Get outlier history for a specific user.",
        "operationId": "get_user_history",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User outlier history retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserOutlierHistoryResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/parameters/audit": {
      "get": {
        "tags": [
          "Governance - Parametric Roles"
        ],
        "summary": "List parameter audit events.",
        "operationId": "list_parameter_audit",
        "parameters": [
          {
            "name": "assignment_id",
            "in": "query",
            "description": "Filter by assignment ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "event_type",
            "in": "query",
            "description": "Filter by event type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ParameterEventType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "actor_id",
            "in": "query",
            "description": "Filter by actor ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "from_date",
            "in": "query",
            "description": "Filter events from this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "to_date",
            "in": "query",
            "description": "Filter events to this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Audit events list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParameterAuditListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/peer-groups": {
      "get": {
        "tags": [
          "Governance - Peer Groups"
        ],
        "summary": "List all peer groups with filtering and pagination.",
        "operationId": "list_peer_groups",
        "parameters": [
          {
            "name": "group_type",
            "in": "query",
            "description": "Filter by group type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/PeerGroupType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "attribute_key",
            "in": "query",
            "description": "Filter by attribute key.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "min_user_count",
            "in": "query",
            "description": "Filter by minimum user count.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true,
              "minimum": 0
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of peer groups",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PeerGroupListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Peer Groups"
        ],
        "summary": "Create a new peer group.",
        "operationId": "create_peer_group",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePeerGroupRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Peer group created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PeerGroupResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/peer-groups/refresh-all": {
      "post": {
        "tags": [
          "Governance - Peer Groups"
        ],
        "summary": "Refresh all peer groups (recalculate statistics).",
        "operationId": "refresh_all_peer_groups",
        "responses": {
          "200": {
            "description": "All groups refreshed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RefreshPeerGroupsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/peer-groups/{group_id}": {
      "get": {
        "tags": [
          "Governance - Peer Groups"
        ],
        "summary": "Get a peer group by ID.",
        "operationId": "get_peer_group",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "description": "Peer group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Peer group details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PeerGroupResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Peer group not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Peer Groups"
        ],
        "summary": "Delete a peer group.",
        "operationId": "delete_peer_group",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "description": "Peer group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Peer group deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Peer group not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/peer-groups/{group_id}/refresh": {
      "post": {
        "tags": [
          "Governance - Peer Groups"
        ],
        "summary": "Refresh statistics for a specific peer group.",
        "operationId": "refresh_peer_group_stats",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "description": "Peer group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Group statistics refreshed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RefreshStatsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Peer group not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/persona-archetypes": {
      "get": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "List persona archetypes.",
        "operationId": "list_archetypes",
        "parameters": [
          {
            "name": "is_active",
            "in": "query",
            "description": "Filter by active status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "name_contains",
            "in": "query",
            "description": "Filter by name (partial match).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of items to return.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "default": 50,
              "nullable": true,
              "maximum": 100
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of items to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "default": 0,
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of archetypes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ArchetypeListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Create a persona archetype.",
        "operationId": "create_archetype",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateArchetypeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Archetype created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ArchetypeResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/persona-archetypes/{id}": {
      "get": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Get a persona archetype by ID.",
        "operationId": "get_archetype",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Archetype ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Archetype details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ArchetypeResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Archetype not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Update a persona archetype.",
        "operationId": "update_archetype",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Archetype ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateArchetypeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Archetype updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ArchetypeResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Archetype not found"
          },
          "409": {
            "description": "Name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Delete a persona archetype.",
        "operationId": "delete_archetype",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Archetype ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Archetype deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Archetype not found"
          },
          "409": {
            "description": "Cannot delete - active personas exist"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/persona-archetypes/{id}/activate": {
      "post": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Activate a persona archetype.",
        "operationId": "activate_archetype",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Archetype ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Archetype activated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ArchetypeResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Archetype not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/persona-archetypes/{id}/deactivate": {
      "post": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Deactivate a persona archetype.",
        "operationId": "deactivate_archetype",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Archetype ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Archetype deactivated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ArchetypeResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Archetype not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/persona-audit": {
      "get": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "List persona audit events.",
        "operationId": "list_audit_events",
        "parameters": [
          {
            "name": "persona_id",
            "in": "query",
            "description": "Filter by persona.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "archetype_id",
            "in": "query",
            "description": "Filter by archetype.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "actor_id",
            "in": "query",
            "description": "Filter by actor.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "event_type",
            "in": "query",
            "description": "Filter by event type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/PersonaAuditEventType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "from_date",
            "in": "query",
            "description": "Filter events from this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "to_date",
            "in": "query",
            "description": "Filter events until this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of items to return.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "default": 50,
              "nullable": true,
              "maximum": 100
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of items to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "default": 0,
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Audit events",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PersonaAuditListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/personas": {
      "get": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "List personas with filtering.",
        "operationId": "list_personas",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/PersonaStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "archetype_id",
            "in": "query",
            "description": "Filter by archetype.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "physical_user_id",
            "in": "query",
            "description": "Filter by physical user.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of items to return.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "default": 50,
              "nullable": true,
              "maximum": 100
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of items to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "default": 0,
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of personas",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PersonaListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Create a persona.",
        "operationId": "create_persona",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePersonaRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Persona created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PersonaResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Archetype or user not found"
          },
          "409": {
            "description": "Duplicate persona for archetype/user"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/personas/{id}": {
      "get": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Get a persona by ID.",
        "operationId": "get_persona",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Persona ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Persona details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PersonaDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Persona not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Update a persona.",
        "operationId": "update_persona",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Persona ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePersonaRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Persona updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PersonaResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Persona not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/personas/{id}/activate": {
      "post": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Activate a persona.",
        "operationId": "activate_persona",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Persona ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Persona activated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PersonaResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Persona not found"
          },
          "409": {
            "description": "Cannot activate - invalid status"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/personas/{id}/archive": {
      "post": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Archive a persona.",
        "operationId": "archive_persona",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Persona ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ArchivePersonaRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Persona archived",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PersonaResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request - reason required"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Persona not found"
          },
          "409": {
            "description": "Already archived"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/personas/{id}/audit": {
      "get": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Get audit events for a specific persona.",
        "operationId": "get_persona_audit",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Persona ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Skip results",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Audit events for persona",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PersonaAuditListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Persona not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/personas/{id}/deactivate": {
      "post": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Deactivate a persona.",
        "operationId": "deactivate_persona",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Persona ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeactivatePersonaRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Persona deactivated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PersonaResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request - reason required"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Persona not found"
          },
          "409": {
            "description": "Cannot deactivate - invalid status"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/personas/{id}/propagate-attributes": {
      "post": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Propagate attributes from physical user to persona.",
        "operationId": "propagate_attributes",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Persona ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Attributes propagated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PersonaResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Persona not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/provisioning-scripts": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "List provisioning scripts with optional filtering and pagination.",
        "operationId": "list_scripts",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by script status (e.g., draft, active, archived).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "search",
            "in": "query",
            "description": "Search scripts by name or description.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "Page number (1-based).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "page_size",
            "in": "query",
            "description": "Number of items per page.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Scripts retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScriptListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Create a new provisioning script.",
        "operationId": "create_script",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateScriptRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Script created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScriptResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/provisioning-scripts/{id}": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Get a provisioning script by ID.",
        "operationId": "get_script",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Script ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Script retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScriptResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Update a provisioning script's metadata.",
        "operationId": "update_script",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Script ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateScriptRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Script updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScriptResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Delete a provisioning script.",
        "operationId": "delete_script",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Script ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Script deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script not found"
          },
          "409": {
            "description": "Script has active bindings"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/provisioning-scripts/{id}/activate": {
      "post": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Activate a provisioning script.",
        "operationId": "activate_script",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Script ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Script activated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScriptResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script not found"
          },
          "409": {
            "description": "Script already active"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/provisioning-scripts/{id}/deactivate": {
      "post": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Deactivate a provisioning script.",
        "operationId": "deactivate_script",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Script ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Script deactivated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScriptResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script not found"
          },
          "409": {
            "description": "Script already inactive"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/provisioning-scripts/{id}/rollback": {
      "post": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Rollback a provisioning script to a previous version.",
        "operationId": "rollback_script",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Script ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RollbackRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Script rolled back",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScriptVersionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid rollback target"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script or target version not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/provisioning-scripts/{id}/versions": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "List all versions of a provisioning script.",
        "operationId": "list_script_versions",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Script ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Script versions retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScriptVersionListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Create a new version for a provisioning script (update script body).",
        "operationId": "create_script_version",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Script ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateScriptBodyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Script version created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScriptVersionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/provisioning-scripts/{script_id}/versions/compare": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Compare two versions of a provisioning script.",
        "operationId": "compare_versions",
        "parameters": [
          {
            "name": "script_id",
            "in": "path",
            "description": "Script ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "from",
            "in": "query",
            "description": "First version number to compare",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "to",
            "in": "query",
            "description": "Second version number to compare",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Version comparison result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/VersionComparisonResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script or version not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/provisioning-scripts/{script_id}/versions/{version_number}": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Get a specific version of a provisioning script.",
        "operationId": "get_script_version",
        "parameters": [
          {
            "name": "script_id",
            "in": "path",
            "description": "Script ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "version_number",
            "in": "path",
            "description": "Version number",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Script version retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScriptVersionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script or version not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reconciliation-runs": {
      "get": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "List reconciliation runs with optional filtering.",
        "operationId": "list_reconciliation_runs",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ReconciliationStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "triggered_by",
            "in": "query",
            "description": "Filter by who triggered the run.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "since",
            "in": "query",
            "description": "Filter runs since this date.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 20, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of reconciliation runs",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReconciliationRunListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Trigger a new reconciliation run for orphan account detection.",
        "operationId": "trigger_reconciliation",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TriggerReconciliationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Reconciliation run started",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReconciliationRunResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Reconciliation already running"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reconciliation-runs/{id}": {
      "get": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Get a reconciliation run by ID.",
        "operationId": "get_reconciliation_run",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Reconciliation run ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Reconciliation run details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReconciliationRunResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Run not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reconciliation-runs/{id}/cancel": {
      "post": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Cancel a running reconciliation.",
        "operationId": "cancel_reconciliation",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Reconciliation run ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Reconciliation cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReconciliationRunResponse"
                }
              }
            }
          },
          "400": {
            "description": "Run not in running state"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Run not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reconciliation-schedule": {
      "get": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Get the current reconciliation schedule.",
        "operationId": "get_schedule",
        "responses": {
          "200": {
            "description": "Current schedule",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ReconciliationScheduleResponse"
                    }
                  ],
                  "nullable": true
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Create or update the reconciliation schedule.",
        "operationId": "upsert_schedule",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpsertScheduleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Schedule updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReconciliationScheduleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid schedule parameters"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Delete the reconciliation schedule.",
        "operationId": "delete_schedule",
        "responses": {
          "204": {
            "description": "Schedule deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reconciliation-schedule/trigger": {
      "post": {
        "tags": [
          "Governance - Orphan Detection"
        ],
        "summary": "Trigger scheduled reconciliation runs (for external scheduler).",
        "description": "This endpoint is typically called by a cron job or scheduler service.",
        "operationId": "trigger_scheduled_runs",
        "responses": {
          "200": {
            "description": "Number of runs triggered",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "array",
                    "items": {
                      "allOf": [
                        {
                          "type": "string",
                          "format": "uuid"
                        },
                        {
                          "type": "string",
                          "format": "uuid"
                        }
                      ]
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reports": {
      "get": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "List generated reports with optional filtering and pagination.",
        "operationId": "list_reports",
        "parameters": [
          {
            "name": "template_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ReportStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "from_date",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "to_date",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of generated reports",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneratedReportListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reports/cleanup": {
      "post": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Delete expired reports.",
        "operationId": "cleanup_expired_reports",
        "responses": {
          "200": {
            "description": "Expired reports deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CleanupResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reports/generate": {
      "post": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Generate a new report.",
        "description": "This endpoint creates a report record in \"pending\" status, then immediately\nexecutes the report generation process. The response includes the completed\n(or failed) report with generated data.",
        "operationId": "generate_report",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GenerateReportRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Report generated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneratedReportResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reports/schedules": {
      "get": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "List report schedules with optional filtering and pagination.",
        "operationId": "list_schedules",
        "parameters": [
          {
            "name": "template_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ScheduleStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of report schedules",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportScheduleListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Create a new report schedule.",
        "operationId": "create_schedule",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateReportScheduleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Schedule created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportScheduleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "409": {
            "description": "Schedule name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reports/schedules/{id}": {
      "get": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Get a report schedule by ID.",
        "operationId": "get_schedule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Schedule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Schedule details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportScheduleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Schedule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Update a report schedule.",
        "operationId": "update_schedule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Schedule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateReportScheduleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Schedule updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportScheduleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Schedule not found"
          },
          "409": {
            "description": "Schedule name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Delete a report schedule.",
        "operationId": "delete_schedule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Schedule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Schedule deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Schedule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reports/schedules/{id}/pause": {
      "post": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Pause a report schedule.",
        "operationId": "pause_schedule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Schedule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Schedule paused",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportScheduleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Schedule already paused"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Schedule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reports/schedules/{id}/resume": {
      "post": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Resume a paused report schedule.",
        "operationId": "resume_schedule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Schedule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Schedule resumed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportScheduleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Schedule already active"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Schedule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reports/templates": {
      "get": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "List report templates with optional filtering and pagination.",
        "operationId": "list_templates",
        "parameters": [
          {
            "name": "template_type",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ReportTemplateType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "compliance_standard",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ComplianceStandard"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "include_system",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of report templates",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportTemplateListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Create a new custom report template.",
        "operationId": "create_template",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateReportTemplateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Template created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportTemplateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Template name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reports/templates/{id}": {
      "get": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Get a report template by ID.",
        "operationId": "get_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Template details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportTemplateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Template not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Update a custom report template.",
        "operationId": "update_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateReportTemplateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Template updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportTemplateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Cannot modify system template"
          },
          "404": {
            "description": "Template not found"
          },
          "409": {
            "description": "Template name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Archive (soft-delete) a custom report template.",
        "operationId": "archive_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Template archived",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportTemplateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Cannot archive system template"
          },
          "404": {
            "description": "Template not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reports/templates/{id}/clone": {
      "post": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Clone a report template.",
        "operationId": "clone_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Source template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CloneReportTemplateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Template cloned",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportTemplateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Source template not found"
          },
          "409": {
            "description": "Template name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reports/{id}": {
      "get": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Get a generated report by ID.",
        "operationId": "get_report",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Report ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Report details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeneratedReportResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Report not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Delete a report (only pending/failed reports).",
        "operationId": "delete_report",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Report ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Report deleted"
          },
          "400": {
            "description": "Cannot delete completed/generating report"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Report not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/reports/{id}/data": {
      "get": {
        "tags": [
          "Governance - Compliance Reporting"
        ],
        "summary": "Get report output data (for completed reports).",
        "operationId": "get_report_data",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Report ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Report data",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "400": {
            "description": "Report not completed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Report not found or no inline data"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/risk-alerts": {
      "get": {
        "tags": [
          "Governance - Risk Alerts"
        ],
        "summary": "List all risk alerts with filtering and pagination.",
        "operationId": "list_risk_alerts",
        "parameters": [
          {
            "name": "user_id",
            "in": "query",
            "description": "Filter by user ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "threshold_id",
            "in": "query",
            "description": "Filter by threshold ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "severity",
            "in": "query",
            "description": "Filter by severity.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/AlertSeverity"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "acknowledged",
            "in": "query",
            "description": "Filter by acknowledged status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "sort_by",
            "in": "query",
            "description": "Sort order.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/RiskAlertSortOption"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of risk alerts",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskAlertListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/risk-alerts/summary": {
      "get": {
        "tags": [
          "Governance - Risk Alerts"
        ],
        "summary": "Get alert summary (unacknowledged counts by severity).",
        "operationId": "get_alert_summary",
        "responses": {
          "200": {
            "description": "Alert summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AlertSummary"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/risk-alerts/{alert_id}": {
      "get": {
        "tags": [
          "Governance - Risk Alerts"
        ],
        "summary": "Get a risk alert by ID.",
        "operationId": "get_risk_alert",
        "parameters": [
          {
            "name": "alert_id",
            "in": "path",
            "description": "Alert ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Risk alert details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskAlertResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Alert not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Risk Alerts"
        ],
        "summary": "Delete a risk alert.",
        "operationId": "delete_risk_alert",
        "parameters": [
          {
            "name": "alert_id",
            "in": "path",
            "description": "Alert ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Alert deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Alert not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/risk-alerts/{alert_id}/acknowledge": {
      "post": {
        "tags": [
          "Governance - Risk Alerts"
        ],
        "summary": "Acknowledge a risk alert.",
        "operationId": "acknowledge_risk_alert",
        "parameters": [
          {
            "name": "alert_id",
            "in": "path",
            "description": "Alert ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Alert acknowledged",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AcknowledgeAlertResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Alert not found or already acknowledged"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/risk-factors": {
      "get": {
        "tags": [
          "Governance - Risk Factors"
        ],
        "summary": "List all risk factors with filtering and pagination.",
        "operationId": "list_risk_factors",
        "parameters": [
          {
            "name": "category",
            "in": "query",
            "description": "Filter by category.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/RiskFactorCategory"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "is_enabled",
            "in": "query",
            "description": "Filter by enabled status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "factor_type",
            "in": "query",
            "description": "Filter by factor type.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of risk factors",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskFactorListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Risk Factors"
        ],
        "summary": "Create a new risk factor.",
        "operationId": "create_risk_factor",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateRiskFactorRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Risk factor created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskFactorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Conflict - factor type already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/risk-factors/{factor_id}": {
      "get": {
        "tags": [
          "Governance - Risk Factors"
        ],
        "summary": "Get a risk factor by ID.",
        "operationId": "get_risk_factor",
        "parameters": [
          {
            "name": "factor_id",
            "in": "path",
            "description": "Risk factor ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Risk factor details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskFactorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Risk factor not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Risk Factors"
        ],
        "summary": "Update a risk factor.",
        "operationId": "update_risk_factor",
        "parameters": [
          {
            "name": "factor_id",
            "in": "path",
            "description": "Risk factor ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateRiskFactorRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Risk factor updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskFactorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Risk factor not found"
          },
          "409": {
            "description": "Conflict - factor type already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Risk Factors"
        ],
        "summary": "Delete a risk factor.",
        "operationId": "delete_risk_factor",
        "parameters": [
          {
            "name": "factor_id",
            "in": "path",
            "description": "Risk factor ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Risk factor deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Risk factor not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/risk-factors/{factor_id}/disable": {
      "post": {
        "tags": [
          "Governance - Risk Factors"
        ],
        "summary": "Disable a risk factor.",
        "operationId": "disable_risk_factor",
        "parameters": [
          {
            "name": "factor_id",
            "in": "path",
            "description": "Risk factor ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Risk factor disabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskFactorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Risk factor not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/risk-factors/{factor_id}/enable": {
      "post": {
        "tags": [
          "Governance - Risk Factors"
        ],
        "summary": "Enable a risk factor.",
        "operationId": "enable_risk_factor",
        "parameters": [
          {
            "name": "factor_id",
            "in": "path",
            "description": "Risk factor ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Risk factor enabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskFactorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Risk factor not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/risk-scores": {
      "get": {
        "tags": [
          "Governance - Risk Scoring"
        ],
        "summary": "List all risk scores with filtering and pagination.",
        "operationId": "list_risk_scores",
        "parameters": [
          {
            "name": "risk_level",
            "in": "query",
            "description": "Filter by risk level.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/RiskLevel"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "min_score",
            "in": "query",
            "description": "Filter by minimum score.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true,
              "maximum": 100,
              "minimum": 0
            }
          },
          {
            "name": "max_score",
            "in": "query",
            "description": "Filter by maximum score.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true,
              "maximum": 100,
              "minimum": 0
            }
          },
          {
            "name": "sort_by",
            "in": "query",
            "description": "Sort order.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/RiskScoreSortOption"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of risk scores",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskScoreListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/risk-scores/calculate-all": {
      "post": {
        "tags": [
          "Governance - Risk Scoring"
        ],
        "summary": "Batch calculate risk scores for all users.",
        "operationId": "calculate_all_risk_scores",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CalculateScoreRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Batch calculation result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchCalculateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/risk-scores/summary": {
      "get": {
        "tags": [
          "Governance - Risk Scoring"
        ],
        "summary": "Get risk score summary for the tenant.",
        "operationId": "get_risk_score_summary",
        "responses": {
          "200": {
            "description": "Risk score summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskScoreSummary"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/risk/enforcement-policy": {
      "get": {
        "tags": [
          "Governance - Risk Management"
        ],
        "summary": "Get the risk enforcement policy for the current tenant.",
        "operationId": "get_enforcement_policy",
        "responses": {
          "200": {
            "description": "Enforcement policy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EnforcementPolicyResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Risk Management"
        ],
        "summary": "Create or update the risk enforcement policy for the current tenant.",
        "operationId": "upsert_enforcement_policy",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpsertEnforcementPolicyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Enforcement policy updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EnforcementPolicyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-entitlements": {
      "get": {
        "tags": [
          "Governance - Role Entitlements"
        ],
        "summary": "List role-entitlement mappings with optional filtering and pagination.",
        "operationId": "list_role_entitlements",
        "parameters": [
          {
            "name": "entitlement_id",
            "in": "query",
            "description": "Filter by entitlement ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "role_name",
            "in": "query",
            "description": "Filter by role name.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results to return.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of role-entitlement mappings",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleEntitlementListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Role Entitlements"
        ],
        "summary": "Create a new role-entitlement mapping.",
        "operationId": "create_role_entitlement",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateRoleEntitlementRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Role-entitlement mapping created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleEntitlementResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Entitlement not found"
          },
          "409": {
            "description": "Mapping already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-entitlements/{id}": {
      "delete": {
        "tags": [
          "Governance - Role Entitlements"
        ],
        "summary": "Delete a role-entitlement mapping.",
        "operationId": "delete_role_entitlement",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Mapping ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Mapping deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Mapping not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/candidates/{candidate_id}": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Get a role candidate by ID.",
        "operationId": "get_candidate",
        "parameters": [
          {
            "name": "candidate_id",
            "in": "path",
            "description": "Candidate ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Candidate details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleCandidateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Candidate not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/candidates/{candidate_id}/dismiss": {
      "post": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Dismiss a role candidate.",
        "operationId": "dismiss_candidate",
        "parameters": [
          {
            "name": "candidate_id",
            "in": "path",
            "description": "Candidate ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DismissCandidateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Candidate dismissed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleCandidateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Candidate not found"
          },
          "409": {
            "description": "Candidate already processed"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/candidates/{candidate_id}/promote": {
      "post": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Promote a candidate to an actual role.",
        "operationId": "promote_candidate",
        "parameters": [
          {
            "name": "candidate_id",
            "in": "path",
            "description": "Candidate ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PromoteCandidateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Candidate promoted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleCandidateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Candidate not found"
          },
          "409": {
            "description": "Candidate already promoted or dismissed"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/consolidation-suggestions/{suggestion_id}": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Get a consolidation suggestion by ID.",
        "operationId": "get_consolidation_suggestion",
        "parameters": [
          {
            "name": "suggestion_id",
            "in": "path",
            "description": "Suggestion ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Suggestion details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConsolidationSuggestionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Suggestion not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/consolidation-suggestions/{suggestion_id}/dismiss": {
      "post": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Dismiss a consolidation suggestion.",
        "operationId": "dismiss_consolidation_suggestion",
        "parameters": [
          {
            "name": "suggestion_id",
            "in": "path",
            "description": "Suggestion ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DismissConsolidationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Suggestion dismissed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConsolidationSuggestionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Suggestion not found"
          },
          "409": {
            "description": "Suggestion already processed"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/excessive-privileges/{flag_id}": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Get an excessive privilege flag by ID.",
        "operationId": "get_excessive_privilege",
        "parameters": [
          {
            "name": "flag_id",
            "in": "path",
            "description": "Flag ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Excessive privilege details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExcessivePrivilegeResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Flag not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/excessive-privileges/{flag_id}/review": {
      "post": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Review an excessive privilege flag.",
        "operationId": "review_excessive_privilege",
        "parameters": [
          {
            "name": "flag_id",
            "in": "path",
            "description": "Flag ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReviewPrivilegeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Flag reviewed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExcessivePrivilegeResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Flag not found"
          },
          "409": {
            "description": "Flag already reviewed"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/jobs": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "List role mining jobs.",
        "operationId": "list_mining_jobs",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/MiningJobStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of mining jobs",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MiningJobListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Create a new mining job.",
        "operationId": "create_mining_job",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateMiningJobRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Mining job created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MiningJobResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/jobs/{job_id}": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Get a mining job by ID.",
        "operationId": "get_mining_job",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "description": "Mining job ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Mining job details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MiningJobResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Job not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Cancel a running mining job.",
        "operationId": "cancel_mining_job",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "description": "Mining job ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Job cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MiningJobResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Job not found"
          },
          "409": {
            "description": "Job cannot be cancelled"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/jobs/{job_id}/candidates": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "List role candidates from a mining job.",
        "operationId": "list_candidates",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "description": "Mining job ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/CandidatePromotionStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "min_confidence",
            "in": "query",
            "required": false,
            "schema": {
              "type": "number",
              "format": "double",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of candidates",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleCandidateListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Job not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/jobs/{job_id}/consolidation-suggestions": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "List consolidation suggestions from a mining job.",
        "operationId": "list_consolidation_suggestions",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "description": "Mining job ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ConsolidationStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "min_overlap",
            "in": "query",
            "required": false,
            "schema": {
              "type": "number",
              "format": "double",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of consolidation suggestions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConsolidationSuggestionListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Job not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/jobs/{job_id}/excessive-privileges": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "List excessive privilege flags from a mining job.",
        "operationId": "list_excessive_privileges",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "description": "Mining job ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/PrivilegeFlagStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "user_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of excessive privilege flags",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExcessivePrivilegeListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Job not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/jobs/{job_id}/patterns": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "List access patterns from a mining job.",
        "operationId": "list_access_patterns",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "description": "Mining job ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "min_frequency",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of access patterns",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessPatternListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Job not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/jobs/{job_id}/run": {
      "post": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Run a pending mining job.",
        "operationId": "run_mining_job",
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "description": "Mining job ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Job started",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MiningJobResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Job not found"
          },
          "409": {
            "description": "Job cannot be started"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/metrics": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "List role effectiveness metrics.",
        "operationId": "list_metrics",
        "parameters": [
          {
            "name": "role_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "trend_direction",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/MetricsTrendDirection"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "min_utilization",
            "in": "query",
            "required": false,
            "schema": {
              "type": "number",
              "format": "double",
              "nullable": true
            }
          },
          {
            "name": "max_utilization",
            "in": "query",
            "required": false,
            "schema": {
              "type": "number",
              "format": "double",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of role metrics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleMetricsListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/metrics/calculate": {
      "post": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Calculate metrics for roles.",
        "operationId": "calculate_metrics",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CalculateMetricsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Metrics calculated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleMetricsListResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/metrics/{role_id}": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Get metrics for a specific role.",
        "operationId": "get_role_metrics",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Role metrics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleMetricsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Metrics not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/patterns/{pattern_id}": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Get an access pattern by ID.",
        "operationId": "get_access_pattern",
        "parameters": [
          {
            "name": "pattern_id",
            "in": "path",
            "description": "Pattern ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Pattern details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessPatternResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Pattern not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/simulations": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "List role simulations.",
        "operationId": "list_simulations",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/SimulationStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "scenario_type",
            "in": "query",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ScenarioType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "target_role_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of simulations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SimulationListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Create a new simulation.",
        "operationId": "create_simulation",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSimulationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Simulation created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SimulationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/simulations/{simulation_id}": {
      "get": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Get a simulation by ID.",
        "operationId": "get_simulation",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Simulation details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SimulationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Cancel a simulation.",
        "operationId": "cancel_simulation",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Simulation cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SimulationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "409": {
            "description": "Simulation already applied"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/simulations/{simulation_id}/apply": {
      "post": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Apply a simulation (commit the changes).",
        "operationId": "apply_simulation",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Simulation applied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SimulationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "409": {
            "description": "Simulation not ready or already applied"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/role-mining/simulations/{simulation_id}/execute": {
      "post": {
        "tags": [
          "Governance - Role Mining"
        ],
        "summary": "Execute a simulation.",
        "operationId": "execute_simulation",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Simulation executed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SimulationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "409": {
            "description": "Simulation cannot be executed"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles": {
      "get": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "List governance roles.",
        "operationId": "list_roles",
        "parameters": [
          {
            "name": "parent_role_id",
            "in": "query",
            "description": "Filter by parent role ID (use \"null\" for root roles).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "is_abstract",
            "in": "query",
            "description": "Filter by abstract flag.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "name",
            "in": "query",
            "description": "Search by name prefix.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of roles",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Create a new governance role.",
        "operationId": "create_role",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateRoleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Role created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Conflict - name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/tree": {
      "get": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Get role hierarchy as tree structure.",
        "operationId": "get_tree",
        "parameters": [
          {
            "name": "root_role_id",
            "in": "query",
            "description": "Optional root role ID to start from.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Role hierarchy tree",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleTreeResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Root role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}": {
      "get": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Get a governance role by ID.",
        "operationId": "get_role",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Role details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Update a governance role.",
        "operationId": "update_role",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateRoleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Role updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "409": {
            "description": "Conflict - version mismatch or circular reference"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Delete a governance role.",
        "operationId": "delete_role",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Role deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/ancestors": {
      "get": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Get ancestors of a role.",
        "operationId": "get_ancestors",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of ancestor roles",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/RoleResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/assignments": {
      "post": {
        "tags": [
          "Governance - Parametric Roles"
        ],
        "summary": "Create a parametric assignment (role assignment with parameters).",
        "operationId": "create_parametric_assignment",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role (entitlement) ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/crate.models.CreateParametricAssignmentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Parametric assignment created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/crate.models.ParametricAssignmentResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or validation failed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found or not parametric"
          },
          "409": {
            "description": "Assignment with same parameters already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/children": {
      "get": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Get children of a role.",
        "operationId": "get_children",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of child roles",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/RoleResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/descendants": {
      "get": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Get descendants of a role.",
        "operationId": "get_descendants",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of descendant roles",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/RoleResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/effective-entitlements": {
      "get": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Get effective entitlements for a role (direct + inherited).",
        "operationId": "get_effective_entitlements",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Effective entitlements",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EffectiveEntitlementsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/effective-entitlements/recompute": {
      "post": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Trigger recomputation of effective entitlements for a role.",
        "operationId": "recompute_effective_entitlements",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Recomputation completed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RecomputeResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/entitlements": {
      "get": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "List direct entitlements for a role.",
        "operationId": "list_role_entitlements",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of direct entitlements",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/RoleEntitlementResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Add an entitlement to a role.",
        "operationId": "add_role_entitlement",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AddRoleEntitlementRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Entitlement added",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleEntitlementResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role or entitlement not found"
          },
          "409": {
            "description": "Conflict - entitlement already mapped"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/entitlements/{entitlement_id}": {
      "delete": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Remove an entitlement from a role.",
        "operationId": "remove_role_entitlement",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "entitlement_id",
            "in": "path",
            "description": "Entitlement ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Entitlement removed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role or mapping not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/impact": {
      "get": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Get impact analysis for a role.",
        "operationId": "get_impact",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Impact analysis",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ImpactAnalysisResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/inheritance-blocks": {
      "get": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "List inheritance blocks for a role.",
        "operationId": "list_inheritance_blocks",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of inheritance blocks",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/InheritanceBlockDetailsResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Add an inheritance block to a role.",
        "operationId": "add_inheritance_block",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AddInheritanceBlockRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Inheritance block added",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InheritanceBlockResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role or entitlement not found"
          },
          "409": {
            "description": "Conflict - block already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/inheritance-blocks/{block_id}": {
      "delete": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Remove an inheritance block from a role.",
        "operationId": "remove_inheritance_block",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "block_id",
            "in": "path",
            "description": "Inheritance block ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Inheritance block removed"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role or block not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/meta-roles": {
      "get": {
        "tags": [
          "Governance - Meta-roles"
        ],
        "summary": "Get meta-roles that apply to a specific role.",
        "operationId": "get_role_meta_roles",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role (entitlement) ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Meta-roles for role",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleMatchResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/move": {
      "post": {
        "tags": [
          "Governance - Role Hierarchy"
        ],
        "summary": "Move a role to a new parent.",
        "operationId": "move_role",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MoveRoleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Role moved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleMoveResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request - circular reference or depth exceeded"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role or parent not found"
          },
          "409": {
            "description": "Conflict - version mismatch"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/parameters": {
      "get": {
        "tags": [
          "Governance - Parametric Roles"
        ],
        "summary": "List all parameters defined for a role.",
        "operationId": "list_role_parameters",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role (entitlement) ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "parameter_type",
            "in": "query",
            "description": "Filter by parameter type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ParameterType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "is_required",
            "in": "query",
            "description": "Filter by required flag.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "name",
            "in": "query",
            "description": "Filter by name (partial match).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of role parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleParameterListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Parametric Roles"
        ],
        "summary": "Add a new parameter to a role.",
        "operationId": "add_role_parameter",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role (entitlement) ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateRoleParameterRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Parameter created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleParameterResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found"
          },
          "409": {
            "description": "Parameter name already exists for this role"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/parameters/validate": {
      "post": {
        "tags": [
          "Governance - Parametric Roles"
        ],
        "summary": "Validate parameter values before creating an assignment.",
        "operationId": "validate_parameters",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role (entitlement) ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ValidateParametersRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Validation result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidateParametersResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Role not found or not parametric"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/roles/{role_id}/parameters/{parameter_id}": {
      "get": {
        "tags": [
          "Governance - Parametric Roles"
        ],
        "summary": "Get a specific role parameter by ID.",
        "operationId": "get_role_parameter",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role (entitlement) ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "parameter_id",
            "in": "path",
            "description": "Parameter ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Parameter details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleParameterResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Parameter or role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Parametric Roles"
        ],
        "summary": "Update a role parameter.",
        "operationId": "update_role_parameter",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role (entitlement) ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "parameter_id",
            "in": "path",
            "description": "Parameter ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateRoleParameterRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Parameter updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleParameterResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Parameter or role not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Parametric Roles"
        ],
        "summary": "Delete a role parameter.",
        "description": "A parameter can only be deleted if no assignments are using it (FR-012).",
        "operationId": "delete_role_parameter",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "description": "Role (entitlement) ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "parameter_id",
            "in": "path",
            "description": "Parameter ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Parameter deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Parameter or role not found"
          },
          "409": {
            "description": "Cannot delete - parameter has active assignments"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/script-analytics/dashboard": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Get the provisioning script analytics dashboard.",
        "description": "Returns aggregate statistics including total/active script counts,\noverall success rate, average duration, and per-script summaries.",
        "operationId": "get_dashboard",
        "responses": {
          "200": {
            "description": "Dashboard analytics data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DashboardResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/script-analytics/scripts/{script_id}": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Get detailed analytics for a specific provisioning script.",
        "description": "Returns per-script statistics including success rate, average and p95\ndurations, daily execution trends, and top error messages.",
        "operationId": "get_script_analytics",
        "parameters": [
          {
            "name": "script_id",
            "in": "path",
            "description": "Script ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Script analytics data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScriptAnalyticsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/script-audit-events": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "List script audit events with optional filtering.",
        "description": "Returns an audit trail of script lifecycle actions such as creation,\nactivation, rollback, binding, and deletion.",
        "operationId": "list_script_audit_events",
        "parameters": [
          {
            "name": "script_id",
            "in": "query",
            "description": "Filter by script ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "action",
            "in": "query",
            "description": "Filter by audit action (e.g., created, activated, deleted).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of events to return (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of events to skip for pagination.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Script audit events",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/script-execution-logs": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "List script execution logs with optional filtering.",
        "description": "Supports filtering by script, connector, binding, status, dry-run flag,\nand date range. Results are paginated.",
        "operationId": "list_execution_logs",
        "parameters": [
          {
            "name": "script_id",
            "in": "query",
            "description": "Filter by script ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "connector_id",
            "in": "query",
            "description": "Filter by connector ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "binding_id",
            "in": "query",
            "description": "Filter by binding ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by execution status.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "dry_run",
            "in": "query",
            "description": "Filter by dry run flag.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "from_date",
            "in": "query",
            "description": "Filter executions from this date (ISO 8601 format).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "to_date",
            "in": "query",
            "description": "Filter executions until this date (ISO 8601 format).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "Page number (1-based).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "page_size",
            "in": "query",
            "description": "Number of items per page.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Execution log list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExecutionLogListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/script-execution-logs/{id}": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Get a single execution log entry by ID.",
        "operationId": "get_execution_log",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Execution log entry ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Execution log entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExecutionLogResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Execution log not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/script-templates": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "List script templates with optional filtering and pagination.",
        "operationId": "list_templates",
        "parameters": [
          {
            "name": "category",
            "in": "query",
            "description": "Filter by template category.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "search",
            "in": "query",
            "description": "Search templates by name or description.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "Page number (1-based).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "page_size",
            "in": "query",
            "description": "Number of items per page.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of script templates",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Create a new script template.",
        "operationId": "create_template",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateTemplateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Script template created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Template name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/script-templates/{id}": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Get a script template by ID.",
        "operationId": "get_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Script template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Script template details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script template not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Update a script template.",
        "operationId": "update_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Script template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateTemplateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Script template updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script template not found"
          },
          "409": {
            "description": "Template name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Delete a script template.",
        "operationId": "delete_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Script template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Script template deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script template not found"
          },
          "409": {
            "description": "Template is in use"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/script-templates/{id}/instantiate": {
      "post": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Instantiate a script template into a concrete provisioning script.",
        "operationId": "instantiate_template",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Script template ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/InstantiateTemplateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Script instantiated from template",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScriptResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or missing template variables"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script template not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/scripts/bindings": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "List script hook bindings with optional filtering and pagination.",
        "operationId": "list_bindings",
        "parameters": [
          {
            "name": "connector_id",
            "in": "query",
            "description": "Filter by connector ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "script_id",
            "in": "query",
            "description": "Filter by script ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "hook_phase",
            "in": "query",
            "description": "Filter by hook phase.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "operation_type",
            "in": "query",
            "description": "Filter by operation type.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "Page number (1-based).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "page_size",
            "in": "query",
            "description": "Number of items per page.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of script hook bindings",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BindingListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Create a new script hook binding.",
        "operationId": "create_binding",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateBindingRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Script hook binding created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BindingResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script or connector not found"
          },
          "409": {
            "description": "Maximum bindings exceeded for hook point"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/scripts/bindings/{id}": {
      "get": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Get a script hook binding by ID.",
        "operationId": "get_binding",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Binding ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Script hook binding details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BindingResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Binding not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Update a script hook binding.",
        "operationId": "update_binding",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Binding ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateBindingRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Script hook binding updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BindingResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Binding not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Delete a script hook binding.",
        "operationId": "delete_binding",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Binding ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Script hook binding deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Binding not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/scripts/dry-run": {
      "post": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Execute a dry-run of a raw (unsaved) script body with sample context.",
        "operationId": "dry_run_raw",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RawDryRunRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Dry-run result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DryRunResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/scripts/validate": {
      "post": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Validate a script for syntax errors (without executing it).",
        "operationId": "validate_script",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ValidateScriptRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Validation result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/scripts/{script_id}/versions/{version_number}/dry-run": {
      "post": {
        "tags": [
          "Governance - Provisioning Scripts"
        ],
        "summary": "Execute a dry-run of a saved script version with sample context.",
        "operationId": "dry_run_version",
        "parameters": [
          {
            "name": "script_id",
            "in": "path",
            "description": "Script ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "version_number",
            "in": "path",
            "description": "Version number",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DryRunRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Dry-run result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DryRunResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Script or version not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/semi-manual/applications": {
      "get": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "List applications configured as semi-manual.",
        "operationId": "list_semi_manual_applications",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results to return",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Results to skip",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Semi-manual applications retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SemiManualApplicationsListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/semi-manual/applications/{id}": {
      "get": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "Get semi-manual configuration for an application.",
        "operationId": "get_semi_manual_config",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Application ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Semi-manual configuration retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SemiManualApplicationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "Configure an application as semi-manual.",
        "operationId": "configure_semi_manual",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Application ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ConfigureSemiManualRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Semi-manual configuration updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SemiManualApplicationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "Remove semi-manual configuration from an application.",
        "operationId": "remove_semi_manual_config",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Application ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Semi-manual configuration removed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SemiManualApplicationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Application not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/siem/destinations": {
      "get": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "List SIEM destinations.",
        "operationId": "list_destinations",
        "parameters": [
          {
            "name": "enabled",
            "in": "query",
            "description": "Filter by enabled status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (1-100, default 50).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip (default 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of destinations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SiemDestinationListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "Create a SIEM destination.",
        "operationId": "create_destination",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSiemDestinationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Destination created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SiemDestinationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Duplicate name"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/siem/destinations/{id}": {
      "get": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "Get a SIEM destination by ID.",
        "operationId": "get_destination",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Destination ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Destination details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SiemDestinationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "Update a SIEM destination.",
        "operationId": "update_destination",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Destination ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSiemDestinationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Destination updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SiemDestinationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Not found"
          },
          "409": {
            "description": "Duplicate name"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "Delete a SIEM destination.",
        "operationId": "delete_destination",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Destination ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Destination deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/siem/destinations/{id}/dead-letter": {
      "get": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "List dead letter events for a destination.",
        "operationId": "list_dead_letter",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Destination ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Dead letter events"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Destination not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/siem/destinations/{id}/dead-letter/redeliver": {
      "post": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "Re-deliver all dead letter events for a destination.",
        "operationId": "redeliver_dead_letter",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Destination ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Re-delivery result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RedeliverResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Destination not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/siem/destinations/{id}/health": {
      "get": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "Get delivery health summary for a destination.",
        "operationId": "get_destination_health",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Destination ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Health summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SiemHealthSummaryResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Destination not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/siem/destinations/{id}/health/history": {
      "get": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "Get delivery health history for a destination.",
        "operationId": "get_delivery_history",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Destination ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "from",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          },
          {
            "name": "to",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Health history windows"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Destination not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/siem/destinations/{id}/test": {
      "post": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "Test connectivity to a SIEM destination.",
        "operationId": "test_destination",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Destination ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Test result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TestConnectivityResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/siem/exports": {
      "get": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "List batch exports.",
        "operationId": "list_batch_exports",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of batch exports",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SiemBatchExportListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "Create a batch export job.",
        "operationId": "create_batch_export",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateBatchExportRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Batch export created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SiemBatchExportResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/siem/exports/{id}": {
      "get": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "Get a batch export by ID.",
        "operationId": "get_batch_export",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Batch export ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Batch export details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SiemBatchExportResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/siem/exports/{id}/download": {
      "get": {
        "tags": [
          "Governance - Audit Export"
        ],
        "summary": "Download a completed batch export file.",
        "operationId": "download_batch_export",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Batch export ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Export file download"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/simulations/batch": {
      "get": {
        "tags": [
          "Governance - Enhanced Simulation"
        ],
        "summary": "List batch simulations.",
        "operationId": "list_batch_simulations",
        "parameters": [
          {
            "name": "batch_type",
            "in": "query",
            "description": "Filter by batch type.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/BatchSimulationType"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/SimulationStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "created_by",
            "in": "query",
            "description": "Filter by creator.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "include_archived",
            "in": "query",
            "description": "Include archived simulations.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Page offset (default: 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Page size (default: 20, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Simulations listed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Enhanced Simulation"
        ],
        "summary": "Create a new batch simulation.",
        "operationId": "create_batch_simulation",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateBatchSimulationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Simulation created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchSimulationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/simulations/batch/{simulation_id}": {
      "get": {
        "tags": [
          "Governance - Enhanced Simulation"
        ],
        "summary": "Get a batch simulation by ID.",
        "operationId": "get_batch_simulation",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Simulation retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchSimulationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Enhanced Simulation"
        ],
        "summary": "Delete a batch simulation.",
        "operationId": "delete_batch_simulation",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Simulation deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/simulations/batch/{simulation_id}/apply": {
      "post": {
        "tags": [
          "Governance - Enhanced Simulation"
        ],
        "summary": "Apply a batch simulation (commit changes).",
        "operationId": "apply_batch_simulation",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApplyBatchSimulationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Simulation applied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchSimulationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "409": {
            "description": "Scope warning - acknowledge required"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/simulations/batch/{simulation_id}/archive": {
      "post": {
        "tags": [
          "Governance - Enhanced Simulation"
        ],
        "summary": "Archive a batch simulation.",
        "operationId": "archive_batch_simulation",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Simulation archived",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchSimulationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/simulations/batch/{simulation_id}/cancel": {
      "post": {
        "tags": [
          "Governance - Enhanced Simulation"
        ],
        "summary": "Cancel a batch simulation.",
        "operationId": "cancel_batch_simulation",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Simulation cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchSimulationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/simulations/batch/{simulation_id}/execute": {
      "post": {
        "tags": [
          "Governance - Enhanced Simulation"
        ],
        "summary": "Execute a batch simulation (calculate impact).",
        "operationId": "execute_batch_simulation",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ExecuteBatchSimulationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Simulation executed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchSimulationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "409": {
            "description": "Scope warning - acknowledge required"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/simulations/batch/{simulation_id}/export": {
      "get": {
        "tags": [
          "Governance - Enhanced Simulation"
        ],
        "summary": "Export batch simulation results.",
        "operationId": "export_batch_simulation",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "format",
            "in": "query",
            "description": "Export format: json or csv.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            },
            "example": "json"
          }
        ],
        "responses": {
          "200": {
            "description": "Export data"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/simulations/batch/{simulation_id}/notes": {
      "patch": {
        "tags": [
          "Governance - Enhanced Simulation"
        ],
        "summary": "Update notes on a batch simulation.",
        "operationId": "update_batch_simulation_notes",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateNotesRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Notes updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchSimulationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/simulations/batch/{simulation_id}/restore": {
      "post": {
        "tags": [
          "Governance - Enhanced Simulation"
        ],
        "summary": "Restore an archived batch simulation.",
        "operationId": "restore_batch_simulation",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Simulation restored",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchSimulationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/simulations/batch/{simulation_id}/results": {
      "get": {
        "tags": [
          "Governance - Enhanced Simulation"
        ],
        "summary": "Get batch simulation results (per-user impacts).",
        "operationId": "get_batch_simulation_results",
        "parameters": [
          {
            "name": "simulation_id",
            "in": "path",
            "description": "Simulation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "user_id",
            "in": "query",
            "description": "Filter by user ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "has_warnings",
            "in": "query",
            "description": "Filter by whether result has warnings.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Page offset (default: 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Page size (default: 20, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Results retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Simulation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sla-policies": {
      "get": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "List SLA policies.",
        "operationId": "list_sla_policies",
        "parameters": [
          {
            "name": "is_active",
            "in": "query",
            "description": "Filter by active status",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results to return",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Results to skip",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "SLA policies retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SlaPolicyListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "Create a new SLA policy.",
        "operationId": "create_sla_policy",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSlaPolicyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "SLA policy created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SlaPolicyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sla-policies/{id}": {
      "get": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "Get an SLA policy by ID.",
        "operationId": "get_sla_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "SLA policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "SLA policy retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SlaPolicyResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SLA policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "Update an SLA policy.",
        "operationId": "update_sla_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "SLA policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSlaPolicyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "SLA policy updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SlaPolicyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SLA policy not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "Delete an SLA policy.",
        "operationId": "delete_sla_policy",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "SLA policy ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "SLA policy deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SLA policy not found"
          },
          "409": {
            "description": "SLA policy is in use"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sod-check": {
      "post": {
        "tags": [
          "Governance - SoD Rules"
        ],
        "summary": "Check if an assignment would create `SoD` violations.",
        "description": "This is a pre-flight check endpoint that allows clients to validate\nan assignment before attempting it. Useful for UI feedback.",
        "operationId": "sod_check",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SodCheckRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "SoD check result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodCheckResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sod-exemptions": {
      "get": {
        "tags": [
          "Governance - SoD Exemptions"
        ],
        "summary": "List `SoD` exemptions with optional filtering and pagination.",
        "operationId": "list_exemptions",
        "parameters": [
          {
            "name": "rule_id",
            "in": "query",
            "description": "Filter by rule ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "user_id",
            "in": "query",
            "description": "Filter by user ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by exemption status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GovExemptionStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of SoD exemptions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodExemptionListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - SoD Exemptions"
        ],
        "summary": "Create a new `SoD` exemption.",
        "description": "Grants a time-limited exception for a user to hold conflicting entitlements.",
        "operationId": "create_exemption",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSodExemptionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Exemption created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodExemptionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SoD rule not found"
          },
          "409": {
            "description": "Exemption already exists for this user/rule"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sod-exemptions/{id}": {
      "get": {
        "tags": [
          "Governance - SoD Exemptions"
        ],
        "summary": "Get an `SoD` exemption by ID.",
        "operationId": "get_exemption",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "SoD Exemption ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "SoD exemption details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodExemptionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SoD exemption not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sod-exemptions/{id}/revoke": {
      "post": {
        "tags": [
          "Governance - SoD Exemptions"
        ],
        "summary": "Revoke an `SoD` exemption.",
        "description": "The exemption will be marked as revoked and can no longer be used.",
        "operationId": "revoke_exemption",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "SoD Exemption ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Exemption revoked",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodExemptionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SoD exemption not found"
          },
          "409": {
            "description": "Exemption is already inactive"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sod-rules": {
      "get": {
        "tags": [
          "Governance - SoD Rules"
        ],
        "summary": "List `SoD` rules with optional filtering and pagination.",
        "operationId": "list_sod_rules",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by rule status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GovSodRuleStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "severity",
            "in": "query",
            "description": "Filter by severity level.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GovSodSeverity"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "entitlement_id",
            "in": "query",
            "description": "Filter by entitlement (returns rules involving this entitlement).",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of SoD rules",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodRuleListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - SoD Rules"
        ],
        "summary": "Create a new `SoD` rule.",
        "operationId": "create_sod_rule",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSodRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "SoD rule created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodRuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Rule name or entitlement pair already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sod-rules/{id}": {
      "get": {
        "tags": [
          "Governance - SoD Rules"
        ],
        "summary": "Get an `SoD` rule by ID.",
        "operationId": "get_sod_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "SoD Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "SoD rule details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SoD rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - SoD Rules"
        ],
        "summary": "Update an `SoD` rule.",
        "operationId": "update_sod_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "SoD Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSodRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "SoD rule updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodRuleResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SoD rule not found"
          },
          "409": {
            "description": "Rule name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - SoD Rules"
        ],
        "summary": "Delete an `SoD` rule.",
        "operationId": "delete_sod_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "SoD Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "SoD rule deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SoD rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sod-rules/{id}/disable": {
      "post": {
        "tags": [
          "Governance - SoD Rules"
        ],
        "summary": "Disable an `SoD` rule.",
        "operationId": "disable_sod_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "SoD Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "SoD rule disabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SoD rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sod-rules/{id}/enable": {
      "post": {
        "tags": [
          "Governance - SoD Rules"
        ],
        "summary": "Enable an `SoD` rule.",
        "operationId": "enable_sod_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "SoD Rule ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "SoD rule enabled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SoD rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sod-rules/{id}/scan": {
      "post": {
        "tags": [
          "Governance - SoD Violations"
        ],
        "summary": "Scan a specific rule for violations.",
        "description": "Detects all users who currently have both conflicting entitlements\nand creates violation records for them.",
        "operationId": "scan_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "SoD Rule ID to scan",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Scan completed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScanRuleResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SoD rule not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sod-violations": {
      "get": {
        "tags": [
          "Governance - SoD Violations"
        ],
        "summary": "List `SoD` violations with optional filtering and pagination.",
        "operationId": "list_violations",
        "parameters": [
          {
            "name": "rule_id",
            "in": "query",
            "description": "Filter by rule ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "user_id",
            "in": "query",
            "description": "Filter by user ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by violation status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GovViolationStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "detected_after",
            "in": "query",
            "description": "Filter violations detected after this timestamp.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "detected_before",
            "in": "query",
            "description": "Filter violations detected before this timestamp.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of SoD violations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodViolationListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sod-violations/{id}": {
      "get": {
        "tags": [
          "Governance - SoD Violations"
        ],
        "summary": "Get an `SoD` violation by ID.",
        "operationId": "get_violation",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "SoD Violation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "SoD violation details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodViolationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SoD violation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/sod-violations/{id}/remediate": {
      "post": {
        "tags": [
          "Governance - SoD Violations"
        ],
        "summary": "Remediate a violation (mark as resolved).",
        "operationId": "remediate_violation",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "SoD Violation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RemediateViolationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Violation remediated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SodViolationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "SoD violation not found"
          },
          "409": {
            "description": "Violation already remediated"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/ticketing-configurations": {
      "get": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "List ticketing configurations.",
        "operationId": "list_ticketing_configurations",
        "parameters": [
          {
            "name": "ticketing_type",
            "in": "query",
            "description": "Filter by ticketing type",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "is_active",
            "in": "query",
            "description": "Filter by active status",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results to return",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Results to skip",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Ticketing configurations retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TicketingConfigurationListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "Create a new ticketing configuration.",
        "operationId": "create_ticketing_configuration",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateTicketingConfigurationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Ticketing configuration created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TicketingConfigurationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/ticketing-configurations/{id}": {
      "get": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "Get a ticketing configuration by ID.",
        "operationId": "get_ticketing_configuration",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Ticketing configuration ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Ticketing configuration retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TicketingConfigurationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Ticketing configuration not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "Update a ticketing configuration.",
        "operationId": "update_ticketing_configuration",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Ticketing configuration ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateTicketingConfigurationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Ticketing configuration updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TicketingConfigurationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Ticketing configuration not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "Delete a ticketing configuration.",
        "operationId": "delete_ticketing_configuration",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Ticketing configuration ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Ticketing configuration deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Ticketing configuration not found"
          },
          "409": {
            "description": "Ticketing configuration is in use"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/ticketing-configurations/{id}/test": {
      "post": {
        "tags": [
          "Governance - Semi-manual Resources"
        ],
        "summary": "Test a ticketing configuration's connectivity.",
        "operationId": "test_ticketing_configuration",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Ticketing configuration ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Connectivity test completed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TestTicketingConfigurationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Ticketing configuration not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/users/{user_id}/access-snapshots": {
      "get": {
        "tags": [
          "Governance - Lifecycle"
        ],
        "summary": "List access snapshots for a specific user.",
        "operationId": "list_user_snapshots",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Results to skip",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of user's access snapshots",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessSnapshotListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/users/{user_id}/approval-groups": {
      "get": {
        "tags": [
          "Governance - Workflow Escalation"
        ],
        "summary": "Get groups for a specific user.",
        "operationId": "get_user_groups",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User's approval groups",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ApprovalGroupSummary"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/users/{user_id}/effective-access": {
      "get": {
        "tags": [
          "Governance - Effective Access"
        ],
        "summary": "Get effective access for a user.",
        "description": "Returns all entitlements the user has access to, consolidated from:\n- Direct user assignments\n- Group memberships\n- Role mappings",
        "operationId": "get_effective_access",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "application_id",
            "in": "query",
            "description": "Optional filter by application ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Effective access for user",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EffectiveAccessResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/users/{user_id}/parametric-assignments": {
      "get": {
        "tags": [
          "Governance - Parametric Roles"
        ],
        "summary": "List parametric assignments for a user.",
        "operationId": "list_user_parametric_assignments",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "role_id",
            "in": "query",
            "description": "Filter by role ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "include_inactive",
            "in": "query",
            "description": "Include temporally inactive assignments (default: false).",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of parametric assignments",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/crate.models.ParametricAssignmentListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/users/{user_id}/peer-comparison": {
      "get": {
        "tags": [
          "Governance - Peer Groups"
        ],
        "summary": "Get peer comparison for a user.",
        "operationId": "get_user_peer_comparison",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User peer comparison",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserPeerComparisonResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/users/{user_id}/personas": {
      "get": {
        "tags": [
          "Governance - Persona Management"
        ],
        "summary": "Get personas for a specific user.",
        "operationId": "get_user_personas",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "Physical user ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "include_archived",
            "in": "query",
            "description": "Include archived personas",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User's personas",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserPersonasResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/users/{user_id}/risk-alerts/acknowledge-all": {
      "post": {
        "tags": [
          "Governance - Risk Alerts"
        ],
        "summary": "Acknowledge all alerts for a user.",
        "operationId": "acknowledge_user_alerts",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Alerts acknowledged",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkAcknowledgeResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/users/{user_id}/risk-alerts/latest": {
      "get": {
        "tags": [
          "Governance - Risk Alerts"
        ],
        "summary": "Get most recent alert for a user.",
        "operationId": "get_user_latest_alert",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Most recent alert",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/RiskAlertResponse"
                    }
                  ],
                  "nullable": true
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/users/{user_id}/risk-enforcement": {
      "get": {
        "tags": [
          "Governance - Risk Scoring"
        ],
        "summary": "Get risk enforcement action required for a user.",
        "description": "Returns the action that should be taken based on the user's risk score\nand configured thresholds (Alert, `RequireMFA`, or Block).",
        "operationId": "get_user_risk_enforcement",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Risk enforcement action",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskEnforcementResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Risk score not found for user"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/users/{user_id}/risk-score": {
      "get": {
        "tags": [
          "Governance - Risk Scoring"
        ],
        "summary": "Get the risk score for a specific user.",
        "operationId": "get_user_risk_score",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User's risk score",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskScoreResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Risk score not found for user"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/users/{user_id}/risk-score/calculate": {
      "post": {
        "tags": [
          "Governance - Risk Scoring"
        ],
        "summary": "Calculate (or recalculate) the risk score for a specific user.",
        "operationId": "calculate_user_risk_score",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CalculateScoreRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Calculated risk score",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskScoreResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/users/{user_id}/risk-score/history": {
      "get": {
        "tags": [
          "Governance - Risk Scoring"
        ],
        "summary": "Get risk score history for a user.",
        "operationId": "get_user_risk_score_history",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "start_date",
            "in": "query",
            "description": "Start date for history range.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date",
              "nullable": true
            }
          },
          {
            "name": "end_date",
            "in": "query",
            "description": "End date for history range.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of entries (default: 90).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 365,
              "minimum": 1
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Risk score history with trend",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskScoreHistoryResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Risk score not found for user"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/users/{user_id}/risk-score/snapshot": {
      "post": {
        "tags": [
          "Governance - Risk Scoring"
        ],
        "summary": "Save daily snapshot of risk score for a user.",
        "operationId": "save_risk_score_snapshot",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Snapshot saved successfully"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Risk score not found for user"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/governance/webhooks/ticketing/{configuration_id}": {
      "post": {
        "tags": [
          "Governance - Ticketing Webhooks"
        ],
        "summary": "Handle webhook callback from external ticketing system.",
        "description": "This endpoint is called by external ticketing systems (`ServiceNow`, Jira, or custom webhooks)\nto notify us of ticket status changes. The endpoint authenticates using a shared secret\npassed as a query parameter or header.",
        "operationId": "handle_webhook_callback",
        "parameters": [
          {
            "name": "configuration_id",
            "in": "path",
            "description": "Ticketing configuration ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "secret",
            "in": "query",
            "description": "Webhook callback secret for authentication",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WebhookCallbackRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Webhook processed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookCallbackResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid or missing webhook secret"
          },
          "404": {
            "description": "Configuration not found"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/groups": {
      "get": {
        "tags": [
          "Group Hierarchy"
        ],
        "summary": "List groups with optional type filter.",
        "description": "GET /`api/v1/groups?group_type=department&limit=50&offset=0`",
        "operationId": "list_groups",
        "parameters": [
          {
            "name": "group_type",
            "in": "query",
            "description": "Filter by group type.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of items to return (default: 50, max: 200).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination (default: 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated group list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GroupListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/groups/roots": {
      "get": {
        "tags": [
          "Group Hierarchy"
        ],
        "summary": "List root groups (no parent).",
        "description": "GET /api/v1/groups/roots",
        "operationId": "list_root_groups",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of items to return (default: 50, max: 200).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination (default: 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Root groups for the tenant",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GroupListResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/groups/{group_id}/ancestors": {
      "get": {
        "tags": [
          "Group Hierarchy"
        ],
        "summary": "Get ancestor path from root to group.",
        "description": "GET /`api/v1/groups/:group_id/ancestors`",
        "operationId": "get_ancestors",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Ancestor path from root to group",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AncestorPathResponse"
                }
              }
            }
          },
          "404": {
            "description": "Group not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/groups/{group_id}/children": {
      "get": {
        "tags": [
          "Group Hierarchy"
        ],
        "summary": "List direct children of a group.",
        "description": "GET /`api/v1/groups/:group_id/children`",
        "operationId": "get_children",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of items to return (default: 50, max: 200).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination (default: 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Direct children of the group",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GroupListResponse"
                }
              }
            }
          },
          "404": {
            "description": "Group not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/groups/{group_id}/parent": {
      "put": {
        "tags": [
          "Group Hierarchy"
        ],
        "summary": "Move group to a new parent (or make root).",
        "description": "PUT /`api/v1/groups/:group_id/parent`",
        "operationId": "move_group",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MoveGroupRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Group moved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GroupDetail"
                }
              }
            }
          },
          "400": {
            "description": "Validation error (depth exceeded, cycle detected)"
          },
          "404": {
            "description": "Group or parent not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/groups/{group_id}/subtree": {
      "get": {
        "tags": [
          "Group Hierarchy"
        ],
        "summary": "Get full subtree (all descendants).",
        "description": "GET /`api/v1/groups/:group_id/subtree`",
        "operationId": "get_subtree",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of items to return (default: 50, max: 200).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination (default: 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "All descendant groups with relative depth",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubtreeResponse"
                }
              }
            }
          },
          "404": {
            "description": "Group not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/groups/{group_id}/subtree-members": {
      "get": {
        "tags": [
          "Group Hierarchy"
        ],
        "summary": "Get all users in group and all descendant groups.",
        "description": "GET /api/v1/groups/:group_id/subtree-members",
        "operationId": "get_subtree_members",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of items to return (default: 50, max: 200).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination (default: 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated list of users in the subtree",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubtreeMembershipResponse"
                }
              }
            }
          },
          "404": {
            "description": "Group not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/health": {
      "get": {
        "tags": [
          "health"
        ],
        "summary": "Health check handler (legacy `GET /health`).",
        "description": "Returns the current service health status including:\n- Status (healthy, degraded, unhealthy)\n- Application version\n- Uptime in seconds\n- Database connectivity\n- Current timestamp",
        "operationId": "health_handler",
        "responses": {
          "200": {
            "description": "Service health status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/healthz": {
      "get": {
        "tags": [
          "Observability"
        ],
        "summary": "Healthz handler (`GET /healthz`).",
        "description": "Kubernetes naming convention compatibility \u2014 delegates to `readyz_handler`\nfor a full dependency check.",
        "operationId": "healthz_handler",
        "responses": {
          "200": {
            "description": "Service is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReadinessResponse"
                }
              }
            }
          },
          "503": {
            "description": "Service is not healthy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReadinessResponse"
                }
              }
            }
          }
        }
      }
    },
    "/livez": {
      "get": {
        "tags": [
          "Observability"
        ],
        "summary": "Liveness probe handler (`GET /livez`).",
        "description": "Returns 200 immediately \u2014 no dependency checks. A failing liveness probe\ncauses Kubernetes to restart the pod, so this only confirms the process\nis responsive (FR-001).",
        "operationId": "livez_handler",
        "responses": {
          "200": {
            "description": "Process is alive",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LivenessResponse"
                }
              }
            }
          }
        }
      }
    },
    "/mcp/tools": {
      "get": {
        "tags": [
          "MCP Tools"
        ],
        "summary": "GET /mcp/tools - List available tools for the authenticated agent.",
        "operationId": "listMcpTools",
        "responses": {
          "200": {
            "description": "List of available tools",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/McpToolsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/mcp/tools/{name}/call": {
      "post": {
        "tags": [
          "MCP Tools"
        ],
        "summary": "POST /mcp/tools/{name}/call - Invoke a tool.",
        "operationId": "callMcpTool",
        "parameters": [
          {
            "name": "name",
            "in": "path",
            "description": "Tool name",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/McpCallRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tool executed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/McpCallResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/McpErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "403": {
            "description": "Agent not authorized to use this tool",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/McpErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Tool not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/McpErrorResponse"
                }
              }
            }
          },
          "429": {
            "description": "Rate limit exceeded",
            "headers": {
              "Retry-After": {
                "schema": {
                  "type": "integer",
                  "format": "int32"
                },
                "description": "Seconds until rate limit resets"
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/McpErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/nhi": {
      "get": {
        "tags": [
          "nhi"
        ],
        "summary": "Handler for `GET /nhi`.",
        "description": "Lists all non-human identities (service accounts and AI agents) with\noptional filtering by type, status, owner, risk score, and certification status.",
        "operationId": "list_nhi",
        "parameters": [
          {
            "name": "type",
            "in": "query",
            "description": "Filter by NHI type: \"`service_account`\", \"`ai_agent`\", or omit for all.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status: \"active\", \"suspended\", \"expired\", etc.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "owner_id",
            "in": "query",
            "description": "Filter by owner user ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "risk_min",
            "in": "query",
            "description": "Filter by minimum risk score (0-100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true
            }
          },
          {
            "name": "certification_due",
            "in": "query",
            "description": "Filter for NHIs with certification due within 30 days.",
            "required": false,
            "schema": {
              "type": "boolean"
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "description": "Number of results per page (default: 20, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "Page number (1-indexed, default: 1).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of NHIs",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents": {
      "get": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "List AI agents.",
        "operationId": "list_agents",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "agent_type",
            "in": "query",
            "description": "Filter by agent type.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "owner_id",
            "in": "query",
            "description": "Filter by owner ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "risk_level",
            "in": "query",
            "description": "Filter by risk level.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "name",
            "in": "query",
            "description": "Search by name prefix.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results. Default: 100.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination. Default: 0.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of AI agents",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Create a new AI agent.",
        "operationId": "create_agent",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAgentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Agent created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Agent name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/authorize": {
      "post": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Real-time authorization decision (<100ms).",
        "operationId": "authorize_agent",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AuthorizeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Authorization decision",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthorizeResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/thresholds": {
      "get": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Get tenant-wide default thresholds.",
        "operationId": "get_tenant_thresholds",
        "responses": {
          "200": {
            "description": "Tenant default thresholds",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThresholdsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Set tenant-wide default thresholds.",
        "operationId": "set_tenant_thresholds",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetThresholdsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tenant thresholds updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThresholdsResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{agent_id}/credentials/{credential_id}": {
      "get": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Get a specific credential for an AI agent.",
        "operationId": "get_agent_credential",
        "parameters": [
          {
            "name": "agent_id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "credential_id",
            "in": "path",
            "description": "Credential ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Credential details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCredentialResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent or credential not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{agent_id}/credentials/{credential_id}/revoke": {
      "post": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Revoke a credential for an AI agent.",
        "operationId": "revoke_agent_credential",
        "parameters": [
          {
            "name": "agent_id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "credential_id",
            "in": "path",
            "description": "Credential ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RevokeCredentialRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Credential revoked",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCredentialResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or credential already revoked"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent or credential not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{agent_id}/permissions/{tool_id}": {
      "delete": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Revoke tool permission from an agent.",
        "operationId": "revoke_agent_permission",
        "parameters": [
          {
            "name": "agent_id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "tool_id",
            "in": "path",
            "description": "Tool ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Permission revoked"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Permission not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{id}": {
      "get": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Get an AI agent by ID.",
        "operationId": "get_agent",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Delete an AI agent.",
        "operationId": "delete_agent",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Agent deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "patch": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Update an AI agent.",
        "operationId": "update_agent",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateAgentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Agent updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{id}/anomalies": {
      "get": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "List detected anomalies for an agent.",
        "operationId": "list_anomalies",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "since",
            "in": "query",
            "description": "Filter anomalies since this time",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "anomaly_type",
            "in": "query",
            "description": "Filter by anomaly type",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "severity",
            "in": "query",
            "description": "Filter by severity",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of anomalies",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AnomalyListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{id}/audit": {
      "get": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Query audit trail for an agent.",
        "operationId": "query_agent_audit",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "start_time",
            "in": "query",
            "description": "Start time filter.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "end_time",
            "in": "query",
            "description": "End time filter.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "event_type",
            "in": "query",
            "description": "Filter by event type.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "decision",
            "in": "query",
            "description": "Filter by decision.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "tool_name",
            "in": "query",
            "description": "Filter by tool name.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results. Default: 100.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination. Default: 0.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Audit trail",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{id}/baseline": {
      "get": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Get baseline for an agent.",
        "operationId": "get_baseline",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent baseline",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BaselineResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent or baseline not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{id}/credentials": {
      "get": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "List credentials for an AI agent.",
        "operationId": "list_agent_credentials",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "active_only",
            "in": "query",
            "description": "Only return active credentials.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of credentials",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCredentialListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{id}/credentials/rotate": {
      "post": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Rotate credentials for an AI agent.",
        "operationId": "rotate_agent_credentials",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RotateCredentialsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Credentials rotated - secret only shown once",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCredentialCreatedResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or agent suspended"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{id}/credentials/validate": {
      "post": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Validate a credential for an AI agent.",
        "description": "This endpoint allows an agent to verify that its credential is valid\nwithout performing any other operation. Returns 200 if valid, 401 if invalid.",
        "operationId": "validate_agent_credential",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ValidateCredentialRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Credential is valid",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidateCredentialResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid or expired credential"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{id}/permissions": {
      "get": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "List permissions for an agent.",
        "operationId": "list_agent_permissions",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results. Default: 100.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination. Default: 0.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PermissionListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Grant tool permission to an agent.",
        "operationId": "grant_agent_permission",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GrantPermissionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Permission granted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PermissionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent or tool not found"
          },
          "409": {
            "description": "Permission already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{id}/reactivate": {
      "post": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Reactivate a suspended AI agent.",
        "operationId": "reactivate_agent",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent reactivated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentResponse"
                }
              }
            }
          },
          "400": {
            "description": "Not suspended"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{id}/security-assessment": {
      "get": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Get security assessment for an agent.",
        "operationId": "get_security_assessment",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Security assessment",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SecurityAssessment"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{id}/suspend": {
      "post": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Suspend an AI agent.",
        "operationId": "suspend_agent",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent suspended",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentResponse"
                }
              }
            }
          },
          "400": {
            "description": "Already suspended"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/agents/{id}/thresholds": {
      "get": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Get thresholds for an agent.",
        "operationId": "get_thresholds",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent thresholds",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThresholdsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Update thresholds for an agent.",
        "operationId": "update_thresholds",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetThresholdsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Thresholds updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThresholdsResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "NHI - Agents"
        ],
        "summary": "Reset thresholds for an agent to defaults.",
        "operationId": "reset_thresholds",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Thresholds reset to tenant defaults",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThresholdsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Agent not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/approvals": {
      "get": {
        "tags": [
          "NHI - Approvals"
        ],
        "summary": "List pending approvals.",
        "operationId": "list_approvals",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by approval status: pending, approved, denied, expired",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "agent_id",
            "in": "query",
            "description": "Filter by agent ID",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default 50, max 100)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of approvals",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/approvals/{id}": {
      "get": {
        "tags": [
          "NHI - Approvals"
        ],
        "summary": "Get an approval by ID.",
        "operationId": "get_approval",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Approval details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Approval not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/approvals/{id}/approve": {
      "post": {
        "tags": [
          "NHI - Approvals"
        ],
        "summary": "Approve a request.",
        "operationId": "approve_request",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApproveRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Request approved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or already decided"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Approval not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/approvals/{id}/deny": {
      "post": {
        "tags": [
          "NHI - Approvals"
        ],
        "summary": "Deny a request.",
        "operationId": "deny_request",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DenyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Request denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or already decided"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Approval not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/approvals/{id}/status": {
      "get": {
        "tags": [
          "NHI - Approvals"
        ],
        "summary": "Check approval status.",
        "operationId": "check_approval_status",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Approval ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Approval status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApprovalStatusResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Approval not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/certifications/campaigns": {
      "get": {
        "tags": [
          "Unified NHI Certification"
        ],
        "summary": "Lists certification campaigns.",
        "description": "GET /nhi/certifications/campaigns",
        "operationId": "list_campaigns",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status: draft, active, completed, cancelled",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "Page number (1-indexed)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "description": "Items per page (max 100)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of campaigns",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CampaignListResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Unified NHI Certification"
        ],
        "summary": "Creates a new certification campaign.",
        "description": "POST /nhi/certifications/campaigns",
        "operationId": "create_campaign",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateCampaignRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Campaign created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CampaignResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/nhi/certifications/campaigns/{campaign_id}": {
      "get": {
        "tags": [
          "Unified NHI Certification"
        ],
        "summary": "Gets a specific campaign with item counts.",
        "description": "GET /`nhi/certifications/campaigns/:campaign_id`",
        "operationId": "get_campaign",
        "parameters": [
          {
            "name": "campaign_id",
            "in": "path",
            "description": "Campaign UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Campaign details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CampaignResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/nhi/certifications/campaigns/{campaign_id}/cancel": {
      "post": {
        "tags": [
          "Unified NHI Certification"
        ],
        "summary": "Cancels a campaign.",
        "description": "POST /`nhi/certifications/campaigns/:campaign_id/cancel`",
        "operationId": "cancel_campaign",
        "parameters": [
          {
            "name": "campaign_id",
            "in": "path",
            "description": "Campaign UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Campaign cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CampaignResponse"
                }
              }
            }
          },
          "400": {
            "description": "Campaign cannot be cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/nhi/certifications/campaigns/{campaign_id}/items": {
      "get": {
        "tags": [
          "Unified NHI Certification"
        ],
        "summary": "Lists items for a campaign.",
        "description": "GET /`nhi/certifications/campaigns/:campaign_id/items`",
        "operationId": "list_campaign_items",
        "parameters": [
          {
            "name": "campaign_id",
            "in": "path",
            "description": "Campaign UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "nhi_type",
            "in": "query",
            "description": "Filter by NHI type: `service_account`, `ai_agent`",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status: pending, certified, revoked",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "Page number (1-indexed)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "description": "Items per page (max 100)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of certification items",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ItemListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/nhi/certifications/campaigns/{campaign_id}/launch": {
      "post": {
        "tags": [
          "Unified NHI Certification"
        ],
        "summary": "Launches a campaign.",
        "description": "POST /`nhi/certifications/campaigns/:campaign_id/launch`",
        "operationId": "launch_campaign",
        "parameters": [
          {
            "name": "campaign_id",
            "in": "path",
            "description": "Campaign UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Campaign launched",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CampaignResponse"
                }
              }
            }
          },
          "400": {
            "description": "Campaign not in draft status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/nhi/certifications/campaigns/{campaign_id}/summary": {
      "get": {
        "tags": [
          "Unified NHI Certification"
        ],
        "summary": "Gets campaign summary statistics.",
        "description": "GET /`nhi/certifications/campaigns/:campaign_id/summary`",
        "operationId": "get_campaign_summary",
        "parameters": [
          {
            "name": "campaign_id",
            "in": "path",
            "description": "Campaign UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Campaign summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CampaignSummaryResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Campaign not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/nhi/certifications/items/bulk-decide": {
      "post": {
        "tags": [
          "Unified NHI Certification"
        ],
        "summary": "Makes bulk certification decisions.",
        "description": "POST /nhi/certifications/items/bulk-decide",
        "operationId": "bulk_decide",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BulkDecisionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Bulk decision results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDecisionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/nhi/certifications/items/{item_id}/decide": {
      "post": {
        "tags": [
          "Unified NHI Certification"
        ],
        "summary": "Makes a decision on a certification item.",
        "description": "POST /`nhi/certifications/items/:item_id/decide`",
        "operationId": "decide_item",
        "parameters": [
          {
            "name": "item_id",
            "in": "path",
            "description": "Certification item UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DecisionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Decision recorded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CertificationItemResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid decision or item already decided",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Item not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/nhi/certifications/my-pending": {
      "get": {
        "tags": [
          "Unified NHI Certification"
        ],
        "summary": "Gets pending certification items for the current user.",
        "description": "GET /nhi/certifications/my-pending",
        "operationId": "get_my_pending",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "Page number (1-indexed)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "description": "Items per page (max 100)",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User's pending certification items",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MyPendingItemsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/nhi/risk-summary": {
      "get": {
        "tags": [
          "nhi"
        ],
        "summary": "Handler for `GET /nhi/risk-summary`.",
        "description": "Returns aggregated risk statistics across all non-human identities.",
        "operationId": "get_risk_summary",
        "responses": {
          "200": {
            "description": "Risk summary statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RiskSummaryResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts": {
      "get": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "List service accounts with optional filtering.",
        "operationId": "list_service_accounts",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ServiceAccountStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "owner_id",
            "in": "query",
            "description": "Filter by owner.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "expiring_within_days",
            "in": "query",
            "description": "Filter NHIs expiring within this many days.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true,
              "minimum": 1
            }
          },
          {
            "name": "needs_certification",
            "in": "query",
            "description": "Filter NHIs needing certification.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "needs_rotation",
            "in": "query",
            "description": "Filter NHIs needing rotation.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "inactive_only",
            "in": "query",
            "description": "Filter inactive NHIs.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of service accounts",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Create a new service account.",
        "operationId": "create_service_account",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateNhiRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Service account created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Service account name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/requests": {
      "get": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "List service account requests.",
        "operationId": "list_requests",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/NhiRequestStatus"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "requester_id",
            "in": "query",
            "description": "Filter by requester.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "pending_only",
            "in": "query",
            "description": "Filter pending requests only.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 100,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Submit a request for a new service account.",
        "operationId": "submit_request",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SubmitNhiRequestRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Request submitted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/requests/my-pending": {
      "get": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Get my pending requests.",
        "operationId": "get_my_pending_requests",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "My pending requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/requests/summary": {
      "get": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Get request summary statistics.",
        "operationId": "get_request_summary",
        "responses": {
          "200": {
            "description": "Request summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestSummary"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/requests/{request_id}": {
      "get": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Get a service account request by ID.",
        "operationId": "get_request",
        "parameters": [
          {
            "name": "request_id",
            "in": "path",
            "description": "Request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Request details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/requests/{request_id}/approve": {
      "post": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Approve a service account request.",
        "operationId": "approve_request",
        "parameters": [
          {
            "name": "request_id",
            "in": "path",
            "description": "Request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApproveNhiRequestRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Request approved, service account created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestApprovalResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or already decided"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/requests/{request_id}/cancel": {
      "post": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Cancel a service account request.",
        "operationId": "cancel_request",
        "parameters": [
          {
            "name": "request_id",
            "in": "path",
            "description": "Request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Request cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or already decided"
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Only requester can cancel"
          },
          "404": {
            "description": "Request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/requests/{request_id}/reject": {
      "post": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Reject a service account request.",
        "operationId": "reject_request",
        "parameters": [
          {
            "name": "request_id",
            "in": "path",
            "description": "Request ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RejectNhiRequestRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Request rejected",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRequestResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or already decided"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Request not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/summary": {
      "get": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Get service account summary statistics.",
        "operationId": "get_service_account_summary",
        "responses": {
          "200": {
            "description": "Service account summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiSummary"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/{id}": {
      "get": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Get a service account by ID.",
        "operationId": "get_service_account",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Service account details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Update a service account.",
        "operationId": "update_service_account",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateNhiRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Service account updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Delete a service account.",
        "operationId": "delete_service_account",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Service account deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/{id}/certify": {
      "post": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Certify a service account (confirm ownership and purpose are still valid).",
        "operationId": "certify_service_account",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Service account certified",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CertifyNhiResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/{id}/credentials": {
      "get": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "List credentials for a service account.",
        "operationId": "list_credentials",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "active_only",
            "in": "query",
            "description": "Only return active credentials.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of credentials",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCredentialListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/{id}/credentials/rotate": {
      "post": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Rotate credentials for a service account.",
        "operationId": "rotate_credentials",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RotateCredentialsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Credentials rotated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCredentialCreatedResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/{id}/reactivate": {
      "post": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Reactivate a suspended service account.",
        "operationId": "reactivate_service_account",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReactivateNhiRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Service account reactivated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiResponse"
                }
              }
            }
          },
          "400": {
            "description": "Not suspended"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/{id}/risk": {
      "get": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Get risk score for a service account.",
        "operationId": "get_risk_score",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Risk score",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRiskScoreResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/{id}/risk/calculate": {
      "post": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Calculate/recalculate risk score for a service account.",
        "operationId": "calculate_risk_score",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Risk score calculated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiRiskScoreResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/{id}/suspend": {
      "post": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Suspend a service account.",
        "operationId": "suspend_service_account",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SuspendNhiRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Service account suspended",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiResponse"
                }
              }
            }
          },
          "400": {
            "description": "Already suspended"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/{id}/transfer-ownership": {
      "post": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Transfer ownership of a service account.",
        "operationId": "transfer_ownership",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TransferOwnershipRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Ownership transferred",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/{id}/usage": {
      "get": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "List usage events for a service account.",
        "operationId": "list_usage",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "target_resource",
            "in": "query",
            "description": "Filter by target resource (partial match).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "outcome",
            "in": "query",
            "description": "Filter by outcome.",
            "required": false,
            "schema": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/NhiUsageOutcome"
                }
              ],
              "nullable": true
            }
          },
          {
            "name": "start_date",
            "in": "query",
            "description": "Start date for time range.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "end_date",
            "in": "query",
            "description": "End date for time range.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results (default: 50, max: 1000).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "maximum": 1000,
              "minimum": 1
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of usage events",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiUsageListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Record usage for a service account.",
        "operationId": "record_usage",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RecordUsageRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Usage recorded"
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/{id}/usage/summary": {
      "get": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Get usage summary for a service account.",
        "operationId": "get_usage_summary",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "period_days",
            "in": "query",
            "description": "Period in days (default: 30).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Usage summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiUsageSummaryExtendedResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/{nhi_id}/credentials/{credential_id}": {
      "get": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Get a specific credential by ID.",
        "operationId": "get_credential",
        "parameters": [
          {
            "name": "nhi_id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "credential_id",
            "in": "path",
            "description": "Credential ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Credential details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCredentialResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account or credential not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/service-accounts/{nhi_id}/credentials/{credential_id}/revoke": {
      "post": {
        "tags": [
          "NHI - Service Accounts"
        ],
        "summary": "Revoke a credential.",
        "operationId": "revoke_credential",
        "parameters": [
          {
            "name": "nhi_id",
            "in": "path",
            "description": "Service account ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "credential_id",
            "in": "path",
            "description": "Credential ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RevokeCredentialRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Credential revoked",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiCredentialResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or credential already revoked"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Service account or credential not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/staleness-report": {
      "get": {
        "tags": [
          "NHI"
        ],
        "summary": "Handler for `GET /nhi/staleness-report`.",
        "description": "Returns a report of NHIs that have been inactive for a specified number of days.",
        "operationId": "get_staleness_report",
        "parameters": [
          {
            "name": "min_inactive_days",
            "in": "query",
            "description": "Minimum days inactive to include in report.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Staleness report",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StalenessReportResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          },
          "501": {
            "description": "Service not configured"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/tools": {
      "get": {
        "tags": [
          "NHI - Tools"
        ],
        "summary": "List registered tools.",
        "operationId": "list_tools",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "category",
            "in": "query",
            "description": "Filter by category.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "risk_level",
            "in": "query",
            "description": "Filter by risk level.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "requires_approval",
            "in": "query",
            "description": "Filter by approval requirement.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "name",
            "in": "query",
            "description": "Search by name (partial match).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results. Default: 100.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination. Default: 0.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of tools",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ToolListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "NHI - Tools"
        ],
        "summary": "Register a new tool.",
        "operationId": "create_tool",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateToolRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Tool registered",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ToolResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Tool name already exists"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/tools/{id}": {
      "get": {
        "tags": [
          "NHI - Tools"
        ],
        "summary": "Get a tool by ID.",
        "operationId": "get_tool",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tool ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tool details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ToolResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Tool not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "NHI - Tools"
        ],
        "summary": "Delete a tool.",
        "operationId": "delete_tool",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tool ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Tool deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Tool not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "patch": {
        "tags": [
          "NHI - Tools"
        ],
        "summary": "Update a tool.",
        "operationId": "update_tool",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tool ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateToolRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tool updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ToolResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Tool not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/nhi/{id}": {
      "get": {
        "tags": [
          "nhi"
        ],
        "summary": "Handler for `GET /nhi/{id}`.",
        "description": "Returns a specific NHI by its ID.",
        "operationId": "get_nhi",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "NHI unique identifier",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "NHI details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NhiItem"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "NHI not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/oauth/authorize": {
      "get": {
        "tags": [
          "OAuth2"
        ],
        "summary": "Initiates the authorization code flow. Validates the request and",
        "description": "redirects to login/consent if not authenticated.\n\nSECURITY: This endpoint validates the `redirect_uri` against the client's\nregistered URIs to prevent open redirect attacks and authorization code theft.",
        "operationId": "authorize_handler",
        "parameters": [
          {
            "name": "response_type",
            "in": "query",
            "description": "Response type (must be \"code\").",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "client_id",
            "in": "query",
            "description": "Client ID.",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "redirect_uri",
            "in": "query",
            "description": "Redirect URI (must match registered URI).",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "scope",
            "in": "query",
            "description": "Requested scopes (space-separated).",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "state",
            "in": "query",
            "description": "State for CSRF protection.",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "code_challenge",
            "in": "query",
            "description": "PKCE code challenge.",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "code_challenge_method",
            "in": "query",
            "description": "PKCE code challenge method (must be \"S256\").",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "nonce",
            "in": "query",
            "description": "OIDC nonce (echoed in ID token).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "302": {
            "description": "Redirect to login or consent page"
          },
          "400": {
            "description": "Invalid authorization request"
          }
        }
      }
    },
    "/oauth/authorize/consent": {
      "post": {
        "tags": [
          "OAuth2"
        ],
        "summary": "Processes user consent and issues authorization code on approval.",
        "operationId": "consent_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ConsentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "302": {
            "description": "Redirect with authorization code or error"
          },
          "400": {
            "description": "Invalid consent request"
          }
        }
      }
    },
    "/oauth/device/code": {
      "post": {
        "tags": [
          "OAuth2 Device Code"
        ],
        "summary": "Request a device authorization code.",
        "description": "POST /oauth/device/code\n\nThis is the first step in the device code flow. The client sends its\n`client_id` and requested scopes, and receives a `device_code` (for polling)\nand `user_code` (to display to the user).",
        "operationId": "device_authorization_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeviceAuthorizationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Device authorization response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeviceAuthorizationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Invalid or unauthorized client"
          }
        }
      }
    },
    "/oauth/token": {
      "post": {
        "tags": [
          "OAuth2"
        ],
        "summary": "Exchange authorization code for tokens or refresh tokens.",
        "operationId": "token_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TokenRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tokens issued",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid token request"
          },
          "401": {
            "description": "Invalid client credentials"
          }
        }
      }
    },
    "/oauth/userinfo": {
      "get": {
        "tags": [
          "OAuth2"
        ],
        "summary": "Returns user claims based on the scopes in the access token.",
        "operationId": "userinfo_handler",
        "responses": {
          "200": {
            "description": "User claims"
          },
          "401": {
            "description": "Invalid or missing access token"
          },
          "403": {
            "description": "Insufficient scope"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/operations": {
      "get": {
        "tags": [
          "Operations"
        ],
        "summary": "List provisioning operations with optional filtering.",
        "operationId": "list_operations",
        "parameters": [
          {
            "name": "connector_id",
            "in": "query",
            "description": "Filter by connector ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "user_id",
            "in": "query",
            "description": "Filter by user ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "operation_type",
            "in": "query",
            "description": "Filter by operation type.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "from_date",
            "in": "query",
            "description": "Filter operations created on or after this date (RFC3339).",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "to_date",
            "in": "query",
            "description": "Filter operations created on or before this date (RFC3339).",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results (default: 50).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of operations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OperationListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Operations"
        ],
        "summary": "Trigger a manual provisioning operation.",
        "operationId": "trigger_operation",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TriggerOperationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Operation created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OperationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Connector not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/operations/conflicts": {
      "get": {
        "tags": [
          "Conflicts"
        ],
        "summary": "List conflicts with optional filtering.",
        "operationId": "list_conflicts",
        "parameters": [
          {
            "name": "operation_id",
            "in": "query",
            "description": "Filter by operation ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "conflict_type",
            "in": "query",
            "description": "Filter by conflict type.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "pending_only",
            "in": "query",
            "description": "Only show pending conflicts.",
            "required": false,
            "schema": {
              "type": "boolean"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of conflicts",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConflictListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          },
          "501": {
            "description": "Conflict service not configured"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/operations/conflicts/{conflict_id}": {
      "get": {
        "tags": [
          "Conflicts"
        ],
        "summary": "Get a conflict by ID.",
        "operationId": "get_conflict",
        "parameters": [
          {
            "name": "conflict_id",
            "in": "path",
            "description": "Conflict ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Conflict details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConflictResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Conflict not found"
          },
          "500": {
            "description": "Internal server error"
          },
          "501": {
            "description": "Conflict service not configured"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/operations/conflicts/{conflict_id}/resolve": {
      "post": {
        "tags": [
          "Conflicts"
        ],
        "summary": "Resolve a conflict manually.",
        "operationId": "resolve_conflict",
        "parameters": [
          {
            "name": "conflict_id",
            "in": "path",
            "description": "Conflict ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResolveConflictRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Conflict resolved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConflictResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid resolution outcome"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Conflict not found"
          },
          "409": {
            "description": "Conflict already resolved"
          },
          "500": {
            "description": "Internal server error"
          },
          "501": {
            "description": "Conflict service not configured"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/operations/dlq": {
      "get": {
        "tags": [
          "Operations"
        ],
        "summary": "List dead letter queue operations.",
        "operationId": "list_dead_letter",
        "parameters": [
          {
            "name": "connector_id",
            "in": "query",
            "description": "Filter by connector ID.",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results (default: 50).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of dead letter operations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DlqListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/operations/stats": {
      "get": {
        "tags": [
          "Operations"
        ],
        "summary": "Get queue statistics.",
        "operationId": "get_queue_stats",
        "parameters": [
          {
            "name": "connector_id",
            "in": "query",
            "description": "Filter by connector ID",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Queue statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QueueStatsResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/operations/{id}": {
      "get": {
        "tags": [
          "Operations"
        ],
        "summary": "Get an operation by ID.",
        "operationId": "get_operation",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Operation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Operation details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OperationResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Operation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/operations/{id}/attempts": {
      "get": {
        "tags": [
          "Operations"
        ],
        "summary": "Get operation attempts (execution history).",
        "operationId": "get_operation_attempts",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Operation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Operation attempts",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttemptListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Operation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/operations/{id}/cancel": {
      "post": {
        "tags": [
          "Operations"
        ],
        "summary": "Cancel a pending operation.",
        "operationId": "cancel_operation",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Operation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Operation cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OperationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Operation cannot be cancelled"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Operation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/operations/{id}/logs": {
      "get": {
        "tags": [
          "Operations"
        ],
        "summary": "Get logs for an operation.",
        "operationId": "get_operation_logs",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Operation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Operation logs",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/OperationLogResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Operation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/operations/{id}/resolve": {
      "post": {
        "tags": [
          "Operations"
        ],
        "summary": "Resolve a dead letter operation.",
        "operationId": "resolve_operation",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Operation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResolveOperationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Operation resolved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OperationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Operation cannot be resolved"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Operation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/operations/{id}/retry": {
      "post": {
        "tags": [
          "Operations"
        ],
        "summary": "Retry a failed operation.",
        "operationId": "retry_operation",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Operation ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Operation scheduled for retry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OperationResponse"
                }
              }
            }
          },
          "400": {
            "description": "Operation cannot be retried"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Operation not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/public/branding/{tenant_slug}": {
      "get": {
        "tags": [
          "Public"
        ],
        "summary": "Get public branding configuration for a tenant by slug.",
        "description": "This endpoint is public (no authentication required) and used by login pages.\nResults are cached for 5 minutes.",
        "operationId": "get_public_branding",
        "parameters": [
          {
            "name": "tenant_slug",
            "in": "path",
            "description": "Tenant slug",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Public branding configuration",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicBrandingResponse"
                }
              }
            }
          },
          "404": {
            "description": "Tenant not found"
          }
        }
      }
    },
    "/readyz": {
      "get": {
        "tags": [
          "Observability"
        ],
        "summary": "Readiness probe handler (`GET /readyz`).",
        "description": "Checks all critical and non-critical dependencies:\n- **database** (critical): `SELECT 1` with configurable timeout (default 2s)\n- **kafka** (non-critical): broker connectivity via health callback (default 3s timeout)\n\nReturns:\n- 200 with `\"healthy\"` when all checks pass\n- 200 with `\"degraded\"` when non-critical checks fail but critical pass\n- 503 with `\"unhealthy\"` when critical checks fail or service is shutting down\n\n(FR-002, FR-004, FR-005, FR-006, FR-008, FR-009, FR-010, FR-011, FR-012, FR-013)",
        "operationId": "readyz_handler",
        "responses": {
          "200": {
            "description": "Service is ready (healthy or degraded)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReadinessResponse"
                }
              }
            }
          },
          "503": {
            "description": "Service is not ready (unhealthy)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReadinessResponse"
                }
              }
            }
          }
        }
      }
    },
    "/reconciliation/schedules": {
      "get": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "List all schedules.",
        "operationId": "list_schedules",
        "responses": {
          "200": {
            "description": "List of all schedules",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListSchedulesResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/reconciliation/trend": {
      "get": {
        "tags": [
          "Connector Reconciliation"
        ],
        "summary": "Get discrepancy trend data.",
        "operationId": "get_trend",
        "parameters": [
          {
            "name": "connector_id",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "nullable": true
            }
          },
          {
            "name": "from",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          },
          {
            "name": "to",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Trend data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TrendResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/saml/initiate/{sp_id}": {
      "post": {
        "tags": [
          "SAML"
        ],
        "summary": "IdP-initiated SSO",
        "operationId": "initiate_sso",
        "parameters": [
          {
            "name": "sp_id",
            "in": "path",
            "description": "Service Provider ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/InitiateSsoRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "SAML Response form"
          },
          "401": {
            "description": "Not authenticated"
          },
          "404": {
            "description": "Service provider not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/saml/metadata": {
      "get": {
        "tags": [
          "SAML"
        ],
        "summary": "Return `IdP` metadata XML",
        "operationId": "get_metadata",
        "responses": {
          "200": {
            "description": "IdP metadata XML"
          },
          "500": {
            "description": "Failed to generate metadata"
          }
        }
      }
    },
    "/saml/sso": {
      "get": {
        "tags": [
          "SAML"
        ],
        "summary": "SP-initiated SSO via HTTP-Redirect binding",
        "operationId": "sso_redirect",
        "parameters": [
          {
            "name": "SAMLRequest",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "RelayState",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "SigAlg",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "Signature",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "SAML Response form"
          },
          "400": {
            "description": "Invalid SAML request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "404": {
            "description": "Service provider not found"
          }
        }
      },
      "post": {
        "tags": [
          "SAML"
        ],
        "summary": "SP-initiated SSO via HTTP-POST binding",
        "operationId": "sso_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SsoPostForm"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "SAML Response form"
          },
          "400": {
            "description": "Invalid SAML request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "404": {
            "description": "Service provider not found"
          }
        }
      }
    },
    "/scim/v2/Users": {
      "get": {
        "tags": [
          "SCIM"
        ],
        "summary": "List users with optional filtering.",
        "operationId": "list_users",
        "parameters": [
          {
            "name": "filter",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "startIndex",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "count",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "sortBy",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "sortOrder",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of SCIM users"
          },
          "401": {
            "description": "Not authenticated"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "SCIM"
        ],
        "summary": "Create a new user.",
        "operationId": "create_user",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateScimUserRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "User created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScimUser"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "409": {
            "description": "User already exists"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/scim/v2/Users/{id}": {
      "get": {
        "tags": [
          "SCIM"
        ],
        "summary": "Get a user by ID.",
        "operationId": "get_user",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScimUser"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "SCIM"
        ],
        "summary": "Replace a user (full update).",
        "operationId": "replace_user",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateScimUserRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "User replaced",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScimUser"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "SCIM"
        ],
        "summary": "Delete (deactivate) a user.",
        "operationId": "delete_user",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "User deleted"
          },
          "401": {
            "description": "Not authenticated"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "patch": {
        "tags": [
          "SCIM"
        ],
        "summary": "Patch a user (partial update).",
        "operationId": "update_user",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ScimPatchRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "User updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScimUser"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Not authenticated"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/startupz": {
      "get": {
        "tags": [
          "Observability"
        ],
        "summary": "Startup probe handler (`GET /startupz`).",
        "description": "Returns 503 during initialization and 200 once startup is complete.\nThis is a one-time gate: once `startup_complete` is set to true, this\nendpoint always returns 200 (FR-003, FR-014).",
        "operationId": "startupz_handler",
        "responses": {
          "200": {
            "description": "Startup complete",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StartupResponse"
                }
              }
            }
          },
          "503": {
            "description": "Still starting up",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StartupResponse"
                }
              }
            }
          }
        }
      }
    },
    "/tenants/provision": {
      "post": {
        "tags": [
          "Tenant Provisioning"
        ],
        "summary": "POST /tenants/provision",
        "description": "Create a new tenant with all necessary resources.\n\nRequires authentication against the system tenant.\n\n# Request Body\n\n- `organization_name`: Human-readable name for the new tenant (1-100 chars)\n\n# Response\n\nOn success (201 Created):\n- `tenant`: Created tenant details (id, slug, name)\n- `admin`: Admin user details (id, email, `api_key`)\n- `oauth_client`: OAuth client credentials (`client_id`, `client_secret`)\n- `endpoints`: API endpoint URLs\n- `next_steps`: Suggested actions for getting started\n\n# Errors\n\n- 400 Bad Request: Invalid organization name or validation error\n- 401 Unauthorized: Missing or invalid JWT token\n- 403 Forbidden: User not authenticated against system tenant",
        "operationId": "provision_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProvisionTenantRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Tenant provisioned successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProvisionTenantResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/crate.error.ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden - must authenticate against system tenant",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/crate.error.ErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/tools": {
      "get": {
        "tags": [
          "AI Agent Tools"
        ],
        "summary": "GET /tools - List tools.",
        "operationId": "listTools",
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "description": "Filter by status.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "category",
            "in": "query",
            "description": "Filter by category.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "risk_level",
            "in": "query",
            "description": "Filter by risk level.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "requires_approval",
            "in": "query",
            "description": "Filter by approval requirement.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          },
          {
            "name": "name",
            "in": "query",
            "description": "Search by name (partial match).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results. Default: 100.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination. Default: 0.",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int32"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of tools",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ToolListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "AI Agent Tools"
        ],
        "summary": "POST /tools - Create a new tool.",
        "operationId": "createTool",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateToolRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Tool created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ToolResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Authentication required"
          },
          "409": {
            "description": "Tool name already exists"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/tools/{id}": {
      "get": {
        "tags": [
          "AI Agent Tools"
        ],
        "summary": "GET /tools/{id} - Get tool by ID.",
        "operationId": "getTool",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tool ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tool details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ToolResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Tool not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "AI Agent Tools"
        ],
        "summary": "DELETE /tools/{id} - Delete tool.",
        "operationId": "deleteTool",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tool ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Tool deleted"
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Tool not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "patch": {
        "tags": [
          "AI Agent Tools"
        ],
        "summary": "PATCH /tools/{id} - Update tool.",
        "operationId": "updateTool",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tool ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateToolRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tool updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ToolResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "401": {
            "description": "Authentication required"
          },
          "404": {
            "description": "Tool not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/users": {
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "Lists users belonging to the authenticated admin's tenant.",
        "description": "Supports filtering by custom attributes using `custom_attr.{name}` query parameters:\n- `custom_attr.department=Engineering` \u2014 equality filter\n- `custom_attr.hire_date.lt=2024-01-01` \u2014 less-than filter\n- `custom_attr.age.gte=18` \u2014 greater-than-or-equal filter\n\nMultiple custom attribute filters are combined with AND logic.",
        "operationId": "list_users_handler",
        "parameters": [
          {
            "name": "offset",
            "in": "query",
            "description": "Offset for pagination (default: 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of users to return (default: 20, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "nullable": true
            }
          },
          {
            "name": "email",
            "in": "query",
            "description": "Filter by email (case-insensitive partial match).",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          },
          {
            "name": "custom_attr.*",
            "in": "query",
            "description": "Filter by custom attribute values. Use custom_attr.{name} for equality, custom_attr.{name}.lt/gt/lte/gte for range comparisons.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of users",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserListResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid filter parameter"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Users"
        ],
        "summary": "Creates a new user in the authenticated admin's tenant.",
        "operationId": "create_user_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateUserRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "User created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "409": {
            "description": "Email already exists in tenant"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/users/{id}": {
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "Returns details of a specific user in the admin's tenant.",
        "operationId": "get_user_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid user ID format"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Users"
        ],
        "summary": "Updates a user's email, roles, or active status.",
        "operationId": "update_user_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateUserRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "User updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "User not found"
          },
          "409": {
            "description": "Email already exists in tenant"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Users"
        ],
        "summary": "Soft deletes a user by setting `is_active=false`.",
        "operationId": "delete_user_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "User deactivated"
          },
          "400": {
            "description": "Invalid user ID format"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ]
      }
    },
    "/webhooks/event-types": {
      "get": {
        "tags": [
          "Webhooks"
        ],
        "summary": "List all supported webhook event types.",
        "operationId": "list_event_types_handler",
        "responses": {
          "200": {
            "description": "List of event types",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EventTypeListResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/webhooks/subscriptions": {
      "get": {
        "tags": [
          "Webhooks"
        ],
        "summary": "List webhook subscriptions.",
        "operationId": "list_subscriptions_handler",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results to return (default: 20, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip (default: 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "enabled",
            "in": "query",
            "description": "Filter by enabled/disabled status.",
            "required": false,
            "schema": {
              "type": "boolean",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated subscription list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscriptionListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Webhooks"
        ],
        "summary": "Create a new webhook subscription.",
        "operationId": "create_subscription_handler",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateWebhookSubscriptionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Subscription created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscriptionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error"
          },
          "401": {
            "description": "Unauthorized"
          },
          "409": {
            "description": "Subscription limit exceeded"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/webhooks/subscriptions/{id}": {
      "get": {
        "tags": [
          "Webhooks"
        ],
        "summary": "Get a single webhook subscription.",
        "operationId": "get_subscription_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subscription ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Subscription details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscriptionResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Subscription not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Webhooks"
        ],
        "summary": "Delete a webhook subscription.",
        "operationId": "delete_subscription_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subscription ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Subscription deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Subscription not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "patch": {
        "tags": [
          "Webhooks"
        ],
        "summary": "Update a webhook subscription.",
        "operationId": "update_subscription_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subscription ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateWebhookSubscriptionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Subscription updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscriptionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Subscription not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/webhooks/subscriptions/{id}/deliveries": {
      "get": {
        "tags": [
          "Webhooks"
        ],
        "summary": "List delivery attempts for a subscription.",
        "operationId": "list_deliveries_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subscription ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum results to return (default: 20, max: 100).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of results to skip (default: 0).",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter by delivery status.",
            "required": false,
            "schema": {
              "type": "string",
              "nullable": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated delivery list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookDeliveryListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Subscription not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/webhooks/subscriptions/{id}/deliveries/{delivery_id}": {
      "get": {
        "tags": [
          "Webhooks"
        ],
        "summary": "Get detailed information about a specific delivery attempt.",
        "operationId": "get_delivery_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subscription ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "delivery_id",
            "in": "path",
            "description": "Delivery ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Delivery details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookDeliveryDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Delivery or subscription not found"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "A2aErrorResponse": {
        "type": "object",
        "description": "A2A error response.",
        "required": [
          "error",
          "message"
        ],
        "properties": {
          "details": {
            "description": "Additional details.",
            "nullable": true
          },
          "error": {
            "type": "string",
            "description": "Error code."
          },
          "message": {
            "type": "string",
            "description": "Human-readable message."
          }
        }
      },
      "A2aTaskListResponse": {
        "type": "object",
        "description": "Response for GET /a2a/tasks - list tasks.",
        "required": [
          "tasks",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "limit": {
            "type": "integer",
            "format": "int32",
            "description": "Limit used in query."
          },
          "offset": {
            "type": "integer",
            "format": "int32",
            "description": "Offset used in query."
          },
          "tasks": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/A2aTaskResponse"
            },
            "description": "List of tasks."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching filter."
          }
        }
      },
      "A2aTaskResponse": {
        "type": "object",
        "description": "Response for GET /a2a/tasks/{id} - task details.",
        "required": [
          "id",
          "source_agent_id",
          "target_agent_id",
          "task_type",
          "state",
          "created_at"
        ],
        "properties": {
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the task reached a terminal state.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Task creation timestamp."
          },
          "error_code": {
            "type": "string",
            "description": "Error code (when failed).",
            "nullable": true
          },
          "error_message": {
            "type": "string",
            "description": "Error message (when failed).",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Task identifier."
          },
          "result": {
            "description": "Task result (when completed).",
            "nullable": true
          },
          "source_agent_id": {
            "type": "string",
            "format": "uuid",
            "description": "Agent that created the task."
          },
          "started_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the task started execution.",
            "nullable": true
          },
          "state": {
            "type": "string",
            "description": "Current task state."
          },
          "target_agent_id": {
            "type": "string",
            "format": "uuid",
            "description": "Agent executing the task."
          },
          "task_type": {
            "type": "string",
            "description": "Task type/skill."
          }
        }
      },
      "AccessPatternListResponse": {
        "type": "object",
        "description": "List response for access patterns.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AccessPatternResponse"
            }
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "page_size": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "AccessPatternResponse": {
        "type": "object",
        "description": "Response for an access pattern.",
        "required": [
          "id",
          "job_id",
          "entitlement_ids",
          "frequency",
          "user_count",
          "sample_user_ids",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "entitlement_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "frequency": {
            "type": "integer",
            "format": "int32"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "job_id": {
            "type": "string",
            "format": "uuid"
          },
          "sample_user_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "user_count": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "AccessRequestCreatedResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/AccessRequestResponse"
          },
          {
            "type": "object",
            "properties": {
              "sod_warning_message": {
                "type": "string",
                "description": "Message about `SoD` warnings if any.",
                "nullable": true
              }
            }
          }
        ],
        "description": "Response when creating an access request."
      },
      "AccessRequestListResponse": {
        "type": "object",
        "description": "Paginated list of access requests.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AccessRequestResponse"
            },
            "description": "List of requests."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "AccessRequestResponse": {
        "type": "object",
        "description": "Access request response.",
        "required": [
          "id",
          "requester_id",
          "entitlement_id",
          "current_step",
          "status",
          "justification",
          "has_sod_warning",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the request was submitted."
          },
          "current_step": {
            "type": "integer",
            "format": "int32",
            "description": "Current step in approval chain."
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement being requested."
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the request expires.",
            "nullable": true
          },
          "has_sod_warning": {
            "type": "boolean",
            "description": "Whether `SoD` violations were detected."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "justification": {
            "type": "string",
            "description": "Business justification."
          },
          "provisioned_assignment_id": {
            "type": "string",
            "format": "uuid",
            "description": "Assignment ID after provisioning.",
            "nullable": true
          },
          "requested_expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "Requested access expiration.",
            "nullable": true
          },
          "requester_id": {
            "type": "string",
            "format": "uuid",
            "description": "User who submitted the request."
          },
          "sod_violations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SodViolationSummary"
            },
            "description": "`SoD` violation details.",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/GovRequestStatus"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the request was last updated."
          },
          "workflow_id": {
            "type": "string",
            "format": "uuid",
            "description": "Workflow used for approval.",
            "nullable": true
          }
        }
      },
      "AccessSnapshotListResponse": {
        "type": "object",
        "description": "Paginated list of access snapshots.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AccessSnapshotResponse"
            },
            "description": "List of snapshots."
          },
          "page": {
            "type": "integer",
            "format": "int64",
            "description": "Page number."
          },
          "page_size": {
            "type": "integer",
            "format": "int64",
            "description": "Page size."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "AccessSnapshotResponse": {
        "type": "object",
        "description": "Access snapshot response.",
        "required": [
          "id",
          "tenant_id",
          "user_id",
          "event_id",
          "snapshot_type",
          "assignments",
          "created_at"
        ],
        "properties": {
          "assignments": {
            "$ref": "#/components/schemas/SnapshotContentResponse"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the snapshot was created."
          },
          "event_id": {
            "type": "string",
            "format": "uuid",
            "description": "Event that triggered this snapshot."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "snapshot_type": {
            "$ref": "#/components/schemas/AccessSnapshotType"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User whose access was captured."
          }
        }
      },
      "AccessSnapshotType": {
        "type": "string",
        "description": "Type of access snapshot.",
        "enum": [
          "pre_leaver",
          "pre_mover",
          "current"
        ]
      },
      "AcknowledgeAlertResponse": {
        "type": "object",
        "description": "Response for acknowledging an alert.",
        "required": [
          "alert"
        ],
        "properties": {
          "alert": {
            "$ref": "#/components/schemas/RiskAlertResponse"
          }
        }
      },
      "ActionResponse": {
        "type": "object",
        "description": "Response for an action.",
        "required": [
          "id",
          "discrepancy_id",
          "action_type",
          "executed_by",
          "result",
          "dry_run",
          "executed_at"
        ],
        "properties": {
          "action_type": {
            "type": "string"
          },
          "after_state": {
            "nullable": true
          },
          "before_state": {
            "nullable": true
          },
          "discrepancy_id": {
            "type": "string",
            "format": "uuid"
          },
          "dry_run": {
            "type": "boolean"
          },
          "error_message": {
            "type": "string",
            "nullable": true
          },
          "executed_at": {
            "type": "string",
            "format": "date-time"
          },
          "executed_by": {
            "type": "string",
            "format": "uuid"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "result": {
            "type": "string"
          }
        }
      },
      "ActionSummary": {
        "type": "object",
        "description": "Action summary for report.",
        "required": [
          "total",
          "by_type",
          "by_result"
        ],
        "properties": {
          "by_result": {
            "type": "object",
            "additionalProperties": {
              "type": "integer",
              "format": "int32",
              "minimum": 0
            }
          },
          "by_type": {
            "type": "object",
            "additionalProperties": {
              "type": "integer",
              "format": "int32",
              "minimum": 0
            }
          },
          "total": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "AddMetaRoleConstraintRequest": {
        "type": "object",
        "description": "Request to add a constraint to an existing meta-role.",
        "required": [
          "constraint_type",
          "constraint_value"
        ],
        "properties": {
          "constraint_type": {
            "type": "string",
            "description": "Constraint type."
          },
          "constraint_value": {
            "description": "Constraint configuration."
          }
        }
      },
      "AddMetaRoleEntitlementRequest": {
        "type": "object",
        "description": "Request to add an entitlement to an existing meta-role.",
        "required": [
          "entitlement_id"
        ],
        "properties": {
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "The entitlement ID to inherit."
          },
          "permission_type": {
            "allOf": [
              {
                "$ref": "#/components/schemas/PermissionType"
              }
            ],
            "nullable": true
          }
        }
      },
      "AdminCredentialInfo": {
        "type": "object",
        "description": "Admin view of a credential.",
        "required": [
          "id",
          "name",
          "authenticator_type",
          "backup_eligible",
          "backup_state",
          "created_at"
        ],
        "properties": {
          "authenticator_type": {
            "type": "string",
            "description": "Authenticator type (platform or cross-platform)."
          },
          "backup_eligible": {
            "type": "boolean",
            "description": "Whether credential supports backup (passkey sync)."
          },
          "backup_state": {
            "type": "boolean",
            "description": "Whether credential is currently backed up."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the credential was created."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Credential ID."
          },
          "last_used_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the credential was last used.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "User-friendly name."
          }
        }
      },
      "AdminCredentialListResponse": {
        "type": "object",
        "description": "Response containing admin view of user credentials.",
        "required": [
          "user_id",
          "credentials",
          "count"
        ],
        "properties": {
          "count": {
            "type": "integer",
            "description": "Total count of credentials.",
            "minimum": 0
          },
          "credentials": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AdminCredentialInfo"
            },
            "description": "List of registered `WebAuthn` credentials."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "The user these credentials belong to."
          }
        }
      },
      "AdminInfo": {
        "type": "object",
        "description": "Admin user information from provisioning.",
        "required": [
          "id",
          "email",
          "api_key"
        ],
        "properties": {
          "api_key": {
            "type": "string",
            "description": "API key for programmatic access.\n\n**WARNING**: This key is shown only once. Store it securely.\nThe key is stored as a hash and cannot be retrieved later.",
            "example": "xavyo_sk_live_a1b2c3d4e5f6789012345678901234567890"
          },
          "email": {
            "type": "string",
            "description": "Admin email address (from JWT claims).",
            "example": "admin@acme.com"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Admin user identifier.",
            "example": "550e8400-e29b-41d4-a716-446655440001"
          }
        }
      },
      "AgentAuthentication": {
        "type": "object",
        "description": "Agent authentication configuration (A2A Protocol).",
        "required": [
          "schemes"
        ],
        "properties": {
          "schemes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Supported authentication schemes."
          }
        }
      },
      "AgentCapabilities": {
        "type": "object",
        "description": "Agent capabilities (A2A Protocol).",
        "required": [
          "streaming",
          "pushNotifications"
        ],
        "properties": {
          "pushNotifications": {
            "type": "boolean",
            "description": "Whether agent supports push notifications."
          },
          "streaming": {
            "type": "boolean",
            "description": "Whether agent supports streaming."
          }
        }
      },
      "AgentCard": {
        "type": "object",
        "description": "A2A Protocol `AgentCard` for agent discovery.",
        "required": [
          "name",
          "url",
          "version",
          "protocolVersion",
          "capabilities",
          "authentication",
          "skills"
        ],
        "properties": {
          "authentication": {
            "$ref": "#/components/schemas/AgentAuthentication"
          },
          "capabilities": {
            "$ref": "#/components/schemas/AgentCapabilities"
          },
          "description": {
            "type": "string",
            "description": "Agent description.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Agent name."
          },
          "protocolVersion": {
            "type": "string",
            "description": "A2A protocol version."
          },
          "skills": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AgentSkill"
            },
            "description": "Agent skills (tools it can use)."
          },
          "url": {
            "type": "string",
            "description": "Agent API URL."
          },
          "version": {
            "type": "string",
            "description": "Agent version."
          }
        }
      },
      "AgentListResponse": {
        "type": "object",
        "description": "List response for agents with pagination.",
        "required": [
          "agents",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "agents": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AgentResponse"
            },
            "description": "List of agents."
          },
          "limit": {
            "type": "integer",
            "format": "int32",
            "description": "Current limit."
          },
          "offset": {
            "type": "integer",
            "format": "int32",
            "description": "Current offset."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count (for pagination)."
          }
        }
      },
      "AgentResponse": {
        "type": "object",
        "description": "Agent response DTO.",
        "required": [
          "id",
          "name",
          "agent_type",
          "status",
          "risk_level",
          "max_token_lifetime_secs",
          "requires_human_approval",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "agent_type": {
            "type": "string",
            "description": "Agent type: autonomous, copilot, workflow, orchestrator."
          },
          "backup_owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Backup owner ID for governance continuity (F108).",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Agent creation timestamp."
          },
          "description": {
            "type": "string",
            "description": "Agent description.",
            "nullable": true
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "Expiration timestamp.",
            "nullable": true
          },
          "grace_period_ends_at": {
            "type": "string",
            "format": "date-time",
            "description": "When grace period expires and agent will be suspended.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Agent unique identifier."
          },
          "inactivity_threshold_days": {
            "type": "integer",
            "format": "int32",
            "description": "Days of inactivity before agent enters grace period.",
            "nullable": true
          },
          "last_activity_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last activity timestamp.",
            "nullable": true
          },
          "last_rotation_at": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp of last credential rotation.",
            "nullable": true
          },
          "max_token_lifetime_secs": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum token lifetime in seconds."
          },
          "model_name": {
            "type": "string",
            "description": "Model name.",
            "nullable": true
          },
          "model_provider": {
            "type": "string",
            "description": "Model provider.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Agent display name."
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Owner user ID.",
            "nullable": true
          },
          "requires_human_approval": {
            "type": "boolean",
            "description": "Requires human approval for sensitive operations."
          },
          "risk_level": {
            "type": "string",
            "description": "Risk level: low, medium, high, critical."
          },
          "rotation_interval_days": {
            "type": "integer",
            "format": "int32",
            "description": "Days between required credential rotations.",
            "nullable": true
          },
          "status": {
            "type": "string",
            "description": "Agent status: active, suspended, expired."
          },
          "suspension_reason": {
            "type": "string",
            "description": "Reason for suspension (if suspended).",
            "nullable": true
          },
          "team_id": {
            "type": "string",
            "format": "uuid",
            "description": "Team/group ID.",
            "nullable": true
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Agent last update timestamp."
          }
        }
      },
      "AgentSkill": {
        "type": "object",
        "description": "Agent skill (tool capability) for A2A Protocol.",
        "required": [
          "id",
          "name"
        ],
        "properties": {
          "description": {
            "type": "string",
            "description": "Skill description.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "description": "Skill/tool ID."
          },
          "name": {
            "type": "string",
            "description": "Skill display name."
          }
        }
      },
      "AlertResponse": {
        "type": "object",
        "description": "Response containing alert details.",
        "required": [
          "id",
          "analysis_id",
          "user_id",
          "alert_type",
          "severity",
          "score",
          "classification",
          "is_read",
          "is_dismissed",
          "created_at"
        ],
        "properties": {
          "alert_type": {
            "$ref": "#/components/schemas/OutlierAlertType"
          },
          "analysis_id": {
            "type": "string",
            "format": "uuid"
          },
          "classification": {
            "$ref": "#/components/schemas/OutlierClassification"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_dismissed": {
            "type": "boolean"
          },
          "is_read": {
            "type": "boolean"
          },
          "score": {
            "type": "number",
            "format": "double"
          },
          "severity": {
            "$ref": "#/components/schemas/OutlierAlertSeverity"
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "AlertSummary": {
        "type": "object",
        "description": "Alert summary by severity.",
        "required": [
          "unacknowledged",
          "total_unacknowledged"
        ],
        "properties": {
          "total_unacknowledged": {
            "type": "integer",
            "format": "int64",
            "description": "Total unacknowledged count."
          },
          "unacknowledged": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SeverityCount"
            },
            "description": "Unacknowledged alerts by severity."
          }
        }
      },
      "AlertSummaryResponse": {
        "type": "object",
        "description": "Summary of alerts.",
        "required": [
          "total_count",
          "unread_count",
          "critical_count",
          "high_count",
          "medium_count",
          "low_count"
        ],
        "properties": {
          "critical_count": {
            "type": "integer",
            "format": "int64"
          },
          "high_count": {
            "type": "integer",
            "format": "int64"
          },
          "low_count": {
            "type": "integer",
            "format": "int64"
          },
          "medium_count": {
            "type": "integer",
            "format": "int64"
          },
          "total_count": {
            "type": "integer",
            "format": "int64"
          },
          "unread_count": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "AncestorEntry": {
        "type": "object",
        "description": "An ancestor entry in the path from root to a group.",
        "required": [
          "id",
          "display_name",
          "group_type",
          "depth"
        ],
        "properties": {
          "depth": {
            "type": "integer",
            "format": "int32",
            "description": "Depth from root (root = 1)."
          },
          "display_name": {
            "type": "string",
            "description": "Ancestor group display name."
          },
          "group_type": {
            "type": "string",
            "description": "Ancestor group type."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Ancestor group ID."
          }
        }
      },
      "AncestorPathResponse": {
        "type": "object",
        "description": "Response for getting ancestor path.",
        "required": [
          "group_id",
          "ancestors"
        ],
        "properties": {
          "ancestors": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AncestorEntry"
            },
            "description": "Ancestors ordered from root to immediate parent."
          },
          "group_id": {
            "type": "string",
            "format": "uuid",
            "description": "The group ID that was queried."
          }
        }
      },
      "AnomalyListResponse": {
        "type": "object",
        "description": "Response for listing detected anomalies.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DetectedAnomaly"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "AnomalyThresholdInput": {
        "type": "object",
        "description": "Input for a single threshold configuration.",
        "required": [
          "anomaly_type"
        ],
        "properties": {
          "aggregation_window_secs": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "alert_enabled": {
            "type": "boolean",
            "nullable": true
          },
          "anomaly_type": {
            "$ref": "#/components/schemas/AnomalyType"
          },
          "enabled": {
            "type": "boolean",
            "nullable": true
          },
          "threshold_value": {
            "type": "number",
            "format": "double",
            "nullable": true
          }
        }
      },
      "ApplicationEventListResponse": {
        "type": "object",
        "description": "Paginated list of application events.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApplicationEventResponse"
            },
            "description": "List of events."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Current page size."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Current offset."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count."
          }
        }
      },
      "ApplicationEventResponse": {
        "type": "object",
        "description": "Application event response.",
        "required": [
          "id",
          "object_type",
          "object_id",
          "operation",
          "rules_applied",
          "changes_made",
          "created_at"
        ],
        "properties": {
          "actor_id": {
            "type": "string",
            "format": "uuid",
            "description": "Actor who triggered the operation.",
            "nullable": true
          },
          "changes_made": {
            "description": "Changes made to the object."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Event timestamp."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "object_id": {
            "type": "string",
            "format": "uuid",
            "description": "ID of affected object."
          },
          "object_type": {
            "$ref": "#/components/schemas/TemplateObjectType"
          },
          "operation": {
            "type": "string",
            "description": "Operation type (create/update)."
          },
          "rules_applied": {
            "description": "Rules that were applied."
          },
          "template_id": {
            "type": "string",
            "format": "uuid",
            "description": "Template ID.",
            "nullable": true
          },
          "template_version_id": {
            "type": "string",
            "format": "uuid",
            "description": "Template version ID.",
            "nullable": true
          },
          "validation_errors": {
            "description": "Validation errors if any.",
            "nullable": true
          }
        }
      },
      "ApplicationListResponse": {
        "type": "object",
        "description": "Paginated list of applications.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApplicationResponse"
            },
            "description": "List of applications."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Maximum number of results returned."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Number of results skipped."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count of matching applications."
          }
        }
      },
      "ApplicationResponse": {
        "type": "object",
        "description": "Application response model.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "app_type",
          "status",
          "is_delegable",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "app_type": {
            "$ref": "#/components/schemas/GovAppType"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the application was created."
          },
          "description": {
            "type": "string",
            "description": "Application description.",
            "nullable": true
          },
          "external_id": {
            "type": "string",
            "description": "External system reference ID.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the application."
          },
          "is_delegable": {
            "type": "boolean",
            "description": "Whether entitlements in this application can be delegated."
          },
          "metadata": {
            "description": "Extensible metadata as JSON.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Application display name."
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Application owner (user ID).",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/GovAppStatus"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the application was last updated."
          }
        }
      },
      "ApplyBatchSimulationRequest": {
        "type": "object",
        "description": "Request to apply a batch simulation (commit changes).",
        "required": [
          "justification"
        ],
        "properties": {
          "acknowledge_scope_warning": {
            "type": "boolean",
            "description": "Acknowledge scope warning (required if >100 users affected)."
          },
          "justification": {
            "type": "string",
            "description": "Reason/justification for applying the changes."
          }
        }
      },
      "ApprovalActionResponse": {
        "type": "object",
        "description": "Response after an approval/rejection action.",
        "required": [
          "request_id",
          "new_status",
          "decision",
          "message"
        ],
        "properties": {
          "decision": {
            "$ref": "#/components/schemas/GovDecisionType"
          },
          "message": {
            "type": "string",
            "description": "Message about the action."
          },
          "new_status": {
            "$ref": "#/components/schemas/GovRequestStatus"
          },
          "provisioned_assignment_id": {
            "type": "string",
            "format": "uuid",
            "description": "Assignment ID if provisioned.",
            "nullable": true
          },
          "request_id": {
            "type": "string",
            "format": "uuid",
            "description": "Request ID."
          }
        }
      },
      "ApprovalGroupListResponse": {
        "type": "object",
        "description": "Paginated list of approval groups.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApprovalGroupSummary"
            },
            "description": "List of groups."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "ApprovalGroupResponse": {
        "type": "object",
        "description": "Approval group response.",
        "required": [
          "id",
          "name",
          "member_ids",
          "member_count",
          "is_active",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the group is active."
          },
          "member_count": {
            "type": "integer",
            "description": "Number of members.",
            "minimum": 0
          },
          "member_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Member user IDs."
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          }
        }
      },
      "ApprovalGroupSummary": {
        "type": "object",
        "description": "Approval group summary for list views.",
        "required": [
          "id",
          "name",
          "member_count",
          "is_active",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the group is active."
          },
          "member_count": {
            "type": "integer",
            "description": "Number of members.",
            "minimum": 0
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          }
        }
      },
      "ApprovalListResponse": {
        "type": "object",
        "description": "List response for approval requests.",
        "required": [
          "items",
          "total"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApprovalSummary"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "offset": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ApprovalResponse": {
        "type": "object",
        "description": "Full approval request details.",
        "required": [
          "id",
          "agent_id",
          "agent_name",
          "tool_id",
          "tool_name",
          "parameters",
          "context",
          "status",
          "risk_score",
          "requested_at",
          "expires_at"
        ],
        "properties": {
          "agent_id": {
            "type": "string",
            "format": "uuid"
          },
          "agent_name": {
            "type": "string"
          },
          "conditions": {
            "nullable": true
          },
          "context": {},
          "conversation_id": {
            "type": "string",
            "nullable": true
          },
          "decided_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "decided_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "decision_reason": {
            "type": "string",
            "nullable": true
          },
          "expires_at": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "parameters": {},
          "requested_at": {
            "type": "string",
            "format": "date-time"
          },
          "risk_score": {
            "type": "integer",
            "format": "int32"
          },
          "session_id": {
            "type": "string",
            "nullable": true
          },
          "status": {
            "type": "string"
          },
          "tool_id": {
            "type": "string",
            "format": "uuid"
          },
          "tool_name": {
            "type": "string"
          },
          "user_instruction": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "ApprovalStatusResponse": {
        "type": "object",
        "description": "Lightweight status response for agent polling.",
        "required": [
          "status"
        ],
        "properties": {
          "conditions": {
            "nullable": true
          },
          "decided_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "status": {
            "type": "string"
          }
        }
      },
      "ApprovalStepResponse": {
        "type": "object",
        "description": "Approval step response.",
        "required": [
          "id",
          "step_order",
          "approver_type",
          "created_at"
        ],
        "properties": {
          "approver_type": {
            "$ref": "#/components/schemas/GovApproverType"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "specific_approvers": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Specific approver user IDs.",
            "nullable": true
          },
          "step_order": {
            "type": "integer",
            "format": "int32",
            "description": "Order in the approval chain."
          }
        }
      },
      "ApprovalSummary": {
        "type": "object",
        "description": "Summary of an approval request for list views.",
        "required": [
          "id",
          "agent_id",
          "agent_name",
          "tool_id",
          "tool_name",
          "status",
          "risk_score",
          "requested_at",
          "expires_at"
        ],
        "properties": {
          "agent_id": {
            "type": "string",
            "format": "uuid"
          },
          "agent_name": {
            "type": "string"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "requested_at": {
            "type": "string",
            "format": "date-time"
          },
          "risk_score": {
            "type": "integer",
            "format": "int32"
          },
          "status": {
            "type": "string"
          },
          "tool_id": {
            "type": "string",
            "format": "uuid"
          },
          "tool_name": {
            "type": "string"
          }
        }
      },
      "ApprovalWorkflowListResponse": {
        "type": "object",
        "description": "Paginated list of workflows.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApprovalWorkflowSummary"
            },
            "description": "List of workflows."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "ApprovalWorkflowResponse": {
        "type": "object",
        "description": "Approval workflow response.",
        "required": [
          "id",
          "name",
          "is_default",
          "is_active",
          "steps",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the workflow is active."
          },
          "is_default": {
            "type": "boolean",
            "description": "Whether this is the default workflow."
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "steps": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApprovalStepResponse"
            },
            "description": "Approval steps."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          }
        }
      },
      "ApprovalWorkflowSummary": {
        "type": "object",
        "description": "Workflow summary for list views.",
        "required": [
          "id",
          "name",
          "is_default",
          "is_active",
          "step_count",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the workflow is active."
          },
          "is_default": {
            "type": "boolean",
            "description": "Whether this is the default workflow."
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "step_count": {
            "type": "integer",
            "format": "int32",
            "description": "Number of steps."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          }
        }
      },
      "ApproveNhiRequestRequest": {
        "type": "object",
        "description": "Request to approve an NHI request.",
        "properties": {
          "comments": {
            "type": "string",
            "description": "Approver comments.",
            "nullable": true
          }
        }
      },
      "ApproveRequest": {
        "type": "object",
        "description": "Request body for approving an approval request.",
        "properties": {
          "conditions": {
            "nullable": true
          },
          "reason": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "ApproveRequestRequest": {
        "type": "object",
        "description": "Request to approve an access request.",
        "properties": {
          "comments": {
            "type": "string",
            "description": "Optional comments from the approver.",
            "nullable": true
          }
        }
      },
      "ArchetypeListResponse": {
        "type": "object",
        "description": "List of archetypes response.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ArchetypeResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ArchetypeResponse": {
        "type": "object",
        "description": "Archetype response model.",
        "required": [
          "id",
          "name",
          "naming_pattern",
          "attribute_mappings",
          "lifecycle_policy",
          "is_active",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "attribute_mappings": {},
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "default_entitlements": {
            "nullable": true
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_active": {
            "type": "boolean"
          },
          "lifecycle_policy": {},
          "name": {
            "type": "string"
          },
          "naming_pattern": {
            "type": "string"
          },
          "personas_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of personas using this archetype.",
            "nullable": true
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "ArchivePersonaRequest": {
        "type": "object",
        "description": "Request to archive a persona.",
        "required": [
          "reason"
        ],
        "properties": {
          "reason": {
            "type": "string",
            "description": "Reason for archiving (5-1000 characters)."
          }
        }
      },
      "AssetResponse": {
        "type": "object",
        "description": "Response for branding asset upload.",
        "required": [
          "id",
          "asset_type",
          "filename",
          "content_type",
          "file_size",
          "url",
          "width",
          "height",
          "checksum",
          "created_at"
        ],
        "properties": {
          "asset_type": {
            "type": "string"
          },
          "checksum": {
            "type": "string"
          },
          "content_type": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "file_size": {
            "type": "integer",
            "format": "int32"
          },
          "filename": {
            "type": "string"
          },
          "height": {
            "type": "integer",
            "format": "int32"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "url": {
            "type": "string"
          },
          "width": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "AssignLicenseRequest": {
        "type": "object",
        "description": "Request to assign a license to a user.",
        "required": [
          "license_pool_id",
          "user_id"
        ],
        "properties": {
          "license_pool_id": {
            "type": "string",
            "format": "uuid",
            "description": "The license pool to assign from."
          },
          "notes": {
            "type": "string",
            "description": "Optional notes about the assignment.",
            "nullable": true
          },
          "source": {
            "$ref": "#/components/schemas/LicenseAssignmentSource"
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "The user to assign the license to."
          }
        }
      },
      "AssignmentDetailResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/AssignmentResponse"
          },
          {
            "type": "object",
            "properties": {
              "template": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/RoleTemplateDetailResponse"
                  }
                ],
                "nullable": true
              }
            }
          }
        ],
        "description": "Assignment detail response (with template details)."
      },
      "AssignmentListResponse": {
        "type": "object",
        "description": "Paginated list of assignments.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AssignmentResponse"
            },
            "description": "List of assignments."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Maximum number of results returned."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Number of results skipped."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count of matching assignments."
          }
        }
      },
      "AssignmentParameterResponse": {
        "type": "object",
        "description": "Assignment parameter response.",
        "required": [
          "id",
          "assignment_id",
          "parameter_id",
          "parameter_name",
          "parameter_type",
          "value",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "assignment_id": {
            "type": "string",
            "format": "uuid",
            "description": "Assignment ID."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the parameter was set."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "parameter_display_name": {
            "type": "string",
            "description": "Parameter display name.",
            "nullable": true
          },
          "parameter_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parameter ID."
          },
          "parameter_name": {
            "type": "string",
            "description": "Parameter name."
          },
          "parameter_type": {
            "type": "string",
            "description": "Parameter type."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the parameter was last updated."
          },
          "value": {
            "description": "Parameter value."
          }
        }
      },
      "AssignmentResponse": {
        "type": "object",
        "description": "Assignment response model.",
        "required": [
          "id",
          "tenant_id",
          "entitlement_id",
          "target_type",
          "target_id",
          "assigned_by",
          "assigned_at",
          "status",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "assigned_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the assignment was made."
          },
          "assigned_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who assigned this entitlement."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the assignment was created."
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "The entitlement being assigned."
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the assignment expires (optional).",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the assignment."
          },
          "justification": {
            "type": "string",
            "description": "Business justification for the assignment.",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/GovAssignmentStatus"
          },
          "target_id": {
            "type": "string",
            "format": "uuid",
            "description": "The target ID (`user_id` or `group_id`)."
          },
          "target_type": {
            "$ref": "#/components/schemas/GovAssignmentTargetType"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the assignment was last updated."
          }
        }
      },
      "AttemptListResponse": {
        "type": "object",
        "description": "List of operation attempts.",
        "required": [
          "attempts",
          "operation_id"
        ],
        "properties": {
          "attempts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AttemptResponse"
            },
            "description": "List of attempts."
          },
          "operation_id": {
            "type": "string",
            "format": "uuid",
            "description": "Operation ID these attempts belong to."
          }
        }
      },
      "AttemptResponse": {
        "type": "object",
        "description": "Operation attempt (execution history) response.",
        "required": [
          "id",
          "operation_id",
          "attempt_number",
          "started_at",
          "success"
        ],
        "properties": {
          "attempt_number": {
            "type": "integer",
            "format": "int32",
            "description": "Attempt number (1-based)."
          },
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the attempt completed.",
            "nullable": true
          },
          "duration_ms": {
            "type": "integer",
            "format": "int32",
            "description": "Duration in milliseconds.",
            "nullable": true
          },
          "error_code": {
            "type": "string",
            "description": "Error code if failed.",
            "nullable": true
          },
          "error_message": {
            "type": "string",
            "description": "Error message if failed.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Attempt ID."
          },
          "operation_id": {
            "type": "string",
            "format": "uuid",
            "description": "Operation ID."
          },
          "started_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the attempt started."
          },
          "success": {
            "type": "boolean",
            "description": "Whether the attempt was successful."
          }
        }
      },
      "AttributeComparison": {
        "type": "object",
        "description": "Attribute comparison between two identities.",
        "required": [
          "attribute",
          "is_different"
        ],
        "properties": {
          "attribute": {
            "type": "string"
          },
          "is_different": {
            "type": "boolean"
          },
          "value_a": {
            "nullable": true
          },
          "value_b": {
            "nullable": true
          }
        }
      },
      "AttributeDefinitionListResponse": {
        "type": "object",
        "description": "Response for listing attribute definitions.",
        "required": [
          "definitions",
          "total_count"
        ],
        "properties": {
          "definitions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AttributeDefinitionResponse"
            },
            "description": "List of attribute definitions."
          },
          "total_count": {
            "type": "integer",
            "format": "int64",
            "description": "Total count of matching definitions."
          }
        }
      },
      "AttributeDefinitionResponse": {
        "type": "object",
        "description": "Single attribute definition response.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "display_label",
          "data_type",
          "required",
          "sort_order",
          "is_active",
          "is_well_known",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "data_type": {
            "type": "string",
            "description": "Data type: string, number, boolean, date, json."
          },
          "default_value": {
            "description": "Default value.",
            "nullable": true
          },
          "display_label": {
            "type": "string",
            "description": "Human-readable display label."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the definition is active."
          },
          "is_well_known": {
            "type": "boolean",
            "description": "Whether this attribute was seeded from the well-known catalog (F081)."
          },
          "name": {
            "type": "string",
            "description": "Attribute name."
          },
          "required": {
            "type": "boolean",
            "description": "Whether this attribute is required."
          },
          "sort_order": {
            "type": "integer",
            "format": "int32",
            "description": "Display ordering."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant this definition belongs to."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          },
          "validation_rules": {
            "description": "Type-specific validation constraints.",
            "nullable": true
          },
          "well_known_slug": {
            "type": "string",
            "description": "Original well-known catalog slug for cross-tenant interoperability (F081).",
            "nullable": true
          }
        }
      },
      "AttributeFieldError": {
        "type": "object",
        "description": "A single attribute validation error with field name and description.",
        "required": [
          "attribute",
          "error"
        ],
        "properties": {
          "attribute": {
            "type": "string",
            "description": "The attribute name that failed validation."
          },
          "error": {
            "type": "string",
            "description": "Description of the validation failure."
          }
        }
      },
      "AttributeMappingsRequest": {
        "type": "object",
        "description": "Attribute mappings configuration.",
        "properties": {
          "computed": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ComputedMappingRequest"
            },
            "description": "Computed attributes from templates."
          },
          "persona_only": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Persona-only attribute names."
          },
          "propagate": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PropagateMappingRequest"
            },
            "description": "Attributes to propagate from physical user."
          }
        }
      },
      "AttributeMismatchCount": {
        "type": "object",
        "description": "Attribute mismatch count.",
        "required": [
          "attribute",
          "count"
        ],
        "properties": {
          "attribute": {
            "type": "string"
          },
          "count": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "AttributeResolutionRule": {
        "type": "string",
        "description": "Rule for automatic attribute resolution.",
        "enum": [
          "newest_wins",
          "oldest_wins",
          "prefer_non_null"
        ]
      },
      "AuditEventListResponse": {
        "type": "object",
        "description": "Paginated response for audit events.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LicenseAuditEntry"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "AuditEventResponse": {
        "type": "object",
        "description": "Audit event response DTO.",
        "required": [
          "id",
          "agent_id",
          "event_type",
          "timestamp"
        ],
        "properties": {
          "agent_id": {
            "type": "string",
            "format": "uuid",
            "description": "Agent ID."
          },
          "conversation_id": {
            "type": "string",
            "description": "Conversation ID.",
            "nullable": true
          },
          "decision": {
            "type": "string",
            "description": "Authorization decision.",
            "nullable": true
          },
          "decision_reason": {
            "type": "string",
            "description": "Decision reason.",
            "nullable": true
          },
          "event_type": {
            "type": "string",
            "description": "Event type: `tool_invocation`, authorization, `status_change`."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Event unique identifier."
          },
          "outcome": {
            "type": "string",
            "description": "Outcome: success, failure, error.",
            "nullable": true
          },
          "session_id": {
            "type": "string",
            "description": "Session ID.",
            "nullable": true
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Event timestamp."
          },
          "tool_name": {
            "type": "string",
            "description": "Tool name.",
            "nullable": true
          }
        }
      },
      "AuditListResponse": {
        "type": "object",
        "description": "List response for audit events with pagination.",
        "required": [
          "events",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "events": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AuditEventResponse"
            },
            "description": "List of audit events."
          },
          "limit": {
            "type": "integer",
            "format": "int32",
            "description": "Current limit."
          },
          "offset": {
            "type": "integer",
            "format": "int32",
            "description": "Current offset."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count (for pagination)."
          }
        }
      },
      "AuditLogEntryResponse": {
        "type": "object",
        "description": "Audit log entry response.",
        "required": [
          "id",
          "admin_user_id",
          "action",
          "resource_type",
          "created_at"
        ],
        "properties": {
          "action": {
            "type": "string"
          },
          "admin_user_email": {
            "type": "string",
            "nullable": true
          },
          "admin_user_id": {
            "type": "string",
            "format": "uuid"
          },
          "admin_user_name": {
            "type": "string",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "ip_address": {
            "type": "string",
            "nullable": true
          },
          "new_value": {
            "nullable": true
          },
          "old_value": {
            "nullable": true
          },
          "resource_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "resource_type": {
            "type": "string"
          },
          "user_agent": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "AuditLogResponse": {
        "type": "object",
        "description": "Audit log list response.",
        "required": [
          "entries",
          "total"
        ],
        "properties": {
          "entries": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AuditLogEntryResponse"
            }
          },
          "next_cursor": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "AuthenticationOptionsResponse": {
        "allOf": [
          {
            "type": "object",
            "description": "The authentication options to pass to `navigator.credentials.get()`.\nThis is the `WebAuthn` `PublicKeyCredentialRequestOptions` structure."
          },
          {
            "type": "object"
          }
        ],
        "description": "Response containing `WebAuthn` authentication options."
      },
      "AuthenticationSuccessResponse": {
        "type": "object",
        "description": "Response after successful `WebAuthn` authentication.",
        "required": [
          "message",
          "credential_id"
        ],
        "properties": {
          "credential_id": {
            "type": "string",
            "description": "The credential ID that was used."
          },
          "message": {
            "type": "string",
            "description": "Success message."
          }
        }
      },
      "AuthorizationContext": {
        "type": "object",
        "description": "Context for authorization decisions.",
        "properties": {
          "conversation_id": {
            "type": "string",
            "description": "Conversation/session ID for audit trail.",
            "nullable": true
          },
          "session_id": {
            "type": "string",
            "description": "Session ID for correlation.",
            "nullable": true
          },
          "user_context": {
            "allOf": [
              {
                "$ref": "#/components/schemas/UserContext"
              }
            ],
            "nullable": true
          },
          "user_instruction": {
            "type": "string",
            "description": "User instruction that triggered the tool call.",
            "nullable": true
          }
        }
      },
      "AuthorizeRequest": {
        "type": "object",
        "description": "Request for real-time authorization decision.",
        "required": [
          "agent_id",
          "tool"
        ],
        "properties": {
          "agent_id": {
            "type": "string",
            "format": "uuid",
            "description": "Agent ID requesting authorization."
          },
          "context": {
            "allOf": [
              {
                "$ref": "#/components/schemas/AuthorizationContext"
              }
            ],
            "nullable": true
          },
          "parameters": {
            "description": "Tool invocation parameters.",
            "nullable": true
          },
          "tool": {
            "type": "string",
            "description": "Tool name to authorize."
          }
        }
      },
      "AuthorizeResponse": {
        "type": "object",
        "description": "Authorization decision response.",
        "required": [
          "decision",
          "decision_id",
          "reason",
          "latency_ms"
        ],
        "properties": {
          "anomaly_warnings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AnomalyWarning"
            },
            "description": "Behavioral anomaly warnings detected during authorization.\nNon-blocking: request is still processed but anomalies are flagged.",
            "nullable": true
          },
          "approval_request_id": {
            "type": "string",
            "format": "uuid",
            "description": "Approval request ID (if decision is `require_approval`).",
            "nullable": true
          },
          "decision": {
            "type": "string",
            "description": "Authorization decision: allow, deny, `require_approval`."
          },
          "decision_id": {
            "type": "string",
            "format": "uuid",
            "description": "Decision ID for audit trail correlation."
          },
          "latency_ms": {
            "type": "number",
            "format": "double",
            "description": "Decision latency in milliseconds."
          },
          "reason": {
            "type": "string",
            "description": "Reason for the decision."
          }
        }
      },
      "AvailableMethodsResponse": {
        "type": "object",
        "description": "Response showing available passwordless methods for the tenant.",
        "required": [
          "magic_link",
          "email_otp"
        ],
        "properties": {
          "email_otp": {
            "type": "boolean",
            "description": "Whether email OTP authentication is available."
          },
          "magic_link": {
            "type": "boolean",
            "description": "Whether magic link authentication is available."
          }
        }
      },
      "Baseline": {
        "type": "object",
        "description": "A single baseline entry.",
        "required": [
          "baseline_type",
          "mean",
          "std_deviation",
          "sample_count"
        ],
        "properties": {
          "baseline_type": {
            "$ref": "#/components/schemas/BaselineType"
          },
          "mean": {
            "type": "number",
            "format": "double"
          },
          "percentiles": {
            "nullable": true
          },
          "sample_count": {
            "type": "integer",
            "format": "int32"
          },
          "std_deviation": {
            "type": "number",
            "format": "double"
          }
        }
      },
      "BaselineResponse": {
        "type": "object",
        "description": "Response for getting an agent's baseline.",
        "required": [
          "agent_id",
          "status",
          "baselines"
        ],
        "properties": {
          "agent_id": {
            "type": "string",
            "format": "uuid"
          },
          "baselines": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Baseline"
            }
          },
          "computed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "data_since": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/BaselineStatus"
          }
        }
      },
      "BatchCalculateResponse": {
        "type": "object",
        "description": "Response for batch score calculation.",
        "required": [
          "calculated",
          "errors",
          "duration_ms"
        ],
        "properties": {
          "calculated": {
            "type": "integer",
            "format": "int64",
            "description": "Number of scores calculated."
          },
          "duration_ms": {
            "type": "integer",
            "format": "int64",
            "description": "Time taken in milliseconds.",
            "minimum": 0
          },
          "errors": {
            "type": "integer",
            "format": "int64",
            "description": "Number of errors encountered."
          }
        }
      },
      "BatchMergeRequest": {
        "type": "object",
        "description": "Request for batch merge operation.",
        "required": [
          "candidate_ids",
          "entitlement_strategy",
          "attribute_rule"
        ],
        "properties": {
          "attribute_rule": {
            "$ref": "#/components/schemas/AttributeResolutionRule"
          },
          "candidate_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "entitlement_strategy": {
            "$ref": "#/components/schemas/GovEntitlementStrategy"
          },
          "min_confidence": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "skip_sod_violations": {
            "type": "boolean"
          }
        }
      },
      "BatchMergeResponse": {
        "type": "object",
        "description": "Response for batch merge initiation.",
        "required": [
          "job_id",
          "status",
          "total_pairs",
          "processed",
          "successful",
          "failed",
          "skipped"
        ],
        "properties": {
          "failed": {
            "type": "integer",
            "format": "int32"
          },
          "job_id": {
            "type": "string",
            "format": "uuid"
          },
          "processed": {
            "type": "integer",
            "format": "int32"
          },
          "skipped": {
            "type": "integer",
            "format": "int32"
          },
          "status": {
            "$ref": "#/components/schemas/BatchMergeStatus"
          },
          "successful": {
            "type": "integer",
            "format": "int32"
          },
          "total_pairs": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "BatchMergeStatus": {
        "type": "string",
        "description": "Status of batch merge job.",
        "enum": [
          "queued",
          "running",
          "completed",
          "failed"
        ]
      },
      "BatchSimulationListResponse": {
        "type": "object",
        "description": "Paginated list of batch simulations.",
        "required": [
          "simulations",
          "total",
          "offset",
          "limit"
        ],
        "properties": {
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Page size limit."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Current page offset."
          },
          "simulations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BatchSimulationResponse"
            },
            "description": "List of simulations."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count (for pagination)."
          }
        }
      },
      "BatchSimulationResponse": {
        "type": "object",
        "description": "Response containing a batch simulation.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "batch_type",
          "selection_mode",
          "total_users",
          "processed_users",
          "status",
          "has_scope_warning",
          "is_archived",
          "created_by",
          "created_at"
        ],
        "properties": {
          "applied_at": {
            "type": "string",
            "format": "date-time",
            "description": "When it was applied.",
            "nullable": true
          },
          "applied_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who applied the simulation.",
            "nullable": true
          },
          "batch_type": {
            "$ref": "#/components/schemas/BatchSimulationType"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When it was created."
          },
          "created_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who created the simulation."
          },
          "data_snapshot_at": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp when data was captured.",
            "nullable": true
          },
          "executed_at": {
            "type": "string",
            "format": "date-time",
            "description": "When it was executed.",
            "nullable": true
          },
          "has_scope_warning": {
            "type": "boolean",
            "description": "Whether this simulation exceeds scope warning threshold."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "impact_summary": {
            "allOf": [
              {
                "$ref": "#/components/schemas/BatchImpactSummary"
              }
            ],
            "nullable": true
          },
          "is_archived": {
            "type": "boolean",
            "description": "Whether the simulation is archived."
          },
          "name": {
            "type": "string",
            "description": "Simulation name."
          },
          "notes": {
            "type": "string",
            "description": "Notes/comments.",
            "nullable": true
          },
          "processed_users": {
            "type": "integer",
            "format": "int32",
            "description": "Users processed so far."
          },
          "selection_mode": {
            "$ref": "#/components/schemas/SelectionMode"
          },
          "status": {
            "$ref": "#/components/schemas/SimulationStatus"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "total_users": {
            "type": "integer",
            "format": "int32",
            "description": "Number of users in selection."
          }
        }
      },
      "BatchSimulationResultListResponse": {
        "type": "object",
        "description": "Paginated list of batch simulation results.",
        "required": [
          "results",
          "total",
          "offset",
          "limit"
        ],
        "properties": {
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Page size limit."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Current page offset."
          },
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BatchSimulationResultResponse"
            },
            "description": "List of results."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count (for pagination)."
          }
        }
      },
      "BatchSimulationResultResponse": {
        "type": "object",
        "description": "Response containing a batch simulation result (per-user impact).",
        "required": [
          "id",
          "simulation_id",
          "user_id",
          "access_gained",
          "access_lost",
          "warnings",
          "created_at"
        ],
        "properties": {
          "access_gained": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AccessItem"
            },
            "description": "Access that would be gained."
          },
          "access_lost": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AccessItem"
            },
            "description": "Access that would be lost."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When this result was created."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "simulation_id": {
            "type": "string",
            "format": "uuid",
            "description": "Reference to parent simulation."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "Affected user ID."
          },
          "warnings": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Warning messages."
          }
        }
      },
      "BatchSimulationType": {
        "type": "string",
        "description": "Type of batch simulation.",
        "enum": [
          "role_add",
          "role_remove",
          "entitlement_add",
          "entitlement_remove"
        ]
      },
      "BindingListResponse": {
        "type": "object",
        "description": "Paginated list of hook bindings.",
        "required": [
          "bindings",
          "total"
        ],
        "properties": {
          "bindings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BindingResponse"
            },
            "description": "List of bindings."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count for pagination."
          }
        }
      },
      "BindingResponse": {
        "type": "object",
        "description": "Hook binding response.",
        "required": [
          "id",
          "tenant_id",
          "script_id",
          "connector_id",
          "hook_phase",
          "operation_type",
          "execution_order",
          "failure_policy",
          "max_retries",
          "timeout_seconds",
          "enabled",
          "created_by",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "The bound connector ID."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the binding was created."
          },
          "created_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who created the binding."
          },
          "enabled": {
            "type": "boolean",
            "description": "Whether the binding is enabled."
          },
          "execution_order": {
            "type": "integer",
            "format": "int32",
            "description": "Execution order."
          },
          "failure_policy": {
            "type": "string",
            "description": "Failure policy."
          },
          "hook_phase": {
            "type": "string",
            "description": "The provisioning lifecycle phase."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "max_retries": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum retry attempts."
          },
          "operation_type": {
            "type": "string",
            "description": "The operation type."
          },
          "script_id": {
            "type": "string",
            "format": "uuid",
            "description": "The bound script ID."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "timeout_seconds": {
            "type": "integer",
            "format": "int32",
            "description": "Timeout in seconds."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the binding was last updated."
          }
        }
      },
      "BirthrightPolicyListResponse": {
        "type": "object",
        "description": "Paginated list of birthright policies.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BirthrightPolicyResponse"
            },
            "description": "List of policies."
          },
          "page": {
            "type": "integer",
            "format": "int64",
            "description": "Page number."
          },
          "page_size": {
            "type": "integer",
            "format": "int64",
            "description": "Page size."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "BirthrightPolicyResponse": {
        "type": "object",
        "description": "Birthright policy response.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "priority",
          "conditions",
          "entitlement_ids",
          "status",
          "evaluation_mode",
          "grace_period_days",
          "created_by",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "conditions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PolicyConditionResponse"
            },
            "description": "Conditions that must match."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the policy was created."
          },
          "created_by": {
            "type": "string",
            "format": "uuid",
            "description": "Admin who created the policy."
          },
          "description": {
            "type": "string",
            "description": "Policy description.",
            "nullable": true
          },
          "entitlement_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Entitlement IDs to grant."
          },
          "evaluation_mode": {
            "$ref": "#/components/schemas/EvaluationMode"
          },
          "grace_period_days": {
            "type": "integer",
            "format": "int32",
            "description": "Grace period in days for revocation."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "name": {
            "type": "string",
            "description": "Policy display name."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority for evaluation."
          },
          "status": {
            "$ref": "#/components/schemas/BirthrightPolicyStatus"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the policy was last updated."
          }
        }
      },
      "BirthrightPolicyStatus": {
        "type": "string",
        "description": "Status for birthright policies.",
        "enum": [
          "active",
          "inactive",
          "archived"
        ]
      },
      "BrandingResponse": {
        "type": "object",
        "description": "Response for tenant branding configuration.",
        "properties": {
          "accent_color": {
            "type": "string",
            "nullable": true
          },
          "background_color": {
            "type": "string",
            "nullable": true
          },
          "custom_css": {
            "type": "string",
            "nullable": true
          },
          "email_logo_url": {
            "type": "string",
            "nullable": true
          },
          "favicon_url": {
            "type": "string",
            "nullable": true
          },
          "font_family": {
            "type": "string",
            "nullable": true
          },
          "footer_text": {
            "type": "string",
            "nullable": true
          },
          "login_page_background_url": {
            "type": "string",
            "nullable": true
          },
          "login_page_subtitle": {
            "type": "string",
            "nullable": true
          },
          "login_page_title": {
            "type": "string",
            "nullable": true
          },
          "logo_dark_url": {
            "type": "string",
            "nullable": true
          },
          "logo_url": {
            "type": "string",
            "nullable": true
          },
          "primary_color": {
            "type": "string",
            "nullable": true
          },
          "privacy_policy_url": {
            "type": "string",
            "nullable": true
          },
          "secondary_color": {
            "type": "string",
            "nullable": true
          },
          "support_url": {
            "type": "string",
            "nullable": true
          },
          "terms_of_service_url": {
            "type": "string",
            "nullable": true
          },
          "text_color": {
            "type": "string",
            "nullable": true
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          }
        }
      },
      "BulkAcknowledgeResponse": {
        "type": "object",
        "description": "Response for bulk acknowledgement.",
        "required": [
          "acknowledged_count"
        ],
        "properties": {
          "acknowledged_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of alerts acknowledged.",
            "minimum": 0
          }
        }
      },
      "BulkAssignLicenseRequest": {
        "type": "object",
        "description": "Request for bulk license assignment.",
        "required": [
          "license_pool_id",
          "user_ids"
        ],
        "properties": {
          "license_pool_id": {
            "type": "string",
            "format": "uuid",
            "description": "The license pool to assign from."
          },
          "source": {
            "$ref": "#/components/schemas/LicenseAssignmentSource"
          },
          "user_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "List of user IDs to assign licenses to."
          }
        }
      },
      "BulkAssignmentFailureResponse": {
        "type": "object",
        "description": "Bulk assignment failure detail.",
        "required": [
          "target_id",
          "reason"
        ],
        "properties": {
          "reason": {
            "type": "string",
            "description": "The reason for the failure."
          },
          "target_id": {
            "type": "string",
            "format": "uuid",
            "description": "The target ID that failed."
          }
        }
      },
      "BulkAssignmentResponse": {
        "type": "object",
        "description": "Response for bulk assignment creation.",
        "required": [
          "successful",
          "failed",
          "total_processed",
          "success_count",
          "failure_count"
        ],
        "properties": {
          "failed": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BulkAssignmentFailureResponse"
            },
            "description": "Details of failed assignments."
          },
          "failure_count": {
            "type": "integer",
            "description": "Number of failed assignments.",
            "minimum": 0
          },
          "success_count": {
            "type": "integer",
            "description": "Number of successful assignments.",
            "minimum": 0
          },
          "successful": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "IDs of successfully created assignments."
          },
          "total_processed": {
            "type": "integer",
            "description": "Total number of targets processed.",
            "minimum": 0
          }
        }
      },
      "BulkCertificationError": {
        "type": "object",
        "description": "Error for a single item in bulk operation.",
        "required": [
          "item_id",
          "error"
        ],
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message."
          },
          "item_id": {
            "type": "string",
            "format": "uuid",
            "description": "The item ID that failed."
          }
        }
      },
      "BulkCreateAssignmentsRequest": {
        "type": "object",
        "description": "Request to create multiple assignments at once.",
        "required": [
          "entitlement_id",
          "target_type",
          "target_ids"
        ],
        "properties": {
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "The entitlement to assign."
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the assignments expire (optional).",
            "nullable": true
          },
          "justification": {
            "type": "string",
            "description": "Business justification for the assignments.",
            "nullable": true
          },
          "target_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "The target IDs (`user_ids` or `group_ids`)."
          },
          "target_type": {
            "$ref": "#/components/schemas/GovAssignmentTargetType"
          }
        }
      },
      "BulkDecisionFailure": {
        "type": "object",
        "description": "Individual failure in bulk decision.",
        "required": [
          "certification_id",
          "error"
        ],
        "properties": {
          "certification_id": {
            "type": "string",
            "format": "uuid",
            "description": "Certification ID that failed."
          },
          "error": {
            "type": "string",
            "description": "Error message."
          }
        }
      },
      "BulkDecisionRequest": {
        "type": "object",
        "description": "Request for bulk certification decisions.",
        "required": [
          "item_ids",
          "decision"
        ],
        "properties": {
          "comment": {
            "type": "string",
            "nullable": true
          },
          "decision": {
            "type": "string"
          },
          "item_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "BulkDecisionResponse": {
        "type": "object",
        "description": "Bulk decision response.",
        "required": [
          "succeeded",
          "failed",
          "total_succeeded",
          "total_failed"
        ],
        "properties": {
          "failed": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BulkFailureResponse"
            }
          },
          "succeeded": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CertificationItemResponse"
            }
          },
          "total_failed": {
            "type": "integer",
            "minimum": 0
          },
          "total_succeeded": {
            "type": "integer",
            "minimum": 0
          }
        }
      },
      "BulkNhiCertificationDecisionRequest": {
        "type": "object",
        "description": "Request for bulk certification decision.",
        "required": [
          "item_ids",
          "decision"
        ],
        "properties": {
          "comment": {
            "type": "string",
            "description": "Comment for all items.",
            "nullable": true
          },
          "decision": {
            "$ref": "#/components/schemas/NhiCertificationDecision"
          },
          "item_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "IDs of certification items to process."
          }
        }
      },
      "BulkNhiCertificationResult": {
        "type": "object",
        "description": "Result of bulk certification decision.",
        "required": [
          "succeeded",
          "failed"
        ],
        "properties": {
          "failed": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BulkCertificationError"
            },
            "description": "Items that failed with their error messages."
          },
          "succeeded": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "IDs that were successfully processed."
          }
        }
      },
      "BulkOperationFailure": {
        "type": "object",
        "description": "A single failure in a bulk operation.",
        "required": [
          "item_id",
          "error"
        ],
        "properties": {
          "error": {
            "type": "string"
          },
          "item_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "BulkOperationResult": {
        "type": "object",
        "description": "Result of a bulk operation.",
        "required": [
          "success_count",
          "failure_count",
          "failures"
        ],
        "properties": {
          "failure_count": {
            "type": "integer",
            "format": "int32"
          },
          "failures": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BulkOperationFailure"
            }
          },
          "success_count": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "BulkReclaimLicenseRequest": {
        "type": "object",
        "description": "Request for bulk license reclamation.",
        "required": [
          "license_pool_id",
          "assignment_ids",
          "reason"
        ],
        "properties": {
          "assignment_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "List of assignment IDs to reclaim."
          },
          "license_pool_id": {
            "type": "string",
            "format": "uuid",
            "description": "The license pool to reclaim from."
          },
          "reason": {
            "type": "string",
            "description": "Reason for reclamation."
          }
        }
      },
      "BulkRemediateItem": {
        "type": "object",
        "description": "Single item in bulk remediation request.",
        "required": [
          "discrepancy_id",
          "action"
        ],
        "properties": {
          "action": {
            "type": "string"
          },
          "direction": {
            "type": "string",
            "nullable": true
          },
          "discrepancy_id": {
            "type": "string",
            "format": "uuid"
          },
          "identity_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          }
        }
      },
      "BulkRemediateRequest": {
        "type": "object",
        "description": "Request for bulk remediation.",
        "required": [
          "items"
        ],
        "properties": {
          "dry_run": {
            "type": "boolean"
          },
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BulkRemediateItem"
            }
          }
        }
      },
      "BulkRemediateResponse": {
        "type": "object",
        "description": "Response for bulk remediation.",
        "required": [
          "succeeded",
          "failed",
          "errors"
        ],
        "properties": {
          "errors": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BulkRemediationError"
            },
            "description": "Details of failures."
          },
          "failed": {
            "type": "integer",
            "format": "int64",
            "description": "Number of failed remediations."
          },
          "succeeded": {
            "type": "integer",
            "format": "int64",
            "description": "Number of successful remediations."
          }
        }
      },
      "BulkRemediationAction": {
        "type": "string",
        "description": "Actions available for bulk remediation.",
        "enum": [
          "disable",
          "dismiss",
          "reassign"
        ]
      },
      "BulkRemediationResponse": {
        "type": "object",
        "description": "Response for bulk remediation.",
        "required": [
          "results",
          "summary"
        ],
        "properties": {
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RemediationResponse"
            }
          },
          "summary": {
            "$ref": "#/components/schemas/BulkRemediationSummary"
          }
        }
      },
      "BulkRemediationSummary": {
        "type": "object",
        "description": "Summary of bulk remediation.",
        "required": [
          "total",
          "succeeded",
          "failed"
        ],
        "properties": {
          "failed": {
            "type": "integer",
            "minimum": 0
          },
          "succeeded": {
            "type": "integer",
            "minimum": 0
          },
          "total": {
            "type": "integer",
            "minimum": 0
          }
        }
      },
      "BulkUpdateFailure": {
        "type": "object",
        "description": "Details about a single failure in a bulk update.",
        "required": [
          "user_id",
          "error"
        ],
        "properties": {
          "error": {
            "type": "string",
            "description": "Error description."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID that failed."
          }
        }
      },
      "BulkUpdateFilter": {
        "type": "object",
        "description": "Filter criteria for bulk attribute updates.",
        "properties": {
          "current_value": {
            "description": "Only update users whose attribute currently has this value.",
            "nullable": true
          },
          "user_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Specific user IDs to update.",
            "nullable": true
          }
        }
      },
      "BulkUpdateRequest": {
        "type": "object",
        "description": "Request for bulk updating a custom attribute across users.",
        "required": [
          "attribute_name",
          "new_value",
          "filter"
        ],
        "properties": {
          "attribute_name": {
            "type": "string",
            "description": "Name of the attribute to update."
          },
          "filter": {
            "$ref": "#/components/schemas/BulkUpdateFilter"
          },
          "new_value": {
            "description": "New value to set for the attribute."
          }
        }
      },
      "BulkUpdateResponse": {
        "type": "object",
        "description": "Response for a bulk attribute update operation.",
        "required": [
          "total_matched",
          "total_updated",
          "total_failed"
        ],
        "properties": {
          "failures": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BulkUpdateFailure"
            },
            "description": "Individual failure details."
          },
          "total_failed": {
            "type": "integer",
            "format": "int64",
            "description": "Number of users that failed validation."
          },
          "total_matched": {
            "type": "integer",
            "format": "int64",
            "description": "Number of users matched by the filter."
          },
          "total_updated": {
            "type": "integer",
            "format": "int64",
            "description": "Number of users successfully updated."
          }
        }
      },
      "CalculateMetricsRequest": {
        "type": "object",
        "description": "Request to calculate metrics for roles.",
        "properties": {
          "role_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "nullable": true
          }
        }
      },
      "CalculateScoreRequest": {
        "type": "object",
        "description": "Request to calculate risk score.",
        "properties": {
          "include_peer_comparison": {
            "type": "boolean",
            "description": "Whether to include peer comparison."
          }
        }
      },
      "CampaignFilterRequest": {
        "type": "object",
        "description": "Filter criteria in request.",
        "properties": {
          "inactive_days": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "risk_min": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          }
        }
      },
      "CampaignListResponse": {
        "type": "object",
        "description": "Campaign list response.",
        "required": [
          "items",
          "total",
          "page",
          "per_page"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CampaignResponse"
            }
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "per_page": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "CampaignProgressResponse": {
        "type": "object",
        "description": "Campaign progress summary.",
        "required": [
          "total_items",
          "completed_items",
          "pending_items",
          "approved_count",
          "revoked_count",
          "skipped_count",
          "completion_percentage"
        ],
        "properties": {
          "approved_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of approved items."
          },
          "by_reviewer": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ReviewerProgressResponse"
            },
            "description": "Progress by reviewer.",
            "nullable": true
          },
          "completed_items": {
            "type": "integer",
            "format": "int64",
            "description": "Number of completed items (decided)."
          },
          "completion_percentage": {
            "type": "number",
            "format": "double",
            "description": "Completion percentage."
          },
          "pending_items": {
            "type": "integer",
            "format": "int64",
            "description": "Number of pending items."
          },
          "revoked_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of revoked items."
          },
          "skipped_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of skipped items."
          },
          "total_items": {
            "type": "integer",
            "format": "int64",
            "description": "Total number of items."
          }
        }
      },
      "CampaignResponse": {
        "type": "object",
        "description": "Campaign response.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "nhi_types",
          "status",
          "reviewer_id",
          "due_date",
          "created_at"
        ],
        "properties": {
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "due_date": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "item_counts": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ItemCountsResponse"
              }
            ],
            "nullable": true
          },
          "launched_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "name": {
            "type": "string"
          },
          "nhi_types": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "reviewer_id": {
            "type": "string",
            "format": "uuid"
          },
          "status": {
            "type": "string"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "CampaignSummaryResponse": {
        "type": "object",
        "description": "Campaign summary response.",
        "required": [
          "campaign_id",
          "campaign_name",
          "status",
          "due_date",
          "item_counts",
          "by_type",
          "progress_percent"
        ],
        "properties": {
          "by_type": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NhiTypeCountsResponse"
            }
          },
          "campaign_id": {
            "type": "string",
            "format": "uuid"
          },
          "campaign_name": {
            "type": "string"
          },
          "due_date": {
            "type": "string",
            "format": "date-time"
          },
          "item_counts": {
            "$ref": "#/components/schemas/ItemCountsResponse"
          },
          "progress_percent": {
            "type": "integer",
            "format": "int32"
          },
          "status": {
            "type": "string"
          }
        }
      },
      "CampaignWithProgressResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/CampaignResponse"
          },
          {
            "type": "object",
            "required": [
              "progress"
            ],
            "properties": {
              "progress": {
                "$ref": "#/components/schemas/CampaignProgressResponse"
              }
            }
          }
        ],
        "description": "Campaign response with progress information."
      },
      "CancelA2aTaskResponse": {
        "type": "object",
        "description": "Response for POST /a2a/tasks/{id}/cancel.",
        "required": [
          "task_id",
          "state",
          "cancelled_at"
        ],
        "properties": {
          "cancelled_at": {
            "type": "string",
            "format": "date-time",
            "description": "Cancellation timestamp."
          },
          "state": {
            "type": "string",
            "description": "New state (always \"cancelled\")."
          },
          "task_id": {
            "type": "string",
            "format": "uuid",
            "description": "Task identifier."
          }
        }
      },
      "CancelEscalationResponse": {
        "type": "object",
        "description": "Response for cancel escalation operation.",
        "required": [
          "success",
          "previous_level",
          "current_assignee_id",
          "message"
        ],
        "properties": {
          "current_assignee_id": {
            "type": "string",
            "format": "uuid",
            "description": "The user who currently has the work item (kept as assignee)."
          },
          "message": {
            "type": "string",
            "description": "Message describing the result."
          },
          "previous_level": {
            "type": "integer",
            "format": "int32",
            "description": "The escalation level that was active before cancellation."
          },
          "success": {
            "type": "boolean",
            "description": "Whether the cancellation was successful."
          }
        }
      },
      "CancelManualTaskRequest": {
        "type": "object",
        "description": "Request to cancel a manual provisioning task.",
        "required": [
          "reason"
        ],
        "properties": {
          "reason": {
            "type": "string",
            "description": "Cancellation reason."
          }
        }
      },
      "CandidatePromotionStatus": {
        "type": "string",
        "description": "Promotion status for a role candidate.",
        "enum": [
          "pending",
          "promoted",
          "dismissed"
        ]
      },
      "CascadeFailure": {
        "type": "object",
        "description": "A failure during cascade.",
        "required": [
          "role_id",
          "error",
          "failed_at"
        ],
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message."
          },
          "failed_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the failure occurred."
          },
          "role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Role ID that failed."
          }
        }
      },
      "CascadeStatusResponse": {
        "type": "object",
        "description": "Cascade status response.",
        "required": [
          "meta_role_id",
          "in_progress",
          "processed_count",
          "remaining_count",
          "success_count",
          "failure_count"
        ],
        "properties": {
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the cascade completed.",
            "nullable": true
          },
          "failure_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of failures."
          },
          "failures": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CascadeFailure"
            },
            "description": "Failure details.",
            "nullable": true
          },
          "in_progress": {
            "type": "boolean",
            "description": "Whether cascade is in progress."
          },
          "meta_role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Meta-role ID."
          },
          "processed_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of roles processed."
          },
          "remaining_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of roles remaining."
          },
          "started_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the cascade started.",
            "nullable": true
          },
          "success_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of successful applications."
          }
        }
      },
      "CategorySummaryResponse": {
        "type": "object",
        "description": "Category summary.",
        "required": [
          "name",
          "permission_count"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "permission_count": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "CertCampaignStatus": {
        "type": "string",
        "description": "Status for certification campaigns.",
        "enum": [
          "draft",
          "active",
          "completed",
          "cancelled",
          "overdue"
        ]
      },
      "CertDecisionType": {
        "type": "string",
        "description": "Decision type for certification items.",
        "enum": [
          "approved",
          "revoked"
        ]
      },
      "CertItemStatus": {
        "type": "string",
        "description": "Status for certification items.",
        "enum": [
          "pending",
          "approved",
          "revoked",
          "skipped"
        ]
      },
      "CertReviewerType": {
        "type": "string",
        "description": "Reviewer type for certification campaigns.",
        "enum": [
          "user_manager",
          "application_owner",
          "entitlement_owner",
          "specific_users"
        ]
      },
      "CertScopeType": {
        "type": "string",
        "description": "Scope type for certification campaigns.",
        "enum": [
          "all_users",
          "department",
          "application",
          "entitlement"
        ]
      },
      "CertificateInfo": {
        "type": "object",
        "description": "Public certificate info (without private key)",
        "required": [
          "id",
          "key_id",
          "subject_dn",
          "issuer_dn",
          "not_before",
          "not_after",
          "is_active",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_active": {
            "type": "boolean"
          },
          "issuer_dn": {
            "type": "string"
          },
          "key_id": {
            "type": "string"
          },
          "not_after": {
            "type": "string",
            "format": "date-time"
          },
          "not_before": {
            "type": "string",
            "format": "date-time"
          },
          "subject_dn": {
            "type": "string"
          }
        }
      },
      "CertificateListResponse": {
        "type": "object",
        "description": "Certificate list response",
        "required": [
          "items"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CertificateInfo"
            }
          }
        }
      },
      "CertificationItemResponse": {
        "type": "object",
        "description": "Certification item response.",
        "required": [
          "id",
          "campaign_id",
          "nhi_id",
          "nhi_type",
          "nhi_name",
          "reviewer_id",
          "status",
          "created_at"
        ],
        "properties": {
          "campaign_id": {
            "type": "string",
            "format": "uuid"
          },
          "comment": {
            "type": "string",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "decided_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "decided_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "decision": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "nhi_id": {
            "type": "string",
            "format": "uuid"
          },
          "nhi_name": {
            "type": "string"
          },
          "nhi_type": {
            "type": "string"
          },
          "reviewer_id": {
            "type": "string",
            "format": "uuid"
          },
          "status": {
            "type": "string"
          }
        }
      },
      "CertifyNhiResponse": {
        "type": "object",
        "description": "Response for certify operation.",
        "required": [
          "nhi",
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Message."
          },
          "nhi": {
            "$ref": "#/components/schemas/NhiResponse"
          }
        }
      },
      "CheckPermissionRequest": {
        "type": "object",
        "description": "Check permission request body.",
        "required": [
          "user_id",
          "permission"
        ],
        "properties": {
          "permission": {
            "type": "string"
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "CheckPermissionResponse": {
        "type": "object",
        "description": "Check permission response body.",
        "required": [
          "has_permission",
          "is_super_admin"
        ],
        "properties": {
          "has_permission": {
            "type": "boolean"
          },
          "is_super_admin": {
            "type": "boolean"
          }
        }
      },
      "ChildRoleSummary": {
        "type": "object",
        "description": "Summary of a child role for display.",
        "required": [
          "id",
          "name"
        ],
        "properties": {
          "application_id": {
            "type": "string",
            "format": "uuid",
            "description": "Application ID.",
            "nullable": true
          },
          "application_name": {
            "type": "string",
            "description": "Application name.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Role ID."
          },
          "name": {
            "type": "string",
            "description": "Role name."
          }
        }
      },
      "ClaimMappingConfig": {
        "type": "object",
        "description": "Claim mapping configuration.",
        "properties": {
          "mappings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ClaimMappingEntry"
            }
          },
          "name_id": {
            "allOf": [
              {
                "$ref": "#/components/schemas/NameIdConfig"
              }
            ],
            "nullable": true
          }
        }
      },
      "ClaimMappingEntry": {
        "type": "object",
        "description": "A single claim mapping entry.",
        "required": [
          "source",
          "target"
        ],
        "properties": {
          "default": {
            "type": "string",
            "nullable": true
          },
          "group_mapping": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            },
            "nullable": true
          },
          "required": {
            "type": "boolean"
          },
          "source": {
            "type": "string"
          },
          "target": {
            "type": "string"
          },
          "transform": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "CleanupResponse": {
        "type": "object",
        "description": "Response for cleanup operation.",
        "required": [
          "deleted_count"
        ],
        "properties": {
          "deleted_count": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ClientListResponse": {
        "type": "object",
        "description": "`OAuth2` client list response.",
        "required": [
          "clients",
          "total"
        ],
        "properties": {
          "clients": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ClientResponse"
            },
            "description": "List of clients."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count."
          }
        }
      },
      "ClientResponse": {
        "type": "object",
        "description": "`OAuth2` client response.",
        "required": [
          "id",
          "client_id",
          "name",
          "client_type",
          "redirect_uris",
          "grant_types",
          "scopes",
          "is_active",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "client_id": {
            "type": "string",
            "description": "Public client ID."
          },
          "client_type": {
            "$ref": "#/components/schemas/ClientType"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "grant_types": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Allowed grant types."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Internal ID."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the client is active."
          },
          "name": {
            "type": "string",
            "description": "Human-readable name."
          },
          "redirect_uris": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Allowed redirect URIs."
          },
          "scopes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Allowed scopes."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          }
        }
      },
      "ClientType": {
        "type": "string",
        "description": "`OAuth2` client type.",
        "enum": [
          "confidential",
          "public"
        ]
      },
      "CloneReportTemplateRequest": {
        "type": "object",
        "description": "Request to clone a report template.",
        "required": [
          "name"
        ],
        "properties": {
          "description": {
            "type": "string",
            "nullable": true
          },
          "name": {
            "type": "string"
          }
        }
      },
      "ColumnDefinition": {
        "type": "object",
        "description": "A column definition within a template.",
        "required": [
          "field",
          "label"
        ],
        "properties": {
          "field": {
            "type": "string"
          },
          "label": {
            "type": "string"
          },
          "sortable": {
            "type": "boolean"
          }
        }
      },
      "ComparisonType": {
        "type": "string",
        "description": "Comparison type for simulation comparisons.",
        "enum": [
          "simulation_vs_simulation",
          "simulation_vs_current"
        ]
      },
      "CompleteManualTaskRequest": {
        "type": "object",
        "description": "Request to manually complete a task.",
        "required": [
          "completion_notes"
        ],
        "properties": {
          "completion_notes": {
            "type": "string",
            "description": "Completion notes."
          },
          "external_reference": {
            "type": "string",
            "description": "External reference (ticket number, etc.).",
            "nullable": true
          },
          "result_data": {
            "description": "Additional result data.",
            "nullable": true
          },
          "success": {
            "type": "boolean",
            "description": "Whether the task was successful."
          }
        }
      },
      "ComplianceStandard": {
        "type": "string",
        "description": "Compliance standard for the template.",
        "enum": [
          "sox",
          "gdpr",
          "hipaa",
          "custom"
        ]
      },
      "ComplianceStatus": {
        "type": "object",
        "description": "Compliance status for security standards.",
        "required": [
          "owasp_agentic",
          "a2a_protocol",
          "mcp_oauth"
        ],
        "properties": {
          "a2a_protocol": {
            "type": "boolean",
            "description": "A2A Protocol compliance (check 3 passes)."
          },
          "mcp_oauth": {
            "type": "boolean",
            "description": "MCP OAuth 2.1 compliance (check 1 passes with <= 900s)."
          },
          "owasp_agentic": {
            "$ref": "#/components/schemas/OwaspAgenticCompliance"
          }
        }
      },
      "ComputedMappingRequest": {
        "type": "object",
        "description": "Computed attribute mapping.",
        "required": [
          "target",
          "template"
        ],
        "properties": {
          "target": {
            "type": "string",
            "description": "Target attribute name on persona."
          },
          "template": {
            "type": "string",
            "description": "Handlebars template for computing value."
          },
          "variables": {
            "type": "object",
            "description": "Static variables for template.",
            "additionalProperties": {}
          }
        }
      },
      "ConfigureSemiManualRequest": {
        "type": "object",
        "description": "Request to configure an application as semi-manual.",
        "required": [
          "is_semi_manual"
        ],
        "properties": {
          "is_semi_manual": {
            "type": "boolean",
            "description": "Whether the application requires manual provisioning."
          },
          "requires_approval_before_ticket": {
            "type": "boolean",
            "description": "Whether approval must complete before ticket creation.\nWhen true, tickets are only created after access request approval completes."
          },
          "sla_policy_id": {
            "type": "string",
            "format": "uuid",
            "description": "Default SLA policy for this application.",
            "nullable": true
          },
          "ticketing_config_id": {
            "type": "string",
            "format": "uuid",
            "description": "Default ticketing configuration for this application.",
            "nullable": true
          }
        }
      },
      "ConfigureStepEscalationRequest": {
        "type": "object",
        "description": "Request to configure escalation for an approval step.",
        "required": [
          "timeout_secs"
        ],
        "properties": {
          "final_fallback": {
            "allOf": [
              {
                "$ref": "#/components/schemas/FinalFallbackAction"
              }
            ],
            "nullable": true
          },
          "timeout_secs": {
            "type": "integer",
            "format": "int64",
            "description": "Timeout in seconds before escalation (minimum 60 seconds)."
          },
          "warning_threshold_secs": {
            "type": "integer",
            "format": "int64",
            "description": "Warning threshold in seconds before timeout (optional).",
            "nullable": true
          }
        }
      },
      "ConfirmCaseRequest": {
        "type": "object",
        "description": "Request to confirm a correlation case with a specific candidate.",
        "required": [
          "candidate_id"
        ],
        "properties": {
          "candidate_id": {
            "type": "string",
            "format": "uuid",
            "description": "The candidate identity to confirm as the match."
          },
          "reason": {
            "type": "string",
            "description": "Optional reason for the confirmation.",
            "nullable": true
          }
        }
      },
      "ConfirmManualTaskRequest": {
        "type": "object",
        "description": "Request to confirm a manual task.",
        "properties": {
          "notes": {
            "type": "string",
            "description": "Optional completion notes.",
            "nullable": true
          }
        }
      },
      "ConflictListResponse": {
        "type": "object",
        "description": "List response for conflicts.",
        "required": [
          "conflicts",
          "pending_count",
          "offset",
          "limit"
        ],
        "properties": {
          "conflicts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ConflictResponse"
            },
            "description": "List of conflicts."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Applied limit."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Current offset."
          },
          "pending_count": {
            "type": "integer",
            "format": "int64",
            "description": "Total pending conflicts count."
          }
        }
      },
      "ConflictResponse": {
        "type": "object",
        "description": "Conflict response for the API.",
        "required": [
          "id",
          "operation_id",
          "conflict_type",
          "affected_attributes",
          "detected_at",
          "resolution_strategy",
          "is_pending"
        ],
        "properties": {
          "affected_attributes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Affected attributes."
          },
          "conflict_type": {
            "type": "string",
            "description": "Type of conflict."
          },
          "conflicting_operation_id": {
            "type": "string",
            "format": "uuid",
            "description": "Conflicting operation ID (if known).",
            "nullable": true
          },
          "detected_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the conflict was detected."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Conflict ID."
          },
          "is_pending": {
            "type": "boolean",
            "description": "Whether the conflict is pending resolution."
          },
          "notes": {
            "type": "string",
            "description": "Notes about the resolution.",
            "nullable": true
          },
          "operation_id": {
            "type": "string",
            "format": "uuid",
            "description": "Primary operation ID."
          },
          "resolution_outcome": {
            "type": "string",
            "description": "Outcome of the resolution.",
            "nullable": true
          },
          "resolution_strategy": {
            "type": "string",
            "description": "Resolution strategy used."
          },
          "resolved_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the conflict was resolved.",
            "nullable": true
          },
          "resolved_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who resolved the conflict.",
            "nullable": true
          }
        }
      },
      "ConnectionTestResponse": {
        "type": "object",
        "description": "Response for connection test.",
        "required": [
          "success",
          "tested_at"
        ],
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message if failed.",
            "nullable": true
          },
          "success": {
            "type": "boolean",
            "description": "Whether the test succeeded."
          },
          "tested_at": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp of the test."
          }
        }
      },
      "ConnectorListResponse": {
        "type": "object",
        "description": "Response for listing connectors.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ConnectorSummaryResponse"
            },
            "description": "List of connectors."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Requested limit."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Requested offset."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count (for pagination)."
          }
        }
      },
      "ConnectorResponse": {
        "type": "object",
        "description": "Response for a single connector.",
        "required": [
          "id",
          "name",
          "connector_type",
          "config",
          "status",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "config": {
            "description": "Non-sensitive configuration."
          },
          "connector_type": {
            "$ref": "#/components/schemas/ConnectorType"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "description": {
            "type": "string",
            "description": "Description.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Connector ID."
          },
          "last_connection_test": {
            "type": "string",
            "format": "date-time",
            "description": "Last connection test timestamp.",
            "nullable": true
          },
          "last_error": {
            "type": "string",
            "description": "Last error message.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "status": {
            "$ref": "#/components/schemas/ConnectorStatus"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          }
        }
      },
      "ConnectorStatus": {
        "type": "string",
        "description": "Connector status.",
        "enum": [
          "active",
          "inactive",
          "error"
        ]
      },
      "ConnectorSummaryResponse": {
        "type": "object",
        "description": "Summary response for connector listing.",
        "required": [
          "id",
          "name",
          "connector_type",
          "status",
          "created_at"
        ],
        "properties": {
          "connector_type": {
            "$ref": "#/components/schemas/ConnectorType"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Connector ID."
          },
          "last_connection_test": {
            "type": "string",
            "format": "date-time",
            "description": "Last connection test timestamp.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "status": {
            "$ref": "#/components/schemas/ConnectorStatus"
          }
        }
      },
      "ConnectorType": {
        "type": "string",
        "description": "Connector type classification.",
        "enum": [
          "ldap",
          "database",
          "rest"
        ]
      },
      "ConsentRequest": {
        "type": "object",
        "description": "Consent request (submitted by user).",
        "required": [
          "client_id",
          "redirect_uri",
          "scope",
          "state",
          "code_challenge",
          "code_challenge_method",
          "approved"
        ],
        "properties": {
          "approved": {
            "type": "boolean",
            "description": "Whether user approved the request."
          },
          "client_id": {
            "type": "string",
            "description": "Client ID."
          },
          "code_challenge": {
            "type": "string",
            "description": "PKCE code challenge."
          },
          "code_challenge_method": {
            "type": "string",
            "description": "PKCE code challenge method."
          },
          "csrf_sig": {
            "type": "string",
            "description": "CSRF signature (F082-US6).",
            "nullable": true
          },
          "csrf_token": {
            "type": "string",
            "description": "CSRF token (F082-US6).",
            "nullable": true
          },
          "nonce": {
            "type": "string",
            "description": "OIDC nonce.",
            "nullable": true
          },
          "redirect_uri": {
            "type": "string",
            "description": "Redirect URI."
          },
          "scope": {
            "type": "string",
            "description": "Requested scopes."
          },
          "state": {
            "type": "string",
            "description": "State."
          }
        }
      },
      "ConsolidationStatus": {
        "type": "string",
        "description": "Status for a consolidation suggestion.",
        "enum": [
          "pending",
          "merged",
          "dismissed"
        ]
      },
      "ConsolidationSuggestionListResponse": {
        "type": "object",
        "description": "List response for consolidation suggestions.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ConsolidationSuggestionResponse"
            }
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "page_size": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ConsolidationSuggestionResponse": {
        "type": "object",
        "description": "Response for a consolidation suggestion.",
        "required": [
          "id",
          "job_id",
          "role_a_id",
          "role_b_id",
          "overlap_percent",
          "shared_entitlements",
          "unique_to_a",
          "unique_to_b",
          "status",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "dismissed_reason": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "job_id": {
            "type": "string",
            "format": "uuid"
          },
          "overlap_percent": {
            "type": "number",
            "format": "double"
          },
          "role_a_id": {
            "type": "string",
            "format": "uuid"
          },
          "role_b_id": {
            "type": "string",
            "format": "uuid"
          },
          "shared_entitlements": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "status": {
            "$ref": "#/components/schemas/ConsolidationStatus"
          },
          "unique_to_a": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "unique_to_b": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "ContextSessionListResponse": {
        "type": "object",
        "description": "List of context sessions response.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ContextSessionSummary"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ContextSessionSummary": {
        "type": "object",
        "description": "Summary of a context session.",
        "required": [
          "id",
          "switched_at",
          "from_context",
          "to_context"
        ],
        "properties": {
          "from_context": {
            "type": "string",
            "description": "\"Persona name\" or \"Physical User\"."
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "reason": {
            "type": "string",
            "nullable": true
          },
          "switched_at": {
            "type": "string",
            "format": "date-time"
          },
          "to_context": {
            "type": "string",
            "description": "\"Persona name\" or \"Physical User\"."
          }
        }
      },
      "CorrelationAuditEventResponse": {
        "type": "object",
        "description": "Audit event response for correlation actions.",
        "required": [
          "id",
          "connector_id",
          "event_type",
          "outcome",
          "candidate_count",
          "candidates_summary",
          "rules_snapshot",
          "thresholds_snapshot",
          "actor_type",
          "created_at"
        ],
        "properties": {
          "account_id": {
            "type": "string",
            "format": "uuid",
            "description": "Account involved (if applicable).",
            "nullable": true
          },
          "actor_id": {
            "type": "string",
            "format": "uuid",
            "description": "ID of the actor who performed the action.",
            "nullable": true
          },
          "actor_type": {
            "type": "string",
            "description": "Type of actor (e.g., \"system\", \"user\")."
          },
          "candidate_count": {
            "type": "integer",
            "format": "int32",
            "description": "Number of candidates evaluated."
          },
          "candidates_summary": {
            "description": "Summary of candidate details at the time of the event."
          },
          "case_id": {
            "type": "string",
            "format": "uuid",
            "description": "Correlation case involved (if applicable).",
            "nullable": true
          },
          "confidence_score": {
            "type": "number",
            "format": "double",
            "description": "Confidence score at the time of the event.",
            "nullable": true
          },
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "Connector involved in the correlation."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the event occurred."
          },
          "event_type": {
            "type": "string",
            "description": "Type of event (e.g., \"`auto_confirm`\", \"`manual_confirm`\", \"reject\", \"`create_identity`\")."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique audit event identifier."
          },
          "identity_id": {
            "type": "string",
            "format": "uuid",
            "description": "Identity involved (if applicable).",
            "nullable": true
          },
          "outcome": {
            "type": "string",
            "description": "Outcome of the event (e.g., \"success\", \"failure\")."
          },
          "reason": {
            "type": "string",
            "description": "Reason provided for the action.",
            "nullable": true
          },
          "rules_snapshot": {
            "description": "Snapshot of the rules used during correlation."
          },
          "thresholds_snapshot": {
            "description": "Snapshot of the thresholds used during correlation."
          }
        }
      },
      "CorrelationAuditListResponse": {
        "type": "object",
        "description": "Paginated list of correlation audit events.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CorrelationAuditEventResponse"
            },
            "description": "List of audit events."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for the query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for the query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "CorrelationCandidateDetailResponse": {
        "type": "object",
        "description": "Detailed response for a correlation candidate.",
        "required": [
          "id",
          "identity_id",
          "identity_attributes",
          "aggregate_confidence",
          "per_attribute_scores",
          "is_deactivated",
          "is_definitive_match"
        ],
        "properties": {
          "aggregate_confidence": {
            "type": "number",
            "format": "double",
            "description": "Aggregate confidence score across all rules."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique candidate identifier."
          },
          "identity_attributes": {
            "description": "Attributes of the candidate identity."
          },
          "identity_display_name": {
            "type": "string",
            "description": "Display name of the candidate identity.",
            "nullable": true
          },
          "identity_id": {
            "type": "string",
            "format": "uuid",
            "description": "Identity this candidate refers to."
          },
          "is_deactivated": {
            "type": "boolean",
            "description": "Whether the candidate identity is deactivated."
          },
          "is_definitive_match": {
            "type": "boolean",
            "description": "Whether this candidate was flagged as a definitive match."
          },
          "per_attribute_scores": {
            "description": "Breakdown of scores per matching attribute/rule."
          }
        }
      },
      "CorrelationCaseDetailResponse": {
        "type": "object",
        "description": "Detailed response for a correlation case including candidates.",
        "required": [
          "id",
          "connector_id",
          "account_identifier",
          "status",
          "trigger_type",
          "highest_confidence",
          "candidate_count",
          "account_attributes",
          "candidates",
          "rules_snapshot",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "account_attributes": {
            "description": "Attributes of the account being correlated."
          },
          "account_id": {
            "type": "string",
            "format": "uuid",
            "description": "Linked account identifier (if resolved).",
            "nullable": true
          },
          "account_identifier": {
            "type": "string",
            "description": "Identifier of the unmatched account."
          },
          "assigned_to": {
            "type": "string",
            "format": "uuid",
            "description": "User assigned to review this case.",
            "nullable": true
          },
          "candidate_count": {
            "type": "integer",
            "format": "int32",
            "description": "Number of identity candidates."
          },
          "candidates": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CorrelationCandidateDetailResponse"
            },
            "description": "List of identity candidates with scoring details."
          },
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "Connector the account belongs to."
          },
          "connector_name": {
            "type": "string",
            "description": "Display name of the connector.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the case was created."
          },
          "highest_confidence": {
            "type": "number",
            "format": "double",
            "description": "Highest confidence score among candidates."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique case identifier."
          },
          "resolution_reason": {
            "type": "string",
            "description": "Reason provided for resolution.",
            "nullable": true
          },
          "resolved_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the case was resolved.",
            "nullable": true
          },
          "resolved_by": {
            "type": "string",
            "format": "uuid",
            "description": "User who resolved the case.",
            "nullable": true
          },
          "rules_snapshot": {
            "description": "Snapshot of the rules used during correlation."
          },
          "status": {
            "type": "string",
            "description": "Current status of the case."
          },
          "trigger_type": {
            "type": "string",
            "description": "What triggered the case."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the case was last updated."
          }
        }
      },
      "CorrelationCaseSummaryResponse": {
        "type": "object",
        "description": "Summary response for a correlation case requiring manual review.",
        "required": [
          "id",
          "connector_id",
          "account_identifier",
          "status",
          "trigger_type",
          "highest_confidence",
          "candidate_count",
          "created_at"
        ],
        "properties": {
          "account_identifier": {
            "type": "string",
            "description": "Identifier of the unmatched account."
          },
          "assigned_to": {
            "type": "string",
            "format": "uuid",
            "description": "User assigned to review this case.",
            "nullable": true
          },
          "candidate_count": {
            "type": "integer",
            "format": "int32",
            "description": "Number of identity candidates."
          },
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "Connector the account belongs to."
          },
          "connector_name": {
            "type": "string",
            "description": "Display name of the connector.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the case was created."
          },
          "highest_confidence": {
            "type": "number",
            "format": "double",
            "description": "Highest confidence score among candidates."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique case identifier."
          },
          "status": {
            "type": "string",
            "description": "Current status of the case (e.g., \"pending\", \"confirmed\", \"rejected\")."
          },
          "trigger_type": {
            "type": "string",
            "description": "What triggered the case (e.g., \"import\", \"reconciliation\", \"manual\")."
          }
        }
      },
      "CorrelationJobStatusResponse": {
        "type": "object",
        "description": "Response containing correlation job status and progress.",
        "required": [
          "job_id",
          "status",
          "total_accounts",
          "processed_accounts",
          "auto_confirmed",
          "queued_for_review",
          "no_match",
          "errors",
          "started_at"
        ],
        "properties": {
          "auto_confirmed": {
            "type": "integer",
            "format": "int64",
            "description": "Number of accounts auto-confirmed."
          },
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the job completed (if finished).",
            "nullable": true
          },
          "errors": {
            "type": "integer",
            "format": "int64",
            "description": "Number of accounts that encountered errors."
          },
          "job_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique job identifier."
          },
          "no_match": {
            "type": "integer",
            "format": "int64",
            "description": "Number of accounts with no match found."
          },
          "processed_accounts": {
            "type": "integer",
            "format": "int64",
            "description": "Number of accounts processed so far."
          },
          "queued_for_review": {
            "type": "integer",
            "format": "int64",
            "description": "Number of accounts queued for manual review."
          },
          "started_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the job started."
          },
          "status": {
            "type": "string",
            "description": "Current job status (e.g., \"running\", \"completed\", \"failed\")."
          },
          "total_accounts": {
            "type": "integer",
            "format": "int64",
            "description": "Total number of accounts to evaluate."
          }
        }
      },
      "CorrelationRuleListResponse": {
        "type": "object",
        "description": "Paginated list of correlation rules.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CorrelationRuleResponse"
            },
            "description": "List of correlation rules."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for the query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for the query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "CorrelationRuleResponse": {
        "type": "object",
        "description": "Correlation rule response.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "match_type",
          "weight",
          "is_definitive",
          "normalize",
          "is_active",
          "priority",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "algorithm": {
            "type": "string",
            "description": "Matching algorithm used.",
            "nullable": true
          },
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "Connector this rule is scoped to (null for global rules).",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the rule was created."
          },
          "expression": {
            "type": "string",
            "description": "Custom matching expression.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique rule identifier."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the rule is active."
          },
          "is_definitive": {
            "type": "boolean",
            "description": "Whether a match definitively confirms identity."
          },
          "match_type": {
            "type": "string",
            "description": "Type of matching performed."
          },
          "name": {
            "type": "string",
            "description": "Display name for the rule."
          },
          "normalize": {
            "type": "boolean",
            "description": "Whether attribute values are normalized before comparison."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Evaluation priority (lower = higher priority)."
          },
          "source_attribute": {
            "type": "string",
            "description": "Source attribute to match against.",
            "nullable": true
          },
          "target_attribute": {
            "type": "string",
            "description": "Target attribute to match against.",
            "nullable": true
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant that owns this rule."
          },
          "threshold": {
            "type": "number",
            "format": "double",
            "description": "Similarity threshold for fuzzy matching.",
            "nullable": true
          },
          "tier": {
            "type": "integer",
            "format": "int32",
            "description": "Evaluation tier for multi-pass correlation.",
            "nullable": true
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the rule was last updated."
          },
          "weight": {
            "type": "number",
            "format": "double",
            "description": "Weight in aggregate confidence score."
          }
        }
      },
      "CorrelationStatisticsResponse": {
        "type": "object",
        "description": "Response containing correlation statistics for a connector.",
        "required": [
          "connector_id",
          "total_evaluated",
          "auto_confirmed_count",
          "auto_confirmed_percentage",
          "manual_review_count",
          "manual_review_percentage",
          "no_match_count",
          "no_match_percentage",
          "average_confidence",
          "review_queue_depth",
          "suggestions"
        ],
        "properties": {
          "auto_confirmed_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of accounts auto-confirmed."
          },
          "auto_confirmed_percentage": {
            "type": "number",
            "format": "double",
            "description": "Percentage of accounts auto-confirmed."
          },
          "average_confidence": {
            "type": "number",
            "format": "double",
            "description": "Average confidence score across all evaluations."
          },
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "Connector the statistics are for."
          },
          "manual_review_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of accounts sent to manual review."
          },
          "manual_review_percentage": {
            "type": "number",
            "format": "double",
            "description": "Percentage of accounts sent to manual review."
          },
          "no_match_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of accounts with no match."
          },
          "no_match_percentage": {
            "type": "number",
            "format": "double",
            "description": "Percentage of accounts with no match."
          },
          "period_end": {
            "type": "string",
            "format": "date-time",
            "description": "End of the statistics period.",
            "nullable": true
          },
          "period_start": {
            "type": "string",
            "format": "date-time",
            "description": "Start of the statistics period.",
            "nullable": true
          },
          "review_queue_depth": {
            "type": "integer",
            "format": "int64",
            "description": "Current depth of the manual review queue."
          },
          "suggestions": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Optimization suggestions based on the statistics."
          },
          "total_evaluated": {
            "type": "integer",
            "format": "int64",
            "description": "Total accounts evaluated in the period."
          }
        }
      },
      "CorrelationThresholdResponse": {
        "type": "object",
        "description": "Correlation threshold response.",
        "required": [
          "id",
          "connector_id",
          "auto_confirm_threshold",
          "manual_review_threshold",
          "tuning_mode",
          "include_deactivated",
          "batch_size",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "auto_confirm_threshold": {
            "type": "number",
            "format": "double",
            "description": "Confidence score above which matches are auto-confirmed."
          },
          "batch_size": {
            "type": "integer",
            "format": "int32",
            "description": "Number of accounts processed per batch."
          },
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "Connector these thresholds apply to."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the threshold configuration was created."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique threshold configuration identifier."
          },
          "include_deactivated": {
            "type": "boolean",
            "description": "Whether deactivated identities are included in matching."
          },
          "manual_review_threshold": {
            "type": "number",
            "format": "double",
            "description": "Confidence score above which matches go to manual review."
          },
          "tuning_mode": {
            "type": "boolean",
            "description": "Whether tuning mode is enabled."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the threshold configuration was last updated."
          }
        }
      },
      "CorrelationTrendsResponse": {
        "type": "object",
        "description": "Response containing correlation trend data over time.",
        "required": [
          "connector_id",
          "period_start",
          "period_end",
          "daily_trends",
          "suggestions"
        ],
        "properties": {
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "Connector the trends are for."
          },
          "daily_trends": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DailyTrendData"
            },
            "description": "Daily trend data points."
          },
          "period_end": {
            "type": "string",
            "format": "date-time",
            "description": "End of the trend period."
          },
          "period_start": {
            "type": "string",
            "format": "date-time",
            "description": "Start of the trend period."
          },
          "suggestions": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Optimization suggestions based on the trends."
          }
        }
      },
      "CountByRiskLevel": {
        "type": "object",
        "description": "Count of NHIs by risk level.",
        "required": [
          "critical",
          "high",
          "medium",
          "low"
        ],
        "properties": {
          "critical": {
            "type": "integer",
            "format": "int32"
          },
          "high": {
            "type": "integer",
            "format": "int32"
          },
          "low": {
            "type": "integer",
            "format": "int32"
          },
          "medium": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "CountByType": {
        "type": "object",
        "description": "Count of NHIs by type.",
        "required": [
          "service_account",
          "ai_agent"
        ],
        "properties": {
          "ai_agent": {
            "type": "integer",
            "format": "int32"
          },
          "service_account": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "CreateA2aTaskRequest": {
        "type": "object",
        "description": "Request body for POST /a2a/tasks - create a new task.",
        "required": [
          "target_agent_id",
          "task_type",
          "input"
        ],
        "properties": {
          "callback_url": {
            "type": "string",
            "description": "Optional webhook URL for completion notification.",
            "nullable": true
          },
          "input": {
            "description": "Task input parameters."
          },
          "target_agent_id": {
            "type": "string",
            "format": "uuid",
            "description": "Target agent ID that will execute the task."
          },
          "task_type": {
            "type": "string",
            "description": "Task type/skill identifier."
          }
        }
      },
      "CreateA2aTaskResponse": {
        "type": "object",
        "description": "Response for POST /a2a/tasks - task created.",
        "required": [
          "task_id",
          "status",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Task creation timestamp."
          },
          "status": {
            "type": "string",
            "description": "Initial task status (always \"pending\")."
          },
          "task_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique task identifier."
          }
        }
      },
      "CreateAccessRequestRequest": {
        "type": "object",
        "description": "Request to submit a new access request.",
        "required": [
          "entitlement_id",
          "justification"
        ],
        "properties": {
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "ID of the entitlement being requested."
          },
          "justification": {
            "type": "string",
            "description": "Business justification for the request (minimum 20 characters)."
          },
          "requested_expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "Optional requested access expiration date.",
            "nullable": true
          }
        }
      },
      "CreateAgentRequest": {
        "type": "object",
        "description": "Request to create a new AI agent.",
        "required": [
          "name",
          "agent_type"
        ],
        "properties": {
          "agent_type": {
            "type": "string",
            "description": "Agent type: autonomous, copilot, workflow, orchestrator."
          },
          "backup_owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Backup owner ID for governance continuity (F108).",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Agent description.",
            "nullable": true
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "Optional expiration date.",
            "nullable": true
          },
          "inactivity_threshold_days": {
            "type": "integer",
            "format": "int32",
            "description": "Days of inactivity before agent enters grace period (F108).",
            "nullable": true
          },
          "max_token_lifetime_secs": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum OAuth token lifetime in seconds. Default: 900 (15 min)."
          },
          "model_name": {
            "type": "string",
            "description": "Model name (e.g., claude-sonnet-4, gpt-4).",
            "nullable": true
          },
          "model_provider": {
            "type": "string",
            "description": "Model provider (e.g., anthropic, openai, google).",
            "nullable": true
          },
          "model_version": {
            "type": "string",
            "description": "Model version.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Agent display name (unique per tenant)."
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID of the agent owner.",
            "nullable": true
          },
          "requires_human_approval": {
            "type": "boolean",
            "description": "Require human approval for sensitive operations."
          },
          "risk_level": {
            "type": "string",
            "description": "Risk level: low, medium, high, critical. Default: medium."
          },
          "rotation_interval_days": {
            "type": "integer",
            "format": "int32",
            "description": "Days between required credential rotations (F108).",
            "nullable": true
          },
          "team_id": {
            "type": "string",
            "format": "uuid",
            "description": "Team/group ID associated with this agent.",
            "nullable": true
          }
        }
      },
      "CreateApplicationRequest": {
        "type": "object",
        "description": "Request to create a new application.",
        "required": [
          "name",
          "app_type"
        ],
        "properties": {
          "app_type": {
            "$ref": "#/components/schemas/GovAppType"
          },
          "description": {
            "type": "string",
            "description": "Application description.",
            "nullable": true
          },
          "external_id": {
            "type": "string",
            "description": "External system reference ID.",
            "nullable": true
          },
          "is_delegable": {
            "type": "boolean",
            "description": "Whether entitlements in this application can be delegated. Defaults to true.",
            "nullable": true
          },
          "metadata": {
            "description": "Extensible metadata as JSON.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Application display name."
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Application owner (user ID).",
            "nullable": true
          }
        }
      },
      "CreateApprovalGroupRequest": {
        "type": "object",
        "description": "Request to create a new approval group.",
        "required": [
          "name"
        ],
        "properties": {
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "member_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Initial member user IDs."
          },
          "name": {
            "type": "string",
            "description": "Display name for the group."
          }
        }
      },
      "CreateApprovalStepRequest": {
        "type": "object",
        "description": "Request to create an approval step.",
        "required": [
          "approver_type"
        ],
        "properties": {
          "approver_type": {
            "$ref": "#/components/schemas/GovApproverType"
          },
          "specific_approvers": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Specific approver user IDs (required for `SpecificUsers` type).",
            "nullable": true
          }
        }
      },
      "CreateApprovalWorkflowRequest": {
        "type": "object",
        "description": "Request to create a new approval workflow.",
        "required": [
          "name",
          "steps"
        ],
        "properties": {
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "is_default": {
            "type": "boolean",
            "description": "Whether this should be the default workflow."
          },
          "name": {
            "type": "string",
            "description": "Display name for the workflow."
          },
          "steps": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateApprovalStepRequest"
            },
            "description": "Approval steps (1-5 required)."
          }
        }
      },
      "CreateArchetypeRequest": {
        "type": "object",
        "description": "Request to create a new persona archetype.",
        "required": [
          "name",
          "naming_pattern"
        ],
        "properties": {
          "attribute_mappings": {
            "allOf": [
              {
                "$ref": "#/components/schemas/AttributeMappingsRequest"
              }
            ],
            "nullable": true
          },
          "default_entitlements": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DefaultEntitlementRequest"
            },
            "description": "Default entitlements to assign to new personas.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Optional description of the archetype.",
            "nullable": true
          },
          "lifecycle_policy": {
            "allOf": [
              {
                "$ref": "#/components/schemas/LifecyclePolicyRequest"
              }
            ],
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Display name for the archetype (1-255 characters)."
          },
          "naming_pattern": {
            "type": "string",
            "description": "Template for generating persona names (e.g., \"admin.{username}\")."
          }
        }
      },
      "CreateAssignmentRequest": {
        "type": "object",
        "description": "Request to create a new assignment.",
        "required": [
          "entitlement_id",
          "target_type",
          "target_id"
        ],
        "properties": {
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "The entitlement to assign."
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the assignment expires (optional).",
            "nullable": true
          },
          "justification": {
            "type": "string",
            "description": "Business justification for the assignment.",
            "nullable": true
          },
          "target_id": {
            "type": "string",
            "format": "uuid",
            "description": "The target ID (`user_id` or `group_id`)."
          },
          "target_type": {
            "$ref": "#/components/schemas/GovAssignmentTargetType"
          }
        }
      },
      "CreateAttributeDefinitionRequest": {
        "type": "object",
        "description": "Request to create a new attribute definition.",
        "required": [
          "name",
          "display_label",
          "data_type"
        ],
        "properties": {
          "data_type": {
            "type": "string",
            "description": "Data type: string, number, boolean, date, json."
          },
          "default_value": {
            "description": "Default value when attribute is not provided.",
            "nullable": true
          },
          "display_label": {
            "type": "string",
            "description": "Human-readable display label."
          },
          "name": {
            "type": "string",
            "description": "Attribute name (lowercase, alphanumeric + underscore, 1-64 chars)."
          },
          "required": {
            "type": "boolean",
            "description": "Whether this attribute is required on user creation/update."
          },
          "sort_order": {
            "type": "integer",
            "format": "int32",
            "description": "Display ordering (default: 0)."
          },
          "validation_rules": {
            "description": "Type-specific validation constraints (`max_length`, `min_length`, pattern, `allowed_values`, min, max).",
            "nullable": true
          }
        }
      },
      "CreateBatchExportRequest": {
        "type": "object",
        "description": "Request to create a batch export.",
        "required": [
          "date_range_start",
          "date_range_end",
          "output_format"
        ],
        "properties": {
          "date_range_end": {
            "type": "string",
            "format": "date-time"
          },
          "date_range_start": {
            "type": "string",
            "format": "date-time"
          },
          "event_type_filter": {
            "nullable": true
          },
          "output_format": {
            "type": "string"
          }
        }
      },
      "CreateBatchSimulationRequest": {
        "type": "object",
        "description": "Request to create a new batch simulation.",
        "required": [
          "name",
          "batch_type",
          "selection_mode",
          "change_spec"
        ],
        "properties": {
          "batch_type": {
            "$ref": "#/components/schemas/BatchSimulationType"
          },
          "change_spec": {
            "$ref": "#/components/schemas/ChangeSpec"
          },
          "filter_criteria": {
            "$ref": "#/components/schemas/FilterCriteria"
          },
          "name": {
            "type": "string",
            "description": "Name for the simulation."
          },
          "selection_mode": {
            "$ref": "#/components/schemas/SelectionMode"
          },
          "user_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Explicit user IDs (required for `user_list` mode)."
          }
        }
      },
      "CreateBindingRequest": {
        "type": "object",
        "description": "Request to create a new hook binding.",
        "required": [
          "script_id",
          "connector_id",
          "hook_phase",
          "operation_type",
          "execution_order"
        ],
        "properties": {
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "The connector to bind to."
          },
          "execution_order": {
            "type": "integer",
            "format": "int32",
            "description": "Execution order when multiple scripts are bound to the same hook."
          },
          "failure_policy": {
            "type": "string",
            "description": "What to do when the script fails (e.g., abort, continue, retry).",
            "nullable": true
          },
          "hook_phase": {
            "type": "string",
            "description": "The provisioning lifecycle phase (e.g., `pre_create`, `post_create`)."
          },
          "max_retries": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum number of retry attempts on failure.",
            "nullable": true
          },
          "operation_type": {
            "type": "string",
            "description": "The operation type (e.g., create, update, delete)."
          },
          "script_id": {
            "type": "string",
            "format": "uuid",
            "description": "The script to bind."
          },
          "timeout_seconds": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum execution time in seconds before timeout.",
            "nullable": true
          }
        }
      },
      "CreateBirthrightPolicyRequest": {
        "type": "object",
        "description": "Request to create a new birthright policy.",
        "required": [
          "name",
          "priority",
          "conditions",
          "entitlement_ids"
        ],
        "properties": {
          "conditions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PolicyConditionRequest"
            },
            "description": "Conditions that must ALL match for policy to apply (AND logic)."
          },
          "description": {
            "type": "string",
            "description": "Policy description.",
            "nullable": true
          },
          "entitlement_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Entitlement IDs to grant when conditions match."
          },
          "evaluation_mode": {
            "allOf": [
              {
                "$ref": "#/components/schemas/EvaluationMode"
              }
            ],
            "nullable": true
          },
          "grace_period_days": {
            "type": "integer",
            "format": "int32",
            "description": "Grace period in days for revocation (when user no longer matches).\n0 means immediate revocation.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Policy display name (1-255 characters)."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority for evaluation (higher = evaluated first)."
          }
        }
      },
      "CreateCampaignRequest": {
        "type": "object",
        "description": "Request to create a certification campaign.",
        "required": [
          "name",
          "nhi_types",
          "reviewer_id",
          "due_date"
        ],
        "properties": {
          "description": {
            "type": "string",
            "nullable": true
          },
          "due_date": {
            "type": "string",
            "format": "date-time"
          },
          "filter": {
            "allOf": [
              {
                "$ref": "#/components/schemas/CampaignFilterRequest"
              }
            ],
            "nullable": true
          },
          "name": {
            "type": "string"
          },
          "nhi_types": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "reviewer_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "CreateClientRequest": {
        "type": "object",
        "description": "Request to create a new `OAuth2` client.",
        "required": [
          "name",
          "client_type",
          "redirect_uris",
          "grant_types",
          "scopes"
        ],
        "properties": {
          "client_type": {
            "$ref": "#/components/schemas/ClientType"
          },
          "grant_types": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Allowed grant types."
          },
          "name": {
            "type": "string",
            "description": "Human-readable client name."
          },
          "redirect_uris": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Allowed redirect URIs."
          },
          "scopes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Allowed scopes."
          }
        }
      },
      "CreateClientResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ClientResponse"
          },
          {
            "type": "object",
            "properties": {
              "client_secret": {
                "type": "string",
                "description": "Client secret (only for confidential clients, only shown once).",
                "nullable": true
              }
            }
          }
        ],
        "description": "`OAuth2` client creation response (includes secret for confidential clients)."
      },
      "CreateConnectorRequest": {
        "type": "object",
        "description": "Request to create a new connector.",
        "required": [
          "name",
          "connector_type",
          "config",
          "credentials"
        ],
        "properties": {
          "config": {
            "description": "Non-sensitive configuration (JSON)."
          },
          "connector_type": {
            "$ref": "#/components/schemas/ConnectorType"
          },
          "credentials": {
            "description": "Sensitive credentials (will be encrypted)."
          },
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Connector display name."
          }
        }
      },
      "CreateCorrelationRuleRequest": {
        "type": "object",
        "description": "Request to create a new correlation rule.",
        "required": [
          "name",
          "source_attribute",
          "target_attribute",
          "match_type",
          "weight"
        ],
        "properties": {
          "algorithm": {
            "type": "string",
            "description": "Matching algorithm to use (e.g., \"levenshtein\", \"`jaro_winkler`\").",
            "nullable": true
          },
          "expression": {
            "type": "string",
            "description": "Custom matching expression (for \"expression\" match type).",
            "nullable": true
          },
          "is_definitive": {
            "type": "boolean",
            "description": "Whether a match on this rule definitively confirms identity.",
            "nullable": true
          },
          "match_type": {
            "type": "string",
            "description": "Type of matching to perform (e.g., \"exact\", \"fuzzy\", \"expression\")."
          },
          "name": {
            "type": "string",
            "description": "Display name for the rule (1-255 characters)."
          },
          "normalize": {
            "type": "boolean",
            "description": "Whether to normalize attribute values before comparison.",
            "nullable": true
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority for rule evaluation order (lower = higher priority).",
            "nullable": true
          },
          "source_attribute": {
            "type": "string",
            "description": "Source attribute to match against (1-255 characters)."
          },
          "target_attribute": {
            "type": "string",
            "description": "Target attribute to match against (1-255 characters)."
          },
          "threshold": {
            "type": "number",
            "format": "double",
            "description": "Minimum similarity threshold for fuzzy matching (0.0-1.0).",
            "nullable": true
          },
          "tier": {
            "type": "integer",
            "format": "int32",
            "description": "Evaluation tier for multi-pass correlation.",
            "nullable": true
          },
          "weight": {
            "type": "number",
            "format": "double",
            "description": "Weight of this rule in the aggregate confidence score."
          }
        }
      },
      "CreateDelegationRequest": {
        "type": "object",
        "description": "Request to create a new delegation.",
        "required": [
          "delegate_id",
          "starts_at",
          "ends_at"
        ],
        "properties": {
          "delegate_id": {
            "type": "string",
            "format": "uuid",
            "description": "User receiving approval authority."
          },
          "ends_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the delegation ends."
          },
          "scope": {
            "allOf": [
              {
                "$ref": "#/components/schemas/CreateDelegationScopeRequest"
              }
            ],
            "nullable": true
          },
          "starts_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the delegation becomes active."
          }
        }
      },
      "CreateDetectionRuleRequest": {
        "type": "object",
        "description": "Request to create a new detection rule.",
        "required": [
          "name",
          "rule_type"
        ],
        "properties": {
          "description": {
            "type": "string",
            "description": "Human-readable description.",
            "nullable": true
          },
          "is_enabled": {
            "type": "boolean",
            "description": "Whether this rule should be enabled on creation."
          },
          "name": {
            "type": "string",
            "description": "Rule display name."
          },
          "parameters": {
            "description": "Rule-specific parameters.",
            "nullable": true
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority for rule execution (lower = higher priority)."
          },
          "rule_type": {
            "$ref": "#/components/schemas/DetectionRuleType"
          }
        }
      },
      "CreateDispositionRequest": {
        "type": "object",
        "description": "Request to create or update a disposition.",
        "required": [
          "status"
        ],
        "properties": {
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "Optional expiration for temporary exceptions.",
            "nullable": true
          },
          "justification": {
            "type": "string",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/OutlierDispositionStatus"
          }
        }
      },
      "CreateDomainRequest": {
        "type": "object",
        "description": "Request to add a domain to an identity provider.",
        "required": [
          "domain"
        ],
        "properties": {
          "domain": {
            "type": "string"
          },
          "priority": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "CreateEntitlementRequest": {
        "type": "object",
        "description": "Request to create a new entitlement.",
        "required": [
          "application_id",
          "name",
          "risk_level"
        ],
        "properties": {
          "application_id": {
            "type": "string",
            "format": "uuid",
            "description": "The application this entitlement belongs to."
          },
          "data_controller": {
            "type": "string",
            "description": "Name of the data controller organization.",
            "nullable": true
          },
          "data_processor": {
            "type": "string",
            "description": "Name of the data processor organization.",
            "nullable": true
          },
          "data_protection_classification": {
            "allOf": [
              {
                "$ref": "#/components/schemas/DataProtectionClassification"
              }
            ],
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Entitlement description.",
            "nullable": true
          },
          "external_id": {
            "type": "string",
            "description": "External system reference ID.",
            "nullable": true
          },
          "is_delegable": {
            "type": "boolean",
            "description": "Whether this entitlement can be delegated. Defaults to true.",
            "nullable": true
          },
          "legal_basis": {
            "allOf": [
              {
                "$ref": "#/components/schemas/GdprLegalBasis"
              }
            ],
            "nullable": true
          },
          "metadata": {
            "description": "Extensible metadata as JSON.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Entitlement display name."
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement owner (user ID).",
            "nullable": true
          },
          "purposes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Processing purpose labels.",
            "nullable": true
          },
          "retention_period_days": {
            "type": "integer",
            "format": "int32",
            "description": "Data retention period in days. Must be positive if set.",
            "nullable": true
          },
          "risk_level": {
            "$ref": "#/components/schemas/GovRiskLevel"
          }
        }
      },
      "CreateEscalationLevelRequest": {
        "type": "object",
        "description": "Request to add an escalation level.",
        "required": [
          "level_order",
          "timeout_secs",
          "target_type"
        ],
        "properties": {
          "level_name": {
            "type": "string",
            "description": "Display name for this level.",
            "nullable": true
          },
          "level_order": {
            "type": "integer",
            "format": "int32",
            "description": "Level order (1 = first escalation)."
          },
          "manager_chain_depth": {
            "type": "integer",
            "format": "int32",
            "description": "Depth for `manager_chain` type (1-10).",
            "nullable": true
          },
          "target_id": {
            "type": "string",
            "format": "uuid",
            "description": "Target ID (user or group ID, required for `specific_user` and `approval_group` types).",
            "nullable": true
          },
          "target_type": {
            "$ref": "#/components/schemas/EscalationTargetType"
          },
          "timeout_secs": {
            "type": "integer",
            "format": "int64",
            "description": "Timeout in seconds before escalating to this level."
          }
        }
      },
      "CreateEscalationPolicyRequest": {
        "type": "object",
        "description": "Request to create a new escalation policy.",
        "required": [
          "name",
          "default_timeout_secs",
          "final_fallback"
        ],
        "properties": {
          "default_timeout_secs": {
            "type": "integer",
            "format": "int64",
            "description": "Default timeout in seconds (minimum 60)."
          },
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "final_fallback": {
            "$ref": "#/components/schemas/FinalFallbackAction"
          },
          "name": {
            "type": "string",
            "description": "Display name for the policy."
          },
          "warning_threshold_secs": {
            "type": "integer",
            "format": "int64",
            "description": "Warning threshold in seconds before timeout (optional).",
            "nullable": true
          }
        }
      },
      "CreateIdentityFromCaseRequest": {
        "type": "object",
        "description": "Request to create a new identity from an unmatched correlation case.",
        "properties": {
          "reason": {
            "type": "string",
            "description": "Optional reason for creating a new identity.",
            "nullable": true
          }
        }
      },
      "CreateIdentityProviderRequest": {
        "type": "object",
        "description": "Request to create a new identity provider.",
        "required": [
          "name",
          "provider_type",
          "issuer_url",
          "client_id",
          "client_secret"
        ],
        "properties": {
          "claim_mapping": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ClaimMappingConfig"
              }
            ],
            "nullable": true
          },
          "client_id": {
            "type": "string"
          },
          "client_secret": {
            "type": "string"
          },
          "domains": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Initial domains to configure for HRD."
          },
          "issuer_url": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "provider_type": {
            "type": "string"
          },
          "scopes": {
            "type": "string"
          },
          "sync_on_login": {
            "type": "boolean"
          }
        }
      },
      "CreateIpRuleRequest": {
        "type": "object",
        "description": "Request for POST /admin/ip-restrictions/rules.",
        "required": [
          "rule_type",
          "ip_cidr",
          "name"
        ],
        "properties": {
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "ip_cidr": {
            "type": "string",
            "description": "IP address or range in CIDR notation."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the rule is active."
          },
          "name": {
            "type": "string",
            "description": "Human-readable rule name."
          },
          "rule_type": {
            "$ref": "#/components/schemas/IpRuleType"
          },
          "scope": {
            "type": "string",
            "description": "Target scope: all, admin, or role:name."
          }
        }
      },
      "CreateLicenseEntitlementLinkRequest": {
        "type": "object",
        "description": "Request to create a license-entitlement link.",
        "required": [
          "license_pool_id",
          "entitlement_id"
        ],
        "properties": {
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "The entitlement to link."
          },
          "license_pool_id": {
            "type": "string",
            "format": "uuid",
            "description": "The license pool to link."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority when multiple pools could satisfy the entitlement (lower = higher priority)."
          }
        }
      },
      "CreateLicenseIncompatibilityRequest": {
        "type": "object",
        "description": "Request to create a license incompatibility rule.",
        "required": [
          "pool_a_id",
          "pool_b_id",
          "reason"
        ],
        "properties": {
          "pool_a_id": {
            "type": "string",
            "format": "uuid",
            "description": "First pool in the incompatible pair."
          },
          "pool_b_id": {
            "type": "string",
            "format": "uuid",
            "description": "Second pool in the incompatible pair."
          },
          "reason": {
            "type": "string",
            "description": "Reason for the incompatibility."
          }
        }
      },
      "CreateLicensePoolRequest": {
        "type": "object",
        "description": "Request to create a new license pool.",
        "required": [
          "name",
          "vendor",
          "total_capacity",
          "billing_period"
        ],
        "properties": {
          "billing_period": {
            "$ref": "#/components/schemas/LicenseBillingPeriod"
          },
          "cost_per_license": {
            "allOf": [
              {
                "$ref": "#/components/schemas/Decimal"
              }
            ],
            "nullable": true
          },
          "currency": {
            "type": "string",
            "description": "ISO 4217 currency code (default: USD)."
          },
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "expiration_date": {
            "type": "string",
            "format": "date-time",
            "description": "When the license expires.",
            "nullable": true
          },
          "expiration_policy": {
            "$ref": "#/components/schemas/LicenseExpirationPolicy"
          },
          "license_type": {
            "$ref": "#/components/schemas/LicenseType"
          },
          "name": {
            "type": "string",
            "description": "Pool display name (e.g., \"Microsoft 365 E3\")."
          },
          "total_capacity": {
            "type": "integer",
            "format": "int32",
            "description": "Total number of licenses purchased."
          },
          "vendor": {
            "type": "string",
            "description": "Vendor name (e.g., \"Microsoft\")."
          },
          "warning_days": {
            "type": "integer",
            "format": "int32",
            "description": "Days before expiration to start sending alerts (default: 60)."
          }
        }
      },
      "CreateLifecycleEventRequest": {
        "type": "object",
        "description": "Request to create a lifecycle event (joiner, mover, or leaver).",
        "required": [
          "user_id",
          "event_type"
        ],
        "properties": {
          "attributes_after": {
            "description": "User attributes after the change (required for joiner and mover events).",
            "nullable": true
          },
          "attributes_before": {
            "description": "User attributes before the change (required for mover events).",
            "nullable": true
          },
          "event_type": {
            "$ref": "#/components/schemas/LifecycleEventType"
          },
          "source": {
            "type": "string",
            "description": "Source of the event (e.g., \"api\", \"scim\", \"webhook\", \"trigger\").",
            "nullable": true
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID this event affects."
          }
        }
      },
      "CreateManualProvisioningTaskRequest": {
        "type": "object",
        "description": "Request to create a manual provisioning task.",
        "required": [
          "application_id",
          "target_user_id",
          "operation",
          "provisioning_data"
        ],
        "properties": {
          "access_request_id": {
            "type": "string",
            "format": "uuid",
            "description": "Originating access request (if applicable).",
            "nullable": true
          },
          "application_id": {
            "type": "string",
            "format": "uuid",
            "description": "Application requiring manual provisioning."
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement being provisioned (if applicable).",
            "nullable": true
          },
          "operation": {
            "$ref": "#/components/schemas/ManualTaskOperation"
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Task priority (1-10, lower = higher priority)."
          },
          "provisioning_data": {
            "description": "Provisioning details/instructions."
          },
          "sla_policy_id": {
            "type": "string",
            "format": "uuid",
            "description": "Override SLA policy.",
            "nullable": true
          },
          "target_user_id": {
            "type": "string",
            "format": "uuid",
            "description": "Target user for provisioning."
          },
          "ticketing_configuration_id": {
            "type": "string",
            "format": "uuid",
            "description": "Override ticketing configuration.",
            "nullable": true
          }
        }
      },
      "CreateMergePolicyRequest": {
        "type": "object",
        "description": "Request to create a merge policy.",
        "required": [
          "attribute",
          "strategy"
        ],
        "properties": {
          "attribute": {
            "type": "string",
            "description": "Target attribute."
          },
          "null_handling": {
            "$ref": "#/components/schemas/TemplateNullHandling"
          },
          "source_precedence": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Source precedence order (for `source_precedence` strategy).",
            "nullable": true
          },
          "strategy": {
            "$ref": "#/components/schemas/TemplateMergeStrategy"
          }
        }
      },
      "CreateMetaRoleConstraintRequest": {
        "type": "object",
        "description": "Request to add a constraint to a meta-role.",
        "required": [
          "constraint_type",
          "constraint_value"
        ],
        "properties": {
          "constraint_type": {
            "type": "string",
            "description": "Constraint type (`max_session_duration`, `require_mfa`, `ip_whitelist`, `approval_required`)."
          },
          "constraint_value": {
            "description": "Constraint configuration (JSON format)."
          }
        }
      },
      "CreateMetaRoleCriteriaRequest": {
        "type": "object",
        "description": "Request to create a meta-role criterion.",
        "required": [
          "field",
          "operator",
          "value"
        ],
        "properties": {
          "field": {
            "type": "string",
            "description": "Field to match against (`risk_level`, `application_id`, `owner_id`, status, `is_delegable`, metadata)."
          },
          "operator": {
            "$ref": "#/components/schemas/CriteriaOperator"
          },
          "value": {
            "description": "Value to compare against (JSON format for flexibility)."
          }
        }
      },
      "CreateMetaRoleEntitlementRequest": {
        "type": "object",
        "description": "Request to add an entitlement to a meta-role.",
        "required": [
          "entitlement_id"
        ],
        "properties": {
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "The entitlement ID to inherit."
          },
          "permission_type": {
            "allOf": [
              {
                "$ref": "#/components/schemas/PermissionType"
              }
            ],
            "nullable": true
          }
        }
      },
      "CreateMetaRoleRequest": {
        "type": "object",
        "description": "Request to create a new meta-role.",
        "required": [
          "name",
          "criteria"
        ],
        "properties": {
          "constraints": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateMetaRoleConstraintRequest"
            },
            "description": "Constraints to inherit (optional).",
            "nullable": true
          },
          "criteria": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateMetaRoleCriteriaRequest"
            },
            "description": "Matching criteria for this meta-role."
          },
          "criteria_logic": {
            "$ref": "#/components/schemas/CriteriaLogic"
          },
          "description": {
            "type": "string",
            "description": "Description of the meta-role (max 2000 characters).",
            "nullable": true
          },
          "entitlements": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateMetaRoleEntitlementRequest"
            },
            "description": "Entitlements to inherit (optional).",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Display name for the meta-role (1-255 characters)."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority for conflict resolution (lower = higher priority, default: 100)."
          }
        }
      },
      "CreateMiningJobRequest": {
        "type": "object",
        "description": "Request to create a mining job.",
        "required": [
          "name"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "parameters": {
            "allOf": [
              {
                "$ref": "#/components/schemas/MiningJobParametersRequest"
              }
            ],
            "nullable": true
          }
        }
      },
      "CreateNhiCertificationCampaignRequest": {
        "type": "object",
        "description": "Request to create an NHI certification campaign.",
        "required": [
          "name",
          "deadline"
        ],
        "properties": {
          "deadline": {
            "type": "string",
            "format": "date-time",
            "description": "Deadline for the campaign."
          },
          "description": {
            "type": "string",
            "description": "Campaign description.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Campaign name."
          },
          "needs_certification_only": {
            "type": "boolean",
            "description": "Only include NHIs needing certification (> 365 days since last cert)."
          },
          "owner_filter": {
            "type": "string",
            "format": "uuid",
            "description": "Filter NHIs by owner (optional - certify specific owner's NHIs).",
            "nullable": true
          },
          "reviewer_type": {
            "$ref": "#/components/schemas/NhiCertReviewerType"
          },
          "specific_reviewers": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Specific reviewer IDs (if `reviewer_type` is `SpecificUsers`).",
            "nullable": true
          }
        }
      },
      "CreateNhiRequest": {
        "type": "object",
        "description": "Request to create a new NHI.",
        "required": [
          "user_id",
          "name",
          "purpose",
          "owner_id"
        ],
        "properties": {
          "backup_owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Backup owner (secondary contact).",
            "nullable": true
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "When this NHI expires (optional).",
            "nullable": true
          },
          "inactivity_threshold_days": {
            "type": "integer",
            "format": "int32",
            "description": "Inactivity threshold in days (default: 90).",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Display name for the NHI."
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Primary owner responsible for this NHI."
          },
          "purpose": {
            "type": "string",
            "description": "Purpose/justification for the NHI."
          },
          "rotation_interval_days": {
            "type": "integer",
            "format": "int32",
            "description": "Credential rotation interval in days (default: 90).",
            "nullable": true
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "The user ID to register as an NHI."
          }
        }
      },
      "CreateParametricAssignmentRequest": {
        "type": "object",
        "description": "Request to create a parametric assignment (role assignment with parameters).",
        "required": [
          "target_type",
          "target_id",
          "parameters"
        ],
        "properties": {
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the assignment expires.",
            "nullable": true
          },
          "justification": {
            "type": "string",
            "description": "Justification for the assignment (min 20 characters).",
            "nullable": true
          },
          "parameters": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ParameterValueRequest"
            },
            "description": "Parameter values for this assignment."
          },
          "target_id": {
            "type": "string",
            "format": "uuid",
            "description": "Target ID (`user_id` or `group_id`)."
          },
          "target_type": {
            "type": "string",
            "description": "Target type (user or group)."
          },
          "valid_from": {
            "type": "string",
            "format": "date-time",
            "description": "When the assignment becomes active (for temporal validity).",
            "nullable": true
          },
          "valid_to": {
            "type": "string",
            "format": "date-time",
            "description": "When the assignment becomes inactive (for temporal validity).",
            "nullable": true
          }
        }
      },
      "CreatePeerGroupRequest": {
        "type": "object",
        "description": "Request to create a new peer group.",
        "required": [
          "name",
          "group_type",
          "attribute_key",
          "attribute_value"
        ],
        "properties": {
          "attribute_key": {
            "type": "string",
            "description": "Attribute key used for grouping."
          },
          "attribute_value": {
            "type": "string",
            "description": "Attribute value for this group."
          },
          "group_type": {
            "$ref": "#/components/schemas/PeerGroupType"
          },
          "name": {
            "type": "string",
            "description": "Display name for the group."
          }
        }
      },
      "CreatePersonaRequest": {
        "type": "object",
        "description": "Request to create a new persona.",
        "required": [
          "archetype_id",
          "physical_user_id"
        ],
        "properties": {
          "archetype_id": {
            "type": "string",
            "format": "uuid",
            "description": "Archetype to use for the persona."
          },
          "attribute_overrides": {
            "type": "object",
            "description": "Attribute overrides (persona-specific values).",
            "additionalProperties": {},
            "nullable": true
          },
          "physical_user_id": {
            "type": "string",
            "format": "uuid",
            "description": "Physical user who will own the persona."
          },
          "valid_from": {
            "type": "string",
            "format": "date-time",
            "description": "When persona becomes valid (defaults to now).",
            "nullable": true
          },
          "valid_until": {
            "type": "string",
            "format": "date-time",
            "description": "When persona expires (uses archetype default if not specified).",
            "nullable": true
          }
        }
      },
      "CreateReclamationRuleRequest": {
        "type": "object",
        "description": "Request to create a reclamation rule.",
        "required": [
          "license_pool_id",
          "trigger_type"
        ],
        "properties": {
          "license_pool_id": {
            "type": "string",
            "format": "uuid",
            "description": "The license pool this rule applies to."
          },
          "lifecycle_state": {
            "type": "string",
            "description": "Lifecycle state that triggers reclamation (required for `lifecycle_state` trigger).",
            "nullable": true
          },
          "notification_days_before": {
            "type": "integer",
            "format": "int32",
            "description": "Days before reclamation to notify user (default: 7)."
          },
          "threshold_days": {
            "type": "integer",
            "format": "int32",
            "description": "Days of inactivity before reclamation (required for inactivity trigger).",
            "nullable": true
          },
          "trigger_type": {
            "$ref": "#/components/schemas/LicenseReclamationTrigger"
          }
        }
      },
      "CreateReportScheduleRequest": {
        "type": "object",
        "description": "Request to create a report schedule.",
        "required": [
          "template_id",
          "name",
          "frequency",
          "schedule_hour",
          "recipients",
          "output_format"
        ],
        "properties": {
          "frequency": {
            "$ref": "#/components/schemas/ScheduleFrequency"
          },
          "name": {
            "type": "string"
          },
          "output_format": {
            "$ref": "#/components/schemas/OutputFormat"
          },
          "parameters": {
            "nullable": true
          },
          "recipients": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "schedule_day_of_month": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "schedule_day_of_week": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "schedule_hour": {
            "type": "integer",
            "format": "int32"
          },
          "template_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "CreateReportTemplateRequest": {
        "type": "object",
        "description": "Request to create a custom report template.",
        "required": [
          "name",
          "template_type",
          "definition"
        ],
        "properties": {
          "compliance_standard": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ComplianceStandard"
              }
            ],
            "nullable": true
          },
          "definition": {
            "$ref": "#/components/schemas/TemplateDefinition"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "name": {
            "type": "string"
          },
          "template_type": {
            "$ref": "#/components/schemas/ReportTemplateType"
          }
        }
      },
      "CreateRiskFactorRequest": {
        "type": "object",
        "description": "Request to create a new risk factor.",
        "required": [
          "name",
          "category",
          "factor_type",
          "weight"
        ],
        "properties": {
          "category": {
            "$ref": "#/components/schemas/RiskFactorCategory"
          },
          "description": {
            "type": "string",
            "description": "Human-readable description.",
            "nullable": true
          },
          "factor_type": {
            "type": "string",
            "description": "Specific factor type identifier."
          },
          "is_enabled": {
            "type": "boolean",
            "description": "Whether the factor is enabled (default: true).",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Display name for the factor."
          },
          "weight": {
            "type": "number",
            "format": "double",
            "description": "Weight in score calculation (0.0-10.0)."
          }
        }
      },
      "CreateRoleEntitlementRequest": {
        "type": "object",
        "description": "Request to create a new role-entitlement mapping.",
        "required": [
          "entitlement_id",
          "role_name"
        ],
        "properties": {
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "The entitlement to map to the role."
          },
          "role_name": {
            "type": "string",
            "description": "The role name (e.g., \"admin\", \"viewer\")."
          }
        }
      },
      "CreateRoleParameterRequest": {
        "type": "object",
        "description": "Request to create a new role parameter.",
        "required": [
          "name",
          "parameter_type"
        ],
        "properties": {
          "constraints": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ParameterConstraintsRequest"
              }
            ],
            "nullable": true
          },
          "default_value": {
            "description": "Default value if not provided at assignment time.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Description of the parameter (optional, max 2000 characters).",
            "nullable": true
          },
          "display_name": {
            "type": "string",
            "description": "Human-readable display name (optional, max 255 characters).",
            "nullable": true
          },
          "display_order": {
            "type": "integer",
            "format": "int32",
            "description": "Display order for UI (default: 0)."
          },
          "is_required": {
            "type": "boolean",
            "description": "Whether a value must be provided at assignment time (default: false)."
          },
          "name": {
            "type": "string",
            "description": "Parameter name (alphanumeric with underscores, 1-100 characters)."
          },
          "parameter_type": {
            "$ref": "#/components/schemas/ParameterType"
          }
        }
      },
      "CreateRoleTemplateRequest": {
        "type": "object",
        "description": "Create role template request.",
        "required": [
          "name",
          "permissions"
        ],
        "properties": {
          "description": {
            "type": "string",
            "nullable": true
          },
          "name": {
            "type": "string"
          },
          "permissions": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "CreateRuleRequest": {
        "type": "object",
        "description": "Request to create a new template rule.",
        "required": [
          "rule_type",
          "target_attribute",
          "expression"
        ],
        "properties": {
          "authoritative": {
            "type": "boolean",
            "description": "Whether values are removed when source changes."
          },
          "condition": {
            "type": "string",
            "description": "Optional condition expression.",
            "nullable": true
          },
          "error_message": {
            "type": "string",
            "description": "Custom error message for validation rules.",
            "nullable": true
          },
          "exclusive": {
            "type": "boolean",
            "description": "If true, no other rule can target the same attribute (IGA exclusive mapping)."
          },
          "expression": {
            "type": "string",
            "description": "Expression or value for the rule."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority within the template (lower = first)."
          },
          "rule_type": {
            "$ref": "#/components/schemas/TemplateRuleType"
          },
          "strength": {
            "$ref": "#/components/schemas/TemplateStrength"
          },
          "target_attribute": {
            "type": "string",
            "description": "Target attribute this rule affects."
          },
          "time_from": {
            "type": "string",
            "format": "date-time",
            "description": "Rule only applies after this timestamp.",
            "nullable": true
          },
          "time_reference": {
            "allOf": [
              {
                "$ref": "#/components/schemas/TemplateTimeReference"
              }
            ],
            "nullable": true
          },
          "time_to": {
            "type": "string",
            "format": "date-time",
            "description": "Rule only applies before this timestamp.",
            "nullable": true
          }
        }
      },
      "CreateScimTargetRequest": {
        "type": "object",
        "description": "Request to create a SCIM target.",
        "required": [
          "name",
          "base_url",
          "auth_method",
          "credentials"
        ],
        "properties": {
          "auth_method": {
            "type": "string"
          },
          "base_url": {
            "type": "string"
          },
          "credentials": {
            "$ref": "#/components/schemas/ScimCredentials"
          },
          "deprovisioning_strategy": {
            "type": "string"
          },
          "max_retries": {
            "type": "integer",
            "format": "int32"
          },
          "name": {
            "type": "string"
          },
          "rate_limit_per_minute": {
            "type": "integer",
            "format": "int32"
          },
          "request_timeout_secs": {
            "type": "integer",
            "format": "int32"
          },
          "tls_verify": {
            "type": "boolean"
          }
        }
      },
      "CreateScimUserRequest": {
        "allOf": [
          {
            "type": "object",
            "description": "Extension schema data (e.g., enterprise user attributes).\nCaptures any additional JSON fields not matched by the above,\nincluding `urn:ietf:params:scim:schemas:extension:enterprise:2.0:User`."
          },
          {
            "type": "object",
            "required": [
              "schemas",
              "userName"
            ],
            "properties": {
              "active": {
                "type": "boolean"
              },
              "displayName": {
                "type": "string",
                "nullable": true
              },
              "emails": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/ScimEmail"
                }
              },
              "externalId": {
                "type": "string",
                "nullable": true
              },
              "name": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/ScimName"
                  }
                ],
                "nullable": true
              },
              "schemas": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "userName": {
                "type": "string"
              }
            }
          }
        ],
        "description": "Request to create a SCIM user."
      },
      "CreateScopeRequest": {
        "type": "object",
        "description": "Request to create a template scope.",
        "required": [
          "scope_type"
        ],
        "properties": {
          "condition": {
            "type": "string",
            "description": "Condition expression for condition-type scopes.",
            "nullable": true
          },
          "scope_type": {
            "$ref": "#/components/schemas/TemplateScopeType"
          },
          "scope_value": {
            "type": "string",
            "description": "Scope value (org ID, category name, etc.).",
            "nullable": true
          }
        }
      },
      "CreateScriptRequest": {
        "type": "object",
        "description": "Request to create a new provisioning script.",
        "required": [
          "name"
        ],
        "properties": {
          "description": {
            "type": "string",
            "description": "Optional description of the script's purpose.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Display name for the script."
          }
        }
      },
      "CreateServiceProviderRequest": {
        "type": "object",
        "description": "Request to create a new Service Provider",
        "required": [
          "entity_id",
          "name",
          "acs_urls"
        ],
        "properties": {
          "acs_urls": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "assertion_validity_seconds": {
            "type": "integer",
            "format": "int32"
          },
          "attribute_mapping": {
            "nullable": true
          },
          "certificate": {
            "type": "string",
            "nullable": true
          },
          "entity_id": {
            "type": "string"
          },
          "metadata_url": {
            "type": "string",
            "nullable": true
          },
          "name": {
            "type": "string"
          },
          "name_id_format": {
            "type": "string"
          },
          "sign_assertions": {
            "type": "boolean"
          },
          "validate_signatures": {
            "type": "boolean"
          }
        }
      },
      "CreateSiemDestinationRequest": {
        "type": "object",
        "description": "Request to create a SIEM destination.",
        "required": [
          "name",
          "destination_type",
          "endpoint_host",
          "export_format"
        ],
        "properties": {
          "auth_config_b64": {
            "type": "string",
            "description": "Base64-encoded auth config (tokens, certs).",
            "nullable": true
          },
          "circuit_breaker_cooldown_secs": {
            "type": "integer",
            "format": "int32",
            "description": "Seconds to wait before retrying after circuit breaker opens.",
            "nullable": true
          },
          "circuit_breaker_threshold": {
            "type": "integer",
            "format": "int32",
            "description": "Number of consecutive failures before circuit breaker opens.",
            "nullable": true
          },
          "destination_type": {
            "type": "string",
            "description": "Destination type: `syslog_tcp_tls`, `syslog_udp`, webhook, `splunk_hec`."
          },
          "enabled": {
            "type": "boolean",
            "description": "Whether destination is enabled.",
            "nullable": true
          },
          "endpoint_host": {
            "type": "string",
            "description": "Hostname or IP of the destination."
          },
          "endpoint_port": {
            "type": "integer",
            "format": "int32",
            "description": "Port (optional \u2014 defaults per type).",
            "nullable": true
          },
          "event_type_filter": {
            "description": "Event types to export (JSON array of category strings, empty = all).",
            "nullable": true
          },
          "export_format": {
            "type": "string",
            "description": "Export format: cef, `syslog_rfc5424`, json, csv."
          },
          "name": {
            "type": "string",
            "description": "Destination name (unique per tenant)."
          },
          "queue_buffer_size": {
            "type": "integer",
            "format": "int32",
            "description": "Queue buffer size for delivery resilience.",
            "nullable": true
          },
          "rate_limit_per_second": {
            "type": "integer",
            "format": "int32",
            "description": "Max events per second to this destination.",
            "nullable": true
          },
          "splunk_ack_enabled": {
            "type": "boolean",
            "nullable": true
          },
          "splunk_index": {
            "type": "string",
            "nullable": true
          },
          "splunk_source": {
            "type": "string",
            "nullable": true
          },
          "splunk_sourcetype": {
            "type": "string",
            "nullable": true
          },
          "syslog_facility": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "tls_verify_cert": {
            "type": "boolean",
            "description": "Verify TLS certificates.",
            "nullable": true
          }
        }
      },
      "CreateSimulationRequest": {
        "type": "object",
        "description": "Request to create a simulation.",
        "required": [
          "name",
          "scenario_type",
          "changes"
        ],
        "properties": {
          "changes": {
            "$ref": "#/components/schemas/SimulationChanges"
          },
          "name": {
            "type": "string"
          },
          "scenario_type": {
            "$ref": "#/components/schemas/ScenarioType"
          },
          "target_role_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          }
        }
      },
      "CreateSlaPolicyRequest": {
        "type": "object",
        "description": "Request to create an SLA policy.",
        "required": [
          "name",
          "target_duration_seconds"
        ],
        "properties": {
          "breach_notification_enabled": {
            "type": "boolean",
            "description": "Whether to enable breach notifications."
          },
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "escalation_contacts": {
            "description": "Escalation contacts (email addresses, etc.).",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Display name for the policy (1-255 characters)."
          },
          "target_duration_seconds": {
            "type": "integer",
            "format": "int32",
            "description": "Target resolution time in seconds (60 to 604800 = 7 days)."
          },
          "warning_threshold_percent": {
            "type": "integer",
            "format": "int32",
            "description": "Warning threshold as percentage of target (1-100, default 75)."
          }
        }
      },
      "CreateSodRuleRequest": {
        "type": "object",
        "description": "Request to create a new `SoD` rule.",
        "required": [
          "name",
          "first_entitlement_id",
          "second_entitlement_id",
          "severity"
        ],
        "properties": {
          "business_rationale": {
            "type": "string",
            "description": "Business rationale for the rule.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "first_entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "First conflicting entitlement ID."
          },
          "name": {
            "type": "string",
            "description": "Display name for the rule."
          },
          "second_entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Second conflicting entitlement ID."
          },
          "severity": {
            "$ref": "#/components/schemas/GovSodSeverity"
          }
        }
      },
      "CreateTemplateRequest": {
        "type": "object",
        "description": "Request to create a new script template.",
        "required": [
          "name",
          "category",
          "template_body"
        ],
        "properties": {
          "category": {
            "type": "string",
            "description": "Template category (e.g., ldap, `rest_api`, database)."
          },
          "description": {
            "type": "string",
            "description": "Optional description of the template's purpose.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Template display name."
          },
          "placeholder_annotations": {
            "description": "Annotations describing template placeholders and their types.",
            "nullable": true
          },
          "template_body": {
            "type": "string",
            "description": "The template body content with placeholders."
          }
        }
      },
      "CreateTicketingConfigurationRequest": {
        "type": "object",
        "description": "Request to create a ticketing configuration.",
        "required": [
          "name",
          "ticketing_type",
          "endpoint_url",
          "credentials"
        ],
        "properties": {
          "credentials": {
            "type": "string",
            "description": "Credentials (API key, username/password, etc.) - will be encrypted."
          },
          "default_assignee": {
            "type": "string",
            "description": "Default assignee for tickets.",
            "nullable": true
          },
          "default_assignment_group": {
            "type": "string",
            "description": "`ServiceNow` assignment group.",
            "nullable": true
          },
          "endpoint_url": {
            "type": "string",
            "description": "API endpoint URL (must be valid HTTPS URL)."
          },
          "field_mappings": {
            "description": "Custom field mappings for ticket creation.",
            "nullable": true
          },
          "issue_type": {
            "type": "string",
            "description": "Jira issue type.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Display name for the configuration (1-255 characters)."
          },
          "polling_interval_seconds": {
            "type": "integer",
            "format": "int32",
            "description": "Polling interval in seconds (60-3600)."
          },
          "project_key": {
            "type": "string",
            "description": "Jira project key.",
            "nullable": true
          },
          "ticketing_type": {
            "$ref": "#/components/schemas/TicketingType"
          }
        }
      },
      "CreateToolRequest": {
        "type": "object",
        "description": "Request to create a new tool.",
        "required": [
          "name",
          "input_schema",
          "risk_level"
        ],
        "properties": {
          "category": {
            "type": "string",
            "description": "Tool category (e.g., communication, data, system).",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Tool description.",
            "nullable": true
          },
          "input_schema": {
            "description": "JSON Schema for tool input parameters."
          },
          "max_calls_per_hour": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum calls per hour (rate limiting).",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Tool name (unique per tenant)."
          },
          "output_schema": {
            "description": "JSON Schema for expected output (optional).",
            "nullable": true
          },
          "provider": {
            "type": "string",
            "description": "Tool provider (e.g., internal, mcp:service).",
            "nullable": true
          },
          "requires_approval": {
            "type": "boolean",
            "description": "Whether tool invocation requires approval."
          },
          "risk_level": {
            "type": "string",
            "description": "Risk level: low, medium, high, critical."
          }
        }
      },
      "CreateTriggerRuleRequest": {
        "type": "object",
        "description": "Request to create a new micro-certification trigger rule.",
        "required": [
          "name",
          "trigger_type"
        ],
        "properties": {
          "auto_revoke": {
            "type": "boolean",
            "description": "Whether to auto-revoke on timeout (default: true).",
            "nullable": true
          },
          "fallback_reviewer_id": {
            "type": "string",
            "format": "uuid",
            "description": "Fallback reviewer user ID for escalation.",
            "nullable": true
          },
          "is_default": {
            "type": "boolean",
            "description": "Mark as tenant-wide default for this trigger type (default: false).",
            "nullable": true
          },
          "metadata": {
            "description": "Extensible metadata.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Display name for the trigger rule (1-255 characters)."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority for rule matching (higher = matched first, default: 0).",
            "nullable": true
          },
          "reminder_threshold_percent": {
            "type": "integer",
            "format": "int32",
            "description": "Send reminder at this % of deadline (1-99, default: 75).",
            "nullable": true
          },
          "reviewer_type": {
            "allOf": [
              {
                "$ref": "#/components/schemas/MicroCertReviewerType"
              }
            ],
            "nullable": true
          },
          "revoke_triggering_assignment": {
            "type": "boolean",
            "description": "For `SoD`: revoke triggering assignment (default: true).",
            "nullable": true
          },
          "scope_id": {
            "type": "string",
            "format": "uuid",
            "description": "Scope ID (application/entitlement ID - required for non-tenant scope).",
            "nullable": true
          },
          "scope_type": {
            "allOf": [
              {
                "$ref": "#/components/schemas/MicroCertScopeType"
              }
            ],
            "nullable": true
          },
          "specific_reviewer_id": {
            "type": "string",
            "format": "uuid",
            "description": "Specific reviewer user ID (required when `reviewer_type` is `specific_user`).",
            "nullable": true
          },
          "timeout_secs": {
            "type": "integer",
            "format": "int32",
            "description": "Timeout in seconds (default 86400 = 24 hours).",
            "nullable": true
          },
          "trigger_type": {
            "$ref": "#/components/schemas/MicroCertTriggerType"
          }
        }
      },
      "CreateUserRequest": {
        "type": "object",
        "description": "Request to create a new user.",
        "required": [
          "email",
          "password",
          "roles"
        ],
        "properties": {
          "email": {
            "type": "string",
            "description": "User's email address."
          },
          "password": {
            "type": "string",
            "description": "User's password (will be hashed)."
          },
          "roles": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Roles to assign to the user."
          },
          "username": {
            "type": "string",
            "description": "Optional username (3-64 chars, alphanumeric + underscore + hyphen, starts with letter).",
            "nullable": true
          }
        }
      },
      "CreateWebhookSubscriptionRequest": {
        "type": "object",
        "description": "Request body for creating a webhook subscription.",
        "required": [
          "name",
          "url",
          "event_types"
        ],
        "properties": {
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "event_types": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Event types this subscription receives."
          },
          "name": {
            "type": "string",
            "description": "Display name for this subscription."
          },
          "secret": {
            "type": "string",
            "description": "Shared secret for HMAC-SHA256 signature verification.",
            "nullable": true
          },
          "url": {
            "type": "string",
            "description": "Target URL for webhook delivery (HTTPS required in production)."
          }
        }
      },
      "CredentialInfo": {
        "type": "object",
        "description": "Credential information returned to clients (without sensitive data).",
        "required": [
          "id",
          "name",
          "authenticator_type",
          "backup_eligible",
          "backup_state",
          "created_at"
        ],
        "properties": {
          "authenticator_type": {
            "type": "string"
          },
          "backup_eligible": {
            "type": "boolean"
          },
          "backup_state": {
            "type": "boolean"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "last_used_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "name": {
            "type": "string"
          },
          "transports": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "nullable": true
          }
        }
      },
      "CredentialListResponse": {
        "type": "object",
        "description": "Response containing a list of credentials.",
        "required": [
          "credentials",
          "count"
        ],
        "properties": {
          "count": {
            "type": "integer",
            "description": "Total count of credentials.",
            "minimum": 0
          },
          "credentials": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CredentialInfo"
            },
            "description": "List of registered `WebAuthn` credentials."
          }
        }
      },
      "CriteriaLogic": {
        "type": "string",
        "description": "Criteria logic for combining multiple conditions.",
        "enum": [
          "and",
          "or"
        ]
      },
      "CriteriaOperator": {
        "type": "string",
        "description": "Operator for criteria comparison.",
        "enum": [
          "eq",
          "neq",
          "in",
          "not_in",
          "gt",
          "gte",
          "lt",
          "lte",
          "contains",
          "starts_with"
        ]
      },
      "CurrentContextResponse": {
        "type": "object",
        "description": "Current context response.",
        "required": [
          "physical_user_id",
          "is_persona_active",
          "session_started_at",
          "session_expires_at"
        ],
        "properties": {
          "active_persona": {
            "allOf": [
              {
                "$ref": "#/components/schemas/PersonaResponse"
              }
            ],
            "nullable": true
          },
          "is_persona_active": {
            "type": "boolean"
          },
          "physical_user_id": {
            "type": "string",
            "format": "uuid"
          },
          "physical_user_name": {
            "type": "string",
            "nullable": true
          },
          "session_expires_at": {
            "type": "string",
            "format": "date-time"
          },
          "session_started_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "DailyTrend": {
        "type": "object",
        "description": "Execution trend data for a single day.",
        "required": [
          "date",
          "executions",
          "successes",
          "failures",
          "avg_duration_ms"
        ],
        "properties": {
          "avg_duration_ms": {
            "type": "number",
            "format": "double",
            "description": "Average execution duration in milliseconds on this date."
          },
          "date": {
            "type": "string",
            "description": "Date in YYYY-MM-DD format."
          },
          "executions": {
            "type": "integer",
            "format": "int64",
            "description": "Total executions on this date."
          },
          "failures": {
            "type": "integer",
            "format": "int64",
            "description": "Failed executions on this date."
          },
          "successes": {
            "type": "integer",
            "format": "int64",
            "description": "Successful executions on this date."
          }
        }
      },
      "DailyTrendData": {
        "type": "object",
        "description": "A single day's correlation trend data.",
        "required": [
          "date",
          "total_evaluated",
          "auto_confirmed",
          "manual_review",
          "no_match",
          "average_confidence"
        ],
        "properties": {
          "auto_confirmed": {
            "type": "integer",
            "format": "int64",
            "description": "Number of accounts auto-confirmed."
          },
          "average_confidence": {
            "type": "number",
            "format": "double",
            "description": "Average confidence score for the day."
          },
          "date": {
            "type": "string",
            "description": "Date in ISO 8601 format (YYYY-MM-DD)."
          },
          "manual_review": {
            "type": "integer",
            "format": "int64",
            "description": "Number of accounts sent to manual review."
          },
          "no_match": {
            "type": "integer",
            "format": "int64",
            "description": "Number of accounts with no match."
          },
          "total_evaluated": {
            "type": "integer",
            "format": "int64",
            "description": "Total accounts evaluated on this day."
          }
        }
      },
      "DashboardMetricsResponse": {
        "type": "object",
        "description": "Dashboard metrics response.",
        "required": [
          "pending_count",
          "in_progress_count",
          "sla_at_risk_count",
          "sla_breached_count",
          "completed_today"
        ],
        "properties": {
          "avg_completion_time_human": {
            "type": "string",
            "description": "Human-readable average completion time.",
            "nullable": true
          },
          "avg_completion_time_secs": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "completed_today": {
            "type": "integer",
            "format": "int64"
          },
          "in_progress_count": {
            "type": "integer",
            "format": "int64"
          },
          "pending_count": {
            "type": "integer",
            "format": "int64"
          },
          "sla_at_risk_count": {
            "type": "integer",
            "format": "int64"
          },
          "sla_breached_count": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "DashboardResponse": {
        "type": "object",
        "description": "Dashboard analytics response for provisioning scripts.",
        "required": [
          "total_scripts",
          "active_scripts",
          "total_executions",
          "success_rate",
          "avg_duration_ms",
          "scripts"
        ],
        "properties": {
          "active_scripts": {
            "type": "integer",
            "format": "int64",
            "description": "Number of active scripts."
          },
          "avg_duration_ms": {
            "type": "number",
            "format": "double",
            "description": "Average execution duration in milliseconds."
          },
          "scripts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScriptSummary"
            },
            "description": "Per-script summary statistics."
          },
          "success_rate": {
            "type": "number",
            "format": "double",
            "description": "Overall success rate as a percentage (0.0 - 100.0)."
          },
          "total_executions": {
            "type": "integer",
            "format": "int64",
            "description": "Total number of script executions."
          },
          "total_scripts": {
            "type": "integer",
            "format": "int64",
            "description": "Total number of scripts."
          }
        }
      },
      "DeactivatePersonaRequest": {
        "type": "object",
        "description": "Request to deactivate a persona.",
        "required": [
          "reason"
        ],
        "properties": {
          "reason": {
            "type": "string",
            "description": "Reason for deactivation (5-1000 characters)."
          }
        }
      },
      "DecideMicroCertificationRequest": {
        "type": "object",
        "description": "Request to submit a decision for a micro-certification.",
        "required": [
          "decision"
        ],
        "properties": {
          "comment": {
            "type": "string",
            "description": "Comment/justification (required for revoke/reduce, optional for approve).",
            "nullable": true
          },
          "decision": {
            "$ref": "#/components/schemas/MicroCertDecision"
          }
        }
      },
      "DecisionRequest": {
        "type": "object",
        "description": "Request to make a certification decision.",
        "required": [
          "decision"
        ],
        "properties": {
          "comment": {
            "type": "string",
            "nullable": true
          },
          "decision": {
            "type": "string"
          }
        }
      },
      "DecisionResponse": {
        "type": "object",
        "description": "Decision response.",
        "required": [
          "id",
          "item_id",
          "decision_type",
          "decided_by",
          "decided_at",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the record was created."
          },
          "decided_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the decision was made."
          },
          "decided_by": {
            "type": "string",
            "format": "uuid",
            "description": "User who made the decision."
          },
          "decision_type": {
            "$ref": "#/components/schemas/CertDecisionType"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "item_id": {
            "type": "string",
            "format": "uuid",
            "description": "Item ID."
          },
          "justification": {
            "type": "string",
            "description": "Justification.",
            "nullable": true
          }
        }
      },
      "DecisionSummary": {
        "type": "object",
        "description": "Summary of a previous decision.",
        "required": [
          "step_order",
          "decision",
          "approver_id",
          "decided_at"
        ],
        "properties": {
          "approver_id": {
            "type": "string",
            "format": "uuid",
            "description": "Approver ID."
          },
          "approver_name": {
            "type": "string",
            "description": "Approver name.",
            "nullable": true
          },
          "comments": {
            "type": "string",
            "description": "Comments.",
            "nullable": true
          },
          "decided_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the decision was made."
          },
          "decision": {
            "$ref": "#/components/schemas/GovDecisionType"
          },
          "step_order": {
            "type": "integer",
            "format": "int32",
            "description": "Step this decision was for."
          }
        }
      },
      "DefaultEntitlementRequest": {
        "type": "object",
        "description": "Default entitlement to assign to new personas.",
        "required": [
          "application_id",
          "entitlement_id"
        ],
        "properties": {
          "application_id": {
            "type": "string",
            "format": "uuid",
            "description": "Application ID."
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement ID."
          },
          "reason": {
            "type": "string",
            "description": "Assignment reason.",
            "nullable": true
          }
        }
      },
      "DelegateMicroCertificationRequest": {
        "type": "object",
        "description": "Request to delegate a micro-certification to another reviewer.",
        "required": [
          "delegate_to"
        ],
        "properties": {
          "comment": {
            "type": "string",
            "description": "Reason for delegating (optional but recommended).",
            "nullable": true
          },
          "delegate_to": {
            "type": "string",
            "format": "uuid",
            "description": "The user ID to delegate the certification to."
          }
        }
      },
      "DelegationListResponse": {
        "type": "object",
        "description": "Paginated list of delegations.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DelegationResponse"
            },
            "description": "List of delegations."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "DelegationResponse": {
        "type": "object",
        "description": "Delegation response.",
        "required": [
          "id",
          "delegator_id",
          "delegate_id",
          "starts_at",
          "ends_at",
          "is_active",
          "is_currently_active",
          "status",
          "expiry_warning_sent",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the delegation was created."
          },
          "delegate_id": {
            "type": "string",
            "format": "uuid",
            "description": "User receiving authority."
          },
          "delegator_id": {
            "type": "string",
            "format": "uuid",
            "description": "User who delegated authority."
          },
          "ends_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the delegation ends."
          },
          "expiry_warning_sent": {
            "type": "boolean",
            "description": "Whether expiration warning was sent (F053)."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the delegation is active (not revoked). Legacy field."
          },
          "is_currently_active": {
            "type": "boolean",
            "description": "Whether the delegation is currently in effect."
          },
          "revoked_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the delegation was revoked (if applicable).",
            "nullable": true
          },
          "scope_id": {
            "type": "string",
            "format": "uuid",
            "description": "Scope ID if scoped delegation (F053).",
            "nullable": true
          },
          "starts_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the delegation becomes active."
          },
          "status": {
            "$ref": "#/components/schemas/DelegationStatus"
          }
        }
      },
      "DeleteOrphanRequest": {
        "type": "object",
        "description": "Request to request deletion of an orphan account.",
        "required": [
          "justification"
        ],
        "properties": {
          "justification": {
            "type": "string",
            "description": "Justification for deletion."
          }
        }
      },
      "DeleteOrphanResponse": {
        "type": "object",
        "description": "Response for delete request (may need approval).",
        "required": [
          "detection",
          "requires_approval"
        ],
        "properties": {
          "access_request_id": {
            "type": "string",
            "format": "uuid",
            "description": "Access request ID if approval is required.",
            "nullable": true
          },
          "detection": {
            "$ref": "#/components/schemas/OrphanDetectionResponse"
          },
          "requires_approval": {
            "type": "boolean",
            "description": "Whether deletion requires approval."
          }
        }
      },
      "DenyRequest": {
        "type": "object",
        "description": "Request body for denying an approval request.",
        "required": [
          "reason"
        ],
        "properties": {
          "reason": {
            "type": "string"
          }
        }
      },
      "DependencyCheck": {
        "type": "object",
        "description": "Dependency check result included in readiness responses.",
        "required": [
          "status",
          "latency_ms"
        ],
        "properties": {
          "error": {
            "type": "string",
            "nullable": true
          },
          "latency_ms": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          },
          "status": {
            "type": "string"
          }
        }
      },
      "DetailedFactorScore": {
        "type": "object",
        "description": "Detailed factor score with explanation.",
        "required": [
          "factor_name",
          "raw_value",
          "weight",
          "contribution",
          "details"
        ],
        "properties": {
          "contribution": {
            "type": "number",
            "format": "double"
          },
          "details": {
            "type": "string"
          },
          "factor_name": {
            "type": "string"
          },
          "peer_average": {
            "type": "number",
            "format": "double",
            "description": "How this compares to peers.",
            "nullable": true
          },
          "peer_std_dev": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "raw_value": {
            "type": "number",
            "format": "double"
          },
          "weight": {
            "type": "number",
            "format": "double"
          },
          "z_score": {
            "type": "number",
            "format": "double",
            "nullable": true
          }
        }
      },
      "DetectedAnomaly": {
        "type": "object",
        "description": "A detected anomaly record.",
        "required": [
          "id",
          "agent_id",
          "anomaly_type",
          "severity",
          "score",
          "z_score",
          "baseline_value",
          "observed_value",
          "description",
          "detected_at"
        ],
        "properties": {
          "agent_id": {
            "type": "string",
            "format": "uuid"
          },
          "anomaly_type": {
            "$ref": "#/components/schemas/AnomalyType"
          },
          "baseline_value": {
            "type": "number",
            "format": "double"
          },
          "context": {
            "nullable": true
          },
          "description": {
            "type": "string"
          },
          "detected_at": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "observed_value": {
            "type": "number",
            "format": "double"
          },
          "score": {
            "type": "integer",
            "format": "int32"
          },
          "severity": {
            "$ref": "#/components/schemas/Severity"
          },
          "z_score": {
            "type": "number",
            "format": "double"
          }
        }
      },
      "DetectionJobResponse": {
        "type": "object",
        "description": "Response for detection job.",
        "required": [
          "job_id",
          "status",
          "started_at"
        ],
        "properties": {
          "job_id": {
            "type": "string",
            "format": "uuid"
          },
          "started_at": {
            "type": "string",
            "format": "date-time"
          },
          "status": {
            "$ref": "#/components/schemas/DetectionJobStatus"
          }
        }
      },
      "DetectionJobStatus": {
        "type": "string",
        "description": "Status of detection job.",
        "enum": [
          "queued",
          "running",
          "completed"
        ]
      },
      "DetectionRuleListResponse": {
        "type": "object",
        "description": "Paginated list of detection rules.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DetectionRuleResponse"
            },
            "description": "List of rules."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "DetectionRuleResponse": {
        "type": "object",
        "description": "Detection rule response.",
        "required": [
          "id",
          "name",
          "rule_type",
          "is_enabled",
          "priority",
          "parameters",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "description": {
            "type": "string",
            "description": "Human-readable description.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Rule ID."
          },
          "is_enabled": {
            "type": "boolean",
            "description": "Whether this rule is enabled."
          },
          "name": {
            "type": "string",
            "description": "Rule display name."
          },
          "parameters": {
            "description": "Rule-specific parameters."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority for rule execution (lower = higher priority)."
          },
          "rule_type": {
            "$ref": "#/components/schemas/DetectionRuleType"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          }
        }
      },
      "DetectionRuleType": {
        "type": "string",
        "description": "Type of detection rule.",
        "enum": [
          "no_manager",
          "terminated",
          "inactive",
          "custom"
        ]
      },
      "DeviceAuthorizationRequest": {
        "type": "object",
        "description": "Request for POST /oauth/device/code.",
        "required": [
          "client_id"
        ],
        "properties": {
          "client_id": {
            "type": "string",
            "description": "OAuth client identifier."
          },
          "scope": {
            "type": "string",
            "description": "Space-separated list of requested scopes.",
            "nullable": true
          }
        }
      },
      "DeviceAuthorizationResponse": {
        "type": "object",
        "description": "Response for POST /oauth/device/code (RFC 8628).",
        "required": [
          "device_code",
          "user_code",
          "verification_uri",
          "expires_in",
          "interval"
        ],
        "properties": {
          "device_code": {
            "type": "string",
            "description": "Secret code for token polling (do not display to user)."
          },
          "expires_in": {
            "type": "integer",
            "format": "int64",
            "description": "Seconds until `device_code` expires."
          },
          "interval": {
            "type": "integer",
            "format": "int32",
            "description": "Minimum seconds between polling requests."
          },
          "user_code": {
            "type": "string",
            "description": "Code to display to user for browser entry."
          },
          "verification_uri": {
            "type": "string",
            "description": "URL where user should visit to enter code."
          },
          "verification_uri_complete": {
            "type": "string",
            "description": "URL with code pre-filled (optional convenience).",
            "nullable": true
          }
        }
      },
      "DeviceCodeErrorResponse": {
        "type": "object",
        "description": "Error response for device code endpoints.",
        "required": [
          "error"
        ],
        "properties": {
          "error": {
            "type": "string",
            "description": "Error code."
          },
          "error_description": {
            "type": "string",
            "description": "Human-readable error description.",
            "nullable": true
          }
        }
      },
      "DiffChangeType": {
        "type": "string",
        "description": "Type of change in a diff line.",
        "enum": [
          "added",
          "removed",
          "unchanged"
        ]
      },
      "DiffLine": {
        "type": "object",
        "description": "A single line in a version diff.",
        "required": [
          "line_number",
          "change_type",
          "content"
        ],
        "properties": {
          "change_type": {
            "$ref": "#/components/schemas/DiffChangeType"
          },
          "content": {
            "type": "string",
            "description": "Content of the line."
          },
          "line_number": {
            "type": "integer",
            "description": "Line number in the output.",
            "minimum": 0
          }
        }
      },
      "DisableOrphanRequest": {
        "type": "object",
        "description": "Request to disable an orphan account.",
        "properties": {
          "notes": {
            "type": "string",
            "description": "Justification for disabling.",
            "nullable": true
          }
        }
      },
      "DiscoveredEndpointsResponse": {
        "type": "object",
        "description": "Discovered endpoints in validation response.",
        "required": [
          "authorization_endpoint",
          "token_endpoint",
          "jwks_uri"
        ],
        "properties": {
          "authorization_endpoint": {
            "type": "string"
          },
          "jwks_uri": {
            "type": "string"
          },
          "token_endpoint": {
            "type": "string"
          },
          "userinfo_endpoint": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "DiscrepancyResponse": {
        "type": "object",
        "description": "Response for a discrepancy.",
        "required": [
          "id",
          "run_id",
          "discrepancy_type",
          "external_uid",
          "resolution_status",
          "detected_at",
          "suggested_actions"
        ],
        "properties": {
          "detected_at": {
            "type": "string",
            "format": "date-time"
          },
          "discrepancy_type": {
            "type": "string"
          },
          "external_uid": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "identity_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "mismatched_attributes": {
            "nullable": true
          },
          "resolution_status": {
            "type": "string"
          },
          "resolved_action": {
            "type": "string",
            "nullable": true
          },
          "resolved_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "resolved_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "run_id": {
            "type": "string",
            "format": "uuid"
          },
          "suggested_actions": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "DiscrepancySummary": {
        "type": "object",
        "description": "Discrepancy summary for report.",
        "required": [
          "total",
          "by_type",
          "by_resolution"
        ],
        "properties": {
          "by_resolution": {
            "type": "object",
            "additionalProperties": {
              "type": "integer",
              "format": "int32",
              "minimum": 0
            }
          },
          "by_type": {
            "type": "object",
            "additionalProperties": {
              "type": "integer",
              "format": "int32",
              "minimum": 0
            }
          },
          "total": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "DismissCandidateRequest": {
        "type": "object",
        "description": "Request to dismiss a candidate.",
        "properties": {
          "reason": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "DismissConsolidationRequest": {
        "type": "object",
        "description": "Request to dismiss a consolidation suggestion.",
        "properties": {
          "reason": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "DismissDuplicateRequest": {
        "type": "object",
        "description": "Request to dismiss a duplicate.",
        "required": [
          "reason"
        ],
        "properties": {
          "reason": {
            "type": "string"
          }
        }
      },
      "DismissOrphanRequest": {
        "type": "object",
        "description": "Request to dismiss an orphan detection as false positive.",
        "required": [
          "justification"
        ],
        "properties": {
          "justification": {
            "type": "string",
            "description": "Justification for dismissal."
          }
        }
      },
      "DispositionResponse": {
        "type": "object",
        "description": "Response containing disposition details.",
        "required": [
          "id",
          "result_id",
          "user_id",
          "status",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "justification": {
            "type": "string",
            "nullable": true
          },
          "result_id": {
            "type": "string",
            "format": "uuid"
          },
          "reviewed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "reviewed_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/OutlierDispositionStatus"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "DispositionSummaryResponse": {
        "type": "object",
        "description": "Summary of dispositions by status.",
        "required": [
          "new_count",
          "legitimate_count",
          "requires_remediation_count",
          "under_investigation_count",
          "remediated_count"
        ],
        "properties": {
          "legitimate_count": {
            "type": "integer",
            "format": "int64"
          },
          "new_count": {
            "type": "integer",
            "format": "int64"
          },
          "remediated_count": {
            "type": "integer",
            "format": "int64"
          },
          "requires_remediation_count": {
            "type": "integer",
            "format": "int64"
          },
          "under_investigation_count": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "DlqListResponse": {
        "type": "object",
        "description": "Dead letter queue list response.",
        "required": [
          "operations",
          "offset",
          "limit"
        ],
        "properties": {
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Applied limit."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Current offset."
          },
          "operations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/OperationResponse"
            },
            "description": "List of dead letter operations."
          }
        }
      },
      "DomainListResponse": {
        "type": "object",
        "description": "Domain list response.",
        "required": [
          "items"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DomainResponse"
            }
          }
        }
      },
      "DomainResponse": {
        "type": "object",
        "description": "Domain response.",
        "required": [
          "id",
          "domain",
          "priority",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "domain": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "priority": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "DryRunRequest": {
        "type": "object",
        "description": "Request to perform a dry run of a script.",
        "required": [
          "context"
        ],
        "properties": {
          "context": {
            "description": "Simulated provisioning context for the dry run."
          }
        }
      },
      "DryRunResponse": {
        "type": "object",
        "description": "Response from a script dry run.",
        "required": [
          "success",
          "duration_ms"
        ],
        "properties": {
          "duration_ms": {
            "type": "integer",
            "format": "int64",
            "description": "Execution duration in milliseconds.",
            "minimum": 0
          },
          "error": {
            "type": "string",
            "description": "Error message (if the script failed).",
            "nullable": true
          },
          "output": {
            "description": "Output produced by the script (if successful).",
            "nullable": true
          },
          "success": {
            "type": "boolean",
            "description": "Whether the dry run completed successfully."
          }
        }
      },
      "DuplicateCandidateResponse": {
        "type": "object",
        "description": "Response for a duplicate candidate in list.",
        "required": [
          "id",
          "identity_a_id",
          "identity_b_id",
          "confidence_score",
          "status",
          "detected_at"
        ],
        "properties": {
          "confidence_score": {
            "type": "number",
            "format": "double"
          },
          "detected_at": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "identity_a_id": {
            "type": "string",
            "format": "uuid"
          },
          "identity_b_id": {
            "type": "string",
            "format": "uuid"
          },
          "status": {
            "$ref": "#/components/schemas/GovDuplicateStatus"
          }
        }
      },
      "DuplicateDetailResponse": {
        "type": "object",
        "description": "Detailed duplicate comparison response.",
        "required": [
          "id",
          "identity_a_id",
          "identity_b_id",
          "confidence_score",
          "identity_a",
          "identity_b",
          "attribute_comparison",
          "rule_matches"
        ],
        "properties": {
          "attribute_comparison": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AttributeComparison"
            }
          },
          "confidence_score": {
            "type": "number",
            "format": "double"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "identity_a": {
            "$ref": "#/components/schemas/IdentitySummary"
          },
          "identity_a_id": {
            "type": "string",
            "format": "uuid"
          },
          "identity_b": {
            "$ref": "#/components/schemas/IdentitySummary"
          },
          "identity_b_id": {
            "type": "string",
            "format": "uuid"
          },
          "rule_matches": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RuleMatchResponse"
            }
          }
        }
      },
      "EffectiveAccessResponse": {
        "type": "object",
        "description": "Response for effective access query.",
        "required": [
          "user_id",
          "tenant_id",
          "entitlements",
          "total"
        ],
        "properties": {
          "entitlements": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EffectiveEntitlementResponse"
            },
            "description": "All effective entitlements with their sources."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count of unique entitlements."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID."
          }
        }
      },
      "EffectiveEntitlementResponse": {
        "type": "object",
        "description": "An effective entitlement with its sources (API response format).",
        "required": [
          "entitlement_id",
          "entitlement_name",
          "application_id",
          "risk_level",
          "sources"
        ],
        "properties": {
          "application_id": {
            "type": "string",
            "format": "uuid",
            "description": "Application ID."
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement ID."
          },
          "entitlement_name": {
            "type": "string",
            "description": "Entitlement name."
          },
          "risk_level": {
            "type": "string",
            "description": "Risk level."
          },
          "sources": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EntitlementSourceResponse"
            },
            "description": "All sources that grant this entitlement."
          }
        }
      },
      "EffectiveEntitlementWithParams": {
        "type": "object",
        "description": "Effective entitlement with parameter context.",
        "required": [
          "entitlement_id",
          "entitlement_name",
          "application_id",
          "assignment_id",
          "source",
          "is_parametric"
        ],
        "properties": {
          "application_id": {
            "type": "string",
            "format": "uuid",
            "description": "Application ID."
          },
          "application_name": {
            "type": "string",
            "description": "Application name.",
            "nullable": true
          },
          "assignment_id": {
            "type": "string",
            "format": "uuid",
            "description": "Assignment ID."
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement ID."
          },
          "entitlement_name": {
            "type": "string",
            "description": "Entitlement name."
          },
          "is_parametric": {
            "type": "boolean",
            "description": "Whether this is a parametric entitlement."
          },
          "parameters": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EffectiveParameterValue"
            },
            "description": "Parameter context (if parametric).",
            "nullable": true
          },
          "source": {
            "type": "string",
            "description": "How the entitlement was obtained (direct, group, role)."
          }
        }
      },
      "EffectiveParameterValue": {
        "type": "object",
        "description": "An effective parameter value for provisioning.",
        "required": [
          "name",
          "value",
          "parameter_type"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Parameter name."
          },
          "parameter_type": {
            "type": "string",
            "description": "Parameter type."
          },
          "value": {
            "description": "Parameter value."
          }
        }
      },
      "EffectivePermissions": {
        "type": "object",
        "description": "User's effective permissions after aggregating all assignments.",
        "required": [
          "permissions",
          "scopes"
        ],
        "properties": {
          "permissions": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Set of permission codes (e.g., \"users:read\", \"users:*\").",
            "uniqueItems": true
          },
          "scopes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScopeAssignment"
            },
            "description": "List of scopes from all active assignments."
          }
        }
      },
      "EmailOtpVerifyRequest": {
        "type": "object",
        "description": "Request to verify an email OTP code.",
        "required": [
          "email",
          "code"
        ],
        "properties": {
          "code": {
            "type": "string",
            "description": "6-digit OTP code from email."
          },
          "email": {
            "type": "string",
            "description": "User email address."
          }
        }
      },
      "EmailTemplatePreviewResponse": {
        "type": "object",
        "description": "Response for email template preview.",
        "required": [
          "subject",
          "body_html"
        ],
        "properties": {
          "body_html": {
            "type": "string"
          },
          "body_text": {
            "type": "string",
            "nullable": true
          },
          "subject": {
            "type": "string"
          }
        }
      },
      "EmailTemplateResponse": {
        "type": "object",
        "description": "Full email template response.",
        "required": [
          "template_type",
          "locale",
          "subject",
          "body_html",
          "available_variables",
          "is_customized",
          "is_active"
        ],
        "properties": {
          "available_variables": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TemplateVariableInfo"
            }
          },
          "body_html": {
            "type": "string"
          },
          "body_text": {
            "type": "string",
            "nullable": true
          },
          "is_active": {
            "type": "boolean"
          },
          "is_customized": {
            "type": "boolean"
          },
          "locale": {
            "type": "string"
          },
          "subject": {
            "type": "string"
          },
          "template_type": {
            "type": "string"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          }
        }
      },
      "EmailTemplateSummaryResponse": {
        "type": "object",
        "description": "Summary of an email template.",
        "required": [
          "template_type",
          "locale",
          "is_customized",
          "is_active"
        ],
        "properties": {
          "is_active": {
            "type": "boolean"
          },
          "is_customized": {
            "type": "boolean"
          },
          "locale": {
            "type": "string"
          },
          "template_type": {
            "type": "string"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          }
        }
      },
      "EndpointInfo": {
        "type": "object",
        "description": "API endpoint information.",
        "required": [
          "api",
          "auth"
        ],
        "properties": {
          "api": {
            "type": "string",
            "description": "Base API URL.",
            "example": "https://api.xavyo.net"
          },
          "auth": {
            "type": "string",
            "description": "Authentication URL.",
            "example": "https://auth.xavyo.net"
          }
        }
      },
      "EnforcementAction": {
        "type": "string",
        "description": "Enforcement action required based on risk.",
        "enum": [
          "none",
          "alert",
          "require_mfa",
          "block"
        ]
      },
      "EnforcementPolicyResponse": {
        "type": "object",
        "description": "Enforcement policy response for admin API.",
        "required": [
          "id",
          "tenant_id",
          "enforcement_mode",
          "fail_open",
          "impossible_travel_speed_kmh",
          "impossible_travel_enabled",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the policy was created."
          },
          "enforcement_mode": {
            "type": "string",
            "description": "Enforcement mode."
          },
          "fail_open": {
            "type": "boolean",
            "description": "Whether to fail-open when risk service is unavailable."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Policy ID (nil UUID if using default)."
          },
          "impossible_travel_enabled": {
            "type": "boolean",
            "description": "Whether impossible travel detection is enabled."
          },
          "impossible_travel_speed_kmh": {
            "type": "integer",
            "format": "int32",
            "description": "Speed threshold for impossible travel (km/h)."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the policy was last updated."
          }
        }
      },
      "EntitlementLinkListResponse": {
        "type": "object",
        "description": "Paginated response for entitlement links.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LicenseEntitlementLinkResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "EntitlementListResponse": {
        "type": "object",
        "description": "Paginated list of entitlements.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EntitlementResponse"
            },
            "description": "List of entitlements."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Maximum number of results returned."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Number of results skipped."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count of matching entitlements."
          }
        }
      },
      "EntitlementResponse": {
        "type": "object",
        "description": "Entitlement response model.",
        "required": [
          "id",
          "tenant_id",
          "application_id",
          "name",
          "risk_level",
          "status",
          "is_delegable",
          "data_protection_classification",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "application_id": {
            "type": "string",
            "format": "uuid",
            "description": "The application this entitlement belongs to."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the entitlement was created."
          },
          "data_controller": {
            "type": "string",
            "description": "Name of the data controller organization.",
            "nullable": true
          },
          "data_processor": {
            "type": "string",
            "description": "Name of the data processor organization.",
            "nullable": true
          },
          "data_protection_classification": {
            "$ref": "#/components/schemas/DataProtectionClassification"
          },
          "description": {
            "type": "string",
            "description": "Entitlement description.",
            "nullable": true
          },
          "external_id": {
            "type": "string",
            "description": "External system reference ID.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the entitlement."
          },
          "is_delegable": {
            "type": "boolean",
            "description": "Whether this entitlement can be delegated."
          },
          "legal_basis": {
            "allOf": [
              {
                "$ref": "#/components/schemas/GdprLegalBasis"
              }
            ],
            "nullable": true
          },
          "metadata": {
            "description": "Extensible metadata as JSON.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Entitlement display name."
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement owner (user ID).",
            "nullable": true
          },
          "purposes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Processing purpose labels.",
            "nullable": true
          },
          "retention_period_days": {
            "type": "integer",
            "format": "int32",
            "description": "Data retention period in days.",
            "nullable": true
          },
          "risk_level": {
            "$ref": "#/components/schemas/GovRiskLevel"
          },
          "status": {
            "$ref": "#/components/schemas/GovEntitlementStatus"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the entitlement was last updated."
          }
        }
      },
      "EntitlementSourceResponse": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "direct"
                ]
              }
            }
          },
          {
            "type": "object",
            "description": "Inherited from group membership.",
            "required": [
              "group_id",
              "group_name",
              "type"
            ],
            "properties": {
              "group_id": {
                "type": "string",
                "format": "uuid",
                "description": "Group ID."
              },
              "group_name": {
                "type": "string",
                "description": "Group name."
              },
              "type": {
                "type": "string",
                "enum": [
                  "group"
                ]
              }
            }
          },
          {
            "type": "object",
            "description": "Inherited from role (legacy string-based roles).",
            "required": [
              "role_name",
              "type"
            ],
            "properties": {
              "role_name": {
                "type": "string",
                "description": "Role name."
              },
              "type": {
                "type": "string",
                "enum": [
                  "role"
                ]
              }
            }
          },
          {
            "type": "object",
            "description": "From governance role hierarchy (F088).",
            "required": [
              "role_id",
              "role_name",
              "source_role_id",
              "source_role_name",
              "is_inherited",
              "type"
            ],
            "properties": {
              "is_inherited": {
                "type": "boolean",
                "description": "Whether entitlement is inherited from an ancestor role."
              },
              "role_id": {
                "type": "string",
                "format": "uuid",
                "description": "The role ID the user is assigned to."
              },
              "role_name": {
                "type": "string",
                "description": "The role name the user is assigned to."
              },
              "source_role_id": {
                "type": "string",
                "format": "uuid",
                "description": "The source role ID that grants the entitlement (may be ancestor)."
              },
              "source_role_name": {
                "type": "string",
                "description": "The source role name."
              },
              "type": {
                "type": "string",
                "enum": [
                  "gov_role"
                ]
              }
            }
          }
        ],
        "description": "Source of an entitlement assignment (API response format).",
        "discriminator": {
          "propertyName": "type"
        }
      },
      "EntitlementUsage": {
        "type": "object",
        "description": "Entitlement usage details within a role.",
        "required": [
          "entitlement_id",
          "used_by_count",
          "total_users",
          "usage_rate"
        ],
        "properties": {
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement ID."
          },
          "total_users": {
            "type": "integer",
            "format": "int32",
            "description": "Total users with the role."
          },
          "usage_rate": {
            "type": "number",
            "format": "double",
            "description": "Usage rate (`used_by_count` / `total_users`)."
          },
          "used_by_count": {
            "type": "integer",
            "format": "int32",
            "description": "Users who actually use this entitlement."
          }
        }
      },
      "EntitlementsPreview": {
        "type": "object",
        "description": "Entitlements preview showing consolidation result.",
        "required": [
          "source_only",
          "target_only",
          "common",
          "merged"
        ],
        "properties": {
          "common": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MergeEntitlementSummary"
            }
          },
          "merged": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MergeEntitlementSummary"
            }
          },
          "source_only": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MergeEntitlementSummary"
            }
          },
          "target_only": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MergeEntitlementSummary"
            }
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "description": "Error response.",
        "required": [
          "error",
          "message"
        ],
        "properties": {
          "error": {
            "type": "string"
          },
          "message": {
            "type": "string"
          }
        }
      },
      "ErrorSummary": {
        "type": "object",
        "description": "Summary of a recurring error.",
        "required": [
          "error_message",
          "count",
          "last_occurred"
        ],
        "properties": {
          "count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of times this error has occurred."
          },
          "error_message": {
            "type": "string",
            "description": "The error message."
          },
          "last_occurred": {
            "type": "string",
            "format": "date-time",
            "description": "When this error last occurred."
          }
        }
      },
      "EscalationEventListResponse": {
        "type": "object",
        "description": "Paginated list of escalation events.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EscalationEventResponse"
            },
            "description": "List of escalation events."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "EscalationEventResponse": {
        "type": "object",
        "description": "Escalation event response for audit trail.",
        "required": [
          "id",
          "request_id",
          "step_order",
          "escalation_level",
          "escalation_target_type",
          "escalation_target_ids",
          "reason",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the escalation occurred."
          },
          "escalation_level": {
            "type": "integer",
            "format": "int32",
            "description": "The escalation level reached (1 = first escalation)."
          },
          "escalation_target_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "User IDs who received the escalated work item."
          },
          "escalation_target_type": {
            "$ref": "#/components/schemas/EscalationTargetType"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique event identifier."
          },
          "metadata": {
            "description": "Additional metadata (e.g., fallback action, `levels_exhausted`).",
            "nullable": true
          },
          "new_deadline": {
            "type": "string",
            "format": "date-time",
            "description": "New deadline after escalation (if any).",
            "nullable": true
          },
          "original_approver_id": {
            "type": "string",
            "format": "uuid",
            "description": "Original approver who didn't respond (if applicable).",
            "nullable": true
          },
          "previous_deadline": {
            "type": "string",
            "format": "date-time",
            "description": "Previous deadline before escalation (if any).",
            "nullable": true
          },
          "reason": {
            "$ref": "#/components/schemas/EscalationReason"
          },
          "request_id": {
            "type": "string",
            "format": "uuid",
            "description": "The access request this escalation belongs to."
          },
          "step_order": {
            "type": "integer",
            "format": "int32",
            "description": "The approval step order (1-indexed)."
          }
        }
      },
      "EscalationHistoryResponse": {
        "type": "object",
        "description": "Escalation history for a specific access request.",
        "required": [
          "request_id",
          "events",
          "current_level",
          "levels_exhausted",
          "total_escalations"
        ],
        "properties": {
          "current_level": {
            "type": "integer",
            "format": "int32",
            "description": "Current escalation level (0 = not escalated)."
          },
          "events": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EscalationEventResponse"
            },
            "description": "Escalation events in chronological order."
          },
          "levels_exhausted": {
            "type": "boolean",
            "description": "Whether all escalation levels have been exhausted."
          },
          "request_id": {
            "type": "string",
            "format": "uuid",
            "description": "The access request ID."
          },
          "total_escalations": {
            "type": "integer",
            "description": "Total number of escalation events.",
            "minimum": 0
          }
        }
      },
      "EscalationLevelResponse": {
        "type": "object",
        "description": "Escalation level response.",
        "required": [
          "id",
          "level_order",
          "timeout_secs",
          "target_type",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "level_name": {
            "type": "string",
            "description": "Display name for this level.",
            "nullable": true
          },
          "level_order": {
            "type": "integer",
            "format": "int32",
            "description": "Level order (1 = first escalation)."
          },
          "manager_chain_depth": {
            "type": "integer",
            "format": "int32",
            "description": "Depth for `manager_chain` type.",
            "nullable": true
          },
          "target_id": {
            "type": "string",
            "format": "uuid",
            "description": "Target ID (user, group, or null for manager types).",
            "nullable": true
          },
          "target_type": {
            "$ref": "#/components/schemas/EscalationTargetType"
          },
          "timeout_secs": {
            "type": "integer",
            "format": "int64",
            "description": "Timeout in seconds before escalating to this level."
          }
        }
      },
      "EscalationPolicyListResponse": {
        "type": "object",
        "description": "Paginated list of escalation policies.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EscalationPolicySummary"
            },
            "description": "List of policies."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "EscalationPolicyResponse": {
        "type": "object",
        "description": "Escalation policy response.",
        "required": [
          "id",
          "name",
          "default_timeout_secs",
          "final_fallback",
          "is_active",
          "levels",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "default_timeout_secs": {
            "type": "integer",
            "format": "int64",
            "description": "Default timeout in seconds."
          },
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "final_fallback": {
            "$ref": "#/components/schemas/FinalFallbackAction"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether this is the active default policy."
          },
          "levels": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EscalationLevelResponse"
            },
            "description": "Escalation levels."
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          },
          "warning_threshold_secs": {
            "type": "integer",
            "format": "int64",
            "description": "Warning threshold in seconds.",
            "nullable": true
          }
        }
      },
      "EscalationPolicySummary": {
        "type": "object",
        "description": "Policy summary for list views.",
        "required": [
          "id",
          "name",
          "default_timeout_secs",
          "final_fallback",
          "is_active",
          "level_count",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "default_timeout_secs": {
            "type": "integer",
            "format": "int64",
            "description": "Default timeout in seconds."
          },
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "final_fallback": {
            "$ref": "#/components/schemas/FinalFallbackAction"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the policy is active."
          },
          "level_count": {
            "type": "integer",
            "format": "int32",
            "description": "Number of escalation levels."
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          }
        }
      },
      "EscalationReason": {
        "type": "string",
        "description": "Reason for escalation.",
        "enum": [
          "timeout",
          "manual_escalation",
          "target_unavailable"
        ]
      },
      "EscalationTargetType": {
        "type": "string",
        "description": "Escalation target types.",
        "enum": [
          "specific_user",
          "approval_group",
          "manager",
          "manager_chain",
          "tenant_admin"
        ]
      },
      "EvaluateRoleMatchRequest": {
        "type": "object",
        "description": "Request to evaluate which meta-roles match a role.",
        "required": [
          "role_id"
        ],
        "properties": {
          "role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Role ID to evaluate."
          }
        }
      },
      "EvaluationMode": {
        "type": "string",
        "description": "Evaluation mode for birthright policies.",
        "enum": [
          "first_match",
          "all_match"
        ]
      },
      "EventListResponse": {
        "type": "object",
        "description": "Paginated list of events.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EventResponse"
            },
            "description": "List of events."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "EventResponse": {
        "type": "object",
        "description": "Event response.",
        "required": [
          "id",
          "tenant_id",
          "event_type",
          "created_at"
        ],
        "properties": {
          "actor_id": {
            "type": "string",
            "format": "uuid",
            "description": "Actor who triggered the event (NULL for system events).",
            "nullable": true
          },
          "affected_roles": {
            "description": "Affected role IDs.",
            "nullable": true
          },
          "changes": {
            "description": "Before/after state changes.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the event occurred."
          },
          "event_type": {
            "$ref": "#/components/schemas/MetaRoleEventType"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "meta_role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Related meta-role ID (NULL for cascade events).",
            "nullable": true
          },
          "metadata": {
            "description": "Additional context.",
            "nullable": true
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          }
        }
      },
      "EventStatsResponse": {
        "type": "object",
        "description": "Event statistics response.",
        "required": [
          "total",
          "created",
          "updated",
          "deleted",
          "disabled",
          "enabled",
          "inheritance_applied",
          "inheritance_removed",
          "conflict_detected",
          "conflict_resolved",
          "cascade_started",
          "cascade_completed",
          "cascade_failed"
        ],
        "properties": {
          "cascade_completed": {
            "type": "integer",
            "format": "int64",
            "description": "Cascade completed events."
          },
          "cascade_failed": {
            "type": "integer",
            "format": "int64",
            "description": "Cascade failed events."
          },
          "cascade_started": {
            "type": "integer",
            "format": "int64",
            "description": "Cascade started events."
          },
          "conflict_detected": {
            "type": "integer",
            "format": "int64",
            "description": "Conflict detected events."
          },
          "conflict_resolved": {
            "type": "integer",
            "format": "int64",
            "description": "Conflict resolved events."
          },
          "created": {
            "type": "integer",
            "format": "int64",
            "description": "Created events."
          },
          "deleted": {
            "type": "integer",
            "format": "int64",
            "description": "Deleted events."
          },
          "disabled": {
            "type": "integer",
            "format": "int64",
            "description": "Disabled events."
          },
          "enabled": {
            "type": "integer",
            "format": "int64",
            "description": "Enabled events."
          },
          "inheritance_applied": {
            "type": "integer",
            "format": "int64",
            "description": "Inheritance applied events."
          },
          "inheritance_removed": {
            "type": "integer",
            "format": "int64",
            "description": "Inheritance removed events."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total events."
          },
          "updated": {
            "type": "integer",
            "format": "int64",
            "description": "Updated events."
          }
        }
      },
      "EventTypeInfo": {
        "type": "object",
        "description": "Information about a supported event type.",
        "required": [
          "event_type",
          "category",
          "description"
        ],
        "properties": {
          "category": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "event_type": {
            "type": "string"
          }
        }
      },
      "EventTypeListResponse": {
        "type": "object",
        "description": "List of all available event types.",
        "required": [
          "event_types"
        ],
        "properties": {
          "event_types": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EventTypeInfo"
            }
          }
        }
      },
      "ExcessivePrivilegeListResponse": {
        "type": "object",
        "description": "List response for excessive privileges.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ExcessivePrivilegeResponse"
            }
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "page_size": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ExcessivePrivilegeResponse": {
        "type": "object",
        "description": "Response for an excessive privilege flag.",
        "required": [
          "id",
          "job_id",
          "user_id",
          "deviation_percent",
          "excess_entitlements",
          "peer_average",
          "user_count",
          "status",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "deviation_percent": {
            "type": "number",
            "format": "double"
          },
          "excess_entitlements": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "job_id": {
            "type": "string",
            "format": "uuid"
          },
          "notes": {
            "type": "string",
            "nullable": true
          },
          "peer_average": {
            "type": "number",
            "format": "double"
          },
          "peer_group_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "reviewed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "reviewed_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/PrivilegeFlagStatus"
          },
          "user_count": {
            "type": "integer",
            "format": "int32"
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "ExecuteBatchSimulationRequest": {
        "type": "object",
        "description": "Request to execute a batch simulation.",
        "properties": {
          "acknowledge_scope_warning": {
            "type": "boolean",
            "description": "Acknowledge scope warning (required if >100 users affected)."
          }
        }
      },
      "ExecutionLogFilter": {
        "type": "object",
        "description": "Filter criteria for execution logs (used in POST-based filtering).",
        "properties": {
          "binding_id": {
            "type": "string",
            "format": "uuid",
            "description": "Filter by binding ID.",
            "nullable": true
          },
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "Filter by connector ID.",
            "nullable": true
          },
          "dry_run": {
            "type": "boolean",
            "description": "Filter by dry run flag.",
            "nullable": true
          },
          "from_date": {
            "type": "string",
            "format": "date-time",
            "description": "Filter executions from this date.",
            "nullable": true
          },
          "script_id": {
            "type": "string",
            "format": "uuid",
            "description": "Filter by script ID.",
            "nullable": true
          },
          "status": {
            "type": "string",
            "description": "Filter by execution status.",
            "nullable": true
          },
          "to_date": {
            "type": "string",
            "format": "date-time",
            "description": "Filter executions until this date.",
            "nullable": true
          }
        }
      },
      "ExecutionLogListResponse": {
        "type": "object",
        "description": "Paginated list of execution logs.",
        "required": [
          "logs",
          "total"
        ],
        "properties": {
          "logs": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ExecutionLogResponse"
            },
            "description": "List of execution log entries."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count for pagination."
          }
        }
      },
      "ExecutionLogResponse": {
        "type": "object",
        "description": "Script execution log entry response.",
        "required": [
          "id",
          "tenant_id",
          "script_id",
          "script_version",
          "status",
          "dry_run",
          "duration_ms",
          "executed_by",
          "executed_at"
        ],
        "properties": {
          "binding_id": {
            "type": "string",
            "format": "uuid",
            "description": "The binding that triggered the execution (if applicable).",
            "nullable": true
          },
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "The connector involved in the execution.",
            "nullable": true
          },
          "dry_run": {
            "type": "boolean",
            "description": "Whether this was a dry run."
          },
          "duration_ms": {
            "type": "integer",
            "format": "int64",
            "description": "Execution duration in milliseconds."
          },
          "error": {
            "type": "string",
            "description": "Error message (if the execution failed).",
            "nullable": true
          },
          "executed_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the execution started."
          },
          "executed_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who triggered the execution."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "input_context": {
            "description": "Input context provided to the script.",
            "nullable": true
          },
          "output": {
            "description": "Output produced by the script.",
            "nullable": true
          },
          "script_id": {
            "type": "string",
            "format": "uuid",
            "description": "The script that was executed."
          },
          "script_version": {
            "type": "integer",
            "format": "int32",
            "description": "Script version that was executed."
          },
          "status": {
            "type": "string",
            "description": "Execution status (e.g., success, failure, timeout)."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          }
        }
      },
      "ExpiringLicensesResponse": {
        "type": "object",
        "description": "Response for expiring licenses query.",
        "required": [
          "pools",
          "total_expiring"
        ],
        "properties": {
          "pools": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ExpiringPoolInfo"
            }
          },
          "total_expiring": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ExpiringPersonaSummary": {
        "type": "object",
        "description": "Summary of an expiring persona.",
        "required": [
          "id",
          "persona_name",
          "physical_user_id",
          "valid_until",
          "days_remaining",
          "notification_sent"
        ],
        "properties": {
          "archetype_name": {
            "type": "string",
            "nullable": true
          },
          "days_remaining": {
            "type": "integer",
            "format": "int32"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "notification_sent": {
            "type": "boolean"
          },
          "persona_name": {
            "type": "string"
          },
          "physical_user_id": {
            "type": "string",
            "format": "uuid"
          },
          "physical_user_name": {
            "type": "string",
            "nullable": true
          },
          "valid_until": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "ExpiringPersonasResponse": {
        "type": "object",
        "description": "Expiring personas response.",
        "required": [
          "items",
          "total",
          "within_days",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ExpiringPersonaSummary"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          },
          "within_days": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "ExpiringPoolInfo": {
        "type": "object",
        "description": "Information about an expiring pool.",
        "required": [
          "id",
          "name",
          "vendor",
          "expiration_date",
          "days_until_expiration",
          "allocated_count",
          "total_capacity",
          "expiration_policy"
        ],
        "properties": {
          "allocated_count": {
            "type": "integer",
            "format": "int32"
          },
          "days_until_expiration": {
            "type": "integer",
            "format": "int64"
          },
          "expiration_date": {
            "type": "string",
            "format": "date-time"
          },
          "expiration_policy": {
            "$ref": "#/components/schemas/LicenseExpirationPolicy"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "total_capacity": {
            "type": "integer",
            "format": "int32"
          },
          "vendor": {
            "type": "string"
          }
        }
      },
      "ExpressionValidationResult": {
        "type": "object",
        "description": "Validation result for expressions.",
        "required": [
          "valid"
        ],
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message if invalid.",
            "nullable": true
          },
          "references": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Attribute references found in the expression.",
            "nullable": true
          },
          "valid": {
            "type": "boolean",
            "description": "Whether the expression is valid."
          }
        }
      },
      "ExtendPersonaRequest": {
        "type": "object",
        "description": "Request to extend persona validity.",
        "required": [
          "new_valid_until"
        ],
        "properties": {
          "new_valid_until": {
            "type": "string",
            "format": "date-time",
            "description": "New expiration date."
          },
          "reason": {
            "type": "string",
            "description": "Reason for extension.",
            "nullable": true
          }
        }
      },
      "ExtendPersonaResponse": {
        "type": "object",
        "description": "Response for persona extension request.",
        "required": [
          "status"
        ],
        "properties": {
          "approval_request_id": {
            "type": "string",
            "format": "uuid",
            "description": "Approval request ID (if `pending_approval`).",
            "nullable": true
          },
          "persona": {
            "allOf": [
              {
                "$ref": "#/components/schemas/PersonaResponse"
              }
            ],
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/ExtensionStatus"
          }
        }
      },
      "ExtensionStatus": {
        "type": "string",
        "description": "Extension request status.",
        "enum": [
          "approved",
          "pending_approval"
        ]
      },
      "ExternalTicketResponse": {
        "type": "object",
        "description": "External ticket response.",
        "required": [
          "id",
          "task_id",
          "ticketing_config_id",
          "external_reference",
          "status_category",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "external_reference": {
            "type": "string"
          },
          "external_status": {
            "type": "string",
            "nullable": true
          },
          "external_url": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "last_synced_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "status_category": {
            "$ref": "#/components/schemas/TicketStatusCategory"
          },
          "sync_error": {
            "type": "string",
            "nullable": true
          },
          "task_id": {
            "type": "string",
            "format": "uuid"
          },
          "ticketing_config_id": {
            "type": "string",
            "format": "uuid"
          },
          "ticketing_config_name": {
            "type": "string",
            "nullable": true
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "FilterDefinition": {
        "type": "object",
        "description": "A filter definition within a template.",
        "required": [
          "field",
          "type"
        ],
        "properties": {
          "default": {
            "nullable": true
          },
          "field": {
            "type": "string"
          },
          "options": {
            "nullable": true
          },
          "required": {
            "type": "boolean"
          },
          "type": {
            "type": "string"
          }
        }
      },
      "FinalFallbackAction": {
        "type": "string",
        "description": "Final fallback actions when all escalation levels are exhausted.",
        "enum": [
          "escalate_admin",
          "auto_approve",
          "auto_reject",
          "remain_pending"
        ]
      },
      "FinishAuthenticationRequest": {
        "allOf": [
          {
            "type": "object",
            "description": "The credential assertion response from the authenticator.\nThis is the `WebAuthn` `PublicKeyCredential` structure returned by `navigator.credentials.get()`."
          },
          {
            "type": "object"
          }
        ],
        "description": "Request to finish `WebAuthn` authentication.\nContains the authenticator's response from `navigator.credentials.get()`."
      },
      "FinishRegistrationRequest": {
        "allOf": [
          {
            "type": "object",
            "description": "The credential creation response from the authenticator.\nThis is the `WebAuthn` `PublicKeyCredential` structure returned by `navigator.credentials.create()`."
          },
          {
            "type": "object"
          }
        ],
        "description": "Request to finish `WebAuthn` registration.\nContains the authenticator's response from `navigator.credentials.create()`."
      },
      "ForgotPasswordRequest": {
        "type": "object",
        "description": "Forgot password request payload.",
        "required": [
          "email"
        ],
        "properties": {
          "email": {
            "type": "string",
            "description": "User email address."
          }
        }
      },
      "ForgotPasswordResponse": {
        "type": "object",
        "description": "Forgot password response payload.\n\nAlways returns success to prevent email enumeration.",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Generic success message."
          }
        }
      },
      "GenerateOutlierReportRequest": {
        "type": "object",
        "description": "Request to generate an outlier report.",
        "required": [
          "start_date",
          "end_date"
        ],
        "properties": {
          "end_date": {
            "type": "string",
            "format": "date-time",
            "description": "End date for the report period."
          },
          "include_peer_breakdown": {
            "type": "boolean",
            "description": "Whether to include peer group breakdown."
          },
          "include_trends": {
            "type": "boolean",
            "description": "Whether to include trends over time."
          },
          "start_date": {
            "type": "string",
            "format": "date-time",
            "description": "Start date for the report period."
          }
        }
      },
      "GenerateReportRequest": {
        "type": "object",
        "description": "Request to generate a report.",
        "required": [
          "template_id",
          "output_format"
        ],
        "properties": {
          "name": {
            "type": "string",
            "nullable": true
          },
          "output_format": {
            "$ref": "#/components/schemas/OutputFormat"
          },
          "parameters": {
            "nullable": true
          },
          "template_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "GeneratedReportListResponse": {
        "type": "object",
        "description": "List response for generated reports.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/GeneratedReportResponse"
            }
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "page_size": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "GeneratedReportResponse": {
        "type": "object",
        "description": "Response for a generated report.",
        "required": [
          "id",
          "tenant_id",
          "template_id",
          "name",
          "status",
          "parameters",
          "output_format",
          "progress_percent",
          "generated_by",
          "retention_until",
          "created_at"
        ],
        "properties": {
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "error_message": {
            "type": "string",
            "nullable": true
          },
          "file_size_bytes": {
            "type": "integer",
            "format": "int64",
            "nullable": true
          },
          "generated_by": {
            "type": "string",
            "format": "uuid"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "output_format": {
            "$ref": "#/components/schemas/OutputFormat"
          },
          "parameters": {},
          "progress_percent": {
            "type": "integer",
            "format": "int32"
          },
          "record_count": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "retention_until": {
            "type": "string",
            "format": "date-time"
          },
          "schedule_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "started_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/ReportStatus"
          },
          "template_id": {
            "type": "string",
            "format": "uuid"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "GovAppStatus": {
        "type": "string",
        "description": "Application status.",
        "enum": [
          "active",
          "inactive"
        ]
      },
      "GovAppType": {
        "type": "string",
        "description": "Application type classification.",
        "enum": [
          "internal",
          "external"
        ]
      },
      "GovApproverType": {
        "type": "string",
        "description": "Types of approvers for workflow steps.",
        "enum": [
          "manager",
          "entitlement_owner",
          "specific_users"
        ]
      },
      "GovAssignmentStatus": {
        "type": "string",
        "description": "Assignment status.",
        "enum": [
          "active",
          "suspended",
          "expired"
        ]
      },
      "GovAssignmentTargetType": {
        "type": "string",
        "description": "Assignment target type (user or group).",
        "enum": [
          "user",
          "group"
        ]
      },
      "GovCorrelationCaseStatus": {
        "type": "string",
        "description": "Status for correlation cases.",
        "enum": [
          "pending",
          "confirmed",
          "rejected",
          "no_match",
          "new_identity",
          "collision"
        ]
      },
      "GovCorrelationTrigger": {
        "type": "string",
        "description": "Trigger type for how the correlation case was created.",
        "enum": [
          "reconciliation",
          "live_sync",
          "manual"
        ]
      },
      "GovDecisionType": {
        "type": "string",
        "description": "Decision types for approvals.",
        "enum": [
          "approved",
          "rejected"
        ]
      },
      "GovDuplicateStatus": {
        "type": "string",
        "description": "Status for duplicate candidates.",
        "enum": [
          "pending",
          "merged",
          "dismissed"
        ]
      },
      "GovEntitlementStatus": {
        "type": "string",
        "description": "Entitlement status.",
        "enum": [
          "active",
          "inactive",
          "suspended"
        ]
      },
      "GovEntitlementStrategy": {
        "type": "string",
        "description": "Entitlement consolidation strategy.",
        "enum": [
          "union",
          "intersection",
          "manual"
        ]
      },
      "GovMergeOperationStatus": {
        "type": "string",
        "description": "Status for merge operations.",
        "enum": [
          "in_progress",
          "completed",
          "failed",
          "cancelled"
        ]
      },
      "GovRequestStatus": {
        "type": "string",
        "description": "Status for access requests.",
        "enum": [
          "pending",
          "pending_approval",
          "approved",
          "provisioned",
          "rejected",
          "cancelled",
          "expired",
          "failed"
        ]
      },
      "GovRiskLevel": {
        "type": "string",
        "description": "Risk level classification for entitlements.",
        "enum": [
          "low",
          "medium",
          "high",
          "critical"
        ]
      },
      "GovSodRuleStatus": {
        "type": "string",
        "description": "Status for `SoD` rules.",
        "enum": [
          "active",
          "inactive"
        ]
      },
      "GovSodSeverity": {
        "type": "string",
        "description": "Severity levels for `SoD` rules.",
        "enum": [
          "low",
          "medium",
          "high",
          "critical"
        ]
      },
      "GrantPermissionRequest": {
        "type": "object",
        "description": "Request to grant a tool permission to an agent.",
        "required": [
          "tool_id"
        ],
        "properties": {
          "allowed_parameters": {
            "description": "Parameter restrictions (JSON object).",
            "nullable": true
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "Permission expiration date.",
            "nullable": true
          },
          "max_calls_per_hour": {
            "type": "integer",
            "format": "int32",
            "description": "Override tool's max calls per hour.",
            "nullable": true
          },
          "requires_approval": {
            "type": "boolean",
            "description": "Override tool's approval requirement.",
            "nullable": true
          },
          "tool_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tool ID to grant permission for."
          }
        }
      },
      "GroupDetail": {
        "type": "object",
        "description": "Group detail with hierarchy information.",
        "required": [
          "id",
          "tenant_id",
          "display_name",
          "group_type",
          "path",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the group was created."
          },
          "description": {
            "type": "string",
            "description": "Group description.",
            "nullable": true
          },
          "display_name": {
            "type": "string",
            "description": "Group display name."
          },
          "external_id": {
            "type": "string",
            "description": "External system ID.",
            "nullable": true
          },
          "group_type": {
            "type": "string",
            "description": "Group type classification."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the group."
          },
          "parent_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parent group ID (null for root groups).",
            "nullable": true
          },
          "path": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Ancestor names from root to this group's parent."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "The tenant this group belongs to."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the group was last updated."
          }
        }
      },
      "GroupListResponse": {
        "type": "object",
        "description": "Response for listing groups with pagination.",
        "required": [
          "groups",
          "pagination"
        ],
        "properties": {
          "groups": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/GroupDetail"
            },
            "description": "List of groups."
          },
          "pagination": {
            "$ref": "#/components/schemas/Pagination"
          }
        }
      },
      "HealthCheckResponse": {
        "type": "object",
        "description": "Health check response.",
        "required": [
          "status",
          "checked_at"
        ],
        "properties": {
          "checked_at": {
            "type": "string",
            "format": "date-time"
          },
          "error": {
            "type": "string",
            "nullable": true
          },
          "service_provider_config": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ServiceProviderConfig"
              }
            ],
            "nullable": true
          },
          "status": {
            "type": "string"
          }
        }
      },
      "HealthResponse": {
        "type": "object",
        "description": "Health status response (legacy `/health` endpoint).",
        "required": [
          "status",
          "version",
          "uptime_seconds",
          "timestamp"
        ],
        "properties": {
          "database": {
            "type": "string",
            "description": "Database connectivity status.",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/HealthState"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Response timestamp."
          },
          "uptime_seconds": {
            "type": "integer",
            "format": "int64",
            "description": "Seconds since service started.",
            "minimum": 0
          },
          "version": {
            "type": "string",
            "description": "Application version from Cargo.toml."
          }
        }
      },
      "HealthState": {
        "type": "string",
        "description": "Health state enum.",
        "enum": [
          "healthy",
          "degraded",
          "unhealthy"
        ]
      },
      "IdentityProviderListResponse": {
        "type": "object",
        "description": "List response with pagination.",
        "required": [
          "items",
          "total",
          "offset",
          "limit"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IdentityProviderResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "IdentityProviderResponse": {
        "type": "object",
        "description": "Full identity provider response.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "provider_type",
          "issuer_url",
          "client_id",
          "scopes",
          "claim_mapping",
          "sync_on_login",
          "is_enabled",
          "validation_status",
          "domains",
          "linked_users_count",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "claim_mapping": {
            "$ref": "#/components/schemas/ClaimMappingConfig"
          },
          "client_id": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "domains": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DomainResponse"
            }
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_enabled": {
            "type": "boolean"
          },
          "issuer_url": {
            "type": "string"
          },
          "last_validated_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "linked_users_count": {
            "type": "integer",
            "format": "int64"
          },
          "name": {
            "type": "string"
          },
          "provider_type": {
            "type": "string"
          },
          "scopes": {
            "type": "string"
          },
          "sync_on_login": {
            "type": "boolean"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "validation_status": {
            "type": "string"
          }
        }
      },
      "IdentitySummary": {
        "type": "object",
        "description": "Summary of an identity for comparison.",
        "required": [
          "id",
          "attributes"
        ],
        "properties": {
          "attributes": {},
          "department": {
            "type": "string",
            "nullable": true
          },
          "display_name": {
            "type": "string",
            "nullable": true
          },
          "email": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "ImpactAnalysisRequest": {
        "type": "object",
        "description": "Request for policy impact analysis.",
        "properties": {
          "max_affected_users": {
            "type": "integer",
            "format": "int64",
            "description": "Maximum number of affected users to return in detail (default: 100)."
          },
          "proposed_conditions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PolicyConditionRequest"
            },
            "description": "Optional: Proposed changes to the policy to analyze.\nIf not provided, analyzes the policy as-is.",
            "nullable": true
          },
          "proposed_entitlement_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Optional: Proposed entitlements to analyze.",
            "nullable": true
          }
        }
      },
      "ImpactAnalysisResponse": {
        "type": "object",
        "description": "Response for policy impact analysis.",
        "required": [
          "policy_id",
          "policy_name",
          "summary",
          "by_department",
          "by_location",
          "entitlement_impacts",
          "affected_users",
          "is_truncated"
        ],
        "properties": {
          "affected_users": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AffectedUser"
            },
            "description": "Sample of affected users (limited by `max_affected_users`)."
          },
          "by_department": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DepartmentImpact"
            },
            "description": "Breakdown by department."
          },
          "by_location": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LocationImpact"
            },
            "description": "Breakdown by location."
          },
          "entitlement_impacts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EntitlementImpact"
            },
            "description": "Entitlement impact details."
          },
          "is_truncated": {
            "type": "boolean",
            "description": "Whether the result was truncated due to `max_affected_users` limit."
          },
          "policy_id": {
            "type": "string",
            "format": "uuid",
            "description": "The policy being analyzed."
          },
          "policy_name": {
            "type": "string",
            "description": "Policy name."
          },
          "summary": {
            "$ref": "#/components/schemas/ImpactSummary"
          }
        }
      },
      "ImpactType": {
        "type": "string",
        "description": "Impact type for simulation results.",
        "enum": [
          "violation",
          "entitlement_gain",
          "entitlement_loss",
          "no_change",
          "warning"
        ]
      },
      "InboundChangeResponse": {
        "type": "object",
        "description": "Response for an inbound change.",
        "required": [
          "id",
          "change_type",
          "external_uid",
          "object_class",
          "sync_situation",
          "processing_status",
          "created_at"
        ],
        "properties": {
          "change_type": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "external_uid": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "linked_identity_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "object_class": {
            "type": "string"
          },
          "processing_status": {
            "type": "string"
          },
          "sync_situation": {
            "type": "string"
          }
        }
      },
      "IncompatibilityCheckResult": {
        "type": "object",
        "description": "Result of checking for license incompatibility violations.",
        "required": [
          "blocked",
          "violations"
        ],
        "properties": {
          "blocked": {
            "type": "boolean",
            "description": "Whether the assignment would be blocked."
          },
          "violations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IncompatibilityViolation"
            },
            "description": "List of violations if blocked."
          }
        }
      },
      "IncompatibilityListResponse": {
        "type": "object",
        "description": "Paginated response for incompatibilities.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LicenseIncompatibilityResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "IncompatibilityViolation": {
        "type": "object",
        "description": "A single incompatibility violation.",
        "required": [
          "rule_id",
          "existing_pool_id",
          "existing_pool_name",
          "requested_pool_id",
          "requested_pool_name",
          "reason"
        ],
        "properties": {
          "existing_pool_id": {
            "type": "string",
            "format": "uuid"
          },
          "existing_pool_name": {
            "type": "string"
          },
          "reason": {
            "type": "string"
          },
          "requested_pool_id": {
            "type": "string",
            "format": "uuid"
          },
          "requested_pool_name": {
            "type": "string"
          },
          "rule_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "InheritanceListResponse": {
        "type": "object",
        "description": "Paginated list of inheritances.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/InheritanceResponse"
            },
            "description": "List of inheritances."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "InheritanceResponse": {
        "type": "object",
        "description": "Inheritance relationship response.",
        "required": [
          "id",
          "tenant_id",
          "meta_role_id",
          "child_role_id",
          "match_reason",
          "status",
          "matched_at",
          "updated_at"
        ],
        "properties": {
          "child_role": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ChildRoleSummary"
              }
            ],
            "nullable": true
          },
          "child_role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Child role (entitlement) ID."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "match_reason": {
            "description": "Why this role matched."
          },
          "matched_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the inheritance was established."
          },
          "meta_role": {
            "allOf": [
              {
                "$ref": "#/components/schemas/MetaRoleSummary"
              }
            ],
            "nullable": true
          },
          "meta_role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parent meta-role ID."
          },
          "status": {
            "$ref": "#/components/schemas/InheritanceStatus"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the inheritance was last updated."
          }
        }
      },
      "InheritanceStatus": {
        "type": "string",
        "description": "Status of an inheritance relationship.",
        "enum": [
          "active",
          "suspended",
          "removed"
        ]
      },
      "InitiateSsoRequest": {
        "type": "object",
        "description": "IdP-initiated SSO request",
        "properties": {
          "relay_state": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "InstantiateTemplateRequest": {
        "type": "object",
        "description": "Request to instantiate a script from a template.",
        "required": [
          "name"
        ],
        "properties": {
          "description": {
            "type": "string",
            "description": "Optional description for the new script.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Name for the new script created from the template."
          }
        }
      },
      "IpEnforcementMode": {
        "type": "string",
        "description": "IP restriction enforcement mode.",
        "enum": [
          "disabled",
          "whitelist",
          "blacklist"
        ]
      },
      "IpRuleResponse": {
        "type": "object",
        "description": "Response for an IP restriction rule.",
        "required": [
          "id",
          "tenant_id",
          "rule_type",
          "scope",
          "ip_cidr",
          "name",
          "is_active",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the rule was created."
          },
          "created_by": {
            "type": "string",
            "format": "uuid",
            "description": "User who created the rule.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Rule ID."
          },
          "ip_cidr": {
            "type": "string",
            "description": "IP address or range in CIDR notation."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the rule is active."
          },
          "name": {
            "type": "string",
            "description": "Human-readable rule name."
          },
          "rule_type": {
            "$ref": "#/components/schemas/IpRuleType"
          },
          "scope": {
            "type": "string",
            "description": "Target scope: all, admin, or role:name."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the rule was last updated."
          }
        }
      },
      "IpRuleType": {
        "type": "string",
        "description": "IP rule type (whitelist or blacklist).",
        "enum": [
          "whitelist",
          "blacklist"
        ]
      },
      "IpSettingsResponse": {
        "type": "object",
        "description": "Response for GET /admin/ip-restrictions/settings.",
        "required": [
          "tenant_id",
          "enforcement_mode",
          "bypass_for_super_admin",
          "updated_at"
        ],
        "properties": {
          "bypass_for_super_admin": {
            "type": "boolean",
            "description": "Whether super admins bypass IP restrictions."
          },
          "enforcement_mode": {
            "$ref": "#/components/schemas/IpEnforcementMode"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "The tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the settings were last updated."
          },
          "updated_by": {
            "type": "string",
            "format": "uuid",
            "description": "User who last updated the settings.",
            "nullable": true
          }
        }
      },
      "ItemCountsResponse": {
        "type": "object",
        "description": "Item counts response.",
        "required": [
          "total",
          "pending",
          "certified",
          "revoked"
        ],
        "properties": {
          "certified": {
            "type": "integer",
            "format": "int64"
          },
          "pending": {
            "type": "integer",
            "format": "int64"
          },
          "revoked": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ItemListResponse": {
        "type": "object",
        "description": "Item list response.",
        "required": [
          "items",
          "total",
          "page",
          "per_page"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CertificationItemResponse"
            }
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "per_page": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ItemResponse": {
        "type": "object",
        "description": "Certification item response.",
        "required": [
          "id",
          "tenant_id",
          "campaign_id",
          "user_id",
          "entitlement_id",
          "reviewer_id",
          "status",
          "assignment_snapshot",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "assignment_id": {
            "type": "string",
            "format": "uuid",
            "description": "Source assignment ID (NULL if deleted).",
            "nullable": true
          },
          "assignment_snapshot": {
            "description": "Snapshot of assignment at generation time."
          },
          "campaign_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parent campaign ID."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the item was created."
          },
          "decided_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the decision was made.",
            "nullable": true
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement being reviewed."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "reviewer_id": {
            "type": "string",
            "format": "uuid",
            "description": "Assigned reviewer."
          },
          "status": {
            "$ref": "#/components/schemas/CertItemStatus"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the item was last updated."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User whose access is being reviewed."
          }
        }
      },
      "ItemWithDecisionResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ItemResponse"
          },
          {
            "type": "object",
            "required": [
              "decision"
            ],
            "properties": {
              "decision": {
                "$ref": "#/components/schemas/DecisionResponse"
              }
            }
          }
        ],
        "description": "Item response with decision."
      },
      "ItemWithDetailsResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ItemResponse"
          },
          {
            "type": "object",
            "properties": {
              "campaign": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/CampaignSummary"
                  }
                ],
                "nullable": true
              },
              "decision": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/DecisionResponse"
                  }
                ],
                "nullable": true
              },
              "entitlement": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/EntitlementSummary"
                  }
                ],
                "nullable": true
              },
              "user": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/UserSummary"
                  }
                ],
                "nullable": true
              }
            }
          }
        ],
        "description": "Item response with additional details."
      },
      "Jwk": {
        "type": "object",
        "description": "JSON Web Key for JWKS endpoint.",
        "required": [
          "kty",
          "kid",
          "use",
          "alg",
          "n",
          "e"
        ],
        "properties": {
          "alg": {
            "type": "string",
            "description": "Algorithm."
          },
          "e": {
            "type": "string",
            "description": "RSA exponent (base64url encoded)."
          },
          "kid": {
            "type": "string",
            "description": "Key ID."
          },
          "kty": {
            "type": "string",
            "description": "Key type (RSA)."
          },
          "n": {
            "type": "string",
            "description": "RSA modulus (base64url encoded)."
          },
          "use": {
            "type": "string",
            "description": "Key use (sig = signature)."
          }
        }
      },
      "JwkSet": {
        "type": "object",
        "description": "JSON Web Key Set.",
        "required": [
          "keys"
        ],
        "properties": {
          "keys": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Jwk"
            },
            "description": "Array of JWKs."
          }
        }
      },
      "LicenseAssignmentListResponse": {
        "type": "object",
        "description": "Paginated response for license assignments.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LicenseAssignmentResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "LicenseAssignmentResponse": {
        "type": "object",
        "description": "License assignment response.",
        "required": [
          "id",
          "license_pool_id",
          "user_id",
          "assigned_at",
          "assigned_by",
          "source",
          "status",
          "created_at"
        ],
        "properties": {
          "assigned_at": {
            "type": "string",
            "format": "date-time"
          },
          "assigned_by": {
            "type": "string",
            "format": "uuid"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "license_pool_id": {
            "type": "string",
            "format": "uuid"
          },
          "notes": {
            "type": "string",
            "nullable": true
          },
          "pool_name": {
            "type": "string",
            "nullable": true
          },
          "reclaim_reason": {
            "type": "string",
            "nullable": true
          },
          "reclaimed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "source": {
            "$ref": "#/components/schemas/LicenseAssignmentSource"
          },
          "status": {
            "$ref": "#/components/schemas/LicenseAssignmentStatus"
          },
          "user_email": {
            "type": "string",
            "nullable": true
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "LicenseAssignmentSource": {
        "type": "string",
        "description": "Source of how a license was assigned.",
        "enum": [
          "manual",
          "automatic",
          "entitlement"
        ]
      },
      "LicenseAssignmentStatus": {
        "type": "string",
        "description": "License assignment status.",
        "enum": [
          "active",
          "reclaimed",
          "expired",
          "released"
        ]
      },
      "LicenseAuditAction": {
        "type": "string",
        "description": "License audit event action types.",
        "enum": [
          "pool_created",
          "pool_updated",
          "pool_deleted",
          "pool_archived",
          "pool_expired",
          "license_assigned",
          "license_deallocated",
          "license_reclaimed",
          "license_expired",
          "link_created",
          "link_updated",
          "link_deleted",
          "rule_created",
          "rule_updated",
          "rule_deleted",
          "incompatibility_created",
          "incompatibility_deleted",
          "bulk_assign",
          "bulk_reclaim"
        ]
      },
      "LicenseAuditEntry": {
        "type": "object",
        "description": "Audit event entry for API responses.",
        "required": [
          "id",
          "action",
          "actor_id",
          "details",
          "created_at"
        ],
        "properties": {
          "action": {
            "type": "string"
          },
          "actor_email": {
            "type": "string",
            "nullable": true
          },
          "actor_id": {
            "type": "string",
            "format": "uuid"
          },
          "assignment_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "details": {},
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "pool_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "pool_name": {
            "type": "string",
            "nullable": true
          },
          "user_email": {
            "type": "string",
            "nullable": true
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          }
        }
      },
      "LicenseBillingPeriod": {
        "type": "string",
        "description": "Billing period for license cost tracking.",
        "enum": [
          "monthly",
          "annual",
          "perpetual"
        ]
      },
      "LicenseDashboardResponse": {
        "type": "object",
        "description": "License analytics dashboard response.",
        "required": [
          "summary",
          "pools",
          "cost_by_vendor",
          "recent_events"
        ],
        "properties": {
          "cost_by_vendor": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/VendorCost"
            },
            "description": "Cost breakdown by vendor."
          },
          "pools": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LicensePoolStats"
            },
            "description": "Per-pool statistics."
          },
          "recent_events": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LicenseAuditEntry"
            },
            "description": "Recent audit events."
          },
          "summary": {
            "$ref": "#/components/schemas/LicenseSummary"
          }
        }
      },
      "LicenseEntitlementLinkResponse": {
        "type": "object",
        "description": "License entitlement link response.",
        "required": [
          "id",
          "license_pool_id",
          "entitlement_id",
          "priority",
          "enabled",
          "created_at",
          "created_by"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "enabled": {
            "type": "boolean"
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid"
          },
          "entitlement_name": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "license_pool_id": {
            "type": "string",
            "format": "uuid"
          },
          "pool_name": {
            "type": "string",
            "nullable": true
          },
          "pool_vendor": {
            "type": "string",
            "nullable": true
          },
          "priority": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "LicenseExpirationPolicy": {
        "type": "string",
        "description": "Policy to enforce when a license pool expires.",
        "enum": [
          "block_new",
          "revoke_all",
          "warn_only"
        ]
      },
      "LicenseIncompatibilityResponse": {
        "type": "object",
        "description": "License incompatibility response.",
        "required": [
          "id",
          "pool_a_id",
          "pool_b_id",
          "reason",
          "created_at",
          "created_by"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "pool_a_id": {
            "type": "string",
            "format": "uuid"
          },
          "pool_a_name": {
            "type": "string",
            "nullable": true
          },
          "pool_a_vendor": {
            "type": "string",
            "nullable": true
          },
          "pool_b_id": {
            "type": "string",
            "format": "uuid"
          },
          "pool_b_name": {
            "type": "string",
            "nullable": true
          },
          "pool_b_vendor": {
            "type": "string",
            "nullable": true
          },
          "reason": {
            "type": "string"
          }
        }
      },
      "LicensePoolListResponse": {
        "type": "object",
        "description": "Paginated response for license pools.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LicensePoolResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "LicensePoolResponse": {
        "type": "object",
        "description": "License pool response.",
        "required": [
          "id",
          "name",
          "vendor",
          "total_capacity",
          "allocated_count",
          "available_count",
          "utilization_percent",
          "currency",
          "billing_period",
          "license_type",
          "expiration_policy",
          "warning_days",
          "status",
          "created_at",
          "updated_at",
          "created_by"
        ],
        "properties": {
          "allocated_count": {
            "type": "integer",
            "format": "int32"
          },
          "available_count": {
            "type": "integer",
            "format": "int32"
          },
          "billing_period": {
            "$ref": "#/components/schemas/LicenseBillingPeriod"
          },
          "cost_per_license": {
            "allOf": [
              {
                "$ref": "#/components/schemas/Decimal"
              }
            ],
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "currency": {
            "type": "string"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "expiration_date": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "expiration_policy": {
            "$ref": "#/components/schemas/LicenseExpirationPolicy"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "license_type": {
            "$ref": "#/components/schemas/LicenseType"
          },
          "name": {
            "type": "string"
          },
          "status": {
            "$ref": "#/components/schemas/LicensePoolStatus"
          },
          "total_capacity": {
            "type": "integer",
            "format": "int32"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "utilization_percent": {
            "type": "number",
            "format": "double"
          },
          "vendor": {
            "type": "string"
          },
          "warning_days": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "LicensePoolStats": {
        "type": "object",
        "description": "Statistics for a single pool.",
        "required": [
          "id",
          "name",
          "vendor",
          "total_capacity",
          "allocated_count",
          "utilization_percent",
          "status"
        ],
        "properties": {
          "allocated_count": {
            "type": "integer",
            "format": "int32"
          },
          "expiration_date": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "monthly_cost": {
            "allOf": [
              {
                "$ref": "#/components/schemas/Decimal"
              }
            ],
            "nullable": true
          },
          "name": {
            "type": "string"
          },
          "status": {
            "$ref": "#/components/schemas/LicensePoolStatus"
          },
          "total_capacity": {
            "type": "integer",
            "format": "int32"
          },
          "utilization_percent": {
            "type": "number",
            "format": "double"
          },
          "vendor": {
            "type": "string"
          }
        }
      },
      "LicensePoolStatus": {
        "type": "string",
        "description": "License pool lifecycle status.",
        "enum": [
          "active",
          "expired",
          "archived"
        ]
      },
      "LicenseReclaimReason": {
        "type": "string",
        "description": "Reason for license reclamation.",
        "enum": [
          "inactivity",
          "termination",
          "manual",
          "expiration"
        ]
      },
      "LicenseReclamationTrigger": {
        "type": "string",
        "description": "Trigger type for reclamation rules.",
        "enum": [
          "inactivity",
          "lifecycle_state"
        ]
      },
      "LicenseRecommendation": {
        "type": "object",
        "description": "License optimization recommendation.",
        "required": [
          "recommendation_type",
          "pool_id",
          "pool_name",
          "description"
        ],
        "properties": {
          "currency": {
            "type": "string",
            "nullable": true
          },
          "description": {
            "type": "string"
          },
          "pool_id": {
            "type": "string",
            "format": "uuid"
          },
          "pool_name": {
            "type": "string"
          },
          "potential_savings": {
            "allOf": [
              {
                "$ref": "#/components/schemas/Decimal"
              }
            ],
            "nullable": true
          },
          "recommendation_type": {
            "$ref": "#/components/schemas/RecommendationType"
          }
        }
      },
      "LicenseSummary": {
        "type": "object",
        "description": "Summary statistics for the dashboard.",
        "required": [
          "total_pools",
          "total_capacity",
          "total_allocated",
          "total_available",
          "overall_utilization",
          "total_monthly_cost",
          "expiring_soon_count"
        ],
        "properties": {
          "expiring_soon_count": {
            "type": "integer",
            "format": "int64"
          },
          "overall_utilization": {
            "type": "number",
            "format": "double"
          },
          "total_allocated": {
            "type": "integer",
            "format": "int64"
          },
          "total_available": {
            "type": "integer",
            "format": "int64"
          },
          "total_capacity": {
            "type": "integer",
            "format": "int64"
          },
          "total_monthly_cost": {
            "$ref": "#/components/schemas/Decimal"
          },
          "total_pools": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "LicenseType": {
        "type": "string",
        "description": "License type: named (permanent assignment) or concurrent (floating).",
        "enum": [
          "named",
          "concurrent"
        ]
      },
      "LifecycleActionListResponse": {
        "type": "object",
        "description": "Paginated list of lifecycle actions.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LifecycleActionResponse"
            },
            "description": "List of actions."
          },
          "page": {
            "type": "integer",
            "format": "int64",
            "description": "Page number."
          },
          "page_size": {
            "type": "integer",
            "format": "int64",
            "description": "Page size."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "LifecycleActionResponse": {
        "type": "object",
        "description": "Lifecycle action response.",
        "required": [
          "id",
          "tenant_id",
          "event_id",
          "action_type",
          "entitlement_id",
          "created_at",
          "is_pending",
          "is_executed",
          "is_cancelled"
        ],
        "properties": {
          "action_type": {
            "$ref": "#/components/schemas/LifecycleActionType"
          },
          "assignment_id": {
            "type": "string",
            "format": "uuid",
            "description": "Assignment created/modified (if applicable).",
            "nullable": true
          },
          "cancelled_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the scheduled action was cancelled.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the action was created."
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Target entitlement."
          },
          "error_message": {
            "type": "string",
            "description": "Error message if action failed.",
            "nullable": true
          },
          "event_id": {
            "type": "string",
            "format": "uuid",
            "description": "Event that triggered this action."
          },
          "executed_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the action was executed.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_cancelled": {
            "type": "boolean",
            "description": "Whether the action was cancelled."
          },
          "is_executed": {
            "type": "boolean",
            "description": "Whether the action was executed."
          },
          "is_pending": {
            "type": "boolean",
            "description": "Whether the action is pending."
          },
          "policy_id": {
            "type": "string",
            "format": "uuid",
            "description": "Policy that triggered this action.",
            "nullable": true
          },
          "scheduled_at": {
            "type": "string",
            "format": "date-time",
            "description": "When scheduled revocation should execute.",
            "nullable": true
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          }
        }
      },
      "LifecycleActionType": {
        "type": "string",
        "description": "Type of lifecycle action.",
        "enum": [
          "provision",
          "revoke",
          "schedule_revoke",
          "cancel_revoke",
          "skip"
        ]
      },
      "LifecycleEventListResponse": {
        "type": "object",
        "description": "Paginated list of lifecycle events.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LifecycleEventResponse"
            },
            "description": "List of events."
          },
          "page": {
            "type": "integer",
            "format": "int64",
            "description": "Page number."
          },
          "page_size": {
            "type": "integer",
            "format": "int64",
            "description": "Page size."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "LifecycleEventResponse": {
        "type": "object",
        "description": "Lifecycle event response.",
        "required": [
          "id",
          "tenant_id",
          "user_id",
          "event_type",
          "source",
          "created_at"
        ],
        "properties": {
          "attributes_after": {
            "description": "User attributes after the change.",
            "nullable": true
          },
          "attributes_before": {
            "description": "User attributes before the change.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the event was created."
          },
          "event_type": {
            "$ref": "#/components/schemas/LifecycleEventType"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "processed_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the event was processed.",
            "nullable": true
          },
          "source": {
            "type": "string",
            "description": "Source of the event."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID this event affects."
          }
        }
      },
      "LifecycleEventType": {
        "type": "string",
        "description": "Type of lifecycle event.",
        "enum": [
          "joiner",
          "mover",
          "leaver"
        ]
      },
      "LifecycleEventWithActionsResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/LifecycleEventResponse"
          },
          {
            "type": "object",
            "required": [
              "actions"
            ],
            "properties": {
              "actions": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/LifecycleActionResponse"
                },
                "description": "Actions resulting from this event."
              },
              "snapshot": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/AccessSnapshotSummary"
                  }
                ],
                "nullable": true
              }
            }
          }
        ],
        "description": "Lifecycle event response with actions."
      },
      "LifecyclePolicyRequest": {
        "type": "object",
        "description": "Lifecycle policy configuration.",
        "properties": {
          "auto_extension_allowed": {
            "type": "boolean",
            "description": "Whether auto-extension is allowed."
          },
          "default_validity_days": {
            "type": "integer",
            "format": "int32",
            "description": "Default validity in days for new personas."
          },
          "extension_requires_approval": {
            "type": "boolean",
            "description": "Whether extension requires approval."
          },
          "max_validity_days": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum validity in days."
          },
          "notification_before_expiry_days": {
            "type": "integer",
            "format": "int32",
            "description": "Days before expiry to send notification."
          },
          "on_physical_user_deactivation": {
            "type": "string",
            "description": "Action on physical user deactivation."
          }
        }
      },
      "LinkChangeRequest": {
        "type": "object",
        "description": "Request to manually link a change.",
        "required": [
          "user_id"
        ],
        "properties": {
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "ListActionsResponse": {
        "type": "object",
        "description": "Response for listing actions.",
        "required": [
          "actions",
          "total"
        ],
        "properties": {
          "actions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ActionResponse"
            }
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ListChangesResponse": {
        "type": "object",
        "description": "Response for listing changes.",
        "required": [
          "changes",
          "total"
        ],
        "properties": {
          "changes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/InboundChangeResponse"
            }
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ListConflictsResponse": {
        "type": "object",
        "description": "Response for listing conflicts.",
        "required": [
          "conflicts",
          "total"
        ],
        "properties": {
          "conflicts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SyncConflictResponse"
            }
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ListDiscrepanciesResponse": {
        "type": "object",
        "description": "Response for listing discrepancies.",
        "required": [
          "discrepancies",
          "total"
        ],
        "properties": {
          "discrepancies": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DiscrepancyResponse"
            }
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ListRulesResponse": {
        "type": "object",
        "description": "Response for GET /admin/ip-restrictions/rules.",
        "required": [
          "rules"
        ],
        "properties": {
          "rules": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IpRuleResponse"
            },
            "description": "List of IP restriction rules."
          }
        }
      },
      "ListRunsResponse": {
        "type": "object",
        "description": "Response for listing runs.",
        "required": [
          "runs",
          "total"
        ],
        "properties": {
          "runs": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ReconciliationRunResponse"
            }
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ListSchedulesResponse": {
        "type": "object",
        "description": "Response for listing schedules.",
        "required": [
          "schedules"
        ],
        "properties": {
          "schedules": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScheduleResponse"
            }
          }
        }
      },
      "LivenessResponse": {
        "type": "object",
        "description": "Liveness probe response.\n\nIndicates the process is alive and not deadlocked. Does not check\ndependencies \u2014 a failing liveness probe restarts the pod.",
        "required": [
          "status"
        ],
        "properties": {
          "status": {
            "type": "string"
          }
        }
      },
      "LoginRequest": {
        "type": "object",
        "description": "Login request payload.",
        "required": [
          "email",
          "password"
        ],
        "properties": {
          "email": {
            "type": "string",
            "description": "User email address."
          },
          "password": {
            "type": "string",
            "description": "User password.\nLength validation prevents `DoS` attacks via extremely long passwords\nthat could consume excessive CPU during hashing."
          }
        }
      },
      "LogoutRequest": {
        "type": "object",
        "description": "Logout request payload.",
        "required": [
          "refresh_token"
        ],
        "properties": {
          "refresh_token": {
            "type": "string",
            "description": "Refresh token to invalidate."
          }
        }
      },
      "MagicLinkVerifyRequest": {
        "type": "object",
        "description": "Request to verify a magic link token.",
        "required": [
          "token"
        ],
        "properties": {
          "token": {
            "type": "string",
            "description": "Magic link token from email."
          }
        }
      },
      "ManualProvisioningTaskDetailResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ManualProvisioningTaskResponse"
          },
          {
            "type": "object",
            "required": [
              "provisioning_data"
            ],
            "properties": {
              "access_request_id": {
                "type": "string",
                "format": "uuid",
                "description": "Access request details (if linked).",
                "nullable": true
              },
              "audit_events": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/ManualTaskAuditEventResponse"
                },
                "description": "Audit events for this task.",
                "nullable": true
              },
              "completion_notes": {
                "type": "string",
                "description": "Completion notes.",
                "nullable": true
              },
              "provisioning_data": {
                "description": "Provisioning instructions/data."
              },
              "result_data": {
                "description": "Result data from completion.",
                "nullable": true
              },
              "tickets": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/ExternalTicketResponse"
                },
                "description": "External tickets associated with this task.",
                "nullable": true
              }
            }
          }
        ],
        "description": "Detailed task response with provisioning data."
      },
      "ManualProvisioningTaskListResponse": {
        "type": "object",
        "description": "List of manual provisioning tasks response.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ManualProvisioningTaskResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ManualProvisioningTaskResponse": {
        "type": "object",
        "description": "Manual provisioning task response.",
        "required": [
          "id",
          "assignment_id",
          "application_id",
          "user_id",
          "entitlement_id",
          "operation_type",
          "status",
          "sla_warning_sent",
          "sla_breached",
          "retry_count",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "application_id": {
            "type": "string",
            "format": "uuid"
          },
          "application_name": {
            "type": "string",
            "nullable": true
          },
          "assignee_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "assignee_name": {
            "type": "string",
            "nullable": true
          },
          "assignment_id": {
            "type": "string",
            "format": "uuid"
          },
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid"
          },
          "entitlement_name": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "next_retry_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "notes": {
            "type": "string",
            "nullable": true
          },
          "operation_type": {
            "$ref": "#/components/schemas/ManualTaskOperation"
          },
          "retry_count": {
            "type": "integer",
            "format": "int32"
          },
          "sla_breached": {
            "type": "boolean"
          },
          "sla_deadline": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "sla_warning_sent": {
            "type": "boolean"
          },
          "status": {
            "$ref": "#/components/schemas/ManualTaskStatus"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          },
          "user_name": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "ManualTaskAuditEventResponse": {
        "type": "object",
        "description": "Manual task audit event response.",
        "required": [
          "id",
          "task_id",
          "event_type",
          "created_at"
        ],
        "properties": {
          "actor_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "actor_name": {
            "type": "string",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "details": {
            "nullable": true
          },
          "event_type": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "task_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "ManualTaskAuditListResponse": {
        "type": "object",
        "description": "List of audit events response.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ManualTaskAuditEventResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ManualTaskDashboardResponse": {
        "type": "object",
        "description": "Dashboard response for manual tasks.",
        "required": [
          "pending_count",
          "in_progress_count",
          "sla_at_risk_count",
          "sla_breached_count",
          "completed_today"
        ],
        "properties": {
          "average_completion_time_seconds": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "completed_today": {
            "type": "integer",
            "format": "int64"
          },
          "in_progress_count": {
            "type": "integer",
            "format": "int64"
          },
          "pending_count": {
            "type": "integer",
            "format": "int64"
          },
          "sla_at_risk_count": {
            "type": "integer",
            "format": "int64"
          },
          "sla_breached_count": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ManualTaskOperation": {
        "type": "string",
        "description": "Type of provisioning operation.",
        "enum": [
          "grant",
          "revoke",
          "modify"
        ]
      },
      "ManualTaskStatus": {
        "type": "string",
        "description": "Status of a manual provisioning task.",
        "enum": [
          "pending",
          "pending_ticket",
          "ticket_created",
          "ticket_failed",
          "in_progress",
          "partially_completed",
          "completed",
          "rejected",
          "cancelled",
          "failed_permanent"
        ]
      },
      "ManualTriggerRequest": {
        "type": "object",
        "description": "Request to manually trigger a micro-certification.",
        "required": [
          "user_id",
          "entitlement_id",
          "reason"
        ],
        "properties": {
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "The entitlement to certify."
          },
          "reason": {
            "type": "string",
            "description": "Reason for manually triggering certification (minimum 10 characters)."
          },
          "reviewer_id": {
            "type": "string",
            "format": "uuid",
            "description": "Optional specific reviewer. If not provided, reviewer is resolved based on trigger rule.",
            "nullable": true
          },
          "trigger_rule_id": {
            "type": "string",
            "format": "uuid",
            "description": "Optional specific trigger rule to use. If not provided, the default rule for Manual trigger type is used.",
            "nullable": true
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "The user whose access to certify."
          }
        }
      },
      "ManualTriggerResponse": {
        "type": "object",
        "description": "Response for manual trigger operation.",
        "required": [
          "certification",
          "duplicate_skipped",
          "message"
        ],
        "properties": {
          "certification": {
            "$ref": "#/components/schemas/MicroCertificationResponse"
          },
          "duplicate_skipped": {
            "type": "boolean",
            "description": "Whether a duplicate was detected and skipped."
          },
          "message": {
            "type": "string",
            "description": "Message describing the outcome."
          }
        }
      },
      "MappingEntry": {
        "type": "object",
        "description": "A single mapping entry in a replace request.",
        "required": [
          "source_field",
          "target_scim_path",
          "resource_type"
        ],
        "properties": {
          "constant_value": {
            "type": "string",
            "nullable": true
          },
          "mapping_type": {
            "type": "string"
          },
          "resource_type": {
            "type": "string"
          },
          "source_field": {
            "type": "string"
          },
          "target_scim_path": {
            "type": "string"
          },
          "transform": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "MappingListResponse": {
        "type": "object",
        "description": "Response for mapping list.",
        "required": [
          "target_id",
          "mappings",
          "total_count"
        ],
        "properties": {
          "mappings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScimTargetAttributeMapping"
            }
          },
          "target_id": {
            "type": "string",
            "format": "uuid"
          },
          "total_count": {
            "type": "integer",
            "minimum": 0
          }
        }
      },
      "MatchingMetaRole": {
        "type": "object",
        "description": "A meta-role that matches a role.",
        "required": [
          "meta_role_id",
          "name",
          "priority",
          "match_reason",
          "already_applied"
        ],
        "properties": {
          "already_applied": {
            "type": "boolean",
            "description": "Whether already applied."
          },
          "inheritance_id": {
            "type": "string",
            "format": "uuid",
            "description": "Inheritance ID if already applied.",
            "nullable": true
          },
          "match_reason": {
            "description": "Why this meta-role matches."
          },
          "meta_role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Meta-role ID."
          },
          "name": {
            "type": "string",
            "description": "Meta-role name."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Meta-role priority."
          }
        }
      },
      "MatchingRuleInfo": {
        "type": "object",
        "description": "Matching rule info for validate response.",
        "required": [
          "id",
          "name",
          "ip_cidr"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Rule ID."
          },
          "ip_cidr": {
            "type": "string",
            "description": "IP CIDR that matched."
          },
          "name": {
            "type": "string",
            "description": "Rule name."
          }
        }
      },
      "McpCallRequest": {
        "type": "object",
        "description": "Request body for POST /mcp/tools/{name}/call.",
        "required": [
          "parameters"
        ],
        "properties": {
          "context": {
            "allOf": [
              {
                "$ref": "#/components/schemas/McpContext"
              }
            ],
            "nullable": true
          },
          "parameters": {
            "description": "Tool-specific parameters matching the input schema."
          }
        }
      },
      "McpCallResponse": {
        "type": "object",
        "description": "Response for successful tool invocation.",
        "required": [
          "call_id",
          "result",
          "latency_ms"
        ],
        "properties": {
          "call_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for this tool call (for audit)."
          },
          "latency_ms": {
            "type": "number",
            "format": "double",
            "description": "Execution latency in milliseconds."
          },
          "result": {
            "description": "Tool execution result."
          }
        }
      },
      "McpContext": {
        "type": "object",
        "description": "Optional context for MCP tool invocations.",
        "properties": {
          "conversation_id": {
            "type": "string",
            "description": "Conversation or session ID for correlation.",
            "nullable": true
          },
          "session_id": {
            "type": "string",
            "description": "Session identifier.",
            "nullable": true
          },
          "user_instruction": {
            "type": "string",
            "description": "Original user instruction (for audit).",
            "nullable": true
          }
        }
      },
      "McpErrorResponse": {
        "type": "object",
        "description": "MCP error response (RFC 7807 compatible).",
        "required": [
          "error_code",
          "message"
        ],
        "properties": {
          "details": {
            "description": "Additional error details (e.g., validation errors per field).",
            "nullable": true
          },
          "error_code": {
            "$ref": "#/components/schemas/McpErrorCode"
          },
          "message": {
            "type": "string",
            "description": "Human-readable error message."
          }
        }
      },
      "McpTool": {
        "type": "object",
        "description": "MCP tool definition with JSON Schema.",
        "required": [
          "name",
          "input_schema",
          "status"
        ],
        "properties": {
          "deprecated": {
            "type": "boolean",
            "description": "Whether this tool is deprecated (for MCP clients).",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Human-readable description of what the tool does.",
            "nullable": true
          },
          "input_schema": {
            "description": "JSON Schema defining the tool's input parameters."
          },
          "name": {
            "type": "string",
            "description": "Unique tool name (e.g., \"`send_email`\")."
          },
          "status": {
            "type": "string",
            "description": "Tool status: \"active\", \"deprecated\", or \"disabled\"."
          }
        }
      },
      "McpToolsResponse": {
        "type": "object",
        "description": "Response for GET /mcp/tools - list available tools.",
        "required": [
          "tools"
        ],
        "properties": {
          "tools": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/McpTool"
            },
            "description": "List of tools available to the authenticated agent."
          }
        }
      },
      "MergeAuditDetailResponse": {
        "type": "object",
        "description": "Detailed audit record response.",
        "required": [
          "id",
          "operation_id",
          "source_snapshot",
          "target_snapshot",
          "merged_snapshot",
          "attribute_decisions",
          "entitlement_decisions",
          "created_at"
        ],
        "properties": {
          "attribute_decisions": {},
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "entitlement_decisions": {},
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "merged_snapshot": {},
          "operation_id": {
            "type": "string",
            "format": "uuid"
          },
          "sod_violations": {
            "nullable": true
          },
          "source_snapshot": {},
          "target_snapshot": {}
        }
      },
      "MergeAuditSummaryResponse": {
        "type": "object",
        "description": "Summary response for merge audit in list.",
        "required": [
          "id",
          "operation_id",
          "source_identity_id",
          "target_identity_id",
          "operator_id",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "operation_id": {
            "type": "string",
            "format": "uuid"
          },
          "operator_id": {
            "type": "string",
            "format": "uuid"
          },
          "source_identity_id": {
            "type": "string",
            "format": "uuid"
          },
          "target_identity_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "MergeEntitlementSummary": {
        "type": "object",
        "description": "Summary of an entitlement.",
        "required": [
          "id",
          "name"
        ],
        "properties": {
          "application": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          }
        }
      },
      "MergeErrorResponse": {
        "type": "object",
        "description": "Error response for identity merge operations.",
        "required": [
          "error",
          "message"
        ],
        "properties": {
          "error": {
            "type": "string"
          },
          "message": {
            "type": "string"
          },
          "pending_operation_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "violations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MergeSodViolationResponse"
            },
            "nullable": true
          }
        }
      },
      "MergeExecuteRequest": {
        "type": "object",
        "description": "Request to execute a merge operation.",
        "required": [
          "source_identity_id",
          "target_identity_id",
          "entitlement_strategy"
        ],
        "properties": {
          "attribute_selections": {
            "nullable": true
          },
          "entitlement_selections": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "nullable": true
          },
          "entitlement_strategy": {
            "$ref": "#/components/schemas/GovEntitlementStrategy"
          },
          "sod_override_reason": {
            "type": "string",
            "nullable": true
          },
          "source_identity_id": {
            "type": "string",
            "format": "uuid"
          },
          "target_identity_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "MergeOperationResponse": {
        "type": "object",
        "description": "Response for a merge operation.",
        "required": [
          "id",
          "source_identity_id",
          "target_identity_id",
          "status",
          "entitlement_strategy",
          "operator_id",
          "started_at"
        ],
        "properties": {
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "entitlement_strategy": {
            "$ref": "#/components/schemas/GovEntitlementStrategy"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "operator_id": {
            "type": "string",
            "format": "uuid"
          },
          "source_identity_id": {
            "type": "string",
            "format": "uuid"
          },
          "started_at": {
            "type": "string",
            "format": "date-time"
          },
          "status": {
            "$ref": "#/components/schemas/GovMergeOperationStatus"
          },
          "target_identity_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "MergePolicyListResponse": {
        "type": "object",
        "description": "List of merge policies.",
        "required": [
          "items"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MergePolicyResponse"
            },
            "description": "List of merge policies."
          }
        }
      },
      "MergePolicyResponse": {
        "type": "object",
        "description": "Merge policy response.",
        "required": [
          "id",
          "template_id",
          "attribute",
          "strategy",
          "null_handling",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "attribute": {
            "type": "string",
            "description": "Target attribute."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "null_handling": {
            "$ref": "#/components/schemas/TemplateNullHandling"
          },
          "source_precedence": {
            "description": "Source precedence order.",
            "nullable": true
          },
          "strategy": {
            "$ref": "#/components/schemas/TemplateMergeStrategy"
          },
          "template_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parent template ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          }
        }
      },
      "MergePreviewRequest": {
        "type": "object",
        "description": "Request to preview a merge operation.",
        "required": [
          "source_identity_id",
          "target_identity_id",
          "entitlement_strategy"
        ],
        "properties": {
          "attribute_selections": {
            "nullable": true
          },
          "entitlement_strategy": {
            "$ref": "#/components/schemas/GovEntitlementStrategy"
          },
          "source_identity_id": {
            "type": "string",
            "format": "uuid"
          },
          "target_identity_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "MergePreviewResponse": {
        "type": "object",
        "description": "Response for merge preview.",
        "required": [
          "source_identity",
          "target_identity",
          "merged_preview",
          "entitlements_preview",
          "sod_check"
        ],
        "properties": {
          "entitlements_preview": {
            "$ref": "#/components/schemas/EntitlementsPreview"
          },
          "merged_preview": {
            "$ref": "#/components/schemas/IdentitySummary"
          },
          "sod_check": {
            "$ref": "#/components/schemas/MergeSodCheckResponse"
          },
          "source_identity": {
            "$ref": "#/components/schemas/IdentitySummary"
          },
          "target_identity": {
            "$ref": "#/components/schemas/IdentitySummary"
          }
        }
      },
      "MergeSodCheckResponse": {
        "type": "object",
        "description": "`SoD` check result for merge operations.",
        "required": [
          "has_violations",
          "can_override",
          "violations"
        ],
        "properties": {
          "can_override": {
            "type": "boolean"
          },
          "has_violations": {
            "type": "boolean"
          },
          "violations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MergeSodViolationResponse"
            }
          }
        }
      },
      "MergeSodViolationResponse": {
        "type": "object",
        "description": "`SoD` violation details for merge operations.",
        "required": [
          "rule_id",
          "rule_name",
          "severity",
          "entitlement_being_added",
          "conflicting_entitlement_id",
          "has_exemption"
        ],
        "properties": {
          "conflicting_entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "The existing entitlement that conflicts."
          },
          "entitlement_being_added": {
            "type": "string",
            "format": "uuid",
            "description": "The entitlement being added that causes the violation."
          },
          "has_exemption": {
            "type": "boolean",
            "description": "Whether an exemption exists for this violation."
          },
          "rule_id": {
            "type": "string",
            "format": "uuid",
            "description": "The `SoD` rule that would be violated."
          },
          "rule_name": {
            "type": "string",
            "description": "The name of the `SoD` rule."
          },
          "severity": {
            "type": "string",
            "description": "Severity level of the violation."
          }
        }
      },
      "MetaRoleConflictType": {
        "type": "string",
        "description": "Type of conflict between meta-roles.",
        "enum": [
          "entitlement_conflict",
          "constraint_conflict",
          "policy_conflict"
        ]
      },
      "MetaRoleConstraintResponse": {
        "type": "object",
        "description": "Meta-role constraint response.",
        "required": [
          "id",
          "meta_role_id",
          "constraint_type",
          "constraint_value",
          "created_at"
        ],
        "properties": {
          "constraint_type": {
            "type": "string",
            "description": "Constraint type."
          },
          "constraint_value": {
            "description": "Constraint configuration."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the constraint was created."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "meta_role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parent meta-role ID."
          }
        }
      },
      "MetaRoleCriteriaResponse": {
        "type": "object",
        "description": "Meta-role criterion response.",
        "required": [
          "id",
          "meta_role_id",
          "field",
          "operator",
          "value",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the criterion was created."
          },
          "field": {
            "type": "string",
            "description": "Field being matched."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "meta_role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parent meta-role ID."
          },
          "operator": {
            "$ref": "#/components/schemas/CriteriaOperator"
          },
          "value": {
            "description": "Value being compared."
          }
        }
      },
      "MetaRoleEntitlementResponse": {
        "type": "object",
        "description": "Meta-role entitlement response.",
        "required": [
          "id",
          "meta_role_id",
          "entitlement_id",
          "permission_type",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the entitlement was added."
          },
          "entitlement": {
            "allOf": [
              {
                "$ref": "#/components/schemas/MetaRoleEntitlementSummary"
              }
            ],
            "nullable": true
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement ID."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "meta_role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parent meta-role ID."
          },
          "permission_type": {
            "$ref": "#/components/schemas/PermissionType"
          }
        }
      },
      "MetaRoleEntitlementSummary": {
        "type": "object",
        "description": "Summary of an entitlement for display.",
        "required": [
          "id",
          "name",
          "application_id"
        ],
        "properties": {
          "application_id": {
            "type": "string",
            "format": "uuid",
            "description": "Application ID."
          },
          "application_name": {
            "type": "string",
            "description": "Application name.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement ID."
          },
          "name": {
            "type": "string",
            "description": "Entitlement name."
          },
          "risk_level": {
            "type": "string",
            "description": "Risk level.",
            "nullable": true
          }
        }
      },
      "MetaRoleEventType": {
        "type": "string",
        "description": "Event type for audit trail.",
        "enum": [
          "created",
          "updated",
          "deleted",
          "disabled",
          "enabled",
          "inheritance_applied",
          "inheritance_removed",
          "conflict_detected",
          "conflict_resolved",
          "cascade_started",
          "cascade_completed",
          "cascade_failed"
        ]
      },
      "MetaRoleListResponse": {
        "type": "object",
        "description": "Paginated list of meta-roles.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MetaRoleResponse"
            },
            "description": "List of meta-roles."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "MetaRoleResponse": {
        "type": "object",
        "description": "Meta-role response.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "priority",
          "status",
          "criteria_logic",
          "created_by",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the meta-role was created."
          },
          "created_by": {
            "type": "string",
            "format": "uuid",
            "description": "User who created this meta-role."
          },
          "criteria_logic": {
            "$ref": "#/components/schemas/CriteriaLogic"
          },
          "description": {
            "type": "string",
            "description": "Description.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority for conflict resolution."
          },
          "status": {
            "$ref": "#/components/schemas/MetaRoleStatus"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the meta-role was last updated."
          }
        }
      },
      "MetaRoleSimulationType": {
        "type": "string",
        "description": "Type of meta-role simulation.",
        "enum": [
          "create",
          "update",
          "delete",
          "criteria_change",
          "enable",
          "disable"
        ]
      },
      "MetaRoleStatsResponse": {
        "type": "object",
        "description": "Statistics for a meta-role.",
        "required": [
          "active_inheritances",
          "unresolved_conflicts",
          "criteria_count",
          "entitlements_count",
          "constraints_count"
        ],
        "properties": {
          "active_inheritances": {
            "type": "integer",
            "format": "int64",
            "description": "Number of active inheritances."
          },
          "constraints_count": {
            "type": "integer",
            "format": "int64",
            "description": "Total constraints count."
          },
          "criteria_count": {
            "type": "integer",
            "format": "int64",
            "description": "Total criteria count."
          },
          "entitlements_count": {
            "type": "integer",
            "format": "int64",
            "description": "Total entitlements count."
          },
          "unresolved_conflicts": {
            "type": "integer",
            "format": "int64",
            "description": "Number of unresolved conflicts."
          }
        }
      },
      "MetaRoleStatus": {
        "type": "string",
        "description": "Meta-role status.",
        "enum": [
          "active",
          "disabled"
        ]
      },
      "MetaRoleSummary": {
        "type": "object",
        "description": "Summary of a meta-role for display.",
        "required": [
          "id",
          "name",
          "priority",
          "status"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Meta-role ID."
          },
          "name": {
            "type": "string",
            "description": "Meta-role name."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Meta-role priority."
          },
          "status": {
            "$ref": "#/components/schemas/MetaRoleStatus"
          }
        }
      },
      "MetaRoleWithDetailsResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/MetaRoleResponse"
          },
          {
            "type": "object",
            "required": [
              "criteria",
              "entitlements",
              "constraints"
            ],
            "properties": {
              "constraints": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/MetaRoleConstraintResponse"
                },
                "description": "Inherited constraints."
              },
              "criteria": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/MetaRoleCriteriaResponse"
                },
                "description": "Matching criteria."
              },
              "entitlements": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/MetaRoleEntitlementResponse"
                },
                "description": "Inherited entitlements."
              },
              "stats": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/MetaRoleStatsResponse"
                  }
                ],
                "nullable": true
              }
            }
          }
        ],
        "description": "Meta-role response with full details."
      },
      "MfaMethod": {
        "type": "string",
        "description": "Available MFA method.",
        "enum": [
          "totp",
          "webauthn",
          "recovery"
        ]
      },
      "MfaRequiredResponse": {
        "type": "object",
        "description": "Response when login requires MFA.",
        "required": [
          "partial_token",
          "mfa_required",
          "expires_in"
        ],
        "properties": {
          "available_methods": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MfaMethod"
            },
            "description": "Available MFA methods for this user."
          },
          "expires_in": {
            "type": "integer",
            "format": "int64",
            "description": "Token expiry in seconds."
          },
          "mfa_required": {
            "type": "boolean",
            "description": "Indicates MFA is required."
          },
          "partial_token": {
            "type": "string",
            "description": "Partial token for MFA verification."
          }
        }
      },
      "MicroCertDecision": {
        "type": "string",
        "description": "Decision types for micro-certifications.\nFollows IGA patterns: Accept, Revoke, Reduce, Delegate, No Response.",
        "enum": [
          "approve",
          "revoke",
          "reduce",
          "delegate"
        ]
      },
      "MicroCertEntitlementSummary": {
        "type": "object",
        "description": "Entitlement summary for micro-certification display.",
        "required": [
          "id",
          "name",
          "application_id",
          "application_name",
          "is_sensitive"
        ],
        "properties": {
          "application_id": {
            "type": "string",
            "format": "uuid",
            "description": "Application ID."
          },
          "application_name": {
            "type": "string",
            "description": "Application name."
          },
          "description": {
            "type": "string",
            "description": "Entitlement description.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement ID."
          },
          "is_sensitive": {
            "type": "boolean",
            "description": "Whether it's a sensitive/high-risk entitlement."
          },
          "name": {
            "type": "string",
            "description": "Entitlement name."
          },
          "risk_level": {
            "type": "string",
            "description": "Risk level.",
            "nullable": true
          }
        }
      },
      "MicroCertEventListResponse": {
        "type": "object",
        "description": "Paginated list of micro-certification events.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MicroCertEventResponse"
            },
            "description": "List of events."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "MicroCertEventResponse": {
        "type": "object",
        "description": "Micro-certification event response (audit trail).",
        "required": [
          "id",
          "tenant_id",
          "micro_certification_id",
          "event_type",
          "created_at"
        ],
        "properties": {
          "actor_id": {
            "type": "string",
            "format": "uuid",
            "description": "Actor who performed action (NULL for system events).",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the event occurred."
          },
          "details": {
            "description": "Event-specific details.",
            "nullable": true
          },
          "event_type": {
            "$ref": "#/components/schemas/MicroCertEventType"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique event identifier."
          },
          "micro_certification_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parent certification ID."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          }
        }
      },
      "MicroCertEventType": {
        "type": "string",
        "description": "Event types for audit trail.",
        "enum": [
          "created",
          "reminder_sent",
          "escalated",
          "approved",
          "rejected",
          "flagged_for_review",
          "delegated",
          "auto_revoked",
          "expired",
          "skipped",
          "assignment_revoked"
        ]
      },
      "MicroCertReviewerType": {
        "type": "string",
        "description": "Reviewer types for determining who reviews.",
        "enum": [
          "user_manager",
          "entitlement_owner",
          "application_owner",
          "specific_user"
        ]
      },
      "MicroCertScopeType": {
        "type": "string",
        "description": "Scope types for trigger rules.",
        "enum": [
          "tenant",
          "application",
          "entitlement"
        ]
      },
      "MicroCertStatus": {
        "type": "string",
        "description": "Status for micro-certifications.",
        "enum": [
          "pending",
          "approved",
          "revoked",
          "auto_revoked",
          "flagged_for_review",
          "expired",
          "skipped"
        ]
      },
      "MicroCertTriggerType": {
        "type": "string",
        "description": "Trigger types for micro-certifications.",
        "enum": [
          "high_risk_assignment",
          "sod_violation",
          "manager_change",
          "periodic_recert",
          "manual"
        ]
      },
      "MicroCertUserSummary": {
        "type": "object",
        "description": "User summary for micro-certification display.",
        "required": [
          "id",
          "email",
          "display_name"
        ],
        "properties": {
          "department": {
            "type": "string",
            "description": "User department.",
            "nullable": true
          },
          "display_name": {
            "type": "string",
            "description": "User display name."
          },
          "email": {
            "type": "string",
            "description": "User email."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID."
          },
          "manager_id": {
            "type": "string",
            "format": "uuid",
            "description": "User's manager ID.",
            "nullable": true
          }
        }
      },
      "MicroCertificationListResponse": {
        "type": "object",
        "description": "Paginated list of micro-certifications.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MicroCertificationWithDetailsResponse"
            },
            "description": "List of micro-certifications."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "MicroCertificationResponse": {
        "type": "object",
        "description": "Micro-certification response.",
        "required": [
          "id",
          "tenant_id",
          "trigger_rule_id",
          "user_id",
          "entitlement_id",
          "reviewer_id",
          "status",
          "triggering_event_type",
          "triggering_event_id",
          "deadline",
          "reminder_sent",
          "escalated",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "assignment_id": {
            "type": "string",
            "format": "uuid",
            "description": "Assignment ID being certified (NULL if deleted).",
            "nullable": true
          },
          "backup_reviewer_id": {
            "type": "string",
            "format": "uuid",
            "description": "Backup reviewer for escalation.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the certification was created."
          },
          "deadline": {
            "type": "string",
            "format": "date-time",
            "description": "Deadline for certification."
          },
          "decided_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the decision was made.",
            "nullable": true
          },
          "decided_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who made the decision.",
            "nullable": true
          },
          "decision": {
            "allOf": [
              {
                "$ref": "#/components/schemas/MicroCertDecision"
              }
            ],
            "nullable": true
          },
          "decision_comment": {
            "type": "string",
            "description": "Decision comment.",
            "nullable": true
          },
          "delegated_by_id": {
            "type": "string",
            "format": "uuid",
            "description": "User who delegated to current reviewer (for Delegate decision chain).",
            "nullable": true
          },
          "delegation_comment": {
            "type": "string",
            "description": "Comment from delegator explaining why delegated.",
            "nullable": true
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement being certified."
          },
          "escalated": {
            "type": "boolean",
            "description": "Whether escalated to backup."
          },
          "escalation_deadline": {
            "type": "string",
            "format": "date-time",
            "description": "When to escalate to backup reviewer.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "original_reviewer_id": {
            "type": "string",
            "format": "uuid",
            "description": "Original reviewer before any delegation.",
            "nullable": true
          },
          "reminder_sent": {
            "type": "boolean",
            "description": "Whether reminder was sent."
          },
          "reviewer_id": {
            "type": "string",
            "format": "uuid",
            "description": "Current reviewer."
          },
          "revoked_assignment_id": {
            "type": "string",
            "format": "uuid",
            "description": "Which assignment was revoked (for `SoD` violations).",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/MicroCertStatus"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "trigger_rule_id": {
            "type": "string",
            "format": "uuid",
            "description": "Trigger rule ID that created this certification."
          },
          "triggering_event_data": {
            "description": "Snapshot of event payload.",
            "nullable": true
          },
          "triggering_event_id": {
            "type": "string",
            "format": "uuid",
            "description": "Event ID for traceability."
          },
          "triggering_event_type": {
            "type": "string",
            "description": "Event type that triggered this certification."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the certification was last updated."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User whose access is being certified."
          }
        }
      },
      "MicroCertificationStatsResponse": {
        "type": "object",
        "description": "Statistics response for micro-certifications.",
        "required": [
          "total",
          "pending",
          "approved",
          "revoked",
          "auto_revoked",
          "flagged_for_review",
          "expired",
          "skipped",
          "escalated",
          "past_deadline"
        ],
        "properties": {
          "approved": {
            "type": "integer",
            "format": "int64",
            "description": "Approved certifications."
          },
          "auto_revoked": {
            "type": "integer",
            "format": "int64",
            "description": "Auto-revoked certifications (timeout with `auto_revoke=true`)."
          },
          "by_trigger_type": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TriggerTypeStats"
            },
            "description": "Breakdown by trigger type.",
            "nullable": true
          },
          "escalated": {
            "type": "integer",
            "format": "int64",
            "description": "Certifications that were escalated."
          },
          "expired": {
            "type": "integer",
            "format": "int64",
            "description": "Expired certifications."
          },
          "flagged_for_review": {
            "type": "integer",
            "format": "int64",
            "description": "Flagged for review certifications (Reduce decision)."
          },
          "past_deadline": {
            "type": "integer",
            "format": "int64",
            "description": "Certifications past deadline but still pending."
          },
          "pending": {
            "type": "integer",
            "format": "int64",
            "description": "Pending certifications."
          },
          "revoked": {
            "type": "integer",
            "format": "int64",
            "description": "Revoked certifications (manual)."
          },
          "skipped": {
            "type": "integer",
            "format": "int64",
            "description": "Skipped certifications."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total certifications in period."
          }
        }
      },
      "MicroCertificationWithDetailsResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/MicroCertificationResponse"
          },
          {
            "type": "object",
            "properties": {
              "entitlement": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/MicroCertEntitlementSummary"
                  }
                ],
                "nullable": true
              },
              "events": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/MicroCertEventResponse"
                },
                "description": "Audit trail events.",
                "nullable": true
              },
              "reviewer": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/MicroCertUserSummary"
                  }
                ],
                "nullable": true
              },
              "trigger_rule": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/TriggerRuleSummary"
                  }
                ],
                "nullable": true
              },
              "user": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/MicroCertUserSummary"
                  }
                ],
                "nullable": true
              }
            }
          }
        ],
        "description": "Micro-certification response with additional details."
      },
      "MiningJobListResponse": {
        "type": "object",
        "description": "List response for mining jobs.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MiningJobResponse"
            }
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "page_size": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "MiningJobParameters": {
        "type": "object",
        "description": "Parameters for a mining job.",
        "properties": {
          "confidence_threshold": {
            "type": "number",
            "format": "double",
            "description": "Minimum confidence score for candidates."
          },
          "consolidation_threshold": {
            "type": "number",
            "format": "double",
            "description": "Minimum overlap percentage for consolidation suggestions."
          },
          "deviation_threshold": {
            "type": "number",
            "format": "double",
            "description": "Deviation percentage threshold for excessive privilege detection."
          },
          "include_consolidation": {
            "type": "boolean",
            "description": "Whether to detect role consolidation opportunities."
          },
          "include_excessive_privilege": {
            "type": "boolean",
            "description": "Whether to detect excessive privileges."
          },
          "min_entitlements": {
            "type": "integer",
            "format": "int32",
            "description": "Minimum entitlements in a candidate role."
          },
          "min_users": {
            "type": "integer",
            "format": "int32",
            "description": "Minimum users required to form a candidate role."
          },
          "peer_group_attribute": {
            "type": "string",
            "description": "Attribute to use for peer grouping (e.g., \"department\").",
            "nullable": true
          }
        }
      },
      "MiningJobParametersRequest": {
        "type": "object",
        "description": "Mining job parameters (input version).",
        "properties": {
          "confidence_threshold": {
            "type": "number",
            "format": "double"
          },
          "consolidation_threshold": {
            "type": "number",
            "format": "double"
          },
          "deviation_threshold": {
            "type": "number",
            "format": "double"
          },
          "include_consolidation": {
            "type": "boolean"
          },
          "include_excessive_privilege": {
            "type": "boolean"
          },
          "min_entitlements": {
            "type": "integer",
            "format": "int32"
          },
          "min_users": {
            "type": "integer",
            "format": "int32"
          },
          "peer_group_attribute": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "MiningJobResponse": {
        "type": "object",
        "description": "Response for a mining job.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "status",
          "parameters",
          "progress_percent",
          "candidate_count",
          "excessive_privilege_count",
          "consolidation_suggestion_count",
          "created_by",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "candidate_count": {
            "type": "integer",
            "format": "int32"
          },
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "consolidation_suggestion_count": {
            "type": "integer",
            "format": "int32"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "error_message": {
            "type": "string",
            "nullable": true
          },
          "excessive_privilege_count": {
            "type": "integer",
            "format": "int32"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "parameters": {
            "$ref": "#/components/schemas/MiningJobParameters"
          },
          "progress_percent": {
            "type": "integer",
            "format": "int32"
          },
          "started_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/MiningJobStatus"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "MiningJobStatus": {
        "type": "string",
        "description": "Status of a mining job.",
        "enum": [
          "pending",
          "running",
          "completed",
          "failed",
          "cancelled"
        ]
      },
      "MissingAttributeAuditResponse": {
        "type": "object",
        "description": "Response for missing attribute audit.",
        "required": [
          "users",
          "pagination",
          "total_missing_count"
        ],
        "properties": {
          "pagination": {
            "$ref": "#/components/schemas/PaginationMeta"
          },
          "total_missing_count": {
            "type": "integer",
            "format": "int64",
            "description": "Total number of users missing required attributes."
          },
          "users": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/UserMissingAttributes"
            },
            "description": "Users with missing required attributes."
          }
        }
      },
      "ModifyMembersRequest": {
        "type": "object",
        "description": "Request to modify group members.",
        "required": [
          "member_ids"
        ],
        "properties": {
          "member_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Member user IDs to add or remove."
          }
        }
      },
      "MoveGroupRequest": {
        "type": "object",
        "description": "Request to move a group to a new parent (or make it a root group).",
        "properties": {
          "parent_id": {
            "type": "string",
            "format": "uuid",
            "description": "New parent group ID. Set to null to make a root group.",
            "nullable": true
          }
        }
      },
      "MyPendingItemsResponse": {
        "type": "object",
        "description": "My pending items response.",
        "required": [
          "items",
          "total",
          "page",
          "per_page"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CertificationItemResponse"
            }
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "per_page": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "NameIdConfig": {
        "type": "object",
        "description": "`NameID` configuration.",
        "required": [
          "source"
        ],
        "properties": {
          "format": {
            "type": "string"
          },
          "source": {
            "type": "string"
          }
        }
      },
      "NhiAuditEventListResponse": {
        "type": "object",
        "description": "Paginated list of audit events.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NhiAuditEventResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "NhiAuditEventResponse": {
        "type": "object",
        "description": "NHI audit event response.",
        "required": [
          "id",
          "nhi_id",
          "event_type",
          "timestamp"
        ],
        "properties": {
          "actor_id": {
            "type": "string",
            "format": "uuid",
            "description": "Who performed the action (None for system actions).",
            "nullable": true
          },
          "changes": {
            "description": "Before/after values for changes.",
            "nullable": true
          },
          "event_type": {
            "$ref": "#/components/schemas/NhiAuditEventType"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Event ID."
          },
          "metadata": {
            "description": "Additional context/metadata.",
            "nullable": true
          },
          "nhi_id": {
            "type": "string",
            "format": "uuid",
            "description": "The NHI this event is for."
          },
          "source_ip": {
            "type": "string",
            "description": "IP address of the actor.",
            "nullable": true
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "When the event occurred."
          }
        }
      },
      "NhiAuditEventType": {
        "type": "string",
        "description": "Type of NHI audit event.",
        "enum": [
          "created",
          "updated",
          "credentials_rotated",
          "credential_revoked",
          "suspended",
          "reactivated",
          "ownership_transferred",
          "certified",
          "expired",
          "deleted",
          "emergency_suspended"
        ]
      },
      "NhiCertCampaignStatus": {
        "type": "string",
        "description": "Status of an NHI certification campaign.",
        "enum": [
          "draft",
          "active",
          "overdue",
          "completed",
          "cancelled"
        ]
      },
      "NhiCertReviewerType": {
        "type": "string",
        "description": "Reviewer assignment strategy for NHI certification.",
        "enum": [
          "owner",
          "backup_owner",
          "specific_users",
          "owner_manager"
        ]
      },
      "NhiCertificationCampaignListResponse": {
        "type": "object",
        "description": "Paginated list of NHI certification campaigns.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NhiCertificationCampaignResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "NhiCertificationCampaignResponse": {
        "type": "object",
        "description": "NHI certification campaign response.",
        "required": [
          "id",
          "name",
          "status",
          "total_items",
          "pending_items",
          "certified_items",
          "revoked_items",
          "expired_items",
          "completion_rate",
          "deadline",
          "created_by",
          "created_at"
        ],
        "properties": {
          "certified_items": {
            "type": "integer",
            "format": "int64",
            "description": "Certified items."
          },
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the campaign was completed (if completed).",
            "nullable": true
          },
          "completion_rate": {
            "type": "number",
            "format": "double",
            "description": "Completion rate as percentage."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the campaign was created."
          },
          "created_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who created the campaign."
          },
          "deadline": {
            "type": "string",
            "format": "date-time",
            "description": "Campaign deadline."
          },
          "description": {
            "type": "string",
            "description": "Campaign description.",
            "nullable": true
          },
          "expired_items": {
            "type": "integer",
            "format": "int64",
            "description": "Expired items."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Campaign ID."
          },
          "launched_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the campaign was launched (if launched).",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Campaign name."
          },
          "pending_items": {
            "type": "integer",
            "format": "int64",
            "description": "Pending items."
          },
          "revoked_items": {
            "type": "integer",
            "format": "int64",
            "description": "Revoked items."
          },
          "status": {
            "$ref": "#/components/schemas/NhiCertCampaignStatus"
          },
          "total_items": {
            "type": "integer",
            "format": "int64",
            "description": "Total NHIs included."
          }
        }
      },
      "NhiCertificationDecision": {
        "type": "string",
        "description": "Decision made on an NHI certification item.",
        "enum": [
          "certify",
          "revoke",
          "delegate"
        ]
      },
      "NhiCertificationDecisionRequest": {
        "type": "object",
        "description": "Request to make a decision on an NHI certification item.",
        "required": [
          "decision"
        ],
        "properties": {
          "comment": {
            "type": "string",
            "description": "Comment explaining the decision.",
            "nullable": true
          },
          "decision": {
            "$ref": "#/components/schemas/NhiCertificationDecision"
          },
          "delegate_to": {
            "type": "string",
            "format": "uuid",
            "description": "Delegate to this user (required if decision is Delegate).",
            "nullable": true
          }
        }
      },
      "NhiCertificationItemListResponse": {
        "type": "object",
        "description": "Paginated list of NHI certification items.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NhiCertificationItemResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "NhiCertificationItemResponse": {
        "type": "object",
        "description": "NHI certification item response.",
        "required": [
          "id",
          "campaign_id",
          "nhi_id",
          "nhi_name",
          "nhi_purpose",
          "owner_id",
          "reviewer_id",
          "status",
          "deadline",
          "created_at"
        ],
        "properties": {
          "campaign_id": {
            "type": "string",
            "format": "uuid",
            "description": "The certification campaign this belongs to."
          },
          "comment": {
            "type": "string",
            "description": "Comment from reviewer.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the item was created."
          },
          "deadline": {
            "type": "string",
            "format": "date-time",
            "description": "Deadline for decision."
          },
          "decided_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the decision was made.",
            "nullable": true
          },
          "decided_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who made the decision.",
            "nullable": true
          },
          "decision": {
            "allOf": [
              {
                "$ref": "#/components/schemas/NhiCertificationDecision"
              }
            ],
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Certification item ID."
          },
          "nhi_id": {
            "type": "string",
            "format": "uuid",
            "description": "The NHI being certified."
          },
          "nhi_name": {
            "type": "string",
            "description": "NHI display name."
          },
          "nhi_purpose": {
            "type": "string",
            "description": "NHI purpose."
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "NHI owner responsible."
          },
          "owner_name": {
            "type": "string",
            "description": "Owner name (if resolved).",
            "nullable": true
          },
          "reviewer_id": {
            "type": "string",
            "format": "uuid",
            "description": "Assigned reviewer."
          },
          "status": {
            "$ref": "#/components/schemas/NhiCertificationStatus"
          }
        }
      },
      "NhiCertificationStatus": {
        "type": "string",
        "description": "Status of an NHI certification item.",
        "enum": [
          "pending",
          "certified",
          "revoked",
          "expired"
        ]
      },
      "NhiCertificationSummary": {
        "type": "object",
        "description": "NHI certification campaign summary.",
        "required": [
          "total",
          "pending",
          "certified",
          "revoked",
          "expired"
        ],
        "properties": {
          "certified": {
            "type": "integer",
            "format": "int64",
            "description": "Certified (approved) items."
          },
          "expired": {
            "type": "integer",
            "format": "int64",
            "description": "Expired items (deadline passed)."
          },
          "pending": {
            "type": "integer",
            "format": "int64",
            "description": "Pending items awaiting decision."
          },
          "revoked": {
            "type": "integer",
            "format": "int64",
            "description": "Revoked items."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total items in campaign."
          }
        }
      },
      "NhiCredentialCreatedResponse": {
        "type": "object",
        "description": "Response when creating/rotating credentials (includes sensitive data ONCE).",
        "required": [
          "credential",
          "secret_value",
          "warning"
        ],
        "properties": {
          "credential": {
            "$ref": "#/components/schemas/NhiCredentialResponse"
          },
          "grace_period_ends_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the grace period ends (if old credentials still active).",
            "nullable": true
          },
          "secret_value": {
            "type": "string",
            "description": "The plaintext secret value (ONLY SHOWN ONCE).\nThis is the API key, secret, or certificate content."
          },
          "warning": {
            "type": "string",
            "description": "Message warning about one-time display."
          }
        }
      },
      "NhiCredentialListResponse": {
        "type": "object",
        "description": "List of credentials response.",
        "required": [
          "items",
          "total"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NhiCredentialResponse"
            }
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "NhiCredentialResponse": {
        "type": "object",
        "description": "NHI credential response (without sensitive data).",
        "required": [
          "id",
          "nhi_id",
          "credential_type",
          "is_active",
          "valid_from",
          "valid_until",
          "days_until_expiry",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the credential was created."
          },
          "credential_type": {
            "$ref": "#/components/schemas/NhiCredentialType"
          },
          "days_until_expiry": {
            "type": "integer",
            "format": "int64",
            "description": "Days until expiration."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Credential ID."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the credential is active."
          },
          "nhi_id": {
            "type": "string",
            "format": "uuid",
            "description": "The NHI this credential belongs to."
          },
          "rotated_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who triggered the rotation (if rotated).",
            "nullable": true
          },
          "valid_from": {
            "type": "string",
            "format": "date-time",
            "description": "When the credential becomes valid."
          },
          "valid_until": {
            "type": "string",
            "format": "date-time",
            "description": "When the credential expires."
          }
        }
      },
      "NhiCredentialType": {
        "type": "string",
        "description": "Type of NHI credential.",
        "enum": [
          "api_key",
          "secret",
          "certificate"
        ]
      },
      "NhiItem": {
        "type": "object",
        "description": "Individual NHI item in the listing.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "nhi_type",
          "owner_id",
          "status",
          "created_at",
          "risk_score",
          "risk_level"
        ],
        "properties": {
          "backup_owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Backup owner user ID.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the NHI was created."
          },
          "description": {
            "type": "string",
            "description": "Description or purpose.",
            "nullable": true
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the NHI expires.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "last_activity_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last activity timestamp.",
            "nullable": true
          },
          "last_certified_at": {
            "type": "string",
            "format": "date-time",
            "description": "When last certified.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "next_certification_at": {
            "type": "string",
            "format": "date-time",
            "description": "When next certification is due.",
            "nullable": true
          },
          "nhi_type": {
            "type": "string",
            "description": "Type discriminator: \"`service_account`\" or \"`ai_agent`\"."
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Primary owner user ID."
          },
          "risk_level": {
            "type": "string",
            "description": "Risk level category."
          },
          "risk_score": {
            "type": "integer",
            "format": "int32",
            "description": "Risk score (0-100)."
          },
          "status": {
            "type": "string",
            "description": "Current status."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          }
        }
      },
      "NhiListResponse": {
        "type": "object",
        "description": "Paginated response for NHI listing.",
        "required": [
          "items",
          "total",
          "page",
          "per_page",
          "total_pages"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NhiItem"
            },
            "description": "List of NHIs."
          },
          "page": {
            "type": "integer",
            "format": "int64",
            "description": "Current page number."
          },
          "per_page": {
            "type": "integer",
            "format": "int64",
            "description": "Items per page."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count of matching NHIs."
          },
          "total_pages": {
            "type": "integer",
            "format": "int64",
            "description": "Total number of pages."
          }
        }
      },
      "NhiRequestListResponse": {
        "type": "object",
        "description": "Paginated list of NHI requests.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NhiRequestResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "NhiRequestResponse": {
        "type": "object",
        "description": "NHI request response.",
        "required": [
          "id",
          "requester_id",
          "requested_name",
          "purpose",
          "requested_permissions",
          "status",
          "expires_at",
          "created_at"
        ],
        "properties": {
          "approver_id": {
            "type": "string",
            "format": "uuid",
            "description": "Who approved/rejected the request.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the request was submitted."
          },
          "created_nhi_id": {
            "type": "string",
            "format": "uuid",
            "description": "The created NHI ID (if approved).",
            "nullable": true
          },
          "decision_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the decision was made.",
            "nullable": true
          },
          "decision_comments": {
            "type": "string",
            "description": "Approver comments.",
            "nullable": true
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "When this request expires."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Request ID."
          },
          "purpose": {
            "type": "string",
            "description": "Purpose/justification for the NHI."
          },
          "requested_expiration": {
            "type": "string",
            "format": "date-time",
            "description": "Requested expiration date.",
            "nullable": true
          },
          "requested_name": {
            "type": "string",
            "description": "Requested NHI name."
          },
          "requested_permissions": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Requested entitlement IDs."
          },
          "requested_rotation_days": {
            "type": "integer",
            "format": "int32",
            "description": "Requested rotation interval in days.",
            "nullable": true
          },
          "requester_id": {
            "type": "string",
            "format": "uuid",
            "description": "Who submitted the request."
          },
          "status": {
            "$ref": "#/components/schemas/NhiRequestStatus"
          }
        }
      },
      "NhiRequestStatus": {
        "type": "string",
        "description": "Status of an NHI request.",
        "enum": [
          "pending",
          "approved",
          "rejected",
          "cancelled"
        ]
      },
      "NhiResponse": {
        "type": "object",
        "description": "NHI (Non-Human Identity) response with full lifecycle details.",
        "required": [
          "id",
          "user_id",
          "name",
          "purpose",
          "owner_id",
          "status",
          "needs_rotation",
          "is_inactive",
          "is_in_grace_period",
          "needs_certification",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "backup_owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Backup owner (secondary contact).",
            "nullable": true
          },
          "certified_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who performed the last certification.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "days_since_last_use": {
            "type": "integer",
            "format": "int64",
            "description": "Days since last use.",
            "nullable": true
          },
          "days_until_expiry": {
            "type": "integer",
            "format": "int64",
            "description": "Days until expiration (if applicable).",
            "nullable": true
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "When this NHI expires (if applicable).",
            "nullable": true
          },
          "grace_period_ends_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the grace period ends (after inactivity warning).",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "NHI ID (same as service account ID)."
          },
          "inactivity_threshold_days": {
            "type": "integer",
            "format": "int32",
            "description": "Inactivity threshold in days (default: 90).",
            "nullable": true
          },
          "is_in_grace_period": {
            "type": "boolean",
            "description": "Whether in grace period."
          },
          "is_inactive": {
            "type": "boolean",
            "description": "Whether the NHI is inactive (beyond threshold)."
          },
          "last_certified_at": {
            "type": "string",
            "format": "date-time",
            "description": "When ownership was last certified.",
            "nullable": true
          },
          "last_rotation_at": {
            "type": "string",
            "format": "date-time",
            "description": "When credentials were last rotated.",
            "nullable": true
          },
          "last_used_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the NHI was last used.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Display name for the NHI."
          },
          "needs_certification": {
            "type": "boolean",
            "description": "Whether certification is due."
          },
          "needs_rotation": {
            "type": "boolean",
            "description": "Whether credential rotation is needed."
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Primary owner responsible for this NHI."
          },
          "purpose": {
            "type": "string",
            "description": "Purpose/justification for the NHI."
          },
          "rotation_interval_days": {
            "type": "integer",
            "format": "int32",
            "description": "Credential rotation interval in days.",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/ServiceAccountStatus"
          },
          "suspension_reason": {
            "allOf": [
              {
                "$ref": "#/components/schemas/NhiSuspensionReason"
              }
            ],
            "nullable": true
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "The linked user ID."
          }
        }
      },
      "NhiRiskBreakdown": {
        "type": "object",
        "description": "NHI count breakdown by risk level.",
        "required": [
          "low",
          "medium",
          "high",
          "critical"
        ],
        "properties": {
          "critical": {
            "type": "integer",
            "format": "int64"
          },
          "high": {
            "type": "integer",
            "format": "int64"
          },
          "low": {
            "type": "integer",
            "format": "int64"
          },
          "medium": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "NhiRiskScoreListResponse": {
        "type": "object",
        "description": "Paginated list of NHI risk scores.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NhiRiskScoreResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int32"
          },
          "offset": {
            "type": "integer",
            "format": "int32"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "NhiRiskScoreResponse": {
        "type": "object",
        "description": "NHI risk score response.",
        "required": [
          "nhi_id",
          "total_score",
          "risk_level",
          "staleness_factor",
          "credential_age_factor",
          "access_scope_factor",
          "factor_breakdown",
          "calculated_at"
        ],
        "properties": {
          "access_scope_factor": {
            "type": "integer",
            "format": "int32",
            "description": "Contribution from access scope (entitlement sensitivity)."
          },
          "calculated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the score was calculated."
          },
          "credential_age_factor": {
            "type": "integer",
            "format": "int32",
            "description": "Contribution from credential age."
          },
          "factor_breakdown": {
            "description": "Detailed breakdown of factor calculations."
          },
          "next_calculation_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the next calculation should occur.",
            "nullable": true
          },
          "nhi_id": {
            "type": "string",
            "format": "uuid",
            "description": "The NHI ID."
          },
          "risk_level": {
            "$ref": "#/components/schemas/RiskLevel"
          },
          "staleness_factor": {
            "type": "integer",
            "format": "int32",
            "description": "Contribution from staleness (days since last use)."
          },
          "total_score": {
            "type": "integer",
            "format": "int32",
            "description": "Combined risk score (0-100)."
          }
        }
      },
      "NhiSummary": {
        "type": "object",
        "description": "Summary of NHIs.",
        "required": [
          "total",
          "active",
          "expired",
          "suspended",
          "needs_certification",
          "needs_rotation",
          "inactive",
          "expiring_soon"
        ],
        "properties": {
          "active": {
            "type": "integer",
            "format": "int64",
            "description": "Number of active NHIs."
          },
          "by_risk_level": {
            "allOf": [
              {
                "$ref": "#/components/schemas/NhiRiskBreakdown"
              }
            ],
            "nullable": true
          },
          "expired": {
            "type": "integer",
            "format": "int64",
            "description": "Number of expired NHIs."
          },
          "expiring_soon": {
            "type": "integer",
            "format": "int64",
            "description": "Number expiring within 30 days."
          },
          "inactive": {
            "type": "integer",
            "format": "int64",
            "description": "Number inactive (beyond threshold)."
          },
          "needs_certification": {
            "type": "integer",
            "format": "int64",
            "description": "Number needing certification."
          },
          "needs_rotation": {
            "type": "integer",
            "format": "int64",
            "description": "Number needing credential rotation."
          },
          "suspended": {
            "type": "integer",
            "format": "int64",
            "description": "Number of suspended NHIs."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total number of NHIs."
          }
        }
      },
      "NhiSuspensionReason": {
        "type": "string",
        "description": "Reason why an NHI was suspended.",
        "enum": [
          "expired",
          "inactive",
          "certification_revoked",
          "emergency",
          "manual"
        ]
      },
      "NhiUsageEventListResponse": {
        "type": "object",
        "description": "Paginated list of usage events.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NhiUsageEventResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "NhiUsageEventResponse": {
        "type": "object",
        "description": "NHI usage event response.",
        "required": [
          "id",
          "nhi_id",
          "timestamp",
          "target_resource",
          "action",
          "outcome"
        ],
        "properties": {
          "action": {
            "type": "string",
            "description": "The action performed."
          },
          "duration_ms": {
            "type": "integer",
            "format": "int32",
            "description": "Request duration in milliseconds.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Event ID."
          },
          "nhi_id": {
            "type": "string",
            "format": "uuid",
            "description": "The NHI that was used."
          },
          "outcome": {
            "$ref": "#/components/schemas/NhiUsageOutcome"
          },
          "source_ip": {
            "type": "string",
            "description": "Source IP address.",
            "nullable": true
          },
          "target_resource": {
            "type": "string",
            "description": "The resource/service accessed."
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "When the event occurred."
          },
          "user_agent": {
            "type": "string",
            "description": "User agent string.",
            "nullable": true
          }
        }
      },
      "NhiUsageListResponse": {
        "type": "object",
        "description": "Paginated list of usage events (alias for `NhiUsageEventListResponse`).",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NhiUsageEventResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int32"
          },
          "offset": {
            "type": "integer",
            "format": "int32"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "NhiUsageSummaryExtendedResponse": {
        "type": "object",
        "description": "Extended NHI usage summary response.",
        "required": [
          "nhi_id",
          "nhi_name",
          "period_days",
          "total_events",
          "successful_events",
          "failed_events",
          "denied_events",
          "success_rate",
          "unique_resources",
          "top_resources"
        ],
        "properties": {
          "denied_events": {
            "type": "integer",
            "format": "int64",
            "description": "Denied events."
          },
          "failed_events": {
            "type": "integer",
            "format": "int64",
            "description": "Failed events."
          },
          "last_used_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the NHI was last used.",
            "nullable": true
          },
          "nhi_id": {
            "type": "string",
            "format": "uuid",
            "description": "The NHI ID."
          },
          "nhi_name": {
            "type": "string",
            "description": "The NHI name."
          },
          "period_days": {
            "type": "integer",
            "format": "int32",
            "description": "Period in days covered."
          },
          "success_rate": {
            "type": "number",
            "format": "double",
            "description": "Success rate as percentage."
          },
          "successful_events": {
            "type": "integer",
            "format": "int64",
            "description": "Successful events."
          },
          "top_resources": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ResourceAccessInfo"
            },
            "description": "Top accessed resources."
          },
          "total_events": {
            "type": "integer",
            "format": "int64",
            "description": "Total events in period."
          },
          "unique_resources": {
            "type": "integer",
            "format": "int64",
            "description": "Number of unique resources accessed."
          }
        }
      },
      "NhiUsageSummaryResponse": {
        "type": "object",
        "description": "NHI usage summary.",
        "required": [
          "nhi_id",
          "period_days",
          "total_events",
          "successful_events",
          "failed_events",
          "denied_events",
          "unique_resources",
          "top_resources"
        ],
        "properties": {
          "denied_events": {
            "type": "integer",
            "format": "int64",
            "description": "Denied events."
          },
          "failed_events": {
            "type": "integer",
            "format": "int64",
            "description": "Failed events."
          },
          "last_used_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the NHI was last used.",
            "nullable": true
          },
          "nhi_id": {
            "type": "string",
            "format": "uuid",
            "description": "The NHI ID."
          },
          "period_days": {
            "type": "integer",
            "format": "int32",
            "description": "Period in days covered."
          },
          "successful_events": {
            "type": "integer",
            "format": "int64",
            "description": "Successful events."
          },
          "top_resources": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ResourceAccessSummary"
            },
            "description": "Top accessed resources."
          },
          "total_events": {
            "type": "integer",
            "format": "int64",
            "description": "Total events in period."
          },
          "unique_resources": {
            "type": "integer",
            "format": "int64",
            "description": "Number of unique resources accessed."
          }
        }
      },
      "OAuthClientInfo": {
        "type": "object",
        "description": "OAuth client credentials.",
        "required": [
          "client_id",
          "client_secret"
        ],
        "properties": {
          "client_id": {
            "type": "string",
            "description": "OAuth client identifier.",
            "example": "client_a1b2c3d4e5f6"
          },
          "client_secret": {
            "type": "string",
            "description": "OAuth client secret.\n\n**WARNING**: This secret is shown only once. Store it securely.",
            "example": "secret_x9y8z7w6v5u4t3s2r1q0"
          }
        }
      },
      "ObjectTemplateStatus": {
        "type": "string",
        "description": "Object template lifecycle status (named distinctly from report `TemplateStatus`).",
        "enum": [
          "draft",
          "active",
          "disabled"
        ]
      },
      "OpenIdConfiguration": {
        "type": "object",
        "description": "`OpenID` Connect Discovery document.",
        "required": [
          "issuer",
          "authorization_endpoint",
          "token_endpoint",
          "userinfo_endpoint",
          "jwks_uri",
          "response_types_supported",
          "grant_types_supported",
          "subject_types_supported",
          "id_token_signing_alg_values_supported",
          "scopes_supported",
          "token_endpoint_auth_methods_supported",
          "code_challenge_methods_supported",
          "claims_supported"
        ],
        "properties": {
          "authorization_endpoint": {
            "type": "string",
            "description": "Authorization endpoint URL."
          },
          "claims_supported": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Supported claims."
          },
          "code_challenge_methods_supported": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Supported PKCE code challenge methods."
          },
          "device_authorization_endpoint": {
            "type": "string",
            "description": "Device authorization endpoint URL (RFC 8628).",
            "nullable": true
          },
          "grant_types_supported": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Supported grant types."
          },
          "id_token_signing_alg_values_supported": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Supported ID token signing algorithms."
          },
          "issuer": {
            "type": "string",
            "description": "Issuer identifier."
          },
          "jwks_uri": {
            "type": "string",
            "description": "JWKS URI."
          },
          "response_types_supported": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Supported response types."
          },
          "scopes_supported": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Supported scopes."
          },
          "subject_types_supported": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Supported subject types."
          },
          "token_endpoint": {
            "type": "string",
            "description": "Token endpoint URL."
          },
          "token_endpoint_auth_methods_supported": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Supported token endpoint authentication methods."
          },
          "userinfo_endpoint": {
            "type": "string",
            "description": "`UserInfo` endpoint URL."
          }
        }
      },
      "OperationListResponse": {
        "type": "object",
        "description": "Paginated list response.",
        "required": [
          "operations",
          "total",
          "offset",
          "limit"
        ],
        "properties": {
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Applied limit."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Current offset."
          },
          "operations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/OperationResponse"
            },
            "description": "List of operations."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count (for pagination)."
          }
        }
      },
      "OperationLogResponse": {
        "type": "object",
        "description": "Operation log response.",
        "required": [
          "id",
          "operation_id",
          "connector_id",
          "operation_type",
          "status",
          "created_at"
        ],
        "properties": {
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "Connector ID."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When logged."
          },
          "duration_ms": {
            "type": "integer",
            "format": "int32",
            "description": "Duration in milliseconds.",
            "nullable": true
          },
          "error_message": {
            "type": "string",
            "description": "Error message.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Log ID."
          },
          "operation_id": {
            "type": "string",
            "format": "uuid",
            "description": "Operation ID."
          },
          "operation_type": {
            "type": "string",
            "description": "Operation type."
          },
          "status": {
            "type": "string",
            "description": "Log status."
          },
          "target_uid": {
            "type": "string",
            "description": "Target UID.",
            "nullable": true
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID.",
            "nullable": true
          }
        }
      },
      "OperationResponse": {
        "type": "object",
        "description": "Response for a provisioning operation.",
        "required": [
          "id",
          "tenant_id",
          "connector_id",
          "user_id",
          "operation_type",
          "object_class",
          "status",
          "retry_count",
          "max_retries",
          "priority",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "attempts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AttemptResponse"
            },
            "description": "Execution attempt history (populated when `include_attempts=true`).\nEach attempt records a single execution of the operation (F047).",
            "nullable": true
          },
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the operation completed.",
            "nullable": true
          },
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "Connector ID."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the operation was created."
          },
          "error_message": {
            "type": "string",
            "description": "Error message if failed.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Operation ID."
          },
          "idempotency_key": {
            "type": "string",
            "description": "Idempotency key for duplicate detection.",
            "nullable": true
          },
          "max_retries": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum retries allowed."
          },
          "next_retry_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the next retry is scheduled (if failed).",
            "nullable": true
          },
          "object_class": {
            "type": "string",
            "description": "Target object class."
          },
          "operation_type": {
            "type": "string",
            "description": "Operation type."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority level."
          },
          "resolution_notes": {
            "type": "string",
            "description": "Resolution notes (for resolved DLQ items).",
            "nullable": true
          },
          "resolved_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the operation was resolved.",
            "nullable": true
          },
          "resolved_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who resolved this operation (for DLQ items).",
            "nullable": true
          },
          "retry_count": {
            "type": "integer",
            "format": "int32",
            "description": "Number of retry attempts."
          },
          "started_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the operation started processing.",
            "nullable": true
          },
          "status": {
            "type": "string",
            "description": "Operation status."
          },
          "target_uid": {
            "type": "string",
            "description": "Target UID in external system.",
            "nullable": true
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the operation was last updated."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID being provisioned."
          }
        }
      },
      "OrphanAgeAnalysis": {
        "type": "object",
        "description": "Age analysis of orphan accounts.",
        "required": [
          "under_7_days",
          "from_7_to_30_days",
          "from_30_to_90_days",
          "over_90_days",
          "average_age_days"
        ],
        "properties": {
          "average_age_days": {
            "type": "number",
            "format": "double",
            "description": "Average age in days."
          },
          "from_30_to_90_days": {
            "type": "integer",
            "format": "int64",
            "description": "Orphans detected 30-90 days ago."
          },
          "from_7_to_30_days": {
            "type": "integer",
            "format": "int64",
            "description": "Orphans detected 7-30 days ago."
          },
          "median_age_days": {
            "type": "number",
            "format": "double",
            "description": "Median age in days.",
            "nullable": true
          },
          "over_90_days": {
            "type": "integer",
            "format": "int64",
            "description": "Orphans detected more than 90 days ago."
          },
          "under_7_days": {
            "type": "integer",
            "format": "int64",
            "description": "Orphans detected within last 7 days."
          }
        }
      },
      "OrphanDetectionListResponse": {
        "type": "object",
        "description": "Paginated list of orphan detections.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/OrphanDetectionResponse"
            },
            "description": "List of detections."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "OrphanDetectionResponse": {
        "type": "object",
        "description": "Orphan detection response.",
        "required": [
          "id",
          "user_id",
          "run_id",
          "detection_reason",
          "status",
          "detected_at",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "days_inactive": {
            "type": "integer",
            "format": "int32",
            "description": "Days since last activity (for inactive detection).",
            "nullable": true
          },
          "detected_at": {
            "type": "string",
            "format": "date-time",
            "description": "When this orphan was detected."
          },
          "detection_reason": {
            "$ref": "#/components/schemas/DetectionReason"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Detection ID."
          },
          "last_activity_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last activity time for the user (if available).",
            "nullable": true
          },
          "new_owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "New owner for reassignment.",
            "nullable": true
          },
          "remediation_action": {
            "allOf": [
              {
                "$ref": "#/components/schemas/RemediationAction"
              }
            ],
            "nullable": true
          },
          "remediation_at": {
            "type": "string",
            "format": "date-time",
            "description": "When remediation was performed.",
            "nullable": true
          },
          "remediation_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who performed the remediation.",
            "nullable": true
          },
          "remediation_notes": {
            "type": "string",
            "description": "Notes or justification for remediation.",
            "nullable": true
          },
          "run_id": {
            "type": "string",
            "format": "uuid",
            "description": "The reconciliation run that detected this."
          },
          "status": {
            "$ref": "#/components/schemas/OrphanStatus"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "The user identified as orphan."
          }
        }
      },
      "OrphanRiskReport": {
        "type": "object",
        "description": "Risk assessment of orphan accounts.",
        "required": [
          "total_orphans",
          "high_risk",
          "medium_risk",
          "low_risk",
          "with_active_sessions",
          "with_recent_activity",
          "high_risk_details"
        ],
        "properties": {
          "high_risk": {
            "type": "integer",
            "format": "int64",
            "description": "High-risk orphans (e.g., with sensitive entitlements)."
          },
          "high_risk_details": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/HighRiskOrphan"
            },
            "description": "Top high-risk orphans."
          },
          "low_risk": {
            "type": "integer",
            "format": "int64",
            "description": "Low-risk orphans."
          },
          "medium_risk": {
            "type": "integer",
            "format": "int64",
            "description": "Medium-risk orphans."
          },
          "total_orphans": {
            "type": "integer",
            "format": "int64",
            "description": "Total orphan count."
          },
          "with_active_sessions": {
            "type": "integer",
            "format": "int64",
            "description": "Orphans with active sessions."
          },
          "with_recent_activity": {
            "type": "integer",
            "format": "int64",
            "description": "Orphans with recent activity."
          }
        }
      },
      "OrphanStatus": {
        "type": "string",
        "description": "Status of an orphan detection.",
        "enum": [
          "pending",
          "under_review",
          "remediated",
          "dismissed"
        ]
      },
      "OrphanSummaryResponse": {
        "type": "object",
        "description": "Summary of orphan detections.",
        "required": [
          "total_pending",
          "total_under_review",
          "total_remediated",
          "total_dismissed",
          "by_reason"
        ],
        "properties": {
          "average_age_days": {
            "type": "number",
            "format": "double",
            "description": "Average age in days of pending orphans.",
            "nullable": true
          },
          "by_reason": {
            "$ref": "#/components/schemas/ReasonBreakdown"
          },
          "total_dismissed": {
            "type": "integer",
            "format": "int64",
            "description": "Count of dismissed orphans."
          },
          "total_pending": {
            "type": "integer",
            "format": "int64",
            "description": "Count of pending orphans."
          },
          "total_remediated": {
            "type": "integer",
            "format": "int64",
            "description": "Count of remediated orphans."
          },
          "total_under_review": {
            "type": "integer",
            "format": "int64",
            "description": "Count of orphans under review."
          }
        }
      },
      "OutlierAlertSeverity": {
        "type": "string",
        "description": "Severity level for outlier alerts.",
        "enum": [
          "low",
          "medium",
          "high",
          "critical"
        ]
      },
      "OutlierAlertType": {
        "type": "string",
        "description": "Type of outlier alert.",
        "enum": [
          "new_outlier",
          "score_increase",
          "repeated_outlier"
        ]
      },
      "OutlierAnalysisResponse": {
        "type": "object",
        "description": "Response containing analysis details.",
        "required": [
          "id",
          "tenant_id",
          "status",
          "triggered_by",
          "started_at",
          "users_analyzed",
          "outliers_detected",
          "progress_percent",
          "created_at"
        ],
        "properties": {
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "error_message": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "outliers_detected": {
            "type": "integer",
            "format": "int32"
          },
          "progress_percent": {
            "type": "integer",
            "format": "int32"
          },
          "started_at": {
            "type": "string",
            "format": "date-time"
          },
          "status": {
            "$ref": "#/components/schemas/OutlierAnalysisStatus"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid"
          },
          "triggered_by": {
            "$ref": "#/components/schemas/OutlierTriggerType"
          },
          "users_analyzed": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "OutlierAnalysisStatus": {
        "type": "string",
        "description": "Status of an outlier analysis run.",
        "enum": [
          "pending",
          "running",
          "completed",
          "failed"
        ]
      },
      "OutlierClassification": {
        "type": "string",
        "description": "Classification of a user based on outlier analysis.",
        "enum": [
          "normal",
          "outlier",
          "unclassifiable"
        ]
      },
      "OutlierConfigResponse": {
        "type": "object",
        "description": "Response containing outlier detection configuration.",
        "required": [
          "id",
          "tenant_id",
          "confidence_threshold",
          "frequency_threshold",
          "min_peer_group_size",
          "scoring_weights",
          "retention_days",
          "is_enabled",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "confidence_threshold": {
            "type": "number",
            "format": "double"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "frequency_threshold": {
            "type": "number",
            "format": "double"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_enabled": {
            "type": "boolean"
          },
          "min_peer_group_size": {
            "type": "integer",
            "format": "int32"
          },
          "retention_days": {
            "type": "integer",
            "format": "int32"
          },
          "schedule_cron": {
            "type": "string",
            "nullable": true
          },
          "scoring_weights": {
            "$ref": "#/components/schemas/ScoringWeights"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "OutlierDispositionStatus": {
        "type": "string",
        "description": "Status of an analyst's disposition for an outlier.",
        "enum": [
          "new",
          "legitimate",
          "requires_remediation",
          "under_investigation",
          "remediated"
        ]
      },
      "OutlierReportResponse": {
        "type": "object",
        "description": "Outlier report response.",
        "required": [
          "start_date",
          "end_date",
          "total_analyses",
          "total_users_analyzed",
          "total_outliers_detected",
          "average_outlier_rate",
          "generated_at"
        ],
        "properties": {
          "average_outlier_rate": {
            "type": "number",
            "format": "double"
          },
          "end_date": {
            "type": "string",
            "format": "date-time"
          },
          "generated_at": {
            "type": "string",
            "format": "date-time"
          },
          "peer_group_breakdown": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PeerGroupBreakdown"
            },
            "nullable": true
          },
          "start_date": {
            "type": "string",
            "format": "date-time"
          },
          "total_analyses": {
            "type": "integer",
            "format": "int64"
          },
          "total_outliers_detected": {
            "type": "integer",
            "format": "int64"
          },
          "total_users_analyzed": {
            "type": "integer",
            "format": "int64"
          },
          "trends": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/OutlierTrendPoint"
            },
            "nullable": true
          }
        }
      },
      "OutlierResultResponse": {
        "type": "object",
        "description": "Response containing outlier result details.",
        "required": [
          "id",
          "analysis_id",
          "user_id",
          "overall_score",
          "classification",
          "peer_scores",
          "factor_breakdown",
          "created_at"
        ],
        "properties": {
          "analysis_id": {
            "type": "string",
            "format": "uuid"
          },
          "classification": {
            "$ref": "#/components/schemas/OutlierClassification"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "factor_breakdown": {
            "$ref": "#/components/schemas/FactorBreakdown"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "overall_score": {
            "type": "number",
            "format": "double"
          },
          "peer_scores": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PeerGroupScore"
            }
          },
          "previous_score": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "score_change": {
            "type": "number",
            "format": "double",
            "nullable": true
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "OutlierSummaryResponse": {
        "type": "object",
        "description": "Summary statistics for outlier results.",
        "required": [
          "total_users",
          "outlier_count",
          "normal_count",
          "unclassifiable_count",
          "avg_score",
          "max_score"
        ],
        "properties": {
          "analysis_completed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "analysis_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "avg_score": {
            "type": "number",
            "format": "double"
          },
          "max_score": {
            "type": "number",
            "format": "double"
          },
          "normal_count": {
            "type": "integer",
            "format": "int64"
          },
          "outlier_count": {
            "type": "integer",
            "format": "int64"
          },
          "total_users": {
            "type": "integer",
            "format": "int64"
          },
          "unclassifiable_count": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "OutlierTrendPoint": {
        "type": "object",
        "description": "Outlier trend data point.",
        "required": [
          "date",
          "analysis_id",
          "outlier_count",
          "total_users",
          "avg_score"
        ],
        "properties": {
          "analysis_id": {
            "type": "string",
            "format": "uuid"
          },
          "avg_score": {
            "type": "number",
            "format": "double"
          },
          "date": {
            "type": "string",
            "format": "date-time"
          },
          "outlier_count": {
            "type": "integer",
            "format": "int64"
          },
          "total_users": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "OutlierTriggerType": {
        "type": "string",
        "description": "How the analysis was triggered.",
        "enum": [
          "scheduled",
          "manual",
          "api"
        ]
      },
      "OutputFormat": {
        "type": "string",
        "description": "Output format for reports.",
        "enum": [
          "json",
          "csv"
        ]
      },
      "OwaspAgenticCompliance": {
        "type": "object",
        "description": "OWASP Agentic compliance status.",
        "required": [
          "controls_satisfied",
          "total_controls",
          "compliant"
        ],
        "properties": {
          "compliant": {
            "type": "boolean",
            "description": "True if `controls_satisfied` >= 6."
          },
          "controls_satisfied": {
            "type": "integer",
            "format": "int32",
            "description": "Number of OWASP Agentic controls passing (0-8).",
            "minimum": 0
          },
          "total_controls": {
            "type": "integer",
            "format": "int32",
            "description": "Total number of OWASP Agentic controls (always 8).",
            "minimum": 0
          }
        }
      },
      "Pagination": {
        "type": "object",
        "description": "Pagination metadata (without total count).",
        "required": [
          "limit",
          "offset",
          "has_more"
        ],
        "properties": {
          "has_more": {
            "type": "boolean",
            "description": "Whether more records are available."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Page size."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Current offset."
          }
        }
      },
      "PaginationMeta": {
        "type": "object",
        "description": "Pagination metadata for list responses.",
        "required": [
          "total_count",
          "offset",
          "limit",
          "has_more"
        ],
        "properties": {
          "has_more": {
            "type": "boolean",
            "description": "Whether more records are available."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Page size."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Current offset."
          },
          "total_count": {
            "type": "integer",
            "format": "int64",
            "description": "Total number of matching records."
          }
        }
      },
      "PaginationWithTotal": {
        "type": "object",
        "description": "Pagination metadata with total count.",
        "required": [
          "total_count",
          "limit",
          "offset",
          "has_more"
        ],
        "properties": {
          "has_more": {
            "type": "boolean",
            "description": "Whether more records are available."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Page size."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Current offset."
          },
          "total_count": {
            "type": "integer",
            "format": "int64",
            "description": "Total number of matching records."
          }
        }
      },
      "ParameterAuditEventResponse": {
        "type": "object",
        "description": "Parameter audit event response.",
        "required": [
          "id",
          "tenant_id",
          "assignment_id",
          "event_type",
          "created_at"
        ],
        "properties": {
          "actor_id": {
            "type": "string",
            "format": "uuid",
            "description": "Actor who triggered the event.",
            "nullable": true
          },
          "assignment_id": {
            "type": "string",
            "format": "uuid",
            "description": "Assignment ID."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the event occurred."
          },
          "event_type": {
            "$ref": "#/components/schemas/ParameterEventType"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "metadata": {
            "description": "Additional metadata.",
            "nullable": true
          },
          "new_values": {
            "description": "New parameter values.",
            "nullable": true
          },
          "old_values": {
            "description": "Previous parameter values.",
            "nullable": true
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          }
        }
      },
      "ParameterAuditListResponse": {
        "type": "object",
        "description": "Paginated list of parameter audit events.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ParameterAuditEventResponse"
            },
            "description": "List of events."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count."
          }
        }
      },
      "ParameterConstraintsRequest": {
        "type": "object",
        "description": "Parameter constraints request structure.",
        "properties": {
          "allowed_values": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Allowed values for enum parameters.",
            "nullable": true
          },
          "max_date": {
            "type": "string",
            "description": "Maximum date for date parameters (YYYY-MM-DD format).",
            "nullable": true
          },
          "max_length": {
            "type": "integer",
            "description": "Maximum length for string parameters.",
            "nullable": true,
            "minimum": 0
          },
          "max_value": {
            "type": "integer",
            "format": "int64",
            "description": "Maximum value for integer parameters.",
            "nullable": true
          },
          "min_date": {
            "type": "string",
            "description": "Minimum date for date parameters (YYYY-MM-DD format).",
            "nullable": true
          },
          "min_length": {
            "type": "integer",
            "description": "Minimum length for string parameters.",
            "nullable": true,
            "minimum": 0
          },
          "min_value": {
            "type": "integer",
            "format": "int64",
            "description": "Minimum value for integer parameters.",
            "nullable": true
          },
          "pattern": {
            "type": "string",
            "description": "Regex pattern for string parameters.",
            "nullable": true
          }
        }
      },
      "ParameterEventType": {
        "type": "string",
        "description": "Parameter audit event type enum - matches `gov_parameter_event_type` in database.",
        "enum": [
          "parameters_set",
          "parameters_updated",
          "parameter_added",
          "parameter_removed",
          "validation_failed",
          "schema_violation_flagged"
        ]
      },
      "ParameterType": {
        "type": "string",
        "description": "Parameter type enum - matches `gov_parameter_type` in database.",
        "enum": [
          "string",
          "integer",
          "boolean",
          "date",
          "enum"
        ]
      },
      "ParameterValidationResult": {
        "type": "object",
        "description": "Validation result for a single parameter.",
        "required": [
          "parameter_id",
          "parameter_name",
          "is_valid",
          "errors"
        ],
        "properties": {
          "errors": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Validation errors for this parameter."
          },
          "is_valid": {
            "type": "boolean",
            "description": "Whether this parameter is valid."
          },
          "normalized_value": {
            "description": "Normalized/coerced value (if applicable).",
            "nullable": true
          },
          "parameter_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parameter ID."
          },
          "parameter_name": {
            "type": "string",
            "description": "Parameter name."
          }
        }
      },
      "ParameterValueRequest": {
        "type": "object",
        "description": "A parameter value in an assignment request.",
        "required": [
          "value"
        ],
        "properties": {
          "parameter_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parameter ID or name.",
            "nullable": true
          },
          "parameter_name": {
            "type": "string",
            "description": "Parameter name (alternative to ID).",
            "nullable": true
          },
          "value": {
            "description": "Parameter value."
          }
        }
      },
      "ParametricAssignmentListResponse": {
        "type": "object",
        "description": "Paginated list of parametric assignments.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ParametricAssignmentResponse"
            },
            "description": "List of assignments."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count."
          }
        }
      },
      "ParametricAssignmentResponse": {
        "type": "object",
        "description": "Parametric assignment response (assignment with parameters).",
        "required": [
          "id",
          "tenant_id",
          "role_id",
          "target_type",
          "target_id",
          "assigned_by",
          "assigned_at",
          "status",
          "is_temporally_active",
          "parameters"
        ],
        "properties": {
          "assigned_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the assignment was made."
          },
          "assigned_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who made the assignment."
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the assignment expires.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Assignment ID."
          },
          "is_temporally_active": {
            "type": "boolean",
            "description": "Whether the assignment is currently temporally active."
          },
          "justification": {
            "type": "string",
            "description": "Justification.",
            "nullable": true
          },
          "parameter_hash": {
            "type": "string",
            "description": "Parameter hash for uniqueness.",
            "nullable": true
          },
          "parameters": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AssignmentParameterResponse"
            },
            "description": "Parameter values."
          },
          "role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Role (entitlement) ID."
          },
          "role_name": {
            "type": "string",
            "description": "Role name.",
            "nullable": true
          },
          "status": {
            "type": "string",
            "description": "Assignment status."
          },
          "target_id": {
            "type": "string",
            "format": "uuid",
            "description": "Target ID."
          },
          "target_type": {
            "type": "string",
            "description": "Target type (user or group)."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "valid_from": {
            "type": "string",
            "format": "date-time",
            "description": "When the assignment becomes active.",
            "nullable": true
          },
          "valid_to": {
            "type": "string",
            "format": "date-time",
            "description": "When the assignment becomes inactive.",
            "nullable": true
          }
        }
      },
      "PasswordChangeRequest": {
        "type": "object",
        "description": "Change password request payload.\n\nUsed by authenticated users to change their password.",
        "required": [
          "current_password",
          "new_password"
        ],
        "properties": {
          "current_password": {
            "type": "string",
            "description": "Current password for verification."
          },
          "new_password": {
            "type": "string",
            "description": "New password."
          },
          "revoke_other_sessions": {
            "type": "boolean",
            "description": "Whether to revoke all other sessions after password change.\nDefaults to true for security."
          }
        }
      },
      "PasswordChangeResponse": {
        "type": "object",
        "description": "Password change response payload.",
        "required": [
          "message",
          "sessions_revoked"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Success message."
          },
          "sessions_revoked": {
            "type": "integer",
            "format": "int64",
            "description": "Number of other sessions revoked (if `revoke_other_sessions` was true)."
          }
        }
      },
      "PasswordlessInitResponse": {
        "type": "object",
        "description": "Response after requesting a magic link or email OTP.\n\nAlways returns a generic success message to prevent email enumeration.",
        "required": [
          "message",
          "expires_in_seconds"
        ],
        "properties": {
          "expires_in_seconds": {
            "type": "integer",
            "format": "int64",
            "description": "Token expiry in seconds."
          },
          "message": {
            "type": "string",
            "description": "Generic success message (same regardless of user existence)."
          }
        }
      },
      "PasswordlessMfaRequiredResponse": {
        "type": "object",
        "description": "Response when MFA is required after passwordless authentication.",
        "required": [
          "partial_token",
          "expires_in",
          "mfa_required"
        ],
        "properties": {
          "expires_in": {
            "type": "integer",
            "format": "int64",
            "description": "Partial token validity in seconds."
          },
          "mfa_required": {
            "type": "boolean",
            "description": "Whether MFA is required."
          },
          "partial_token": {
            "type": "string",
            "description": "Partial token for MFA verification."
          }
        }
      },
      "PasswordlessPolicyResponse": {
        "type": "object",
        "description": "Response for passwordless policy CRUD operations.",
        "required": [
          "enabled_methods",
          "magic_link_expiry_minutes",
          "otp_expiry_minutes",
          "otp_max_attempts",
          "require_mfa_after_passwordless"
        ],
        "properties": {
          "enabled_methods": {
            "type": "string",
            "description": "Which methods are enabled."
          },
          "magic_link_expiry_minutes": {
            "type": "integer",
            "format": "int32",
            "description": "Magic link expiry in minutes."
          },
          "otp_expiry_minutes": {
            "type": "integer",
            "format": "int32",
            "description": "OTP expiry in minutes."
          },
          "otp_max_attempts": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum OTP verification attempts."
          },
          "require_mfa_after_passwordless": {
            "type": "boolean",
            "description": "Whether MFA is required after passwordless authentication."
          }
        }
      },
      "PasswordlessRequest": {
        "type": "object",
        "description": "Request to initiate passwordless authentication (magic link or email OTP).",
        "required": [
          "email"
        ],
        "properties": {
          "email": {
            "type": "string",
            "description": "User email address."
          }
        }
      },
      "PatchCustomAttributesRequest": {
        "type": "object",
        "description": "Request to patch (merge) a user's custom attributes.",
        "properties": {
          "set": {
            "description": "Attributes to set or update (merged with existing).",
            "nullable": true
          },
          "unset": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Attribute names to remove.",
            "nullable": true
          }
        }
      },
      "PeerGroupBreakdown": {
        "type": "object",
        "description": "Peer group outlier breakdown.",
        "required": [
          "peer_group_id",
          "peer_group_name",
          "outlier_count",
          "member_count",
          "avg_deviation"
        ],
        "properties": {
          "avg_deviation": {
            "type": "number",
            "format": "double"
          },
          "member_count": {
            "type": "integer",
            "format": "int64"
          },
          "outlier_count": {
            "type": "integer",
            "format": "int64"
          },
          "peer_group_id": {
            "type": "string",
            "format": "uuid"
          },
          "peer_group_name": {
            "type": "string"
          }
        }
      },
      "PeerGroupListResponse": {
        "type": "object",
        "description": "Paginated list of peer groups.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PeerGroupResponse"
            },
            "description": "List of groups."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "PeerGroupResponse": {
        "type": "object",
        "description": "Peer group response.",
        "required": [
          "id",
          "name",
          "group_type",
          "attribute_key",
          "attribute_value",
          "user_count",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "attribute_key": {
            "type": "string",
            "description": "Attribute key."
          },
          "attribute_value": {
            "type": "string",
            "description": "Attribute value."
          },
          "avg_entitlements": {
            "type": "number",
            "format": "double",
            "description": "Average entitlement count.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "group_type": {
            "$ref": "#/components/schemas/PeerGroupType"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "stddev_entitlements": {
            "type": "number",
            "format": "double",
            "description": "Standard deviation.",
            "nullable": true
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          },
          "user_count": {
            "type": "integer",
            "format": "int32",
            "description": "Number of users in group."
          }
        }
      },
      "PendingApprovalItem": {
        "type": "object",
        "description": "A pending approval item.",
        "required": [
          "request_id",
          "requester_id",
          "entitlement_id",
          "entitlement_name",
          "justification",
          "current_step",
          "total_steps",
          "has_sod_warning",
          "is_delegate",
          "submitted_at"
        ],
        "properties": {
          "current_step": {
            "type": "integer",
            "format": "int32",
            "description": "Current step in the workflow."
          },
          "delegator_id": {
            "type": "string",
            "format": "uuid",
            "description": "Original approver (if delegated).",
            "nullable": true
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement ID."
          },
          "entitlement_name": {
            "type": "string",
            "description": "Entitlement name."
          },
          "has_sod_warning": {
            "type": "boolean",
            "description": "Whether `SoD` violations were detected."
          },
          "is_delegate": {
            "type": "boolean",
            "description": "Whether this is a delegated approval."
          },
          "justification": {
            "type": "string",
            "description": "Business justification."
          },
          "previous_decisions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DecisionSummary"
            },
            "description": "Previous decisions in this request."
          },
          "request_id": {
            "type": "string",
            "format": "uuid",
            "description": "Access request ID."
          },
          "requester_id": {
            "type": "string",
            "format": "uuid",
            "description": "Requester user ID."
          },
          "requester_name": {
            "type": "string",
            "description": "Requester display name (if available).",
            "nullable": true
          },
          "sod_warnings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SodWarningSummary"
            },
            "description": "`SoD` violation summaries.",
            "nullable": true
          },
          "submitted_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the request was submitted."
          },
          "total_steps": {
            "type": "integer",
            "format": "int32",
            "description": "Total steps in the workflow."
          }
        }
      },
      "PendingApprovalListResponse": {
        "type": "object",
        "description": "Paginated list of pending approvals.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PendingApprovalItem"
            },
            "description": "List of pending approval items."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count."
          }
        }
      },
      "PerformanceMetrics": {
        "type": "object",
        "description": "Performance metrics.",
        "required": [
          "accounts_per_second",
          "total_duration_seconds"
        ],
        "properties": {
          "accounts_per_second": {
            "type": "number",
            "format": "double"
          },
          "total_duration_seconds": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          }
        }
      },
      "PermissionListResponse": {
        "type": "object",
        "description": "List response for permissions with pagination.",
        "required": [
          "permissions",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "limit": {
            "type": "integer",
            "format": "int32",
            "description": "Current limit."
          },
          "offset": {
            "type": "integer",
            "format": "int32",
            "description": "Current offset."
          },
          "permissions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PermissionResponse"
            },
            "description": "List of permissions."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count (for pagination)."
          }
        }
      },
      "PermissionResponse": {
        "type": "object",
        "description": "Permission response DTO.",
        "required": [
          "id",
          "agent_id",
          "tool_id",
          "tool_name",
          "granted_at"
        ],
        "properties": {
          "agent_id": {
            "type": "string",
            "format": "uuid",
            "description": "Agent ID."
          },
          "allowed_parameters": {
            "description": "Parameter restrictions.",
            "nullable": true
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "Permission expiration.",
            "nullable": true
          },
          "granted_at": {
            "type": "string",
            "format": "date-time",
            "description": "When permission was granted."
          },
          "granted_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who granted the permission.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Permission unique identifier."
          },
          "max_calls_per_hour": {
            "type": "integer",
            "format": "int32",
            "description": "Override max calls per hour.",
            "nullable": true
          },
          "requires_approval": {
            "type": "boolean",
            "description": "Override approval requirement.",
            "nullable": true
          },
          "tool_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tool ID."
          },
          "tool_name": {
            "type": "string",
            "description": "Tool name (for convenience)."
          }
        }
      },
      "PermissionType": {
        "type": "string",
        "description": "Permission type for inherited entitlements.",
        "enum": [
          "grant",
          "deny"
        ]
      },
      "PersonaAttributesResponse": {
        "type": "object",
        "description": "Persona attributes response.",
        "properties": {
          "inherited": {
            "type": "object",
            "description": "Attributes inherited from physical user.",
            "additionalProperties": {}
          },
          "last_propagation_at": {
            "type": "string",
            "format": "date-time",
            "description": "When attributes were last propagated.",
            "nullable": true
          },
          "overrides": {
            "type": "object",
            "description": "Overridden attributes.",
            "additionalProperties": {}
          },
          "persona_specific": {
            "type": "object",
            "description": "Persona-specific attributes.",
            "additionalProperties": {}
          }
        }
      },
      "PersonaAuditEventResponse": {
        "type": "object",
        "description": "Audit event response.",
        "required": [
          "id",
          "event_type",
          "actor_id",
          "event_data",
          "created_at"
        ],
        "properties": {
          "actor_id": {
            "type": "string",
            "format": "uuid"
          },
          "actor_name": {
            "type": "string",
            "nullable": true
          },
          "archetype_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "archetype_name": {
            "type": "string",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "event_data": {},
          "event_type": {
            "$ref": "#/components/schemas/PersonaAuditEventType"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "persona_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "persona_name": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "PersonaAuditEventType": {
        "type": "string",
        "description": "Persona audit event types.",
        "enum": [
          "archetype_created",
          "archetype_updated",
          "archetype_deleted",
          "persona_created",
          "persona_activated",
          "persona_deactivated",
          "persona_expired",
          "persona_extended",
          "persona_archived",
          "context_switched",
          "context_switched_back",
          "attributes_propagated",
          "entitlement_added",
          "entitlement_removed"
        ]
      },
      "PersonaAuditListResponse": {
        "type": "object",
        "description": "List of audit events response.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PersonaAuditEventResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "PersonaDetailResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/PersonaResponse"
          },
          {
            "type": "object",
            "required": [
              "attributes"
            ],
            "properties": {
              "attributes": {
                "$ref": "#/components/schemas/PersonaAttributesResponse"
              },
              "entitlements": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/PersonaEntitlementSummary"
                },
                "description": "Assigned entitlements.",
                "nullable": true
              },
              "physical_user": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/PersonaUserSummary"
                  }
                ],
                "nullable": true
              }
            }
          }
        ],
        "description": "Detailed persona response with attributes."
      },
      "PersonaEntitlementSummary": {
        "type": "object",
        "description": "Summary of an entitlement for persona responses.",
        "required": [
          "id",
          "name",
          "application_name"
        ],
        "properties": {
          "application_name": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          }
        }
      },
      "PersonaLinkType": {
        "type": "string",
        "description": "Persona link type (relationship between physical user and persona).",
        "enum": [
          "owner",
          "delegate"
        ]
      },
      "PersonaListResponse": {
        "type": "object",
        "description": "List of personas response.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PersonaResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "PersonaResponse": {
        "type": "object",
        "description": "Basic persona response.",
        "required": [
          "id",
          "archetype_id",
          "physical_user_id",
          "persona_name",
          "display_name",
          "status",
          "valid_from",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "archetype_id": {
            "type": "string",
            "format": "uuid"
          },
          "archetype_name": {
            "type": "string",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "deactivated_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "display_name": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "persona_name": {
            "type": "string"
          },
          "physical_user_id": {
            "type": "string",
            "format": "uuid"
          },
          "physical_user_name": {
            "type": "string",
            "nullable": true
          },
          "status": {
            "$ref": "#/components/schemas/PersonaStatus"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "valid_from": {
            "type": "string",
            "format": "date-time"
          },
          "valid_until": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          }
        }
      },
      "PersonaStatus": {
        "type": "string",
        "description": "Persona lifecycle status.",
        "enum": [
          "draft",
          "active",
          "expiring",
          "expired",
          "suspended",
          "archived"
        ]
      },
      "PersonaUserSummary": {
        "type": "object",
        "description": "Summary of a user for persona responses.",
        "required": [
          "id",
          "email",
          "display_name"
        ],
        "properties": {
          "display_name": {
            "type": "string"
          },
          "email": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "status": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "PolicyConditionRequest": {
        "type": "object",
        "description": "Request model for a policy condition.",
        "required": [
          "attribute",
          "operator",
          "value"
        ],
        "properties": {
          "attribute": {
            "type": "string",
            "description": "Attribute name to match (e.g., \"department\", \"location\", \"role\")."
          },
          "operator": {
            "$ref": "#/components/schemas/ConditionOperator"
          },
          "value": {
            "description": "Value to compare against.\nFor \"in\" and \"`not_in`\" operators, this should be a JSON array."
          }
        }
      },
      "PolicyConditionResponse": {
        "type": "object",
        "description": "Response model for a policy condition.",
        "required": [
          "attribute",
          "operator",
          "value"
        ],
        "properties": {
          "attribute": {
            "type": "string",
            "description": "Attribute name."
          },
          "operator": {
            "$ref": "#/components/schemas/ConditionOperator"
          },
          "value": {
            "description": "Value to compare against."
          }
        }
      },
      "PolicySimulationType": {
        "type": "string",
        "description": "Type of policy simulation.",
        "enum": [
          "sod_rule",
          "birthright_policy"
        ]
      },
      "PreviewEmailTemplateRequest": {
        "type": "object",
        "description": "Request to preview an email template.",
        "properties": {
          "locale": {
            "type": "string",
            "nullable": true
          },
          "sample_data": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            },
            "nullable": true
          }
        }
      },
      "PreviewItem": {
        "type": "object",
        "description": "Single item in preview.",
        "required": [
          "discrepancy_id",
          "discrepancy_type",
          "suggested_action",
          "would_change"
        ],
        "properties": {
          "discrepancy_id": {
            "type": "string",
            "format": "uuid"
          },
          "discrepancy_type": {
            "type": "string"
          },
          "suggested_action": {
            "type": "string"
          },
          "would_change": {}
        }
      },
      "PreviewRequest": {
        "type": "object",
        "description": "Request for previewing changes.",
        "required": [
          "discrepancy_ids"
        ],
        "properties": {
          "discrepancy_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "PreviewResponse": {
        "type": "object",
        "description": "Response for preview.",
        "required": [
          "items",
          "summary"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PreviewItem"
            }
          },
          "summary": {
            "$ref": "#/components/schemas/PreviewSummary"
          }
        }
      },
      "PreviewSummary": {
        "type": "object",
        "description": "Summary of preview.",
        "required": [
          "total_actions",
          "by_action"
        ],
        "properties": {
          "by_action": {
            "type": "object",
            "additionalProperties": {
              "type": "integer",
              "minimum": 0
            }
          },
          "total_actions": {
            "type": "integer",
            "minimum": 0
          }
        }
      },
      "PrivilegeFlagStatus": {
        "type": "string",
        "description": "Status for an excessive privilege flag.",
        "enum": [
          "pending",
          "reviewed",
          "remediated",
          "accepted"
        ]
      },
      "PrivilegeReviewAction": {
        "type": "string",
        "description": "Review action for excessive privilege.",
        "enum": [
          "accept",
          "remediate"
        ]
      },
      "ProblemDetails": {
        "type": "object",
        "description": "RFC 7807 Problem Details response format.",
        "required": [
          "type",
          "title",
          "status"
        ],
        "properties": {
          "detail": {
            "type": "string",
            "nullable": true
          },
          "errors": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AttributeFieldError"
            },
            "description": "Field-level validation errors (present only for attribute validation failures).",
            "nullable": true
          },
          "status": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "title": {
            "type": "string"
          },
          "type": {
            "type": "string"
          }
        }
      },
      "ProcessEventResult": {
        "type": "object",
        "description": "Result of processing a lifecycle event.",
        "required": [
          "event",
          "actions",
          "summary"
        ],
        "properties": {
          "actions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LifecycleActionResponse"
            },
            "description": "Actions taken as result of processing."
          },
          "event": {
            "$ref": "#/components/schemas/LifecycleEventResponse"
          },
          "snapshot": {
            "allOf": [
              {
                "$ref": "#/components/schemas/AccessSnapshotSummary"
              }
            ],
            "nullable": true
          },
          "summary": {
            "$ref": "#/components/schemas/ProcessingSummary"
          }
        }
      },
      "PromoteCandidateRequest": {
        "type": "object",
        "description": "Request to promote a candidate to a role.",
        "required": [
          "role_name"
        ],
        "properties": {
          "description": {
            "type": "string",
            "nullable": true
          },
          "role_name": {
            "type": "string"
          }
        }
      },
      "PropagateMappingRequest": {
        "type": "object",
        "description": "Propagation mapping configuration.",
        "required": [
          "source",
          "target"
        ],
        "properties": {
          "allow_override": {
            "type": "boolean",
            "description": "Whether persona can override this attribute."
          },
          "mode": {
            "type": "string",
            "description": "Propagation mode: \"always\" or \"default\"."
          },
          "source": {
            "type": "string",
            "description": "Source attribute name on physical user."
          },
          "target": {
            "type": "string",
            "description": "Target attribute name on persona."
          }
        }
      },
      "ProvisionTenantRequest": {
        "type": "object",
        "description": "Request body for tenant provisioning.\n\nThis is used by authenticated system tenant users to create their own\nisolated tenant with all necessary resources.",
        "required": [
          "organization_name"
        ],
        "properties": {
          "organization_name": {
            "type": "string",
            "description": "Human-readable organization name (1-100 characters).\n\nThis will be used as the tenant's display name and to generate\na unique slug. Allowed characters: alphanumeric, spaces, hyphens.",
            "example": "Acme Corp"
          }
        }
      },
      "ProvisionTenantResponse": {
        "type": "object",
        "description": "Response from successful tenant provisioning.\n\nContains all the credentials and details needed to start using the new tenant.\n**Important**: The `api_key` is shown only once and cannot be retrieved later.",
        "required": [
          "tenant",
          "admin",
          "oauth_client",
          "endpoints",
          "next_steps"
        ],
        "properties": {
          "admin": {
            "$ref": "#/components/schemas/AdminInfo"
          },
          "endpoints": {
            "$ref": "#/components/schemas/EndpointInfo"
          },
          "next_steps": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Suggested next steps for getting started."
          },
          "oauth_client": {
            "$ref": "#/components/schemas/OAuthClientInfo"
          },
          "tenant": {
            "$ref": "#/components/schemas/TenantInfo"
          }
        }
      },
      "ProvisioningLogListResponse": {
        "type": "object",
        "description": "Response for provisioning log listing.",
        "required": [
          "target_id",
          "items",
          "total_count",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScimProvisioningLog"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "target_id": {
            "type": "string",
            "format": "uuid"
          },
          "total_count": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ProvisioningStateListResponse": {
        "type": "object",
        "description": "Response for provisioning state listing.",
        "required": [
          "target_id",
          "items",
          "total_count",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScimProvisioningState"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "target_id": {
            "type": "string",
            "format": "uuid"
          },
          "total_count": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "PublicBrandingResponse": {
        "type": "object",
        "description": "Response for public branding (login page).",
        "required": [
          "primary_color",
          "login_page_title"
        ],
        "properties": {
          "accent_color": {
            "type": "string",
            "nullable": true
          },
          "background_color": {
            "type": "string",
            "nullable": true
          },
          "favicon_url": {
            "type": "string",
            "nullable": true
          },
          "font_family": {
            "type": "string",
            "nullable": true
          },
          "footer_text": {
            "type": "string",
            "nullable": true
          },
          "login_page_background_url": {
            "type": "string",
            "nullable": true
          },
          "login_page_subtitle": {
            "type": "string",
            "nullable": true
          },
          "login_page_title": {
            "type": "string"
          },
          "logo_dark_url": {
            "type": "string",
            "nullable": true
          },
          "logo_url": {
            "type": "string",
            "nullable": true
          },
          "primary_color": {
            "type": "string"
          },
          "privacy_policy_url": {
            "type": "string",
            "nullable": true
          },
          "secondary_color": {
            "type": "string",
            "nullable": true
          },
          "support_url": {
            "type": "string",
            "nullable": true
          },
          "terms_of_service_url": {
            "type": "string",
            "nullable": true
          },
          "text_color": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "QueueStatsResponse": {
        "type": "object",
        "description": "Queue statistics response.",
        "required": [
          "pending",
          "in_progress",
          "completed",
          "failed",
          "dead_letter",
          "awaiting_system",
          "success_rate"
        ],
        "properties": {
          "avg_processing_time_secs": {
            "type": "number",
            "format": "double",
            "description": "Average processing time in seconds.",
            "nullable": true
          },
          "awaiting_system": {
            "type": "integer",
            "format": "int64",
            "description": "Number of operations awaiting system (offline connector).",
            "minimum": 0
          },
          "completed": {
            "type": "integer",
            "format": "int64",
            "description": "Number of completed operations.",
            "minimum": 0
          },
          "dead_letter": {
            "type": "integer",
            "format": "int64",
            "description": "Number of dead-lettered operations.",
            "minimum": 0
          },
          "failed": {
            "type": "integer",
            "format": "int64",
            "description": "Number of failed operations awaiting retry.",
            "minimum": 0
          },
          "in_progress": {
            "type": "integer",
            "format": "int64",
            "description": "Number of in-progress operations.",
            "minimum": 0
          },
          "pending": {
            "type": "integer",
            "format": "int64",
            "description": "Number of pending operations.",
            "minimum": 0
          },
          "success_rate": {
            "type": "number",
            "format": "double",
            "description": "Success rate as percentage (completed / (completed + `dead_letter`) * 100)."
          }
        }
      },
      "ReactivateNhiRequest": {
        "type": "object",
        "description": "Request to reactivate an NHI.",
        "required": [
          "reason"
        ],
        "properties": {
          "reason": {
            "type": "string",
            "description": "Reason/justification for reactivation."
          }
        }
      },
      "ReadinessResponse": {
        "type": "object",
        "description": "Readiness probe response (F074 enhanced).\n\nIndicates whether the service is ready to accept traffic by checking\nall critical and non-critical dependencies.",
        "required": [
          "status",
          "checks",
          "version",
          "uptime_seconds"
        ],
        "properties": {
          "checks": {
            "type": "object",
            "additionalProperties": {
              "$ref": "#/components/schemas/DependencyCheck"
            }
          },
          "status": {
            "type": "string"
          },
          "uptime_seconds": {
            "type": "integer",
            "format": "int64",
            "description": "Seconds since service start (F074 \u2014 FR-004).",
            "minimum": 0
          },
          "version": {
            "type": "string",
            "description": "Application version from Cargo.toml (F074 \u2014 FR-004)."
          }
        }
      },
      "ReassignCaseRequest": {
        "type": "object",
        "description": "Request to reassign a correlation case to a different reviewer.",
        "required": [
          "assigned_to"
        ],
        "properties": {
          "assigned_to": {
            "type": "string",
            "format": "uuid",
            "description": "The user to assign the case to."
          },
          "reason": {
            "type": "string",
            "description": "Optional reason for the reassignment.",
            "nullable": true
          }
        }
      },
      "ReassignManualTaskRequest": {
        "type": "object",
        "description": "Request to reassign a manual provisioning task.",
        "required": [
          "new_assignee_id"
        ],
        "properties": {
          "new_assignee_id": {
            "type": "string",
            "format": "uuid",
            "description": "New assignee user ID."
          },
          "reason": {
            "type": "string",
            "description": "Reason for reassignment.",
            "nullable": true
          }
        }
      },
      "ReassignOrphanRequest": {
        "type": "object",
        "description": "Request to reassign an orphan to a new owner.",
        "required": [
          "new_owner_id"
        ],
        "properties": {
          "new_owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "The new owner/manager ID."
          },
          "notes": {
            "type": "string",
            "description": "Justification for the reassignment.",
            "nullable": true
          }
        }
      },
      "ReassignRequest": {
        "type": "object",
        "description": "Request to reassign an item to a different reviewer.",
        "required": [
          "new_reviewer_id"
        ],
        "properties": {
          "new_reviewer_id": {
            "type": "string",
            "format": "uuid",
            "description": "New reviewer user ID."
          }
        }
      },
      "ReclamationRuleListResponse": {
        "type": "object",
        "description": "Paginated response for reclamation rules.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ReclamationRuleResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ReclamationRuleResponse": {
        "type": "object",
        "description": "Reclamation rule response.",
        "required": [
          "id",
          "license_pool_id",
          "trigger_type",
          "notification_days_before",
          "enabled",
          "created_at",
          "updated_at",
          "created_by"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "enabled": {
            "type": "boolean"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "license_pool_id": {
            "type": "string",
            "format": "uuid"
          },
          "lifecycle_state": {
            "type": "string",
            "nullable": true
          },
          "notification_days_before": {
            "type": "integer",
            "format": "int32"
          },
          "pool_name": {
            "type": "string",
            "nullable": true
          },
          "pool_vendor": {
            "type": "string",
            "nullable": true
          },
          "threshold_days": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "trigger_type": {
            "$ref": "#/components/schemas/LicenseReclamationTrigger"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "Recommendation": {
        "type": "object",
        "description": "Actionable recommendation based on check results.",
        "required": [
          "check_id",
          "priority",
          "title",
          "action"
        ],
        "properties": {
          "action": {
            "type": "string",
            "description": "Actionable remediation step."
          },
          "check_id": {
            "type": "integer",
            "format": "int32",
            "description": "Related vulnerability check ID (1-14).",
            "minimum": 0
          },
          "priority": {
            "$ref": "#/components/schemas/Priority"
          },
          "title": {
            "type": "string",
            "description": "Short description of the issue."
          }
        }
      },
      "RecommendationType": {
        "type": "string",
        "description": "Types of recommendations.",
        "enum": [
          "underutilized",
          "high_utilization",
          "expiring_soon",
          "reclaim_opportunity"
        ]
      },
      "ReconciliationRunListResponse": {
        "type": "object",
        "description": "Paginated list of reconciliation runs.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ReconciliationRunResponse"
            },
            "description": "List of runs."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "ReconciliationRunResponse": {
        "type": "object",
        "description": "Response for a reconciliation run.",
        "required": [
          "id",
          "connector_id",
          "mode",
          "status",
          "statistics",
          "created_at"
        ],
        "properties": {
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "connector_id": {
            "type": "string",
            "format": "uuid"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "error_message": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "mode": {
            "type": "string"
          },
          "started_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "statistics": {
            "$ref": "#/components/schemas/ReconciliationStatistics"
          },
          "status": {
            "type": "string"
          },
          "triggered_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          }
        }
      },
      "ReconciliationScheduleResponse": {
        "type": "object",
        "description": "Reconciliation schedule response.",
        "required": [
          "id",
          "frequency",
          "hour_of_day",
          "is_enabled",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "day_of_month": {
            "type": "integer",
            "format": "int32",
            "description": "Day of month for monthly schedules (1-28).",
            "nullable": true
          },
          "day_of_week": {
            "type": "integer",
            "format": "int32",
            "description": "Day of week for weekly schedules (0=Sunday, 6=Saturday).",
            "nullable": true
          },
          "frequency": {
            "type": "string",
            "description": "Frequency: daily, weekly, or monthly."
          },
          "hour_of_day": {
            "type": "integer",
            "format": "int32",
            "description": "Hour of day (0-23) when to run."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Schedule ID."
          },
          "is_enabled": {
            "type": "boolean",
            "description": "Whether the schedule is enabled."
          },
          "last_run_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the last run occurred.",
            "nullable": true
          },
          "next_run_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the next run is scheduled.",
            "nullable": true
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          }
        }
      },
      "ReconciliationStatistics": {
        "type": "object",
        "description": "Statistics for a reconciliation run.",
        "required": [
          "accounts_total",
          "accounts_processed",
          "discrepancies_found",
          "actions_taken",
          "duration_seconds"
        ],
        "properties": {
          "accounts_processed": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "accounts_total": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "actions_taken": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "discrepancies_by_type": {
            "type": "object",
            "additionalProperties": {
              "type": "integer",
              "format": "int32",
              "minimum": 0
            }
          },
          "discrepancies_found": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "duration_seconds": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          }
        }
      },
      "ReconciliationStatus": {
        "type": "string",
        "description": "Status of a reconciliation run.",
        "enum": [
          "running",
          "completed",
          "failed",
          "partial"
        ]
      },
      "RecordUsageRequest": {
        "type": "object",
        "description": "Request to record a usage event.",
        "required": [
          "target_resource",
          "action",
          "outcome"
        ],
        "properties": {
          "action": {
            "type": "string",
            "description": "The action performed (e.g., read, write, admin)."
          },
          "duration_ms": {
            "type": "integer",
            "format": "int32",
            "description": "Request duration in milliseconds.",
            "nullable": true
          },
          "metadata": {
            "description": "Additional metadata.",
            "nullable": true
          },
          "outcome": {
            "$ref": "#/components/schemas/NhiUsageOutcome"
          },
          "source_ip": {
            "type": "string",
            "description": "Source IP address.",
            "nullable": true
          },
          "target_resource": {
            "type": "string",
            "description": "The resource/service accessed."
          },
          "user_agent": {
            "type": "string",
            "description": "User agent string.",
            "nullable": true
          }
        }
      },
      "RedeliverResponse": {
        "type": "object",
        "description": "Re-delivery result.",
        "required": [
          "events_requeued"
        ],
        "properties": {
          "events_requeued": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          }
        }
      },
      "RefreshPeerGroupsResponse": {
        "type": "object",
        "description": "Response for refreshing peer groups.",
        "required": [
          "groups_refreshed",
          "groups_created",
          "users_processed",
          "duration_ms"
        ],
        "properties": {
          "duration_ms": {
            "type": "integer",
            "format": "int64",
            "description": "Time taken in milliseconds.",
            "minimum": 0
          },
          "groups_created": {
            "type": "integer",
            "format": "int64",
            "description": "Number of groups created."
          },
          "groups_refreshed": {
            "type": "integer",
            "format": "int64",
            "description": "Number of groups refreshed."
          },
          "users_processed": {
            "type": "integer",
            "format": "int64",
            "description": "Total users processed."
          }
        }
      },
      "RefreshRequest": {
        "type": "object",
        "description": "Token refresh request payload.",
        "required": [
          "refresh_token"
        ],
        "properties": {
          "refresh_token": {
            "type": "string",
            "description": "Refresh token from login response."
          }
        }
      },
      "RefreshStatsResponse": {
        "type": "object",
        "description": "Response for peer group statistics refresh.",
        "required": [
          "group",
          "member_count"
        ],
        "properties": {
          "group": {
            "$ref": "#/components/schemas/PeerGroupResponse"
          },
          "member_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of members found."
          }
        }
      },
      "RegenerateSecretResponse": {
        "type": "object",
        "description": "Response for regenerate secret endpoint.",
        "required": [
          "client_secret"
        ],
        "properties": {
          "client_secret": {
            "type": "string",
            "description": "The new client secret (only shown once)."
          }
        }
      },
      "RegisterRequest": {
        "type": "object",
        "description": "Registration request payload.",
        "required": [
          "email",
          "password"
        ],
        "properties": {
          "email": {
            "type": "string",
            "description": "User email address."
          },
          "password": {
            "type": "string",
            "description": "User password."
          }
        }
      },
      "RegisterResponse": {
        "type": "object",
        "description": "Registration response payload.",
        "required": [
          "id",
          "email",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Account creation timestamp."
          },
          "email": {
            "type": "string",
            "description": "User email."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID."
          }
        }
      },
      "RegistrationOptionsResponse": {
        "allOf": [
          {
            "type": "object",
            "description": "The registration options to pass to `navigator.credentials.create()`.\nThis is the `WebAuthn` `PublicKeyCredentialCreationOptions` structure."
          },
          {
            "type": "object"
          }
        ],
        "description": "Response containing `WebAuthn` registration options."
      },
      "RegistrationResponse": {
        "type": "object",
        "description": "Response after successful credential registration.",
        "required": [
          "credential",
          "message"
        ],
        "properties": {
          "credential": {
            "$ref": "#/components/schemas/CredentialInfo"
          },
          "message": {
            "type": "string",
            "description": "Success message."
          }
        }
      },
      "RejectCaseRequest": {
        "type": "object",
        "description": "Request to reject all candidates for a correlation case.",
        "properties": {
          "reason": {
            "type": "string",
            "description": "Optional reason for the rejection.",
            "nullable": true
          }
        }
      },
      "RejectManualTaskRequest": {
        "type": "object",
        "description": "Request to reject a manual task.",
        "required": [
          "reason"
        ],
        "properties": {
          "reason": {
            "type": "string",
            "description": "Reason for rejection."
          }
        }
      },
      "RejectNhiRequestRequest": {
        "type": "object",
        "description": "Request to reject an NHI request.",
        "required": [
          "reason"
        ],
        "properties": {
          "reason": {
            "type": "string",
            "description": "Reason for rejection."
          }
        }
      },
      "RejectRequestRequest": {
        "type": "object",
        "description": "Request to reject an access request.",
        "required": [
          "comments"
        ],
        "properties": {
          "comments": {
            "type": "string",
            "description": "Required comments explaining the rejection."
          }
        }
      },
      "RemediateRequest": {
        "type": "object",
        "description": "Request to remediate a discrepancy.",
        "required": [
          "action"
        ],
        "properties": {
          "action": {
            "type": "string",
            "description": "Action: create, update, delete, link, unlink, `inactivate_identity`."
          },
          "direction": {
            "type": "string",
            "description": "Direction for update: `xavyo_to_target` or `target_to_xavyo`."
          },
          "dry_run": {
            "type": "boolean",
            "description": "Whether this is a dry run."
          },
          "identity_id": {
            "type": "string",
            "format": "uuid",
            "description": "Identity ID for link action.",
            "nullable": true
          }
        }
      },
      "RemediationResponse": {
        "type": "object",
        "description": "Response for a remediation action.",
        "required": [
          "discrepancy_id",
          "action",
          "result",
          "dry_run"
        ],
        "properties": {
          "action": {
            "type": "string"
          },
          "after_state": {
            "nullable": true
          },
          "before_state": {
            "nullable": true
          },
          "discrepancy_id": {
            "type": "string",
            "format": "uuid"
          },
          "dry_run": {
            "type": "boolean"
          },
          "error_message": {
            "type": "string",
            "nullable": true
          },
          "result": {
            "type": "string"
          }
        }
      },
      "ReplaceMappingsRequest": {
        "type": "object",
        "description": "Request body for replacing attribute mappings.",
        "required": [
          "mappings"
        ],
        "properties": {
          "mappings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MappingEntry"
            }
          }
        }
      },
      "ReportResponse": {
        "type": "object",
        "description": "Response for a reconciliation report.",
        "required": [
          "run",
          "discrepancy_summary",
          "action_summary",
          "top_mismatched_attributes",
          "performance"
        ],
        "properties": {
          "action_summary": {
            "$ref": "#/components/schemas/ActionSummary"
          },
          "discrepancy_summary": {
            "$ref": "#/components/schemas/DiscrepancySummary"
          },
          "performance": {
            "$ref": "#/components/schemas/PerformanceMetrics"
          },
          "run": {
            "$ref": "#/components/schemas/RunInfo"
          },
          "top_mismatched_attributes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AttributeMismatchCount"
            }
          }
        }
      },
      "ReportScheduleListResponse": {
        "type": "object",
        "description": "List response for schedules.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ReportScheduleResponse"
            }
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "page_size": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ReportScheduleResponse": {
        "type": "object",
        "description": "Response for a report schedule.",
        "required": [
          "id",
          "tenant_id",
          "template_id",
          "name",
          "frequency",
          "schedule_hour",
          "parameters",
          "recipients",
          "output_format",
          "status",
          "next_run_at",
          "consecutive_failures",
          "created_by",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "consecutive_failures": {
            "type": "integer",
            "format": "int32"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "frequency": {
            "$ref": "#/components/schemas/ScheduleFrequency"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "last_error": {
            "type": "string",
            "nullable": true
          },
          "last_run_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "name": {
            "type": "string"
          },
          "next_run_at": {
            "type": "string",
            "format": "date-time"
          },
          "output_format": {
            "$ref": "#/components/schemas/OutputFormat"
          },
          "parameters": {},
          "recipients": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "schedule_day_of_month": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "schedule_day_of_week": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "schedule_hour": {
            "type": "integer",
            "format": "int32"
          },
          "status": {
            "$ref": "#/components/schemas/ScheduleStatus"
          },
          "template_id": {
            "type": "string",
            "format": "uuid"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "ReportStatus": {
        "type": "string",
        "description": "Status of report generation.",
        "enum": [
          "pending",
          "generating",
          "completed",
          "failed"
        ]
      },
      "ReportTemplateListResponse": {
        "type": "object",
        "description": "List response for report templates.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ReportTemplateResponse"
            }
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "page_size": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ReportTemplateResponse": {
        "type": "object",
        "description": "Response for a report template.",
        "required": [
          "id",
          "name",
          "template_type",
          "definition",
          "is_system",
          "status",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "cloned_from": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "compliance_standard": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ComplianceStandard"
              }
            ],
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "created_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "definition": {
            "$ref": "#/components/schemas/TemplateDefinition"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_system": {
            "type": "boolean"
          },
          "name": {
            "type": "string"
          },
          "status": {
            "$ref": "#/components/schemas/TemplateStatus"
          },
          "template_type": {
            "$ref": "#/components/schemas/ReportTemplateType"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "ReportTemplateType": {
        "type": "string",
        "description": "Type of report template.",
        "enum": [
          "access_review",
          "sod_violations",
          "certification_status",
          "user_access",
          "audit_trail"
        ]
      },
      "ResendVerificationRequest": {
        "type": "object",
        "description": "Resend verification request payload.",
        "required": [
          "email"
        ],
        "properties": {
          "email": {
            "type": "string",
            "description": "User email address."
          }
        }
      },
      "ResendVerificationResponse": {
        "type": "object",
        "description": "Resend verification response payload.\n\nAlways returns success to prevent email enumeration.",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Generic success message."
          }
        }
      },
      "ResetEscalationResponse": {
        "type": "object",
        "description": "Response for reset escalation operation.",
        "required": [
          "success",
          "previous_level",
          "original_approver_id",
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Message describing the result."
          },
          "new_deadline": {
            "type": "string",
            "format": "date-time",
            "description": "New deadline for the approval (if applicable).",
            "nullable": true
          },
          "original_approver_id": {
            "type": "string",
            "format": "uuid",
            "description": "The original approver who now has the work item."
          },
          "previous_level": {
            "type": "integer",
            "format": "int32",
            "description": "The escalation level that was active before reset."
          },
          "success": {
            "type": "boolean",
            "description": "Whether the reset was successful."
          }
        }
      },
      "ResetPasswordRequest": {
        "type": "object",
        "description": "Reset password request payload.",
        "required": [
          "token",
          "new_password"
        ],
        "properties": {
          "new_password": {
            "type": "string",
            "description": "New password."
          },
          "token": {
            "type": "string",
            "description": "Password reset token from email."
          }
        }
      },
      "ResetPasswordResponse": {
        "type": "object",
        "description": "Reset password response payload.",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Success message."
          }
        }
      },
      "ResolutionStatus": {
        "type": "string",
        "description": "Status of conflict resolution.",
        "enum": [
          "unresolved",
          "resolved_priority",
          "resolved_manual",
          "ignored"
        ]
      },
      "ResolveConflictRequest": {
        "type": "object",
        "description": "Request to resolve a conflict.",
        "required": [
          "outcome"
        ],
        "properties": {
          "notes": {
            "type": "string",
            "description": "Optional notes about the resolution.",
            "nullable": true
          },
          "outcome": {
            "type": "string",
            "description": "Resolution outcome (applied, superseded, merged, rejected)."
          }
        }
      },
      "ResolveOperationRequest": {
        "type": "object",
        "description": "Request to resolve a dead letter operation.",
        "properties": {
          "resolution_notes": {
            "type": "string",
            "description": "Notes about how the issue was resolved.",
            "nullable": true
          }
        }
      },
      "ResourceAccessInfo": {
        "type": "object",
        "description": "Resource access information for summary.",
        "required": [
          "resource",
          "access_count",
          "last_access"
        ],
        "properties": {
          "access_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of times accessed."
          },
          "last_access": {
            "type": "string",
            "format": "date-time",
            "description": "When last accessed."
          },
          "resource": {
            "type": "string",
            "description": "The resource name."
          }
        }
      },
      "ResourceAccessSummary": {
        "type": "object",
        "description": "Resource access summary.",
        "required": [
          "target_resource",
          "access_count",
          "last_access"
        ],
        "properties": {
          "access_count": {
            "type": "integer",
            "format": "int64"
          },
          "last_access": {
            "type": "string",
            "format": "date-time"
          },
          "target_resource": {
            "type": "string"
          }
        }
      },
      "RetryQueueItemResponse": {
        "type": "object",
        "description": "Retry queue item response.",
        "required": [
          "task_id",
          "operation",
          "retry_count",
          "next_retry_at"
        ],
        "properties": {
          "application_name": {
            "type": "string",
            "nullable": true
          },
          "last_error": {
            "type": "string",
            "nullable": true
          },
          "next_retry_at": {
            "type": "string",
            "format": "date-time"
          },
          "operation": {
            "$ref": "#/components/schemas/ManualTaskOperation"
          },
          "retry_count": {
            "type": "integer",
            "format": "int32"
          },
          "task_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "RetryQueueResponse": {
        "type": "object",
        "description": "Retry queue response.",
        "required": [
          "items",
          "total"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RetryQueueItemResponse"
            }
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "RetryResponse": {
        "type": "object",
        "description": "Response for a retry operation.",
        "required": [
          "state_id",
          "status",
          "message"
        ],
        "properties": {
          "message": {
            "type": "string"
          },
          "state_id": {
            "type": "string",
            "format": "uuid"
          },
          "status": {
            "type": "string"
          }
        }
      },
      "ReviewPrivilegeRequest": {
        "type": "object",
        "description": "Request to review an excessive privilege flag.",
        "required": [
          "action"
        ],
        "properties": {
          "action": {
            "$ref": "#/components/schemas/PrivilegeReviewAction"
          },
          "notes": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "ReviewerCampaignSummary": {
        "type": "object",
        "description": "Summary of pending items for a campaign.",
        "required": [
          "campaign_id",
          "campaign_name",
          "pending_count",
          "deadline",
          "is_overdue"
        ],
        "properties": {
          "campaign_id": {
            "type": "string",
            "format": "uuid",
            "description": "Campaign ID."
          },
          "campaign_name": {
            "type": "string",
            "description": "Campaign name."
          },
          "deadline": {
            "type": "string",
            "format": "date-time",
            "description": "Campaign deadline."
          },
          "is_overdue": {
            "type": "boolean",
            "description": "Whether the campaign is overdue."
          },
          "pending_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of pending items."
          }
        }
      },
      "ReviewerSummaryResponse": {
        "type": "object",
        "description": "Reviewer's certification summary.",
        "required": [
          "total_pending",
          "campaigns"
        ],
        "properties": {
          "campaigns": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ReviewerCampaignSummary"
            },
            "description": "Summary by campaign."
          },
          "total_pending": {
            "type": "integer",
            "format": "int64",
            "description": "Total pending items across all campaigns."
          }
        }
      },
      "RevocationErrorResponse": {
        "type": "object",
        "required": [
          "error",
          "message"
        ],
        "properties": {
          "error": {
            "type": "string",
            "description": "Machine-readable error code."
          },
          "message": {
            "type": "string",
            "description": "Human-readable error message."
          }
        }
      },
      "RevocationResponse": {
        "type": "object",
        "required": [
          "jti",
          "revoked_at",
          "message"
        ],
        "properties": {
          "jti": {
            "type": "string",
            "description": "The JTI of the revoked token."
          },
          "message": {
            "type": "string",
            "description": "Human-readable status message."
          },
          "revoked_at": {
            "type": "string",
            "description": "ISO 8601 timestamp of when the token was revoked."
          }
        }
      },
      "RevokeCredentialRequest": {
        "type": "object",
        "description": "Request to revoke a credential.",
        "required": [
          "reason"
        ],
        "properties": {
          "immediate": {
            "type": "boolean",
            "description": "Whether to revoke immediately (skip grace period)."
          },
          "reason": {
            "type": "string",
            "description": "Reason for revocation."
          }
        }
      },
      "RevokeTokenRequest": {
        "type": "object",
        "required": [
          "jti"
        ],
        "properties": {
          "jti": {
            "type": "string",
            "description": "The JWT ID (jti) of the token to revoke."
          },
          "reason": {
            "type": "string",
            "description": "Optional reason for revocation.",
            "nullable": true
          }
        }
      },
      "RevokeUserTokensRequest": {
        "type": "object",
        "required": [
          "user_id"
        ],
        "properties": {
          "reason": {
            "type": "string",
            "description": "Optional reason for revocation.",
            "nullable": true
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "The user ID whose tokens should be revoked."
          }
        }
      },
      "RiskAlertListResponse": {
        "type": "object",
        "description": "Paginated list of risk alerts.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RiskAlertResponse"
            },
            "description": "List of alerts."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "RiskAlertResponse": {
        "type": "object",
        "description": "Risk alert response.",
        "required": [
          "id",
          "user_id",
          "threshold_id",
          "score_at_alert",
          "severity",
          "acknowledged",
          "created_at"
        ],
        "properties": {
          "acknowledged": {
            "type": "boolean",
            "description": "Whether acknowledged."
          },
          "acknowledged_at": {
            "type": "string",
            "format": "date-time",
            "description": "Acknowledgement timestamp.",
            "nullable": true
          },
          "acknowledged_by": {
            "type": "string",
            "format": "uuid",
            "description": "User who acknowledged.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Alert creation timestamp."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "score_at_alert": {
            "type": "integer",
            "format": "int32",
            "description": "Score at time of alert."
          },
          "severity": {
            "$ref": "#/components/schemas/AlertSeverity"
          },
          "threshold_id": {
            "type": "string",
            "format": "uuid",
            "description": "Threshold that was exceeded."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User who triggered the alert."
          }
        }
      },
      "RiskEnforcementResponse": {
        "type": "object",
        "description": "Risk enforcement check response.",
        "required": [
          "user_id",
          "score",
          "risk_level",
          "action"
        ],
        "properties": {
          "action": {
            "$ref": "#/components/schemas/EnforcementAction"
          },
          "risk_level": {
            "$ref": "#/components/schemas/RiskLevel"
          },
          "score": {
            "type": "integer",
            "format": "int32",
            "description": "Current score."
          },
          "threshold_id": {
            "type": "string",
            "format": "uuid",
            "description": "Threshold that triggered the action (if any).",
            "nullable": true
          },
          "threshold_name": {
            "type": "string",
            "description": "Threshold name.",
            "nullable": true
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID."
          }
        }
      },
      "RiskFactorCategory": {
        "type": "string",
        "description": "Category for risk factors.",
        "enum": [
          "static",
          "dynamic"
        ]
      },
      "RiskFactorListResponse": {
        "type": "object",
        "description": "Paginated list of risk factors.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RiskFactorResponse"
            },
            "description": "List of factors."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "RiskFactorResponse": {
        "type": "object",
        "description": "Risk factor response.",
        "required": [
          "id",
          "name",
          "category",
          "factor_type",
          "weight",
          "is_enabled",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "category": {
            "$ref": "#/components/schemas/RiskFactorCategory"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "description": {
            "type": "string",
            "description": "Description.",
            "nullable": true
          },
          "factor_type": {
            "type": "string",
            "description": "Specific factor type."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_enabled": {
            "type": "boolean",
            "description": "Whether enabled."
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          },
          "weight": {
            "type": "number",
            "format": "double",
            "description": "Weight in calculation."
          }
        }
      },
      "RiskLevel": {
        "type": "string",
        "description": "Risk level classification.",
        "enum": [
          "low",
          "medium",
          "high",
          "critical"
        ]
      },
      "RiskLevelSummary": {
        "type": "object",
        "description": "Summary of NHI risk scores by level.",
        "required": [
          "total",
          "low",
          "medium",
          "high",
          "critical"
        ],
        "properties": {
          "critical": {
            "type": "integer",
            "format": "int64",
            "description": "NHIs with critical risk (76-100)."
          },
          "high": {
            "type": "integer",
            "format": "int64",
            "description": "NHIs with high risk (51-75)."
          },
          "low": {
            "type": "integer",
            "format": "int64",
            "description": "NHIs with low risk (0-25)."
          },
          "medium": {
            "type": "integer",
            "format": "int64",
            "description": "NHIs with medium risk (26-50)."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total NHIs with risk scores."
          }
        }
      },
      "RiskScoreHistoryResponse": {
        "type": "object",
        "description": "Risk score history response with trend.",
        "required": [
          "user_id",
          "current_score",
          "trend",
          "history"
        ],
        "properties": {
          "current_score": {
            "type": "integer",
            "format": "int32",
            "description": "Current score."
          },
          "history": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RiskScoreHistoryEntry"
            },
            "description": "Historical entries."
          },
          "trend": {
            "$ref": "#/components/schemas/RiskTrendResponse"
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID."
          }
        }
      },
      "RiskScoreListResponse": {
        "type": "object",
        "description": "Paginated list of risk scores.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RiskScoreResponse"
            },
            "description": "List of scores."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "RiskScoreResponse": {
        "type": "object",
        "description": "Risk score response.",
        "required": [
          "id",
          "user_id",
          "total_score",
          "risk_level",
          "static_score",
          "dynamic_score",
          "factor_breakdown",
          "calculated_at",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "calculated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the score was calculated."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "dynamic_score": {
            "type": "integer",
            "format": "int32",
            "description": "Score from dynamic factors."
          },
          "factor_breakdown": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/FactorBreakdown"
            },
            "description": "Per-factor breakdown."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Score record ID."
          },
          "peer_comparison": {
            "allOf": [
              {
                "$ref": "#/components/schemas/PeerComparisonData"
              }
            ],
            "nullable": true
          },
          "risk_level": {
            "$ref": "#/components/schemas/RiskLevel"
          },
          "static_score": {
            "type": "integer",
            "format": "int32",
            "description": "Score from static factors."
          },
          "total_score": {
            "type": "integer",
            "format": "int32",
            "description": "Total risk score (0-100)."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID."
          }
        }
      },
      "RiskScoreSortOption": {
        "type": "string",
        "description": "Sort options for risk scores.",
        "enum": [
          "score_desc",
          "score_asc",
          "calculated_at_desc",
          "calculated_at_asc"
        ]
      },
      "RiskScoreSummary": {
        "type": "object",
        "description": "Risk score summary by level.",
        "required": [
          "by_level",
          "total_users",
          "average_score"
        ],
        "properties": {
          "average_score": {
            "type": "number",
            "format": "double",
            "description": "Average score."
          },
          "by_level": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LevelCount"
            },
            "description": "Count of users per risk level."
          },
          "total_users": {
            "type": "integer",
            "format": "int64",
            "description": "Total users with scores."
          }
        }
      },
      "RiskSummaryResponse": {
        "type": "object",
        "description": "Response for risk summary endpoint.",
        "required": [
          "total_count",
          "by_type",
          "by_risk_level",
          "pending_certification",
          "inactive_30_days",
          "expiring_7_days"
        ],
        "properties": {
          "by_risk_level": {
            "$ref": "#/components/schemas/CountByRiskLevel"
          },
          "by_type": {
            "$ref": "#/components/schemas/CountByType"
          },
          "expiring_7_days": {
            "type": "integer",
            "format": "int32",
            "description": "Number of NHIs expiring within 7 days."
          },
          "inactive_30_days": {
            "type": "integer",
            "format": "int32",
            "description": "Number of NHIs inactive for 30+ days."
          },
          "pending_certification": {
            "type": "integer",
            "format": "int32",
            "description": "Number of NHIs with certification due within 30 days."
          },
          "total_count": {
            "type": "integer",
            "format": "int32",
            "description": "Total count of all NHIs."
          }
        }
      },
      "RiskTrendResponse": {
        "type": "object",
        "description": "Risk trend response.",
        "required": [
          "direction"
        ],
        "properties": {
          "change_30d": {
            "type": "integer",
            "format": "int32",
            "description": "Change over 30 days.",
            "nullable": true
          },
          "change_60d": {
            "type": "integer",
            "format": "int32",
            "description": "Change over 60 days.",
            "nullable": true
          },
          "change_90d": {
            "type": "integer",
            "format": "int32",
            "description": "Change over 90 days.",
            "nullable": true
          },
          "direction": {
            "$ref": "#/components/schemas/TrendDirection"
          },
          "score_30d_ago": {
            "type": "integer",
            "format": "int32",
            "description": "Score 30 days ago.",
            "nullable": true
          },
          "score_60d_ago": {
            "type": "integer",
            "format": "int32",
            "description": "Score 60 days ago.",
            "nullable": true
          },
          "score_90d_ago": {
            "type": "integer",
            "format": "int32",
            "description": "Score 90 days ago.",
            "nullable": true
          }
        }
      },
      "RoleCandidateListResponse": {
        "type": "object",
        "description": "List response for role candidates.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RoleCandidateResponse"
            }
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "page_size": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "RoleCandidateResponse": {
        "type": "object",
        "description": "Response for a role candidate.",
        "required": [
          "id",
          "job_id",
          "proposed_name",
          "confidence_score",
          "member_count",
          "entitlement_ids",
          "user_ids",
          "promotion_status",
          "created_at"
        ],
        "properties": {
          "confidence_score": {
            "type": "number",
            "format": "double"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "dismissed_reason": {
            "type": "string",
            "nullable": true
          },
          "entitlement_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "job_id": {
            "type": "string",
            "format": "uuid"
          },
          "member_count": {
            "type": "integer",
            "format": "int32"
          },
          "promoted_role_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "promotion_status": {
            "$ref": "#/components/schemas/CandidatePromotionStatus"
          },
          "proposed_name": {
            "type": "string"
          },
          "user_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "RoleEntitlementListResponse": {
        "type": "object",
        "description": "Paginated list of role entitlements.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RoleEntitlementResponse"
            },
            "description": "List of role-entitlement mappings."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Maximum number of results returned."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Number of results skipped."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count of matching mappings."
          }
        }
      },
      "RoleEntitlementResponse": {
        "type": "object",
        "description": "Role entitlement response model.",
        "required": [
          "id",
          "tenant_id",
          "entitlement_id",
          "role_name",
          "created_at",
          "created_by"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the mapping was created."
          },
          "created_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who created this mapping."
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "The entitlement being mapped."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the mapping."
          },
          "role_name": {
            "type": "string",
            "description": "The role name being mapped."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          }
        }
      },
      "RoleMatchResponse": {
        "type": "object",
        "description": "Response showing which meta-roles match a role.",
        "required": [
          "role_id",
          "matching_meta_roles",
          "total_matches",
          "has_conflicts"
        ],
        "properties": {
          "has_conflicts": {
            "type": "boolean",
            "description": "Whether this role has unresolved conflicts."
          },
          "matching_meta_roles": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MatchingMetaRole"
            },
            "description": "Matching meta-roles."
          },
          "role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Role ID evaluated."
          },
          "total_matches": {
            "type": "integer",
            "format": "int64",
            "description": "Total matches."
          }
        }
      },
      "RoleMetricsListResponse": {
        "type": "object",
        "description": "List response for role metrics.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RoleMetricsResponse"
            }
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "page_size": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "RoleMetricsResponse": {
        "type": "object",
        "description": "Response for role metrics.",
        "required": [
          "id",
          "tenant_id",
          "role_id",
          "utilization_rate",
          "coverage_rate",
          "user_count",
          "active_user_count",
          "entitlement_usage",
          "trend_direction",
          "calculated_at"
        ],
        "properties": {
          "active_user_count": {
            "type": "integer",
            "format": "int32"
          },
          "calculated_at": {
            "type": "string",
            "format": "date-time"
          },
          "coverage_rate": {
            "type": "number",
            "format": "double"
          },
          "entitlement_usage": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EntitlementUsage"
            }
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "role_id": {
            "type": "string",
            "format": "uuid"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid"
          },
          "trend_direction": {
            "$ref": "#/components/schemas/MetricsTrendDirection"
          },
          "user_count": {
            "type": "integer",
            "format": "int32"
          },
          "utilization_rate": {
            "type": "number",
            "format": "double"
          }
        }
      },
      "RoleParameterListResponse": {
        "type": "object",
        "description": "Paginated list of role parameters.",
        "required": [
          "items",
          "total"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RoleParameterResponse"
            },
            "description": "List of parameters."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count."
          }
        }
      },
      "RoleParameterResponse": {
        "type": "object",
        "description": "Role parameter response.",
        "required": [
          "id",
          "tenant_id",
          "role_id",
          "name",
          "parameter_type",
          "is_required",
          "display_order",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "constraints": {
            "description": "Validation constraints.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the parameter was created."
          },
          "default_value": {
            "description": "Default value.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Description.",
            "nullable": true
          },
          "display_name": {
            "type": "string",
            "description": "Human-readable display name.",
            "nullable": true
          },
          "display_order": {
            "type": "integer",
            "format": "int32",
            "description": "Display order."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_required": {
            "type": "boolean",
            "description": "Whether value is required."
          },
          "name": {
            "type": "string",
            "description": "Parameter name."
          },
          "parameter_type": {
            "$ref": "#/components/schemas/ParameterType"
          },
          "role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Role ID."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the parameter was last updated."
          }
        }
      },
      "RoleTemplateDetailResponse": {
        "type": "object",
        "description": "Role template detail response (with permissions).",
        "required": [
          "id",
          "name",
          "is_system",
          "created_at",
          "updated_at",
          "permissions"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_system": {
            "type": "boolean"
          },
          "name": {
            "type": "string"
          },
          "permissions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PermissionResponse"
            }
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "RoleTemplateListResponse": {
        "type": "object",
        "description": "List role templates response.",
        "required": [
          "templates",
          "total"
        ],
        "properties": {
          "templates": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RoleTemplateResponse"
            }
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "RoleTemplateResponse": {
        "type": "object",
        "description": "Role template response (summary).",
        "required": [
          "id",
          "name",
          "is_system",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_system": {
            "type": "boolean"
          },
          "name": {
            "type": "string"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "RollbackRequest": {
        "type": "object",
        "description": "Request to rollback a script to a previous version.",
        "required": [
          "target_version"
        ],
        "properties": {
          "reason": {
            "type": "string",
            "description": "Optional reason for the rollback.",
            "nullable": true
          },
          "target_version": {
            "type": "integer",
            "format": "int32",
            "description": "The version number to rollback to."
          }
        }
      },
      "RotateCredentialsRequest": {
        "type": "object",
        "description": "Request to rotate credentials.",
        "required": [
          "credential_type"
        ],
        "properties": {
          "credential_type": {
            "$ref": "#/components/schemas/NhiCredentialType"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the new credential expires (optional).",
            "nullable": true
          },
          "grace_period_hours": {
            "type": "integer",
            "format": "int32",
            "description": "Grace period in hours (default: 24, max: 168).",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Optional name for the new credential.",
            "nullable": true
          }
        }
      },
      "RuleApplicationResult": {
        "type": "object",
        "description": "Result of applying a single rule.",
        "required": [
          "rule_id",
          "target_attribute",
          "rule_type",
          "after_value",
          "applied"
        ],
        "properties": {
          "after_value": {
            "description": "Value after rule application."
          },
          "applied": {
            "type": "boolean",
            "description": "Whether the rule was applied."
          },
          "before_value": {
            "description": "Value before rule application.",
            "nullable": true
          },
          "rule_id": {
            "type": "string",
            "format": "uuid",
            "description": "Rule ID."
          },
          "rule_type": {
            "$ref": "#/components/schemas/TemplateRuleType"
          },
          "skip_reason": {
            "type": "string",
            "description": "Reason if not applied.",
            "nullable": true
          },
          "target_attribute": {
            "type": "string",
            "description": "Target attribute."
          }
        }
      },
      "RuleListResponse": {
        "type": "object",
        "description": "Paginated list of rules.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RuleResponse"
            },
            "description": "List of rules."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Current page size."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Current offset."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count."
          }
        }
      },
      "RuleMatchResponse": {
        "type": "object",
        "description": "Rule match details.",
        "required": [
          "rule_id",
          "rule_name",
          "attribute",
          "similarity",
          "weighted_score"
        ],
        "properties": {
          "attribute": {
            "type": "string"
          },
          "rule_id": {
            "type": "string",
            "format": "uuid"
          },
          "rule_name": {
            "type": "string"
          },
          "similarity": {
            "type": "number",
            "format": "double"
          },
          "weighted_score": {
            "type": "number",
            "format": "double"
          }
        }
      },
      "RuleResponse": {
        "type": "object",
        "description": "Template rule response.",
        "required": [
          "id",
          "template_id",
          "rule_type",
          "target_attribute",
          "expression",
          "strength",
          "authoritative",
          "priority",
          "exclusive",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "authoritative": {
            "type": "boolean",
            "description": "Authoritative flag."
          },
          "condition": {
            "type": "string",
            "description": "Condition expression.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "error_message": {
            "type": "string",
            "description": "Custom error message.",
            "nullable": true
          },
          "exclusive": {
            "type": "boolean",
            "description": "Exclusive mapping flag."
          },
          "expression": {
            "type": "string",
            "description": "Expression or value."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority within template."
          },
          "rule_type": {
            "$ref": "#/components/schemas/TemplateRuleType"
          },
          "strength": {
            "$ref": "#/components/schemas/TemplateStrength"
          },
          "target_attribute": {
            "type": "string",
            "description": "Target attribute."
          },
          "template_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parent template ID."
          },
          "time_from": {
            "type": "string",
            "format": "date-time",
            "description": "Rule only applies after this timestamp.",
            "nullable": true
          },
          "time_reference": {
            "allOf": [
              {
                "$ref": "#/components/schemas/TemplateTimeReference"
              }
            ],
            "nullable": true
          },
          "time_to": {
            "type": "string",
            "format": "date-time",
            "description": "Rule only applies before this timestamp.",
            "nullable": true
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          }
        }
      },
      "RunInfo": {
        "type": "object",
        "description": "Run info for report.",
        "required": [
          "id",
          "connector_id",
          "mode",
          "status",
          "statistics"
        ],
        "properties": {
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "connector_id": {
            "type": "string",
            "format": "uuid"
          },
          "connector_name": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "mode": {
            "type": "string"
          },
          "started_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "statistics": {
            "$ref": "#/components/schemas/ReconciliationStatistics"
          },
          "status": {
            "type": "string"
          },
          "triggered_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "triggered_by_name": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "ScenarioType": {
        "type": "string",
        "description": "Type of simulation scenario.",
        "enum": [
          "add_entitlement",
          "remove_entitlement",
          "add_role",
          "remove_role",
          "modify_role"
        ]
      },
      "ScheduleFrequency": {
        "type": "string",
        "description": "Schedule frequency for report generation.",
        "enum": [
          "daily",
          "weekly",
          "monthly"
        ]
      },
      "ScheduleRequest": {
        "type": "object",
        "description": "Request to create/update a schedule.",
        "required": [
          "frequency"
        ],
        "properties": {
          "day_of_month": {
            "type": "integer",
            "format": "int32",
            "description": "Day of month (1-28) for monthly schedule.",
            "nullable": true
          },
          "day_of_week": {
            "type": "integer",
            "format": "int32",
            "description": "Day of week (0-6) for weekly schedule.",
            "nullable": true
          },
          "enabled": {
            "type": "boolean",
            "description": "Whether enabled."
          },
          "frequency": {
            "type": "string",
            "description": "Frequency: hourly, daily, weekly, monthly, or cron expression."
          },
          "hour_of_day": {
            "type": "integer",
            "format": "int32",
            "description": "Hour of day (0-23 UTC)."
          },
          "mode": {
            "type": "string",
            "description": "Mode: full or delta."
          }
        }
      },
      "ScheduleResponse": {
        "type": "object",
        "description": "Response for a schedule.",
        "required": [
          "id",
          "connector_id",
          "mode",
          "frequency",
          "hour_of_day",
          "enabled",
          "created_at"
        ],
        "properties": {
          "connector_id": {
            "type": "string",
            "format": "uuid"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "day_of_month": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "day_of_week": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "enabled": {
            "type": "boolean"
          },
          "frequency": {
            "type": "string"
          },
          "hour_of_day": {
            "type": "integer",
            "format": "int32"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "last_run_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "mode": {
            "type": "string"
          },
          "next_run_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          }
        }
      },
      "ScheduleStatus": {
        "type": "string",
        "description": "Schedule status.",
        "enum": [
          "active",
          "paused",
          "disabled"
        ]
      },
      "ScimEmail": {
        "type": "object",
        "description": "SCIM Email value.",
        "required": [
          "value"
        ],
        "properties": {
          "primary": {
            "type": "boolean",
            "description": "Whether this is the primary email."
          },
          "type": {
            "type": "string",
            "description": "Email type (e.g., \"work\", \"home\").",
            "nullable": true
          },
          "value": {
            "type": "string",
            "description": "Email address."
          }
        }
      },
      "ScimMeta": {
        "type": "object",
        "description": "SCIM Resource metadata.",
        "required": [
          "resourceType",
          "created",
          "lastModified"
        ],
        "properties": {
          "created": {
            "type": "string",
            "format": "date-time",
            "description": "When the resource was created."
          },
          "lastModified": {
            "type": "string",
            "format": "date-time",
            "description": "When the resource was last modified."
          },
          "location": {
            "type": "string",
            "description": "Resource location URI.",
            "nullable": true
          },
          "resourceType": {
            "type": "string",
            "description": "Resource type (User or Group)."
          },
          "version": {
            "type": "string",
            "description": "Resource version (`ETag`).",
            "nullable": true
          }
        }
      },
      "ScimName": {
        "type": "object",
        "description": "SCIM User name component.",
        "properties": {
          "familyName": {
            "type": "string",
            "description": "Family name (last name).",
            "nullable": true
          },
          "formatted": {
            "type": "string",
            "description": "Formatted full name.",
            "nullable": true
          },
          "givenName": {
            "type": "string",
            "description": "Given name (first name).",
            "nullable": true
          },
          "honorificPrefix": {
            "type": "string",
            "description": "Honorific prefix.",
            "nullable": true
          },
          "honorificSuffix": {
            "type": "string",
            "description": "Honorific suffix.",
            "nullable": true
          },
          "middleName": {
            "type": "string",
            "description": "Middle name.",
            "nullable": true
          }
        }
      },
      "ScimPatchOp": {
        "type": "object",
        "description": "SCIM PATCH operation (RFC 7644 Section 3.5.2).",
        "required": [
          "op"
        ],
        "properties": {
          "op": {
            "type": "string",
            "description": "Operation type: add, remove, or replace."
          },
          "path": {
            "type": "string",
            "description": "Attribute path (e.g., \"displayName\", \"members[value eq \\\"123\\\"]\").",
            "nullable": true
          },
          "value": {
            "description": "Value to set (for add/replace operations).",
            "nullable": true
          }
        }
      },
      "ScimPatchRequest": {
        "type": "object",
        "description": "SCIM PATCH request (RFC 7644 Section 3.5.2).",
        "required": [
          "schemas",
          "Operations"
        ],
        "properties": {
          "Operations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScimPatchOp"
            },
            "description": "Operations to perform."
          },
          "schemas": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "SCIM schemas."
          }
        }
      },
      "ScimTargetListResponse": {
        "type": "object",
        "description": "Response type for target listing.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScimTargetResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ScimTargetResponse": {
        "type": "object",
        "description": "Response type for a single target (never includes raw credentials).",
        "required": [
          "id",
          "tenant_id",
          "name",
          "base_url",
          "auth_method",
          "deprovisioning_strategy",
          "tls_verify",
          "rate_limit_per_minute",
          "request_timeout_secs",
          "max_retries",
          "status",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "auth_method": {
            "type": "string"
          },
          "base_url": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "deprovisioning_strategy": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "last_health_check_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "last_health_check_error": {
            "type": "string",
            "nullable": true
          },
          "max_retries": {
            "type": "integer",
            "format": "int32"
          },
          "name": {
            "type": "string"
          },
          "rate_limit_per_minute": {
            "type": "integer",
            "format": "int32"
          },
          "request_timeout_secs": {
            "type": "integer",
            "format": "int32"
          },
          "service_provider_config": {
            "nullable": true
          },
          "status": {
            "type": "string"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid"
          },
          "tls_verify": {
            "type": "boolean"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "ScimUser": {
        "allOf": [
          {
            "type": "object",
            "description": "Extension schema data (e.g., enterprise user attributes, custom attributes).\nSerialized as flattened top-level keys in the SCIM JSON response."
          },
          {
            "type": "object",
            "required": [
              "schemas",
              "userName"
            ],
            "properties": {
              "active": {
                "type": "boolean",
                "description": "Whether the user is active."
              },
              "displayName": {
                "type": "string",
                "description": "Display name.",
                "nullable": true
              },
              "emails": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/ScimEmail"
                },
                "description": "User's email addresses."
              },
              "externalId": {
                "type": "string",
                "description": "External identifier from `IdP`.",
                "nullable": true
              },
              "groups": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/ScimUserGroup"
                },
                "description": "User's group memberships (read-only)."
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique resource ID.",
                "nullable": true
              },
              "locale": {
                "type": "string",
                "description": "Locale.",
                "nullable": true
              },
              "meta": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/ScimMeta"
                  }
                ],
                "nullable": true
              },
              "name": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/ScimName"
                  }
                ],
                "nullable": true
              },
              "nickName": {
                "type": "string",
                "description": "Nick name.",
                "nullable": true
              },
              "preferredLanguage": {
                "type": "string",
                "description": "Preferred language.",
                "nullable": true
              },
              "profileUrl": {
                "type": "string",
                "description": "Profile URL.",
                "nullable": true
              },
              "schemas": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "SCIM schemas."
              },
              "timezone": {
                "type": "string",
                "description": "Timezone.",
                "nullable": true
              },
              "title": {
                "type": "string",
                "description": "Title.",
                "nullable": true
              },
              "userName": {
                "type": "string",
                "description": "Unique username (typically email)."
              },
              "userType": {
                "type": "string",
                "description": "User type.",
                "nullable": true
              }
            }
          }
        ],
        "description": "SCIM User resource (RFC 7643 Section 4.1)."
      },
      "ScimUserGroup": {
        "type": "object",
        "description": "SCIM Group reference for user.",
        "required": [
          "value"
        ],
        "properties": {
          "$ref": {
            "type": "string",
            "description": "Reference URI.",
            "nullable": true
          },
          "display": {
            "type": "string",
            "description": "Group display name.",
            "nullable": true
          },
          "value": {
            "type": "string",
            "format": "uuid",
            "description": "Group ID."
          }
        }
      },
      "ScopeAssignment": {
        "type": "object",
        "description": "A single scope assignment.",
        "required": [
          "scope_type",
          "scope_value"
        ],
        "properties": {
          "scope_type": {
            "type": "string"
          },
          "scope_value": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "ScopeConfig": {
        "type": "object",
        "description": "Scope configuration for campaigns.",
        "properties": {
          "application_id": {
            "type": "string",
            "format": "uuid",
            "description": "Application ID (when `scope_type` is application).",
            "nullable": true
          },
          "department": {
            "type": "string",
            "description": "Department name (when `scope_type` is department).",
            "nullable": true
          },
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement ID (when `scope_type` is entitlement).",
            "nullable": true
          }
        }
      },
      "ScopeListResponse": {
        "type": "object",
        "description": "List of scopes.",
        "required": [
          "items"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScopeResponse"
            },
            "description": "List of scopes."
          }
        }
      },
      "ScopeResponse": {
        "type": "object",
        "description": "Template scope response.",
        "required": [
          "id",
          "template_id",
          "scope_type",
          "created_at"
        ],
        "properties": {
          "condition": {
            "type": "string",
            "description": "Condition expression.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "scope_type": {
            "$ref": "#/components/schemas/TemplateScopeType"
          },
          "scope_value": {
            "type": "string",
            "description": "Scope value.",
            "nullable": true
          },
          "template_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parent template ID."
          }
        }
      },
      "ScriptAnalyticsResponse": {
        "type": "object",
        "description": "Detailed analytics for a single script.",
        "required": [
          "script_id",
          "name",
          "total_executions",
          "success_rate",
          "avg_duration_ms",
          "p95_duration_ms",
          "daily_trends",
          "top_errors"
        ],
        "properties": {
          "avg_duration_ms": {
            "type": "number",
            "format": "double",
            "description": "Average execution duration in milliseconds."
          },
          "daily_trends": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DailyTrend"
            },
            "description": "Daily execution trends."
          },
          "name": {
            "type": "string",
            "description": "Script name."
          },
          "p95_duration_ms": {
            "type": "number",
            "format": "double",
            "description": "95th percentile execution duration in milliseconds."
          },
          "script_id": {
            "type": "string",
            "format": "uuid",
            "description": "Script ID."
          },
          "success_rate": {
            "type": "number",
            "format": "double",
            "description": "Success rate as a percentage (0.0 - 100.0)."
          },
          "top_errors": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ErrorSummary"
            },
            "description": "Most frequent errors."
          },
          "total_executions": {
            "type": "integer",
            "format": "int64",
            "description": "Total execution count."
          }
        }
      },
      "ScriptError": {
        "type": "object",
        "description": "A single script error from validation.",
        "required": [
          "message"
        ],
        "properties": {
          "column": {
            "type": "integer",
            "description": "Column number where the error occurred (if applicable).",
            "nullable": true,
            "minimum": 0
          },
          "line": {
            "type": "integer",
            "description": "Line number where the error occurred (if applicable).",
            "nullable": true,
            "minimum": 0
          },
          "message": {
            "type": "string",
            "description": "Error message describing the issue."
          }
        }
      },
      "ScriptListResponse": {
        "type": "object",
        "description": "Paginated list of scripts.",
        "required": [
          "scripts",
          "total"
        ],
        "properties": {
          "scripts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScriptResponse"
            },
            "description": "List of scripts."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count for pagination."
          }
        }
      },
      "ScriptResponse": {
        "type": "object",
        "description": "Full provisioning script response.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "current_version",
          "status",
          "is_system",
          "created_by",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the script was created."
          },
          "created_by": {
            "type": "string",
            "format": "uuid",
            "description": "User who created the script."
          },
          "current_version": {
            "type": "integer",
            "format": "int32",
            "description": "Current active version number."
          },
          "description": {
            "type": "string",
            "description": "Script description.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_system": {
            "type": "boolean",
            "description": "Whether this is a system-provided script."
          },
          "name": {
            "type": "string",
            "description": "Script name."
          },
          "status": {
            "type": "string",
            "description": "Script status (e.g., draft, active, archived)."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the script was last updated."
          }
        }
      },
      "ScriptSummary": {
        "type": "object",
        "description": "Summary statistics for a single script.",
        "required": [
          "script_id",
          "name",
          "total_executions",
          "success_count",
          "failure_count",
          "avg_duration_ms"
        ],
        "properties": {
          "avg_duration_ms": {
            "type": "number",
            "format": "double",
            "description": "Average execution duration in milliseconds."
          },
          "failure_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of failed executions."
          },
          "name": {
            "type": "string",
            "description": "Script name."
          },
          "script_id": {
            "type": "string",
            "format": "uuid",
            "description": "Script ID."
          },
          "success_count": {
            "type": "integer",
            "format": "int64",
            "description": "Number of successful executions."
          },
          "total_executions": {
            "type": "integer",
            "format": "int64",
            "description": "Total execution count."
          }
        }
      },
      "ScriptVersionListResponse": {
        "type": "object",
        "description": "Paginated list of script versions.",
        "required": [
          "versions",
          "total"
        ],
        "properties": {
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count for pagination."
          },
          "versions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScriptVersionResponse"
            },
            "description": "List of versions."
          }
        }
      },
      "ScriptVersionResponse": {
        "type": "object",
        "description": "Script version response.",
        "required": [
          "id",
          "script_id",
          "version_number",
          "script_body",
          "created_by",
          "created_at"
        ],
        "properties": {
          "change_description": {
            "type": "string",
            "description": "Description of what changed in this version.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When this version was created."
          },
          "created_by": {
            "type": "string",
            "format": "uuid",
            "description": "User who created this version."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for this version."
          },
          "script_body": {
            "type": "string",
            "description": "The script body content for this version."
          },
          "script_id": {
            "type": "string",
            "format": "uuid",
            "description": "Reference to the parent script."
          },
          "version_number": {
            "type": "integer",
            "format": "int32",
            "description": "Version number (monotonically increasing)."
          }
        }
      },
      "SecurityAssessment": {
        "type": "object",
        "description": "Complete security assessment response.",
        "required": [
          "agent_id",
          "assessment_id",
          "timestamp",
          "overall_score",
          "risk_level",
          "vulnerabilities",
          "compliance",
          "recommendations"
        ],
        "properties": {
          "agent_id": {
            "type": "string",
            "format": "uuid",
            "description": "The assessed agent's ID."
          },
          "assessment_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique ID for this assessment instance."
          },
          "compliance": {
            "$ref": "#/components/schemas/ComplianceStatus"
          },
          "overall_score": {
            "type": "integer",
            "format": "int32",
            "description": "Computed security score (0-100).",
            "minimum": 0
          },
          "recommendations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Recommendation"
            },
            "description": "Actionable improvement suggestions."
          },
          "risk_level": {
            "$ref": "#/components/schemas/RiskLevel"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "When the assessment was performed."
          },
          "vulnerabilities": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/VulnerabilityCheck"
            },
            "description": "All 14 vulnerability check results."
          }
        }
      },
      "SeedWellKnownResponse": {
        "type": "object",
        "description": "Response for the seed-wellknown endpoint (F081).",
        "required": [
          "seeded",
          "skipped",
          "total_seeded",
          "total_skipped"
        ],
        "properties": {
          "seeded": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SeededAttribute"
            },
            "description": "Attributes that were newly seeded."
          },
          "skipped": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SkippedAttribute"
            },
            "description": "Attributes that were skipped (already exist or limit reached)."
          },
          "total_seeded": {
            "type": "integer",
            "description": "Number of attributes seeded.",
            "minimum": 0
          },
          "total_skipped": {
            "type": "integer",
            "description": "Number of attributes skipped.",
            "minimum": 0
          }
        }
      },
      "SeededAttribute": {
        "type": "object",
        "description": "A single attribute that was seeded from the well-known catalog.",
        "required": [
          "id",
          "slug",
          "display_label",
          "data_type"
        ],
        "properties": {
          "data_type": {
            "type": "string",
            "description": "Data type."
          },
          "display_label": {
            "type": "string",
            "description": "Display label."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "The new definition ID."
          },
          "slug": {
            "type": "string",
            "description": "Well-known slug (e.g., \"department\", \"`hire_date`\")."
          }
        }
      },
      "SelectionMode": {
        "type": "string",
        "description": "User selection mode for batch simulations.",
        "enum": [
          "user_list",
          "filter"
        ]
      },
      "SemiManualApplicationResponse": {
        "type": "object",
        "description": "Response for a semi-manual application configuration.",
        "required": [
          "id",
          "name",
          "is_semi_manual",
          "requires_approval_before_ticket",
          "status",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_semi_manual": {
            "type": "boolean"
          },
          "name": {
            "type": "string"
          },
          "requires_approval_before_ticket": {
            "type": "boolean",
            "description": "Whether approval must complete before ticket creation."
          },
          "sla_policy_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "status": {
            "type": "string"
          },
          "ticketing_config_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "SemiManualApplicationsListResponse": {
        "type": "object",
        "description": "List of semi-manual applications response.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SemiManualApplicationResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ServiceProviderListResponse": {
        "type": "object",
        "description": "Service Provider list response",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ServiceProviderResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int32"
          },
          "offset": {
            "type": "integer",
            "format": "int32"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "ServiceProviderResponse": {
        "type": "object",
        "description": "Single Service Provider response",
        "required": [
          "id",
          "entity_id",
          "name",
          "acs_urls",
          "attribute_mapping",
          "name_id_format",
          "sign_assertions",
          "validate_signatures",
          "assertion_validity_seconds",
          "enabled",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "acs_urls": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "assertion_validity_seconds": {
            "type": "integer",
            "format": "int32"
          },
          "attribute_mapping": {},
          "certificate": {
            "type": "string",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "enabled": {
            "type": "boolean"
          },
          "entity_id": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "metadata_url": {
            "type": "string",
            "nullable": true
          },
          "name": {
            "type": "string"
          },
          "name_id_format": {
            "type": "string"
          },
          "sign_assertions": {
            "type": "boolean"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "validate_signatures": {
            "type": "boolean"
          }
        }
      },
      "SetCustomAttributesRequest": {
        "type": "object",
        "description": "Request to set (full replace) a user's custom attributes.",
        "required": [
          "attributes"
        ],
        "properties": {
          "attributes": {
            "description": "The complete set of custom attributes to apply."
          }
        }
      },
      "SetOwnerRequest": {
        "type": "object",
        "description": "Request to set entitlement owner.",
        "required": [
          "owner_id"
        ],
        "properties": {
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "The user ID to set as owner."
          }
        }
      },
      "SetThresholdsRequest": {
        "type": "object",
        "description": "Request to set thresholds.",
        "required": [
          "thresholds"
        ],
        "properties": {
          "thresholds": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AnomalyThresholdInput"
            }
          }
        }
      },
      "SiemBatchExportListResponse": {
        "type": "object",
        "description": "Paginated list of batch exports.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SiemBatchExportResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "SiemBatchExportResponse": {
        "type": "object",
        "description": "Batch export response.",
        "required": [
          "id",
          "tenant_id",
          "requested_by",
          "date_range_start",
          "date_range_end",
          "event_type_filter",
          "output_format",
          "status",
          "created_at"
        ],
        "properties": {
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "date_range_end": {
            "type": "string",
            "format": "date-time"
          },
          "date_range_start": {
            "type": "string",
            "format": "date-time"
          },
          "error_detail": {
            "type": "string",
            "nullable": true
          },
          "event_type_filter": {},
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "file_size_bytes": {
            "type": "integer",
            "format": "int64",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "output_format": {
            "type": "string"
          },
          "requested_by": {
            "type": "string",
            "format": "uuid"
          },
          "started_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "status": {
            "type": "string"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid"
          },
          "total_events": {
            "type": "integer",
            "format": "int64",
            "nullable": true
          }
        }
      },
      "SiemDestinationListResponse": {
        "type": "object",
        "description": "Paginated list of SIEM destinations.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SiemDestinationResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "SiemDestinationResponse": {
        "type": "object",
        "description": "SIEM destination response.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "destination_type",
          "endpoint_host",
          "export_format",
          "has_auth_config",
          "event_type_filter",
          "rate_limit_per_second",
          "queue_buffer_size",
          "circuit_breaker_threshold",
          "circuit_breaker_cooldown_secs",
          "circuit_state",
          "enabled",
          "splunk_ack_enabled",
          "syslog_facility",
          "tls_verify_cert",
          "created_at",
          "updated_at",
          "created_by"
        ],
        "properties": {
          "circuit_breaker_cooldown_secs": {
            "type": "integer",
            "format": "int32"
          },
          "circuit_breaker_threshold": {
            "type": "integer",
            "format": "int32"
          },
          "circuit_last_failure_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "circuit_state": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "destination_type": {
            "type": "string"
          },
          "enabled": {
            "type": "boolean"
          },
          "endpoint_host": {
            "type": "string"
          },
          "endpoint_port": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "event_type_filter": {},
          "export_format": {
            "type": "string"
          },
          "has_auth_config": {
            "type": "boolean",
            "description": "Whether auth is configured (never returns raw auth data)."
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "queue_buffer_size": {
            "type": "integer",
            "format": "int32"
          },
          "rate_limit_per_second": {
            "type": "integer",
            "format": "int32"
          },
          "splunk_ack_enabled": {
            "type": "boolean"
          },
          "splunk_index": {
            "type": "string",
            "nullable": true
          },
          "splunk_source": {
            "type": "string",
            "nullable": true
          },
          "splunk_sourcetype": {
            "type": "string",
            "nullable": true
          },
          "syslog_facility": {
            "type": "integer",
            "format": "int32"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid"
          },
          "tls_verify_cert": {
            "type": "boolean"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "SiemHealthSummaryResponse": {
        "type": "object",
        "description": "Delivery health summary response.",
        "required": [
          "destination_id",
          "total_events_sent",
          "total_events_delivered",
          "total_events_failed",
          "total_events_dropped",
          "success_rate_percent",
          "circuit_state",
          "dead_letter_count"
        ],
        "properties": {
          "avg_latency_ms": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "circuit_state": {
            "type": "string"
          },
          "dead_letter_count": {
            "type": "integer",
            "format": "int64"
          },
          "destination_id": {
            "type": "string",
            "format": "uuid"
          },
          "last_failure_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "last_success_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "success_rate_percent": {
            "type": "number",
            "format": "double"
          },
          "total_events_delivered": {
            "type": "integer",
            "format": "int64"
          },
          "total_events_dropped": {
            "type": "integer",
            "format": "int64"
          },
          "total_events_failed": {
            "type": "integer",
            "format": "int64"
          },
          "total_events_sent": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "SimulateAllPoliciesResponse": {
        "type": "object",
        "description": "Result of simulating all policies against user attributes.",
        "required": [
          "attributes",
          "matching_policies",
          "total_entitlements"
        ],
        "properties": {
          "attributes": {
            "description": "User attributes that were evaluated."
          },
          "matching_policies": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MatchingPolicyResult"
            },
            "description": "Matching policies."
          },
          "total_entitlements": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Total entitlements that would be granted."
          }
        }
      },
      "SimulateMetaRoleRequest": {
        "type": "object",
        "description": "Request to simulate meta-role changes.",
        "required": [
          "simulation_type"
        ],
        "properties": {
          "criteria_changes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateMetaRoleCriteriaRequest"
            },
            "description": "Updated criteria (for criteria change simulations).",
            "nullable": true
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit results (default: 100)."
          },
          "meta_role_data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/CreateMetaRoleRequest"
              }
            ],
            "nullable": true
          },
          "meta_role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Meta-role ID (for update/delete simulations).",
            "nullable": true
          },
          "simulation_type": {
            "$ref": "#/components/schemas/MetaRoleSimulationType"
          }
        }
      },
      "SimulatePolicyRequest": {
        "type": "object",
        "description": "Request to simulate a policy against user attributes.",
        "required": [
          "attributes"
        ],
        "properties": {
          "attributes": {
            "description": "User attributes to test against (e.g., {\"department\": \"Engineering\", \"location\": \"US\"})."
          }
        }
      },
      "SimulatePolicyResponse": {
        "type": "object",
        "description": "Result of policy simulation.",
        "required": [
          "matches",
          "condition_results"
        ],
        "properties": {
          "condition_results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ConditionEvaluationResult"
            },
            "description": "Details of condition evaluation."
          },
          "matches": {
            "type": "boolean",
            "description": "Whether the policy matches the provided attributes."
          }
        }
      },
      "SimulationChanges": {
        "type": "object",
        "description": "Simulation changes specification.",
        "properties": {
          "entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement being added/removed.",
            "nullable": true
          },
          "entitlement_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Entitlements for new role.",
            "nullable": true
          },
          "role_description": {
            "type": "string",
            "description": "New role description (for `add_role`).",
            "nullable": true
          },
          "role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Role being modified.",
            "nullable": true
          },
          "role_name": {
            "type": "string",
            "description": "New role name (for `add_role`).",
            "nullable": true
          },
          "type": {
            "type": "string",
            "description": "Type of change.",
            "nullable": true
          },
          "user_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Users to assign to new role.",
            "nullable": true
          }
        }
      },
      "SimulationConflict": {
        "type": "object",
        "description": "A potential conflict in simulation.",
        "required": [
          "meta_role_a_id",
          "meta_role_a_name",
          "meta_role_b_id",
          "meta_role_b_name",
          "affected_role_id",
          "affected_role_name",
          "conflict_type",
          "conflicting_items"
        ],
        "properties": {
          "affected_role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Affected role ID."
          },
          "affected_role_name": {
            "type": "string",
            "description": "Affected role name."
          },
          "conflict_type": {
            "$ref": "#/components/schemas/MetaRoleConflictType"
          },
          "conflicting_items": {
            "description": "Details of the conflict."
          },
          "meta_role_a_id": {
            "type": "string",
            "format": "uuid",
            "description": "First meta-role ID."
          },
          "meta_role_a_name": {
            "type": "string",
            "description": "First meta-role name."
          },
          "meta_role_b_id": {
            "type": "string",
            "format": "uuid",
            "description": "Second meta-role ID."
          },
          "meta_role_b_name": {
            "type": "string",
            "description": "Second meta-role name."
          }
        }
      },
      "SimulationListResponse": {
        "type": "object",
        "description": "List response for simulations.",
        "required": [
          "items",
          "total",
          "page",
          "page_size"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SimulationResponse"
            }
          },
          "page": {
            "type": "integer",
            "format": "int64"
          },
          "page_size": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "SimulationRequest": {
        "type": "object",
        "description": "Request to simulate template application.",
        "required": [
          "sample_object"
        ],
        "properties": {
          "limit": {
            "type": "integer",
            "format": "int32",
            "description": "Limit number of results."
          },
          "sample_object": {
            "description": "Sample object data to test template against."
          }
        }
      },
      "SimulationResponse": {
        "type": "object",
        "description": "Response for a role simulation.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "scenario_type",
          "changes",
          "status",
          "affected_users",
          "access_gained",
          "access_lost",
          "created_by",
          "created_at"
        ],
        "properties": {
          "access_gained": {},
          "access_lost": {},
          "affected_users": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "applied_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "applied_by": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "changes": {
            "$ref": "#/components/schemas/SimulationChanges"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "scenario_type": {
            "$ref": "#/components/schemas/ScenarioType"
          },
          "status": {
            "$ref": "#/components/schemas/SimulationStatus"
          },
          "target_role_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "SimulationResultResponse": {
        "type": "object",
        "description": "Simulation result response.",
        "required": [
          "simulation_type",
          "roles_to_add",
          "roles_to_remove",
          "potential_conflicts",
          "conflicts_to_resolve",
          "summary"
        ],
        "properties": {
          "conflicts_to_resolve": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SimulationConflict"
            },
            "description": "Potential conflicts that would be resolved."
          },
          "potential_conflicts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SimulationConflict"
            },
            "description": "Potential conflicts that would be created."
          },
          "roles_to_add": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SimulationRoleChange"
            },
            "description": "Roles that would gain inheritance."
          },
          "roles_to_remove": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SimulationRoleChange"
            },
            "description": "Roles that would lose inheritance."
          },
          "simulation_type": {
            "$ref": "#/components/schemas/MetaRoleSimulationType"
          },
          "summary": {
            "$ref": "#/components/schemas/SimulationSummary"
          }
        }
      },
      "SimulationRoleChange": {
        "type": "object",
        "description": "A role change in simulation.",
        "required": [
          "role_id",
          "role_name",
          "reason",
          "entitlements_affected",
          "constraints_affected"
        ],
        "properties": {
          "application_id": {
            "type": "string",
            "format": "uuid",
            "description": "Application ID.",
            "nullable": true
          },
          "constraints_affected": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Constraints that would be inherited/removed."
          },
          "entitlements_affected": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Entitlements that would be inherited/removed."
          },
          "reason": {
            "description": "Why this role matches/unmatches."
          },
          "role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Role ID."
          },
          "role_name": {
            "type": "string",
            "description": "Role name."
          }
        }
      },
      "SimulationStatus": {
        "type": "string",
        "description": "Status for a simulation.",
        "enum": [
          "draft",
          "executed",
          "applied",
          "cancelled"
        ]
      },
      "SimulationSummary": {
        "type": "object",
        "description": "Summary of simulation results.",
        "required": [
          "total_roles_affected",
          "roles_gaining_inheritance",
          "roles_losing_inheritance",
          "new_conflicts",
          "resolved_conflicts",
          "is_safe",
          "warnings"
        ],
        "properties": {
          "is_safe": {
            "type": "boolean",
            "description": "Whether the change is safe to apply."
          },
          "new_conflicts": {
            "type": "integer",
            "format": "int64",
            "description": "New conflicts that would be created."
          },
          "resolved_conflicts": {
            "type": "integer",
            "format": "int64",
            "description": "Conflicts that would be resolved."
          },
          "roles_gaining_inheritance": {
            "type": "integer",
            "format": "int64",
            "description": "Roles gaining inheritance."
          },
          "roles_losing_inheritance": {
            "type": "integer",
            "format": "int64",
            "description": "Roles losing inheritance."
          },
          "total_roles_affected": {
            "type": "integer",
            "format": "int64",
            "description": "Total roles that would be affected."
          },
          "warnings": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Warnings about potential issues."
          }
        }
      },
      "SkipMicroCertificationRequest": {
        "type": "object",
        "description": "Request to skip a micro-certification.",
        "required": [
          "reason"
        ],
        "properties": {
          "reason": {
            "type": "string",
            "description": "Reason for skipping (minimum 10 characters)."
          }
        }
      },
      "SkippedAttribute": {
        "type": "object",
        "description": "A single attribute that was skipped during seeding.",
        "required": [
          "slug",
          "reason"
        ],
        "properties": {
          "reason": {
            "type": "string",
            "description": "Reason for skipping."
          },
          "slug": {
            "type": "string",
            "description": "Well-known slug that was skipped."
          }
        }
      },
      "SlaPolicyListResponse": {
        "type": "object",
        "description": "List of SLA policies response.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SlaPolicyResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "SlaPolicyResponse": {
        "type": "object",
        "description": "SLA policy response.",
        "required": [
          "id",
          "name",
          "target_duration_seconds",
          "target_duration_human",
          "warning_threshold_percent",
          "breach_notification_enabled",
          "is_active",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "breach_notification_enabled": {
            "type": "boolean"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_active": {
            "type": "boolean"
          },
          "name": {
            "type": "string"
          },
          "target_duration_human": {
            "type": "string",
            "description": "Human-readable target duration (e.g., \"4 hours\")."
          },
          "target_duration_seconds": {
            "type": "integer",
            "format": "int32"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "warning_threshold_percent": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "SodRuleListResponse": {
        "type": "object",
        "description": "Paginated list of `SoD` rules.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SodRuleResponse"
            },
            "description": "List of rules."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "SodRuleResponse": {
        "type": "object",
        "description": "`SoD` rule response.",
        "required": [
          "id",
          "name",
          "first_entitlement_id",
          "second_entitlement_id",
          "severity",
          "status",
          "created_by",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "business_rationale": {
            "type": "string",
            "description": "Business rationale.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "created_by": {
            "type": "string",
            "format": "uuid",
            "description": "User who created the rule."
          },
          "description": {
            "type": "string",
            "description": "Optional description.",
            "nullable": true
          },
          "first_entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "First conflicting entitlement ID."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "second_entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Second conflicting entitlement ID."
          },
          "severity": {
            "$ref": "#/components/schemas/GovSodSeverity"
          },
          "status": {
            "$ref": "#/components/schemas/GovSodRuleStatus"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp."
          }
        }
      },
      "SodViolationSummary": {
        "type": "object",
        "description": "Summary of an `SoD` violation for display.",
        "required": [
          "rule_id",
          "rule_name",
          "severity",
          "conflicting_entitlement_id"
        ],
        "properties": {
          "conflicting_entitlement_id": {
            "type": "string",
            "format": "uuid",
            "description": "Conflicting entitlement."
          },
          "rule_id": {
            "type": "string",
            "format": "uuid",
            "description": "Rule that would be violated."
          },
          "rule_name": {
            "type": "string",
            "description": "Rule name."
          },
          "severity": {
            "$ref": "#/components/schemas/GovSodSeverity"
          }
        }
      },
      "SortDefinition": {
        "type": "object",
        "description": "Sort definition for default ordering.",
        "required": [
          "field",
          "direction"
        ],
        "properties": {
          "direction": {
            "type": "string"
          },
          "field": {
            "type": "string"
          }
        }
      },
      "SsoPostForm": {
        "type": "object",
        "description": "SSO POST form data",
        "required": [
          "SAMLRequest"
        ],
        "properties": {
          "RelayState": {
            "type": "string",
            "nullable": true
          },
          "SAMLRequest": {
            "type": "string"
          }
        }
      },
      "StaleNhiInfo": {
        "type": "object",
        "description": "Information about a stale NHI.",
        "required": [
          "nhi_id",
          "name",
          "owner_id",
          "days_inactive",
          "inactivity_threshold_days",
          "in_grace_period"
        ],
        "properties": {
          "days_inactive": {
            "type": "integer",
            "format": "int32",
            "description": "Days since last use."
          },
          "grace_period_ends_at": {
            "type": "string",
            "format": "date-time",
            "description": "When grace period ends.",
            "nullable": true
          },
          "in_grace_period": {
            "type": "boolean",
            "description": "Whether NHI is in grace period."
          },
          "inactivity_threshold_days": {
            "type": "integer",
            "format": "int32",
            "description": "Configured inactivity threshold."
          },
          "last_used_at": {
            "type": "string",
            "format": "date-time",
            "description": "When last used.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "The NHI name."
          },
          "nhi_id": {
            "type": "string",
            "format": "uuid",
            "description": "The NHI ID."
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "The owner responsible."
          }
        }
      },
      "StalenessReportResponse": {
        "type": "object",
        "description": "Staleness report response.",
        "required": [
          "generated_at",
          "min_inactive_days",
          "total_stale",
          "critical_count",
          "warning_count",
          "stale_nhis"
        ],
        "properties": {
          "critical_count": {
            "type": "integer",
            "format": "int64",
            "description": "NHIs stale > 180 days (critical)."
          },
          "generated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the report was generated."
          },
          "min_inactive_days": {
            "type": "integer",
            "format": "int32",
            "description": "Minimum inactive days threshold used."
          },
          "stale_nhis": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/StaleNhiInfo"
            },
            "description": "List of stale NHIs (sorted by `days_inactive` desc)."
          },
          "total_stale": {
            "type": "integer",
            "format": "int64",
            "description": "Total stale NHIs."
          },
          "warning_count": {
            "type": "integer",
            "format": "int64",
            "description": "NHIs stale 90-180 days (warning)."
          }
        }
      },
      "StartRegistrationRequest": {
        "type": "object",
        "description": "Request to start `WebAuthn` registration.",
        "properties": {
          "name": {
            "type": "string",
            "description": "Optional friendly name for the credential (e.g., \"`MacBook` Touch ID\").",
            "example": "MacBook Touch ID",
            "nullable": true
          }
        }
      },
      "StartupResponse": {
        "type": "object",
        "description": "Startup probe response (F074 \u2014 FR-003).\n\nReturns 503 during initialization, 200 once startup is complete.\nThis is a one-time gate \u2014 once it returns 200, it never reverts.",
        "required": [
          "status"
        ],
        "properties": {
          "status": {
            "type": "string"
          }
        }
      },
      "StepEscalationResponse": {
        "type": "object",
        "description": "Response for step escalation configuration.",
        "required": [
          "step_id",
          "escalation_enabled",
          "has_custom_rule"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp.",
            "nullable": true
          },
          "escalation_enabled": {
            "type": "boolean",
            "description": "Whether escalation is enabled for this step."
          },
          "final_fallback": {
            "allOf": [
              {
                "$ref": "#/components/schemas/FinalFallbackAction"
              }
            ],
            "nullable": true
          },
          "has_custom_rule": {
            "type": "boolean",
            "description": "Whether a rule is configured (vs using tenant defaults)."
          },
          "rule_id": {
            "type": "string",
            "format": "uuid",
            "description": "Rule ID if configured.",
            "nullable": true
          },
          "step_id": {
            "type": "string",
            "format": "uuid",
            "description": "The step ID."
          },
          "timeout_secs": {
            "type": "integer",
            "format": "int64",
            "description": "Timeout in seconds.",
            "nullable": true
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp.",
            "nullable": true
          },
          "warning_threshold_secs": {
            "type": "integer",
            "format": "int64",
            "description": "Warning threshold in seconds.",
            "nullable": true
          }
        }
      },
      "SubmitNhiRequestRequest": {
        "type": "object",
        "description": "Request to submit an NHI request.",
        "required": [
          "name",
          "purpose"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Requested NHI name."
          },
          "purpose": {
            "type": "string",
            "description": "Purpose/justification for the NHI."
          },
          "requested_expiration": {
            "type": "string",
            "format": "date-time",
            "description": "Requested expiration date.",
            "nullable": true
          },
          "requested_permissions": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Requested entitlement IDs."
          },
          "requested_rotation_days": {
            "type": "integer",
            "format": "int32",
            "description": "Requested rotation interval in days.",
            "nullable": true
          }
        }
      },
      "SubtreeEntry": {
        "type": "object",
        "description": "A descendant entry in the subtree.",
        "required": [
          "id",
          "display_name",
          "group_type",
          "relative_depth"
        ],
        "properties": {
          "display_name": {
            "type": "string",
            "description": "Descendant group display name."
          },
          "group_type": {
            "type": "string",
            "description": "Descendant group type."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Descendant group ID."
          },
          "parent_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parent group ID.",
            "nullable": true
          },
          "relative_depth": {
            "type": "integer",
            "format": "int32",
            "description": "Depth relative to the queried group (direct child = 1)."
          }
        }
      },
      "SubtreeMember": {
        "type": "object",
        "description": "A user member in a subtree membership query.",
        "required": [
          "user_id",
          "email"
        ],
        "properties": {
          "display_name": {
            "type": "string",
            "description": "User display name.",
            "nullable": true
          },
          "email": {
            "type": "string",
            "description": "User email."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID."
          }
        }
      },
      "SubtreeMembershipResponse": {
        "type": "object",
        "description": "Response for subtree membership queries.",
        "required": [
          "group_id",
          "members",
          "pagination"
        ],
        "properties": {
          "group_id": {
            "type": "string",
            "format": "uuid",
            "description": "The group ID that was queried."
          },
          "members": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SubtreeMember"
            },
            "description": "All users in the group and its descendants."
          },
          "pagination": {
            "$ref": "#/components/schemas/PaginationWithTotal"
          }
        }
      },
      "SubtreeResponse": {
        "type": "object",
        "description": "Response for getting a group's subtree.",
        "required": [
          "root_group_id",
          "descendants",
          "pagination"
        ],
        "properties": {
          "descendants": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SubtreeEntry"
            },
            "description": "All descendant groups."
          },
          "pagination": {
            "$ref": "#/components/schemas/Pagination"
          },
          "root_group_id": {
            "type": "string",
            "format": "uuid",
            "description": "The root group ID that was queried."
          }
        }
      },
      "SuspendNhiRequest": {
        "type": "object",
        "description": "Request to suspend an NHI.",
        "required": [
          "reason"
        ],
        "properties": {
          "details": {
            "type": "string",
            "description": "Additional details.",
            "nullable": true
          },
          "reason": {
            "$ref": "#/components/schemas/NhiSuspensionReason"
          }
        }
      },
      "SwitchBackRequest": {
        "type": "object",
        "description": "Request to switch back to physical user.",
        "properties": {
          "reason": {
            "type": "string",
            "description": "Reason for switching back.",
            "nullable": true
          }
        }
      },
      "SwitchContextRequest": {
        "type": "object",
        "description": "Request to switch persona context.",
        "required": [
          "persona_id"
        ],
        "properties": {
          "persona_id": {
            "type": "string",
            "format": "uuid",
            "description": "Persona to switch to."
          },
          "reason": {
            "type": "string",
            "description": "Reason for switching.",
            "nullable": true
          }
        }
      },
      "SwitchContextResponse": {
        "type": "object",
        "description": "Response after context switch.",
        "required": [
          "session_id",
          "access_token",
          "switched_at"
        ],
        "properties": {
          "access_token": {
            "type": "string",
            "description": "New JWT with updated persona claims."
          },
          "active_persona_id": {
            "type": "string",
            "format": "uuid",
            "description": "Active persona ID (null if switched back to physical user).",
            "nullable": true
          },
          "active_persona_name": {
            "type": "string",
            "description": "Active persona name.",
            "nullable": true
          },
          "session_id": {
            "type": "string",
            "format": "uuid",
            "description": "Session ID."
          },
          "switched_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the switch occurred."
          }
        }
      },
      "SyncConfigResponse": {
        "type": "object",
        "description": "Response for sync configuration.",
        "required": [
          "connector_id",
          "enabled",
          "sync_mode",
          "polling_interval_secs",
          "batch_size",
          "rate_limit_per_minute",
          "conflict_resolution"
        ],
        "properties": {
          "batch_size": {
            "type": "integer",
            "format": "int32"
          },
          "conflict_resolution": {
            "type": "string"
          },
          "connector_id": {
            "type": "string",
            "format": "uuid"
          },
          "enabled": {
            "type": "boolean"
          },
          "polling_interval_secs": {
            "type": "integer",
            "format": "int32"
          },
          "rate_limit_per_minute": {
            "type": "integer",
            "format": "int32"
          },
          "sync_mode": {
            "type": "string"
          }
        }
      },
      "SyncConflictResponse": {
        "type": "object",
        "description": "Response for a sync conflict.",
        "required": [
          "id",
          "change_id",
          "conflict_type",
          "status",
          "inbound_value",
          "outbound_value",
          "created_at"
        ],
        "properties": {
          "change_id": {
            "type": "string",
            "format": "uuid"
          },
          "conflict_type": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "inbound_value": {},
          "outbound_value": {},
          "status": {
            "type": "string"
          }
        }
      },
      "SyncRunListResponse": {
        "type": "object",
        "description": "Response for listing sync runs.",
        "required": [
          "target_id",
          "items",
          "total_count",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScimSyncRun"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "target_id": {
            "type": "string",
            "format": "uuid"
          },
          "total_count": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "SyncStatusResponse": {
        "type": "object",
        "description": "Response for sync status.",
        "required": [
          "connector_id",
          "current_state",
          "is_throttled",
          "changes_processed",
          "changes_pending",
          "conflicts_pending",
          "current_rate"
        ],
        "properties": {
          "changes_pending": {
            "type": "integer",
            "format": "int32"
          },
          "changes_processed": {
            "type": "integer",
            "format": "int64"
          },
          "conflicts_pending": {
            "type": "integer",
            "format": "int32"
          },
          "connector_id": {
            "type": "string",
            "format": "uuid"
          },
          "current_rate": {
            "type": "number",
            "format": "double"
          },
          "current_state": {
            "type": "string"
          },
          "is_throttled": {
            "type": "boolean"
          },
          "last_sync_completed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "last_sync_error": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "SyncTicketRequest": {
        "type": "object",
        "description": "Request to manually sync a ticket.",
        "properties": {
          "force": {
            "type": "boolean",
            "description": "Force refresh even if recently synced."
          }
        }
      },
      "SyncTicketResponse": {
        "type": "object",
        "description": "Response for ticket sync.",
        "required": [
          "success",
          "ticket"
        ],
        "properties": {
          "message": {
            "type": "string",
            "nullable": true
          },
          "success": {
            "type": "boolean"
          },
          "ticket": {
            "$ref": "#/components/schemas/ExternalTicketResponse"
          }
        }
      },
      "SyncTokenResponse": {
        "type": "object",
        "description": "Response for sync token.",
        "required": [
          "connector_id",
          "token_value",
          "token_type",
          "sequence_number",
          "is_valid"
        ],
        "properties": {
          "connector_id": {
            "type": "string",
            "format": "uuid"
          },
          "is_valid": {
            "type": "boolean"
          },
          "last_processed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "sequence_number": {
            "type": "integer",
            "format": "int64"
          },
          "token_type": {
            "type": "string"
          },
          "token_value": {
            "type": "string"
          }
        }
      },
      "SyncTriggerResponse": {
        "type": "object",
        "description": "Response for sync trigger.",
        "required": [
          "connector_id",
          "processed",
          "succeeded",
          "failed",
          "conflicts",
          "has_more"
        ],
        "properties": {
          "conflicts": {
            "type": "integer",
            "minimum": 0
          },
          "connector_id": {
            "type": "string",
            "format": "uuid"
          },
          "failed": {
            "type": "integer",
            "minimum": 0
          },
          "has_more": {
            "type": "boolean"
          },
          "processed": {
            "type": "integer",
            "minimum": 0
          },
          "succeeded": {
            "type": "integer",
            "minimum": 0
          }
        }
      },
      "TemplateDefinition": {
        "type": "object",
        "description": "Template definition structure.",
        "properties": {
          "columns": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ColumnDefinition"
            }
          },
          "data_sources": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "default_sort": {
            "allOf": [
              {
                "$ref": "#/components/schemas/SortDefinition"
              }
            ],
            "nullable": true
          },
          "filters": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/FilterDefinition"
            }
          },
          "grouping": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "TemplateDetailResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/TemplateResponse"
          },
          {
            "type": "object",
            "required": [
              "rules",
              "scopes",
              "merge_policies"
            ],
            "properties": {
              "current_version": {
                "type": "integer",
                "format": "int32",
                "description": "Current version number.",
                "nullable": true
              },
              "merge_policies": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/MergePolicyResponse"
                },
                "description": "Merge policies for multi-source attributes."
              },
              "parent": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/TemplateResponse"
                  }
                ],
                "nullable": true
              },
              "rules": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/RuleResponse"
                },
                "description": "Rules associated with this template."
              },
              "scopes": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/ScopeResponse"
                },
                "description": "Scopes where this template applies."
              }
            }
          }
        ],
        "description": "Object template detailed response (with rules, scopes, etc.)."
      },
      "TemplateEventListResponse": {
        "type": "object",
        "description": "Paginated list of events.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TemplateEventResponse"
            },
            "description": "List of events."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Current page size."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Current offset."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count."
          }
        }
      },
      "TemplateEventResponse": {
        "type": "object",
        "description": "Template event response.",
        "required": [
          "id",
          "event_type",
          "created_at"
        ],
        "properties": {
          "actor_id": {
            "type": "string",
            "format": "uuid",
            "description": "Actor who triggered the event.",
            "nullable": true
          },
          "changes": {
            "description": "Change details.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Event timestamp."
          },
          "event_type": {
            "$ref": "#/components/schemas/TemplateEventType"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "template_id": {
            "type": "string",
            "format": "uuid",
            "description": "Template ID.",
            "nullable": true
          }
        }
      },
      "TemplateEventType": {
        "type": "string",
        "description": "Event types for template modification audit trail.",
        "enum": [
          "created",
          "updated",
          "activated",
          "disabled",
          "deleted",
          "version_created",
          "rule_added",
          "rule_updated",
          "rule_removed",
          "scope_added",
          "scope_removed",
          "merge_policy_added",
          "merge_policy_updated",
          "merge_policy_removed"
        ]
      },
      "TemplateListResponse": {
        "type": "object",
        "description": "Paginated list of script templates.",
        "required": [
          "templates",
          "total"
        ],
        "properties": {
          "templates": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TemplateResponse"
            },
            "description": "List of templates."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count for pagination."
          }
        }
      },
      "TemplateMergeStrategy": {
        "type": "string",
        "description": "Merge strategies for multi-source data.",
        "enum": [
          "source_precedence",
          "timestamp_wins",
          "concatenate_unique",
          "first_wins",
          "manual_only"
        ]
      },
      "TemplateNullHandling": {
        "type": "string",
        "description": "Null handling options for merge policies.",
        "enum": [
          "merge",
          "preserve_empty"
        ]
      },
      "TemplateObjectType": {
        "type": "string",
        "description": "Object types that templates can target.",
        "enum": [
          "user",
          "role",
          "entitlement",
          "application"
        ]
      },
      "TemplateResponse": {
        "type": "object",
        "description": "Script template response.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "category",
          "template_body",
          "is_system",
          "created_by",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "category": {
            "type": "string",
            "description": "Template category."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the template was created."
          },
          "created_by": {
            "type": "string",
            "format": "uuid",
            "description": "Who created the template."
          },
          "description": {
            "type": "string",
            "description": "Template description.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_system": {
            "type": "boolean",
            "description": "Whether this is a system-provided template."
          },
          "name": {
            "type": "string",
            "description": "Template name."
          },
          "placeholder_annotations": {
            "description": "Annotations describing template placeholders.",
            "nullable": true
          },
          "template_body": {
            "type": "string",
            "description": "The template body content with placeholders."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the template was last updated."
          }
        }
      },
      "TemplateRuleType": {
        "type": "string",
        "description": "Rule types for template rules.",
        "enum": [
          "default",
          "computed",
          "validation",
          "normalization"
        ]
      },
      "TemplateScopeType": {
        "type": "string",
        "description": "Scope types for template matching.",
        "enum": [
          "global",
          "organization",
          "category",
          "condition"
        ]
      },
      "TemplateSimulationResponse": {
        "type": "object",
        "description": "Result of a template simulation.",
        "required": [
          "template_id",
          "rules_applied",
          "validation_errors",
          "computed_values",
          "affected_count"
        ],
        "properties": {
          "affected_count": {
            "type": "integer",
            "format": "int32",
            "description": "Total objects affected (for batch simulation)."
          },
          "computed_values": {
            "description": "Computed values that would be generated."
          },
          "rules_applied": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RuleApplicationResult"
            },
            "description": "Rules that would be applied."
          },
          "template_id": {
            "type": "string",
            "format": "uuid",
            "description": "Template that was simulated."
          },
          "validation_errors": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "description": "Validation errors that would occur."
          }
        }
      },
      "TemplateStatus": {
        "type": "string",
        "description": "Status for report templates.",
        "enum": [
          "active",
          "archived"
        ]
      },
      "TemplateStrength": {
        "type": "string",
        "description": "Mapping strength for rules (IGA-style).",
        "enum": [
          "strong",
          "normal",
          "weak"
        ]
      },
      "TemplateTimeReference": {
        "type": "string",
        "description": "Time reference type for rule time constraints.",
        "enum": [
          "absolute",
          "relative_to_creation"
        ]
      },
      "TemplateVariableInfo": {
        "type": "object",
        "description": "Email template variable documentation.",
        "required": [
          "name",
          "description"
        ],
        "properties": {
          "description": {
            "type": "string"
          },
          "name": {
            "type": "string"
          }
        }
      },
      "TenantInfo": {
        "type": "object",
        "description": "Basic tenant information.",
        "required": [
          "id",
          "slug",
          "name"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique tenant identifier.",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "name": {
            "type": "string",
            "description": "Human-readable tenant name.",
            "example": "Acme Corp"
          },
          "slug": {
            "type": "string",
            "description": "URL-safe tenant slug.",
            "example": "acme-corp"
          }
        }
      },
      "TenantProviderResponse": {
        "type": "object",
        "description": "Response for a tenant provider configuration.",
        "required": [
          "provider",
          "enabled",
          "client_id",
          "has_client_secret",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "client_id": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "enabled": {
            "type": "boolean"
          },
          "has_client_secret": {
            "type": "boolean",
            "description": "Whether client secret is configured (never expose actual secret)."
          },
          "provider": {
            "type": "string"
          },
          "scopes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "nullable": true
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "TenantProvidersListResponse": {
        "type": "object",
        "description": "Response for listing tenant providers.",
        "required": [
          "providers"
        ],
        "properties": {
          "providers": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TenantProviderResponse"
            }
          }
        }
      },
      "TestConnectivityResponse": {
        "type": "object",
        "description": "Test connectivity result.",
        "required": [
          "success"
        ],
        "properties": {
          "error": {
            "type": "string",
            "nullable": true
          },
          "latency_ms": {
            "type": "integer",
            "format": "int64",
            "nullable": true,
            "minimum": 0
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "TestTicketingConfigurationRequest": {
        "type": "object",
        "description": "Request to test ticketing configuration connectivity.",
        "properties": {
          "test_data": {
            "description": "Optional custom test data.",
            "nullable": true
          }
        }
      },
      "TestTicketingConfigurationResponse": {
        "type": "object",
        "description": "Response for ticketing configuration test.",
        "required": [
          "success"
        ],
        "properties": {
          "error": {
            "type": "string",
            "nullable": true
          },
          "message": {
            "type": "string",
            "nullable": true
          },
          "response_time_ms": {
            "type": "integer",
            "format": "int64",
            "nullable": true
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "Threshold": {
        "type": "object",
        "description": "A threshold configuration entry.",
        "required": [
          "anomaly_type",
          "threshold_value",
          "enabled",
          "alert_enabled"
        ],
        "properties": {
          "aggregation_window_secs": {
            "type": "integer",
            "format": "int32"
          },
          "alert_enabled": {
            "type": "boolean"
          },
          "anomaly_type": {
            "$ref": "#/components/schemas/AnomalyType"
          },
          "enabled": {
            "type": "boolean"
          },
          "threshold_value": {
            "type": "number",
            "format": "double"
          }
        }
      },
      "ThresholdsResponse": {
        "type": "object",
        "description": "Response for getting thresholds.",
        "required": [
          "source",
          "thresholds"
        ],
        "properties": {
          "agent_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "source": {
            "$ref": "#/components/schemas/ThresholdSource"
          },
          "thresholds": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Threshold"
            }
          }
        }
      },
      "TicketStatusCategory": {
        "type": "string",
        "description": "Normalized category for external ticket status.",
        "enum": [
          "open",
          "in_progress",
          "pending",
          "resolved",
          "closed",
          "rejected"
        ]
      },
      "TicketingConfigurationListResponse": {
        "type": "object",
        "description": "List of ticketing configurations response.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TicketingConfigurationResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "TicketingConfigurationResponse": {
        "type": "object",
        "description": "Ticketing configuration response.",
        "required": [
          "id",
          "name",
          "ticketing_type",
          "endpoint_url",
          "polling_interval_seconds",
          "is_active",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "default_assignee": {
            "type": "string",
            "nullable": true
          },
          "default_assignment_group": {
            "type": "string",
            "nullable": true
          },
          "endpoint_url": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "is_active": {
            "type": "boolean"
          },
          "issue_type": {
            "type": "string",
            "nullable": true
          },
          "name": {
            "type": "string"
          },
          "polling_interval_seconds": {
            "type": "integer",
            "format": "int32",
            "description": "Note: credentials are never returned in responses for security."
          },
          "project_key": {
            "type": "string",
            "nullable": true
          },
          "ticketing_type": {
            "$ref": "#/components/schemas/TicketingType"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "TicketingType": {
        "type": "string",
        "description": "Type of ticketing system integration.",
        "enum": [
          "service_now",
          "jira",
          "webhook"
        ]
      },
      "ToggleIdentityProviderRequest": {
        "type": "object",
        "description": "Request to toggle identity provider enabled status.",
        "required": [
          "is_enabled"
        ],
        "properties": {
          "is_enabled": {
            "type": "boolean"
          }
        }
      },
      "TokenRequest": {
        "type": "object",
        "description": "Token request for POST /oauth/token.",
        "required": [
          "grant_type"
        ],
        "properties": {
          "client_id": {
            "type": "string",
            "description": "Client ID.",
            "nullable": true
          },
          "client_secret": {
            "type": "string",
            "description": "Client secret (for confidential clients).",
            "nullable": true
          },
          "code": {
            "type": "string",
            "description": "Authorization code (for `authorization_code` grant).",
            "nullable": true
          },
          "code_verifier": {
            "type": "string",
            "description": "PKCE code verifier (for `authorization_code` grant).",
            "nullable": true
          },
          "device_code": {
            "type": "string",
            "description": "Device code (for `device_code` grant, RFC 8628).",
            "nullable": true
          },
          "grant_type": {
            "type": "string",
            "description": "Grant type (`authorization_code`, `client_credentials`, `refresh_token`, urn:ietf:params:oauth:grant-type:device_code)."
          },
          "redirect_uri": {
            "type": "string",
            "description": "Redirect URI (for `authorization_code` grant).",
            "nullable": true
          },
          "refresh_token": {
            "type": "string",
            "description": "Refresh token (for `refresh_token` grant).",
            "nullable": true
          },
          "scope": {
            "type": "string",
            "description": "Requested scopes (for `client_credentials` or scope downgrade).",
            "nullable": true
          }
        }
      },
      "TokenResponse": {
        "type": "object",
        "description": "Token response for POST /oauth/token.",
        "required": [
          "access_token",
          "token_type",
          "expires_in"
        ],
        "properties": {
          "access_token": {
            "type": "string",
            "description": "Access token (JWT)."
          },
          "expires_in": {
            "type": "integer",
            "format": "int64",
            "description": "Token lifetime in seconds."
          },
          "id_token": {
            "type": "string",
            "description": "ID token (for `authorization_code` with openid scope).",
            "nullable": true
          },
          "refresh_token": {
            "type": "string",
            "description": "Refresh token (not included for `client_credentials`).",
            "nullable": true
          },
          "scope": {
            "type": "string",
            "description": "Granted scopes.",
            "nullable": true
          },
          "token_type": {
            "type": "string",
            "description": "Token type (always \"Bearer\")."
          }
        }
      },
      "ToolListResponse": {
        "type": "object",
        "description": "List response for tools with pagination.",
        "required": [
          "tools",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "limit": {
            "type": "integer",
            "format": "int32",
            "description": "Current limit."
          },
          "offset": {
            "type": "integer",
            "format": "int32",
            "description": "Current offset."
          },
          "tools": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ToolResponse"
            },
            "description": "List of tools."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count (for pagination)."
          }
        }
      },
      "ToolResponse": {
        "type": "object",
        "description": "Tool response DTO.",
        "required": [
          "id",
          "name",
          "input_schema",
          "risk_level",
          "requires_approval",
          "provider_verified",
          "status",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "category": {
            "type": "string",
            "description": "Tool category.",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Tool creation timestamp."
          },
          "description": {
            "type": "string",
            "description": "Tool description.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Tool unique identifier."
          },
          "input_schema": {
            "description": "JSON Schema for tool input parameters."
          },
          "max_calls_per_hour": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum calls per hour.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Tool name."
          },
          "output_schema": {
            "description": "JSON Schema for expected output.",
            "nullable": true
          },
          "provider": {
            "type": "string",
            "description": "Tool provider.",
            "nullable": true
          },
          "provider_verified": {
            "type": "boolean",
            "description": "Whether provider is verified."
          },
          "requires_approval": {
            "type": "boolean",
            "description": "Whether tool invocation requires approval."
          },
          "risk_level": {
            "type": "string",
            "description": "Risk level: low, medium, high, critical."
          },
          "status": {
            "type": "string",
            "description": "Tool status: active, inactive, deprecated."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Tool last update timestamp."
          }
        }
      },
      "TransferOwnershipRequest": {
        "type": "object",
        "description": "Request to transfer NHI ownership.",
        "required": [
          "new_owner_id",
          "reason"
        ],
        "properties": {
          "new_owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "New owner ID."
          },
          "reason": {
            "type": "string",
            "description": "Reason for transfer."
          }
        }
      },
      "TrendDataPoint": {
        "type": "object",
        "description": "Single data point in trend.",
        "required": [
          "date",
          "total",
          "by_type"
        ],
        "properties": {
          "by_type": {
            "type": "object",
            "additionalProperties": {
              "type": "integer",
              "format": "int32",
              "minimum": 0
            }
          },
          "date": {
            "type": "string"
          },
          "total": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "TrendDirection": {
        "type": "string",
        "description": "Trend direction for metrics.",
        "enum": [
          "up",
          "stable",
          "down"
        ]
      },
      "TrendResponse": {
        "type": "object",
        "description": "Response for trend data.",
        "required": [
          "data_points",
          "from",
          "to"
        ],
        "properties": {
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true
          },
          "data_points": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TrendDataPoint"
            }
          },
          "from": {
            "type": "string",
            "format": "date-time"
          },
          "to": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "TriggerAnalysisRequest": {
        "type": "object",
        "description": "Request to trigger a new outlier analysis.",
        "required": [
          "triggered_by"
        ],
        "properties": {
          "triggered_by": {
            "$ref": "#/components/schemas/OutlierTriggerType"
          }
        }
      },
      "TriggerCascadeRequest": {
        "type": "object",
        "description": "Request to trigger a cascade propagation.",
        "required": [
          "meta_role_id"
        ],
        "properties": {
          "dry_run": {
            "type": "boolean",
            "description": "Whether to run in dry-run mode (default: false)."
          },
          "meta_role_id": {
            "type": "string",
            "format": "uuid",
            "description": "Meta-role ID to cascade from."
          }
        }
      },
      "TriggerCorrelationRequest": {
        "type": "object",
        "description": "Request to trigger correlation for a connector.",
        "properties": {
          "account_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Optional list of specific account IDs to evaluate.\nIf omitted, all uncorrelated accounts for the connector are evaluated.",
            "nullable": true
          }
        }
      },
      "TriggerCorrelationResponse": {
        "type": "object",
        "description": "Response after triggering a correlation job.",
        "required": [
          "job_id",
          "accounts_to_evaluate",
          "status"
        ],
        "properties": {
          "accounts_to_evaluate": {
            "type": "integer",
            "format": "int64",
            "description": "Number of accounts that will be evaluated."
          },
          "job_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique job identifier for tracking progress."
          },
          "status": {
            "type": "string",
            "description": "Initial job status."
          }
        }
      },
      "TriggerDetectionRequest": {
        "type": "object",
        "description": "Request to trigger duplicate detection.",
        "properties": {
          "identity_id": {
            "type": "string",
            "format": "uuid",
            "description": "Limit scan to specific identity.",
            "nullable": true
          }
        }
      },
      "TriggerOperationRequest": {
        "type": "object",
        "description": "Request to trigger a manual provisioning operation.",
        "required": [
          "connector_id",
          "user_id",
          "operation_type",
          "object_class",
          "payload"
        ],
        "properties": {
          "connector_id": {
            "type": "string",
            "format": "uuid",
            "description": "The connector to provision to."
          },
          "object_class": {
            "type": "string",
            "description": "Target object class."
          },
          "operation_type": {
            "$ref": "#/components/schemas/OperationType"
          },
          "payload": {
            "description": "Payload to provision."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority (higher = more urgent).",
            "nullable": true
          },
          "target_uid": {
            "type": "string",
            "description": "Target UID (required for update/delete).",
            "nullable": true
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "The user to provision."
          }
        }
      },
      "TriggerReconciliationRequest": {
        "type": "object",
        "description": "Request to trigger a reconciliation run.",
        "properties": {
          "dry_run": {
            "type": "boolean",
            "description": "Whether this is a dry run."
          },
          "mode": {
            "type": "string",
            "description": "Mode: \"full\" or \"delta\"."
          }
        }
      },
      "TriggerRuleListResponse": {
        "type": "object",
        "description": "Paginated list of trigger rules.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TriggerRuleResponse"
            },
            "description": "List of trigger rules."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Limit used for query."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Offset used for query."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count matching the filter."
          }
        }
      },
      "TriggerRuleResponse": {
        "type": "object",
        "description": "Trigger rule response.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "trigger_type",
          "scope_type",
          "reviewer_type",
          "timeout_secs",
          "reminder_threshold_percent",
          "auto_revoke",
          "revoke_triggering_assignment",
          "is_active",
          "is_default",
          "priority",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "auto_revoke": {
            "type": "boolean",
            "description": "Whether to auto-revoke on timeout."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the rule was created."
          },
          "fallback_reviewer_id": {
            "type": "string",
            "format": "uuid",
            "description": "Fallback reviewer ID.",
            "nullable": true
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the rule is active."
          },
          "is_default": {
            "type": "boolean",
            "description": "Whether this is the default rule for trigger type."
          },
          "metadata": {
            "description": "Extensible metadata.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Display name."
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Rule priority."
          },
          "reminder_threshold_percent": {
            "type": "integer",
            "format": "int32",
            "description": "Reminder threshold percent (1-99)."
          },
          "reviewer_type": {
            "$ref": "#/components/schemas/MicroCertReviewerType"
          },
          "revoke_triggering_assignment": {
            "type": "boolean",
            "description": "For `SoD`: revoke triggering assignment."
          },
          "scope_id": {
            "type": "string",
            "format": "uuid",
            "description": "Scope ID (application or entitlement ID).",
            "nullable": true
          },
          "scope_type": {
            "$ref": "#/components/schemas/MicroCertScopeType"
          },
          "specific_reviewer_id": {
            "type": "string",
            "format": "uuid",
            "description": "Specific reviewer ID.",
            "nullable": true
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "Tenant ID."
          },
          "timeout_secs": {
            "type": "integer",
            "format": "int32",
            "description": "Timeout in seconds."
          },
          "trigger_type": {
            "$ref": "#/components/schemas/MicroCertTriggerType"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the rule was last updated."
          }
        }
      },
      "TriggerRuleSummary": {
        "type": "object",
        "description": "Trigger rule summary for display.",
        "required": [
          "id",
          "name",
          "trigger_type"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Rule ID."
          },
          "name": {
            "type": "string",
            "description": "Rule name."
          },
          "trigger_type": {
            "$ref": "#/components/schemas/MicroCertTriggerType"
          }
        }
      },
      "TriggerSyncResponse": {
        "type": "object",
        "description": "Response for a triggered sync/reconciliation.",
        "required": [
          "sync_run_id",
          "status",
          "message"
        ],
        "properties": {
          "message": {
            "type": "string"
          },
          "status": {
            "type": "string"
          },
          "sync_run_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "UpdateAgentRequest": {
        "type": "object",
        "description": "Request to update an AI agent.",
        "properties": {
          "backup_owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Updated backup owner ID (F108).",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "Updated expiration date.",
            "nullable": true
          },
          "inactivity_threshold_days": {
            "type": "integer",
            "format": "int32",
            "description": "Updated inactivity threshold in days (F108).",
            "nullable": true
          },
          "max_token_lifetime_secs": {
            "type": "integer",
            "format": "int32",
            "description": "Updated max token lifetime.",
            "nullable": true
          },
          "model_name": {
            "type": "string",
            "description": "Updated model name.",
            "nullable": true
          },
          "model_provider": {
            "type": "string",
            "description": "Updated model provider.",
            "nullable": true
          },
          "model_version": {
            "type": "string",
            "description": "Updated model version.",
            "nullable": true
          },
          "requires_human_approval": {
            "type": "boolean",
            "description": "Updated human approval requirement.",
            "nullable": true
          },
          "risk_level": {
            "type": "string",
            "description": "Updated risk level.",
            "nullable": true
          },
          "rotation_interval_days": {
            "type": "integer",
            "format": "int32",
            "description": "Updated rotation interval in days (F108).",
            "nullable": true
          }
        }
      },
      "UpdateApplicationRequest": {
        "type": "object",
        "description": "Request to update an application.",
        "properties": {
          "description": {
            "type": "string",
            "description": "Application description.",
            "nullable": true
          },
          "external_id": {
            "type": "string",
            "description": "External system reference ID.",
            "nullable": true
          },
          "is_delegable": {
            "type": "boolean",
            "description": "Whether entitlements in this application can be delegated.",
            "nullable": true
          },
          "metadata": {
            "description": "Extensible metadata as JSON.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Application display name.",
            "nullable": true
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Application owner (user ID).",
            "nullable": true
          },
          "status": {
            "allOf": [
              {
                "$ref": "#/components/schemas/GovAppStatus"
              }
            ],
            "nullable": true
          }
        }
      },
      "UpdateApprovalGroupRequest": {
        "type": "object",
        "description": "Request to update an existing approval group.",
        "properties": {
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the group is active.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated display name.",
            "nullable": true
          }
        }
      },
      "UpdateApprovalWorkflowRequest": {
        "type": "object",
        "description": "Request to update an existing workflow.",
        "properties": {
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the workflow is active.",
            "nullable": true
          },
          "is_default": {
            "type": "boolean",
            "description": "Whether this should be the default workflow.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated display name.",
            "nullable": true
          },
          "steps": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateApprovalStepRequest"
            },
            "description": "Updated steps (replaces all existing steps if provided).",
            "nullable": true
          }
        }
      },
      "UpdateArchetypeRequest": {
        "type": "object",
        "description": "Request to update a persona archetype.",
        "properties": {
          "attribute_mappings": {
            "allOf": [
              {
                "$ref": "#/components/schemas/AttributeMappingsRequest"
              }
            ],
            "nullable": true
          },
          "default_entitlements": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DefaultEntitlementRequest"
            },
            "description": "Updated default entitlements.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether archetype is active.",
            "nullable": true
          },
          "lifecycle_policy": {
            "allOf": [
              {
                "$ref": "#/components/schemas/LifecyclePolicyRequest"
              }
            ],
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated name.",
            "nullable": true
          },
          "naming_pattern": {
            "type": "string",
            "description": "Updated naming pattern.",
            "nullable": true
          }
        }
      },
      "UpdateAssignmentParametersRequest": {
        "type": "object",
        "description": "Request to update assignment parameters.",
        "required": [
          "parameters"
        ],
        "properties": {
          "parameters": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ParameterValueRequest"
            },
            "description": "Updated parameter values."
          }
        }
      },
      "UpdateAttributeDefinitionRequest": {
        "type": "object",
        "description": "Request to update an existing attribute definition.",
        "properties": {
          "default_value": {
            "description": "Updated default value. Pass `null` to clear.",
            "nullable": true
          },
          "display_label": {
            "type": "string",
            "description": "Updated display label.",
            "nullable": true
          },
          "is_active": {
            "type": "boolean",
            "description": "Updated active status (set to false to soft-delete).",
            "nullable": true
          },
          "required": {
            "type": "boolean",
            "description": "Updated required flag.",
            "nullable": true
          },
          "sort_order": {
            "type": "integer",
            "format": "int32",
            "description": "Updated display ordering.",
            "nullable": true
          },
          "validation_rules": {
            "description": "Updated validation rules. Pass `null` to clear.",
            "nullable": true
          }
        }
      },
      "UpdateBatchSimulationNotesRequest": {
        "type": "object",
        "description": "Request to update simulation notes.",
        "properties": {
          "notes": {
            "type": "string",
            "description": "Notes/comments on the simulation (null to clear).",
            "nullable": true
          }
        }
      },
      "UpdateBindingRequest": {
        "type": "object",
        "description": "Request to update an existing hook binding.",
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Whether the binding is enabled.",
            "nullable": true
          },
          "execution_order": {
            "type": "integer",
            "format": "int32",
            "description": "Updated execution order.",
            "nullable": true
          },
          "failure_policy": {
            "type": "string",
            "description": "Updated failure policy.",
            "nullable": true
          },
          "max_retries": {
            "type": "integer",
            "format": "int32",
            "description": "Updated max retries.",
            "nullable": true
          },
          "timeout_seconds": {
            "type": "integer",
            "format": "int32",
            "description": "Updated timeout in seconds.",
            "nullable": true
          }
        }
      },
      "UpdateBirthrightPolicyRequest": {
        "type": "object",
        "description": "Request to update an existing birthright policy.",
        "properties": {
          "conditions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PolicyConditionRequest"
            },
            "description": "Conditions that must ALL match.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Policy description.",
            "nullable": true
          },
          "entitlement_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Entitlement IDs to grant.",
            "nullable": true
          },
          "evaluation_mode": {
            "allOf": [
              {
                "$ref": "#/components/schemas/EvaluationMode"
              }
            ],
            "nullable": true
          },
          "grace_period_days": {
            "type": "integer",
            "format": "int32",
            "description": "Grace period in days.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Policy display name.",
            "nullable": true
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority for evaluation.",
            "nullable": true
          }
        }
      },
      "UpdateBrandingRequest": {
        "type": "object",
        "description": "Request to update tenant branding.",
        "properties": {
          "accent_color": {
            "type": "string",
            "nullable": true
          },
          "background_color": {
            "type": "string",
            "nullable": true
          },
          "custom_css": {
            "type": "string",
            "nullable": true
          },
          "email_logo_url": {
            "type": "string",
            "nullable": true
          },
          "favicon_url": {
            "type": "string",
            "nullable": true
          },
          "font_family": {
            "type": "string",
            "nullable": true
          },
          "footer_text": {
            "type": "string",
            "nullable": true
          },
          "login_page_background_url": {
            "type": "string",
            "nullable": true
          },
          "login_page_subtitle": {
            "type": "string",
            "nullable": true
          },
          "login_page_title": {
            "type": "string",
            "nullable": true
          },
          "logo_dark_url": {
            "type": "string",
            "nullable": true
          },
          "logo_url": {
            "type": "string",
            "nullable": true
          },
          "primary_color": {
            "type": "string",
            "nullable": true
          },
          "privacy_policy_url": {
            "type": "string",
            "nullable": true
          },
          "secondary_color": {
            "type": "string",
            "nullable": true
          },
          "support_url": {
            "type": "string",
            "nullable": true
          },
          "terms_of_service_url": {
            "type": "string",
            "nullable": true
          },
          "text_color": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "UpdateCampaignRequest": {
        "type": "object",
        "description": "Request to update a certification campaign (only allowed in draft status).",
        "properties": {
          "deadline": {
            "type": "string",
            "format": "date-time",
            "description": "Campaign deadline (must be in the future).",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Campaign description.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Campaign display name.",
            "nullable": true
          }
        }
      },
      "UpdateClientRequest": {
        "type": "object",
        "description": "Request to update an `OAuth2` client.",
        "properties": {
          "grant_types": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Allowed grant types.",
            "nullable": true
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the client is active.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Human-readable client name.",
            "nullable": true
          },
          "redirect_uris": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Allowed redirect URIs.",
            "nullable": true
          },
          "scopes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Allowed scopes.",
            "nullable": true
          }
        }
      },
      "UpdateConnectorRequest": {
        "type": "object",
        "description": "Request to update a connector.",
        "properties": {
          "config": {
            "description": "Updated configuration.",
            "nullable": true
          },
          "credentials": {
            "description": "Updated credentials (will be encrypted).",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "New description.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "New display name.",
            "nullable": true
          }
        }
      },
      "UpdateCorrelationRuleRequest": {
        "type": "object",
        "description": "Request to update an existing correlation rule.",
        "properties": {
          "algorithm": {
            "type": "string",
            "description": "Updated matching algorithm.",
            "nullable": true
          },
          "expression": {
            "type": "string",
            "description": "Updated custom expression.",
            "nullable": true
          },
          "is_active": {
            "type": "boolean",
            "description": "Updated active status.",
            "nullable": true
          },
          "is_definitive": {
            "type": "boolean",
            "description": "Updated definitive match flag.",
            "nullable": true
          },
          "match_type": {
            "type": "string",
            "description": "Updated match type.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated display name.",
            "nullable": true
          },
          "normalize": {
            "type": "boolean",
            "description": "Updated normalization flag.",
            "nullable": true
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Updated priority.",
            "nullable": true
          },
          "source_attribute": {
            "type": "string",
            "description": "Updated source attribute.",
            "nullable": true
          },
          "target_attribute": {
            "type": "string",
            "description": "Updated target attribute.",
            "nullable": true
          },
          "threshold": {
            "type": "number",
            "format": "double",
            "description": "Updated similarity threshold.",
            "nullable": true
          },
          "tier": {
            "type": "integer",
            "format": "int32",
            "description": "Updated evaluation tier.",
            "nullable": true
          },
          "weight": {
            "type": "number",
            "format": "double",
            "description": "Updated weight.",
            "nullable": true
          }
        }
      },
      "UpdateCredentialRequest": {
        "type": "object",
        "description": "Request to update a credential (rename).",
        "required": [
          "name"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "New name for the credential (1-100 characters).",
            "example": "Office YubiKey"
          }
        }
      },
      "UpdateCredentialResponse": {
        "type": "object",
        "description": "Response after credential update.",
        "required": [
          "credential",
          "message"
        ],
        "properties": {
          "credential": {
            "$ref": "#/components/schemas/CredentialInfo"
          },
          "message": {
            "type": "string",
            "description": "Success message."
          }
        }
      },
      "UpdateDetectionRuleRequest": {
        "type": "object",
        "description": "Request to update a detection rule.",
        "properties": {
          "description": {
            "type": "string",
            "description": "Human-readable description.",
            "nullable": true
          },
          "is_enabled": {
            "type": "boolean",
            "description": "Whether this rule is enabled.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "New name for the rule.",
            "nullable": true
          },
          "parameters": {
            "description": "Rule-specific parameters.",
            "nullable": true
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Priority for rule execution.",
            "nullable": true
          }
        }
      },
      "UpdateEmailTemplateRequest": {
        "type": "object",
        "description": "Request to update an email template.",
        "properties": {
          "body_html": {
            "type": "string",
            "nullable": true
          },
          "body_text": {
            "type": "string",
            "nullable": true
          },
          "is_active": {
            "type": "boolean",
            "nullable": true
          },
          "locale": {
            "type": "string",
            "nullable": true
          },
          "subject": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "UpdateEntitlementRequest": {
        "type": "object",
        "description": "Request to update an entitlement.",
        "properties": {
          "data_controller": {
            "type": "string",
            "description": "Name of the data controller organization.",
            "nullable": true
          },
          "data_processor": {
            "type": "string",
            "description": "Name of the data processor organization.",
            "nullable": true
          },
          "data_protection_classification": {
            "allOf": [
              {
                "$ref": "#/components/schemas/DataProtectionClassification"
              }
            ],
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Entitlement description.",
            "nullable": true
          },
          "external_id": {
            "type": "string",
            "description": "External system reference ID.",
            "nullable": true
          },
          "is_delegable": {
            "type": "boolean",
            "description": "Whether this entitlement can be delegated.",
            "nullable": true
          },
          "legal_basis": {
            "allOf": [
              {
                "$ref": "#/components/schemas/GdprLegalBasis"
              }
            ],
            "nullable": true
          },
          "metadata": {
            "description": "Extensible metadata as JSON.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Entitlement display name.",
            "nullable": true
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Entitlement owner (user ID).",
            "nullable": true
          },
          "purposes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Processing purpose labels.",
            "nullable": true
          },
          "retention_period_days": {
            "type": "integer",
            "format": "int32",
            "description": "Data retention period in days. Must be positive if set.",
            "nullable": true
          },
          "risk_level": {
            "allOf": [
              {
                "$ref": "#/components/schemas/GovRiskLevel"
              }
            ],
            "nullable": true
          },
          "status": {
            "allOf": [
              {
                "$ref": "#/components/schemas/GovEntitlementStatus"
              }
            ],
            "nullable": true
          }
        }
      },
      "UpdateEscalationPolicyRequest": {
        "type": "object",
        "description": "Request to update an existing escalation policy.",
        "properties": {
          "default_timeout_secs": {
            "type": "integer",
            "format": "int64",
            "description": "Updated default timeout in seconds.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "final_fallback": {
            "allOf": [
              {
                "$ref": "#/components/schemas/FinalFallbackAction"
              }
            ],
            "nullable": true
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the policy is active.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated display name.",
            "nullable": true
          },
          "warning_threshold_secs": {
            "type": "integer",
            "format": "int64",
            "description": "Updated warning threshold in seconds.",
            "nullable": true
          }
        }
      },
      "UpdateIdentityProviderRequest": {
        "type": "object",
        "description": "Request to update an identity provider.",
        "properties": {
          "claim_mapping": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ClaimMappingConfig"
              }
            ],
            "nullable": true
          },
          "client_id": {
            "type": "string",
            "nullable": true
          },
          "client_secret": {
            "type": "string",
            "description": "Only include to update the secret.",
            "nullable": true
          },
          "issuer_url": {
            "type": "string",
            "nullable": true
          },
          "name": {
            "type": "string",
            "nullable": true
          },
          "scopes": {
            "type": "string",
            "nullable": true
          },
          "sync_on_login": {
            "type": "boolean",
            "nullable": true
          }
        }
      },
      "UpdateIpRuleRequest": {
        "type": "object",
        "description": "Request for PUT /admin/ip-restrictions/rules/:id.",
        "properties": {
          "description": {
            "type": "string",
            "description": "New description (optional, use null to clear).",
            "nullable": true
          },
          "ip_cidr": {
            "type": "string",
            "description": "New IP CIDR (optional).",
            "nullable": true
          },
          "is_active": {
            "type": "boolean",
            "description": "New active status (optional).",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "New name (optional).",
            "nullable": true
          },
          "rule_type": {
            "allOf": [
              {
                "$ref": "#/components/schemas/IpRuleType"
              }
            ],
            "nullable": true
          },
          "scope": {
            "type": "string",
            "description": "New target scope (optional).",
            "nullable": true
          }
        }
      },
      "UpdateIpSettingsRequest": {
        "type": "object",
        "description": "Request for PUT /admin/ip-restrictions/settings.",
        "properties": {
          "bypass_for_super_admin": {
            "type": "boolean",
            "description": "New bypass setting for super admins (optional).",
            "nullable": true
          },
          "enforcement_mode": {
            "allOf": [
              {
                "$ref": "#/components/schemas/IpEnforcementMode"
              }
            ],
            "nullable": true
          }
        }
      },
      "UpdateLicensePoolRequest": {
        "type": "object",
        "description": "Request to update an existing license pool.",
        "properties": {
          "billing_period": {
            "allOf": [
              {
                "$ref": "#/components/schemas/LicenseBillingPeriod"
              }
            ],
            "nullable": true
          },
          "cost_per_license": {
            "allOf": [
              {
                "$ref": "#/components/schemas/Decimal"
              }
            ],
            "nullable": true
          },
          "currency": {
            "type": "string",
            "description": "Updated currency.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "expiration_date": {
            "type": "string",
            "format": "date-time",
            "description": "Updated expiration date.",
            "nullable": true
          },
          "expiration_policy": {
            "allOf": [
              {
                "$ref": "#/components/schemas/LicenseExpirationPolicy"
              }
            ],
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated name.",
            "nullable": true
          },
          "total_capacity": {
            "type": "integer",
            "format": "int32",
            "description": "Updated total capacity.",
            "nullable": true
          },
          "vendor": {
            "type": "string",
            "description": "Updated vendor.",
            "nullable": true
          },
          "warning_days": {
            "type": "integer",
            "format": "int32",
            "description": "Updated warning days.",
            "nullable": true
          }
        }
      },
      "UpdateMergePolicyRequest": {
        "type": "object",
        "description": "Request to update a merge policy.",
        "properties": {
          "null_handling": {
            "allOf": [
              {
                "$ref": "#/components/schemas/TemplateNullHandling"
              }
            ],
            "nullable": true
          },
          "source_precedence": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Updated source precedence.",
            "nullable": true
          },
          "strategy": {
            "allOf": [
              {
                "$ref": "#/components/schemas/TemplateMergeStrategy"
              }
            ],
            "nullable": true
          }
        }
      },
      "UpdateMetaRoleConstraintRequest": {
        "type": "object",
        "description": "Request to update a constraint value.",
        "required": [
          "constraint_value"
        ],
        "properties": {
          "constraint_value": {
            "description": "Updated constraint value."
          }
        }
      },
      "UpdateMetaRoleRequest": {
        "type": "object",
        "description": "Request to update an existing meta-role.",
        "properties": {
          "criteria_logic": {
            "allOf": [
              {
                "$ref": "#/components/schemas/CriteriaLogic"
              }
            ],
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated display name.",
            "nullable": true
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Updated priority.",
            "nullable": true
          }
        }
      },
      "UpdateNhiRequest": {
        "type": "object",
        "description": "Request to update an NHI.",
        "properties": {
          "backup_owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "New backup owner.",
            "nullable": true
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "New expiration date.",
            "nullable": true
          },
          "inactivity_threshold_days": {
            "type": "integer",
            "format": "int32",
            "description": "New inactivity threshold in days.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "New name for the NHI.",
            "nullable": true
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "New primary owner.",
            "nullable": true
          },
          "purpose": {
            "type": "string",
            "description": "New purpose/justification.",
            "nullable": true
          },
          "rotation_interval_days": {
            "type": "integer",
            "format": "int32",
            "description": "New rotation interval in days.",
            "nullable": true
          }
        }
      },
      "UpdateOutlierConfigRequest": {
        "type": "object",
        "description": "Request to update outlier detection configuration.",
        "properties": {
          "confidence_threshold": {
            "type": "number",
            "format": "double",
            "description": "Z-score threshold for outlier classification (0.0-5.0).",
            "nullable": true
          },
          "frequency_threshold": {
            "type": "number",
            "format": "double",
            "description": "Minimum frequency for a role to be considered \"normal\" (0.0-1.0).",
            "nullable": true
          },
          "is_enabled": {
            "type": "boolean",
            "description": "Whether outlier detection is enabled.",
            "nullable": true
          },
          "min_peer_group_size": {
            "type": "integer",
            "format": "int32",
            "description": "Minimum users in peer group for statistical validity (2-100).",
            "nullable": true
          },
          "retention_days": {
            "type": "integer",
            "format": "int32",
            "description": "Days to retain analysis results (30-3650).",
            "nullable": true
          },
          "schedule_cron": {
            "type": "string",
            "description": "Cron expression for scheduled analysis (null to disable).",
            "nullable": true
          },
          "scoring_weights": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ScoringWeights"
              }
            ],
            "nullable": true
          }
        }
      },
      "UpdatePasswordlessPolicyRequest": {
        "type": "object",
        "description": "Request to update tenant passwordless policy.",
        "required": [
          "enabled_methods",
          "magic_link_expiry_minutes",
          "otp_expiry_minutes",
          "otp_max_attempts",
          "require_mfa_after_passwordless"
        ],
        "properties": {
          "enabled_methods": {
            "type": "string",
            "description": "Which passwordless methods are enabled.\nValid values: \"disabled\", \"`magic_link_only`\", \"`otp_only`\", \"`all_methods`\"."
          },
          "magic_link_expiry_minutes": {
            "type": "integer",
            "format": "int32",
            "description": "Magic link expiry in minutes (must be > 0)."
          },
          "otp_expiry_minutes": {
            "type": "integer",
            "format": "int32",
            "description": "OTP expiry in minutes (must be > 0)."
          },
          "otp_max_attempts": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum OTP verification attempts (must be > 0)."
          },
          "require_mfa_after_passwordless": {
            "type": "boolean",
            "description": "Whether MFA is required after passwordless authentication."
          }
        }
      },
      "UpdatePersonaRequest": {
        "type": "object",
        "description": "Request to update a persona.",
        "properties": {
          "attribute_overrides": {
            "type": "object",
            "description": "Updated attribute overrides.",
            "additionalProperties": {},
            "nullable": true
          },
          "display_name": {
            "type": "string",
            "description": "Updated display name.",
            "nullable": true
          },
          "valid_until": {
            "type": "string",
            "format": "date-time",
            "description": "Updated expiration date.",
            "nullable": true
          }
        }
      },
      "UpdateProviderRequest": {
        "type": "object",
        "description": "Request for updating a tenant provider configuration.",
        "required": [
          "enabled",
          "client_id"
        ],
        "properties": {
          "additional_config": {
            "nullable": true
          },
          "client_id": {
            "type": "string"
          },
          "client_secret": {
            "type": "string",
            "description": "Only required when enabling or changing.",
            "nullable": true
          },
          "enabled": {
            "type": "boolean"
          },
          "scopes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "nullable": true
          }
        }
      },
      "UpdateReclamationRuleRequest": {
        "type": "object",
        "description": "Request to update a reclamation rule.",
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Whether the rule is enabled.",
            "nullable": true
          },
          "lifecycle_state": {
            "type": "string",
            "description": "Updated lifecycle state.",
            "nullable": true
          },
          "notification_days_before": {
            "type": "integer",
            "format": "int32",
            "description": "Updated notification days.",
            "nullable": true
          },
          "threshold_days": {
            "type": "integer",
            "format": "int32",
            "description": "Updated threshold days.",
            "nullable": true
          }
        }
      },
      "UpdateReportScheduleRequest": {
        "type": "object",
        "description": "Request to update a report schedule.",
        "properties": {
          "frequency": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ScheduleFrequency"
              }
            ],
            "nullable": true
          },
          "name": {
            "type": "string",
            "nullable": true
          },
          "output_format": {
            "allOf": [
              {
                "$ref": "#/components/schemas/OutputFormat"
              }
            ],
            "nullable": true
          },
          "parameters": {
            "nullable": true
          },
          "recipients": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "nullable": true
          },
          "schedule_day_of_month": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "schedule_day_of_week": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "schedule_hour": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          }
        }
      },
      "UpdateReportTemplateRequest": {
        "type": "object",
        "description": "Request to update a report template.",
        "properties": {
          "definition": {
            "allOf": [
              {
                "$ref": "#/components/schemas/TemplateDefinition"
              }
            ],
            "nullable": true
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "name": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "UpdateRiskFactorRequest": {
        "type": "object",
        "description": "Request to update an existing risk factor.",
        "properties": {
          "category": {
            "allOf": [
              {
                "$ref": "#/components/schemas/RiskFactorCategory"
              }
            ],
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "factor_type": {
            "type": "string",
            "description": "Updated factor type.",
            "nullable": true
          },
          "is_enabled": {
            "type": "boolean",
            "description": "Updated enabled status.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated display name.",
            "nullable": true
          },
          "weight": {
            "type": "number",
            "format": "double",
            "description": "Updated weight (0.0-10.0).",
            "nullable": true
          }
        }
      },
      "UpdateRoleParameterRequest": {
        "type": "object",
        "description": "Request to update a role parameter.",
        "properties": {
          "constraints": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ParameterConstraintsRequest"
              }
            ],
            "nullable": true
          },
          "default_value": {
            "description": "Updated default value.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "display_name": {
            "type": "string",
            "description": "Updated display name.",
            "nullable": true
          },
          "display_order": {
            "type": "integer",
            "format": "int32",
            "description": "Updated display order.",
            "nullable": true
          },
          "is_required": {
            "type": "boolean",
            "description": "Updated required flag.",
            "nullable": true
          }
        }
      },
      "UpdateRoleTemplateRequest": {
        "type": "object",
        "description": "Update role template request.",
        "properties": {
          "description": {
            "type": "string",
            "nullable": true
          },
          "name": {
            "type": "string",
            "nullable": true
          },
          "permissions": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "nullable": true
          }
        }
      },
      "UpdateRuleRequest": {
        "type": "object",
        "description": "Request to update a template rule.",
        "properties": {
          "authoritative": {
            "type": "boolean",
            "description": "Updated authoritative flag.",
            "nullable": true
          },
          "condition": {
            "type": "string",
            "description": "Updated condition.",
            "nullable": true
          },
          "error_message": {
            "type": "string",
            "description": "Updated error message.",
            "nullable": true
          },
          "exclusive": {
            "type": "boolean",
            "description": "Updated exclusive flag.",
            "nullable": true
          },
          "expression": {
            "type": "string",
            "description": "Updated expression.",
            "nullable": true
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Updated priority.",
            "nullable": true
          },
          "strength": {
            "allOf": [
              {
                "$ref": "#/components/schemas/TemplateStrength"
              }
            ],
            "nullable": true
          },
          "time_from": {
            "type": "string",
            "format": "date-time",
            "description": "Updated `time_from` constraint.",
            "nullable": true
          },
          "time_reference": {
            "allOf": [
              {
                "$ref": "#/components/schemas/TemplateTimeReference"
              }
            ],
            "nullable": true
          },
          "time_to": {
            "type": "string",
            "format": "date-time",
            "description": "Updated `time_to` constraint.",
            "nullable": true
          }
        }
      },
      "UpdateScimTargetRequest": {
        "type": "object",
        "description": "Request to update a SCIM target.",
        "properties": {
          "auth_method": {
            "type": "string",
            "nullable": true
          },
          "base_url": {
            "type": "string",
            "nullable": true
          },
          "credentials": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ScimCredentials"
              }
            ],
            "nullable": true
          },
          "deprovisioning_strategy": {
            "type": "string",
            "nullable": true
          },
          "max_retries": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "name": {
            "type": "string",
            "nullable": true
          },
          "rate_limit_per_minute": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "request_timeout_secs": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "tls_verify": {
            "type": "boolean",
            "nullable": true
          }
        }
      },
      "UpdateScriptBodyRequest": {
        "type": "object",
        "description": "Request to update a script's body (creates a new version).",
        "required": [
          "script_body"
        ],
        "properties": {
          "change_description": {
            "type": "string",
            "description": "Optional description of what changed in this version.",
            "nullable": true
          },
          "script_body": {
            "type": "string",
            "description": "The new script body content."
          }
        }
      },
      "UpdateScriptRequest": {
        "type": "object",
        "description": "Request to update an existing provisioning script metadata.",
        "properties": {
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated name.",
            "nullable": true
          }
        }
      },
      "UpdateServiceProviderRequest": {
        "type": "object",
        "description": "Request to update a Service Provider",
        "properties": {
          "acs_urls": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "nullable": true
          },
          "assertion_validity_seconds": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "attribute_mapping": {
            "nullable": true
          },
          "certificate": {
            "type": "string",
            "nullable": true
          },
          "enabled": {
            "type": "boolean",
            "nullable": true
          },
          "metadata_url": {
            "type": "string",
            "nullable": true
          },
          "name": {
            "type": "string",
            "nullable": true
          },
          "name_id_format": {
            "type": "string",
            "nullable": true
          },
          "sign_assertions": {
            "type": "boolean",
            "nullable": true
          },
          "validate_signatures": {
            "type": "boolean",
            "nullable": true
          }
        }
      },
      "UpdateSiemDestinationRequest": {
        "type": "object",
        "description": "Request to update a SIEM destination.",
        "properties": {
          "auth_config_b64": {
            "type": "string",
            "nullable": true
          },
          "circuit_breaker_cooldown_secs": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "circuit_breaker_threshold": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "enabled": {
            "type": "boolean",
            "nullable": true
          },
          "endpoint_host": {
            "type": "string",
            "nullable": true
          },
          "endpoint_port": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "event_type_filter": {
            "nullable": true
          },
          "export_format": {
            "type": "string",
            "nullable": true
          },
          "name": {
            "type": "string",
            "nullable": true
          },
          "queue_buffer_size": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "rate_limit_per_second": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "splunk_ack_enabled": {
            "type": "boolean",
            "nullable": true
          },
          "splunk_index": {
            "type": "string",
            "nullable": true
          },
          "splunk_source": {
            "type": "string",
            "nullable": true
          },
          "splunk_sourcetype": {
            "type": "string",
            "nullable": true
          },
          "syslog_facility": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "tls_verify_cert": {
            "type": "boolean",
            "nullable": true
          }
        }
      },
      "UpdateSlaPolicyRequest": {
        "type": "object",
        "description": "Request to update an SLA policy.",
        "properties": {
          "breach_notification_enabled": {
            "type": "boolean",
            "description": "Updated breach notification setting.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "escalation_contacts": {
            "description": "Updated escalation contacts.",
            "nullable": true
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the policy is active.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated name.",
            "nullable": true
          },
          "target_duration_seconds": {
            "type": "integer",
            "format": "int32",
            "description": "Updated target duration in seconds.",
            "nullable": true
          },
          "warning_threshold_percent": {
            "type": "integer",
            "format": "int32",
            "description": "Updated warning threshold.",
            "nullable": true
          }
        }
      },
      "UpdateSodRuleRequest": {
        "type": "object",
        "description": "Request to update an existing `SoD` rule.",
        "properties": {
          "business_rationale": {
            "type": "string",
            "description": "Updated business rationale.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated display name.",
            "nullable": true
          },
          "severity": {
            "allOf": [
              {
                "$ref": "#/components/schemas/GovSodSeverity"
              }
            ],
            "nullable": true
          }
        }
      },
      "UpdateSyncConfigRequest": {
        "type": "object",
        "description": "Request to update sync configuration.",
        "properties": {
          "batch_size": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "conflict_resolution": {
            "type": "string",
            "nullable": true
          },
          "enabled": {
            "type": "boolean",
            "nullable": true
          },
          "polling_interval_secs": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "rate_limit_per_minute": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "sync_mode": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "UpdateTemplateRequest": {
        "type": "object",
        "description": "Request to update an existing script template.",
        "properties": {
          "category": {
            "type": "string",
            "description": "Updated category.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated name.",
            "nullable": true
          },
          "placeholder_annotations": {
            "description": "Updated placeholder annotations.",
            "nullable": true
          },
          "template_body": {
            "type": "string",
            "description": "Updated template body.",
            "nullable": true
          }
        }
      },
      "UpdateTicketingConfigurationRequest": {
        "type": "object",
        "description": "Request to update a ticketing configuration.",
        "properties": {
          "credentials": {
            "type": "string",
            "description": "Updated credentials.",
            "nullable": true
          },
          "default_assignee": {
            "type": "string",
            "description": "Updated default assignee.",
            "nullable": true
          },
          "default_assignment_group": {
            "type": "string",
            "description": "Updated assignment group.",
            "nullable": true
          },
          "endpoint_url": {
            "type": "string",
            "description": "Updated API endpoint URL.",
            "nullable": true
          },
          "field_mappings": {
            "description": "Updated field mappings.",
            "nullable": true
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the configuration is active.",
            "nullable": true
          },
          "issue_type": {
            "type": "string",
            "description": "Updated issue type.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated name.",
            "nullable": true
          },
          "polling_interval_seconds": {
            "type": "integer",
            "format": "int32",
            "description": "Updated polling interval.",
            "nullable": true
          },
          "project_key": {
            "type": "string",
            "description": "Updated project key.",
            "nullable": true
          }
        }
      },
      "UpdateToolRequest": {
        "type": "object",
        "description": "Request to update an existing tool.",
        "properties": {
          "category": {
            "type": "string",
            "description": "Updated category.",
            "nullable": true
          },
          "description": {
            "type": "string",
            "description": "Updated description.",
            "nullable": true
          },
          "input_schema": {
            "description": "Updated input schema.",
            "nullable": true
          },
          "max_calls_per_hour": {
            "type": "integer",
            "format": "int32",
            "description": "Updated max calls per hour.",
            "nullable": true
          },
          "output_schema": {
            "description": "Updated output schema.",
            "nullable": true
          },
          "provider": {
            "type": "string",
            "description": "Updated provider.",
            "nullable": true
          },
          "requires_approval": {
            "type": "boolean",
            "description": "Updated approval requirement.",
            "nullable": true
          },
          "risk_level": {
            "type": "string",
            "description": "Updated risk level.",
            "nullable": true
          },
          "status": {
            "type": "string",
            "description": "Updated status.",
            "nullable": true
          }
        }
      },
      "UpdateTriggerRuleRequest": {
        "type": "object",
        "description": "Request to update an existing trigger rule.",
        "properties": {
          "auto_revoke": {
            "type": "boolean",
            "description": "Updated auto-revoke setting.",
            "nullable": true
          },
          "fallback_reviewer_id": {
            "type": "string",
            "format": "uuid",
            "description": "Updated fallback reviewer.",
            "nullable": true
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the rule is active.",
            "nullable": true
          },
          "is_default": {
            "type": "boolean",
            "description": "Whether this is the default rule for trigger type.",
            "nullable": true
          },
          "metadata": {
            "description": "Updated metadata.",
            "nullable": true
          },
          "name": {
            "type": "string",
            "description": "Updated display name.",
            "nullable": true
          },
          "priority": {
            "type": "integer",
            "format": "int32",
            "description": "Updated priority.",
            "nullable": true
          },
          "reminder_threshold_percent": {
            "type": "integer",
            "format": "int32",
            "description": "Updated reminder threshold percent.",
            "nullable": true
          },
          "reviewer_type": {
            "allOf": [
              {
                "$ref": "#/components/schemas/MicroCertReviewerType"
              }
            ],
            "nullable": true
          },
          "revoke_triggering_assignment": {
            "type": "boolean",
            "description": "Updated revoke triggering assignment setting.",
            "nullable": true
          },
          "scope_id": {
            "type": "string",
            "format": "uuid",
            "description": "Updated scope ID.",
            "nullable": true
          },
          "scope_type": {
            "allOf": [
              {
                "$ref": "#/components/schemas/MicroCertScopeType"
              }
            ],
            "nullable": true
          },
          "specific_reviewer_id": {
            "type": "string",
            "format": "uuid",
            "description": "Updated specific reviewer.",
            "nullable": true
          },
          "timeout_secs": {
            "type": "integer",
            "format": "int32",
            "description": "Updated timeout in seconds.",
            "nullable": true
          }
        }
      },
      "UpdateUserRequest": {
        "type": "object",
        "description": "Request to update an existing user.",
        "properties": {
          "email": {
            "type": "string",
            "description": "New email address (optional).",
            "nullable": true
          },
          "is_active": {
            "type": "boolean",
            "description": "New active status (optional).",
            "nullable": true
          },
          "roles": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "New roles (optional, replaces all existing roles).",
            "nullable": true
          },
          "username": {
            "type": "string",
            "description": "New username (optional, 3-64 chars, alphanumeric + underscore + hyphen, starts with letter).",
            "nullable": true
          }
        }
      },
      "UpdateWebAuthnPolicyRequest": {
        "type": "object",
        "description": "Request to update `WebAuthn` policy.",
        "properties": {
          "allowed_authenticator_types": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Allowed authenticator types.",
            "nullable": true
          },
          "max_credentials_per_user": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum credentials per user.",
            "nullable": true
          },
          "require_attestation": {
            "type": "boolean",
            "description": "Whether attestation is required.",
            "nullable": true
          },
          "user_verification": {
            "type": "string",
            "description": "User verification requirement.",
            "nullable": true
          },
          "webauthn_enabled": {
            "type": "boolean",
            "description": "Whether `WebAuthn` is enabled.",
            "nullable": true
          }
        }
      },
      "UpdateWebhookSubscriptionRequest": {
        "type": "object",
        "description": "Request body for updating a webhook subscription.",
        "properties": {
          "description": {
            "type": "string",
            "nullable": true
          },
          "enabled": {
            "type": "boolean",
            "nullable": true
          },
          "event_types": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "nullable": true
          },
          "name": {
            "type": "string",
            "nullable": true
          },
          "secret": {
            "type": "string",
            "nullable": true
          },
          "url": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "UploadCertificateRequest": {
        "type": "object",
        "description": "Request to upload a new certificate",
        "required": [
          "certificate",
          "private_key"
        ],
        "properties": {
          "certificate": {
            "type": "string"
          },
          "private_key": {
            "type": "string"
          }
        }
      },
      "UpsertCorrelationThresholdRequest": {
        "type": "object",
        "description": "Request to create or update correlation thresholds for a connector.",
        "properties": {
          "auto_confirm_threshold": {
            "type": "number",
            "format": "double",
            "description": "Confidence score above which matches are auto-confirmed (0.0-1.0).",
            "nullable": true
          },
          "batch_size": {
            "type": "integer",
            "format": "int32",
            "description": "Number of accounts to process per batch.",
            "nullable": true
          },
          "include_deactivated": {
            "type": "boolean",
            "description": "Whether to include deactivated identities in matching.",
            "nullable": true
          },
          "manual_review_threshold": {
            "type": "number",
            "format": "double",
            "description": "Confidence score above which matches go to manual review (0.0-1.0).",
            "nullable": true
          },
          "tuning_mode": {
            "type": "boolean",
            "description": "Whether tuning mode is enabled (logs decisions without acting).",
            "nullable": true
          }
        }
      },
      "UpsertEnforcementPolicyRequest": {
        "type": "object",
        "description": "Request body for creating or updating an enforcement policy.",
        "properties": {
          "enforcement_mode": {
            "type": "string",
            "description": "Enforcement mode: \"disabled\", \"monitor\", or \"enforce\".",
            "nullable": true
          },
          "fail_open": {
            "type": "boolean",
            "description": "Whether to fail-open when risk service is unavailable.",
            "nullable": true
          },
          "impossible_travel_enabled": {
            "type": "boolean",
            "description": "Whether impossible travel detection is enabled.",
            "nullable": true
          },
          "impossible_travel_speed_kmh": {
            "type": "integer",
            "format": "int32",
            "description": "Speed threshold for impossible travel detection (100-2000 km/h).",
            "nullable": true
          }
        }
      },
      "UpsertScheduleRequest": {
        "type": "object",
        "description": "Request to create or update a reconciliation schedule.",
        "required": [
          "frequency"
        ],
        "properties": {
          "day_of_month": {
            "type": "integer",
            "format": "int32",
            "description": "Day of month for monthly schedules (1-28).",
            "nullable": true
          },
          "day_of_week": {
            "type": "integer",
            "format": "int32",
            "description": "Day of week for weekly schedules (0=Sunday, 6=Saturday).",
            "nullable": true
          },
          "frequency": {
            "$ref": "#/components/schemas/ScheduleFrequency"
          },
          "hour_of_day": {
            "type": "integer",
            "format": "int32",
            "description": "Hour of day (0-23) when to run."
          },
          "is_enabled": {
            "type": "boolean",
            "description": "Whether the schedule is enabled."
          }
        }
      },
      "UserCustomAttributesResponse": {
        "type": "object",
        "description": "Response for a user's custom attributes.",
        "required": [
          "user_id",
          "custom_attributes"
        ],
        "properties": {
          "custom_attributes": {
            "description": "The user's custom attributes."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User's unique identifier."
          }
        }
      },
      "UserListResponse": {
        "type": "object",
        "description": "Response for listing users with pagination.",
        "required": [
          "users",
          "pagination"
        ],
        "properties": {
          "pagination": {
            "$ref": "#/components/schemas/PaginationMeta"
          },
          "users": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/UserResponse"
            },
            "description": "List of users."
          }
        }
      },
      "UserMissingAttributes": {
        "type": "object",
        "description": "A user with their missing required attributes.",
        "required": [
          "user_id",
          "email",
          "missing_attributes"
        ],
        "properties": {
          "email": {
            "type": "string",
            "description": "User's email address."
          },
          "missing_attributes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Names of missing required attributes."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User's unique identifier."
          }
        }
      },
      "UserOutlierHistoryResponse": {
        "type": "object",
        "description": "User outlier history response.",
        "required": [
          "user_id",
          "results"
        ],
        "properties": {
          "current_disposition": {
            "allOf": [
              {
                "$ref": "#/components/schemas/DispositionResponse"
              }
            ],
            "nullable": true
          },
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/OutlierResultResponse"
            }
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "UserPeerComparisonResponse": {
        "type": "object",
        "description": "Peer comparison result for a user.",
        "required": [
          "user_id",
          "user_entitlement_count",
          "comparisons",
          "is_outlier"
        ],
        "properties": {
          "comparisons": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PeerGroupComparison"
            },
            "description": "Comparisons with peer groups."
          },
          "is_outlier": {
            "type": "boolean",
            "description": "Whether user is an outlier in any group."
          },
          "user_entitlement_count": {
            "type": "integer",
            "format": "int32",
            "description": "User's entitlement count."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User ID."
          }
        }
      },
      "UserPersonasResponse": {
        "type": "object",
        "description": "User's personas response.",
        "required": [
          "physical_user_id",
          "personas"
        ],
        "properties": {
          "active_persona_id": {
            "type": "string",
            "format": "uuid",
            "description": "Currently active persona in session.",
            "nullable": true
          },
          "personas": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PersonaResponse"
            }
          },
          "physical_user_id": {
            "type": "string",
            "format": "uuid"
          },
          "physical_user_name": {
            "type": "string",
            "nullable": true
          }
        }
      },
      "UserResponse": {
        "type": "object",
        "description": "User information returned in API responses.",
        "required": [
          "id",
          "email",
          "is_active",
          "email_verified",
          "roles",
          "created_at",
          "updated_at",
          "custom_attributes"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the user was created."
          },
          "custom_attributes": {
            "description": "Custom attributes (F070)."
          },
          "email": {
            "type": "string",
            "description": "User's email address."
          },
          "email_verified": {
            "type": "boolean",
            "description": "Whether the email has been verified."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the user."
          },
          "is_active": {
            "type": "boolean",
            "description": "Whether the account is active."
          },
          "lifecycle_state": {
            "allOf": [
              {
                "$ref": "#/components/schemas/LifecycleStateInfo"
              }
            ],
            "nullable": true
          },
          "roles": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Roles assigned to the user."
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the user was last updated."
          }
        }
      },
      "UserRevocationResponse": {
        "type": "object",
        "required": [
          "user_id",
          "tokens_revoked",
          "revoked_at",
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Human-readable status message."
          },
          "revoked_at": {
            "type": "string",
            "description": "ISO 8601 timestamp of when the tokens were revoked."
          },
          "tokens_revoked": {
            "type": "integer",
            "format": "int64",
            "description": "Number of tokens revoked."
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "The user whose tokens were revoked."
          }
        }
      },
      "ValidateExpressionRequest": {
        "type": "object",
        "description": "Request to validate a custom correlation expression.",
        "required": [
          "expression"
        ],
        "properties": {
          "expression": {
            "type": "string",
            "description": "The expression to validate."
          },
          "test_input": {
            "description": "Optional test input data for expression evaluation.",
            "nullable": true
          }
        }
      },
      "ValidateExpressionResponse": {
        "type": "object",
        "description": "Response from expression validation.",
        "required": [
          "valid"
        ],
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message if the expression is invalid.",
            "nullable": true
          },
          "result": {
            "type": "string",
            "description": "Result of evaluating the expression against test input.",
            "nullable": true
          },
          "valid": {
            "type": "boolean",
            "description": "Whether the expression is syntactically valid."
          }
        }
      },
      "ValidateIpRequest": {
        "type": "object",
        "description": "Request for POST /admin/ip-restrictions/validate.",
        "required": [
          "ip_address"
        ],
        "properties": {
          "ip_address": {
            "type": "string",
            "description": "IP address to validate."
          },
          "role": {
            "type": "string",
            "description": "Optional role to check scope rules against.",
            "nullable": true
          }
        }
      },
      "ValidateIpResponse": {
        "type": "object",
        "description": "Response for POST /admin/ip-restrictions/validate.",
        "required": [
          "ip_address",
          "status",
          "enforcement_mode",
          "matching_rules",
          "reason"
        ],
        "properties": {
          "enforcement_mode": {
            "$ref": "#/components/schemas/IpEnforcementMode"
          },
          "ip_address": {
            "type": "string",
            "description": "The IP address that was validated."
          },
          "matching_rules": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MatchingRuleInfo"
            },
            "description": "Rules that matched the IP address."
          },
          "reason": {
            "type": "string",
            "description": "Human-readable reason for the result."
          },
          "status": {
            "type": "string",
            "description": "Validation status: allowed, blocked, or disabled."
          }
        }
      },
      "ValidateParametersRequest": {
        "type": "object",
        "description": "Request to validate parameters before assignment.",
        "required": [
          "parameters"
        ],
        "properties": {
          "parameters": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ParameterValueRequest"
            },
            "description": "Parameter values to validate."
          }
        }
      },
      "ValidateParametersResponse": {
        "type": "object",
        "description": "Parameter validation result.",
        "required": [
          "is_valid",
          "results",
          "errors"
        ],
        "properties": {
          "errors": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Overall errors."
          },
          "is_valid": {
            "type": "boolean",
            "description": "Whether all parameters are valid."
          },
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ParameterValidationResult"
            },
            "description": "Validation results per parameter."
          }
        }
      },
      "ValidateScriptRequest": {
        "type": "object",
        "description": "Request to validate a script body without saving.",
        "required": [
          "script_body"
        ],
        "properties": {
          "script_body": {
            "type": "string",
            "description": "The script body content to validate."
          }
        }
      },
      "ValidationError": {
        "type": "object",
        "description": "Validation error from template application.",
        "required": [
          "rule_id",
          "target_attribute",
          "message",
          "expression"
        ],
        "properties": {
          "expression": {
            "type": "string",
            "description": "Expression that failed."
          },
          "message": {
            "type": "string",
            "description": "Error message."
          },
          "rule_id": {
            "type": "string",
            "format": "uuid",
            "description": "Rule ID that failed."
          },
          "target_attribute": {
            "type": "string",
            "description": "Target attribute."
          }
        }
      },
      "ValidationResponse": {
        "type": "object",
        "description": "Response from script validation.",
        "required": [
          "valid",
          "errors"
        ],
        "properties": {
          "errors": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScriptError"
            },
            "description": "List of validation errors (empty if valid)."
          },
          "valid": {
            "type": "boolean",
            "description": "Whether the script is valid."
          }
        }
      },
      "ValidationResultResponse": {
        "type": "object",
        "description": "Validation result response.",
        "required": [
          "is_valid"
        ],
        "properties": {
          "discovered_endpoints": {
            "allOf": [
              {
                "$ref": "#/components/schemas/DiscoveredEndpointsResponse"
              }
            ],
            "nullable": true
          },
          "error": {
            "type": "string",
            "nullable": true
          },
          "is_valid": {
            "type": "boolean"
          }
        }
      },
      "ValidationRules": {
        "type": "object",
        "description": "Validation rules schema for documentation.",
        "properties": {
          "allowed_values": {
            "type": "array",
            "items": {},
            "description": "Allowed values (string or number type).",
            "nullable": true
          },
          "max": {
            "type": "number",
            "format": "double",
            "description": "Maximum numeric value (number type).",
            "nullable": true
          },
          "max_length": {
            "type": "integer",
            "format": "int64",
            "description": "Maximum string length (string type).",
            "nullable": true,
            "minimum": 0
          },
          "min": {
            "type": "number",
            "format": "double",
            "description": "Minimum numeric value (number type).",
            "nullable": true
          },
          "min_length": {
            "type": "integer",
            "format": "int64",
            "description": "Minimum string length (string type).",
            "nullable": true,
            "minimum": 0
          },
          "pattern": {
            "type": "string",
            "description": "Regex pattern to match (string type).",
            "nullable": true
          }
        }
      },
      "VendorCost": {
        "type": "object",
        "description": "Cost breakdown by vendor.",
        "required": [
          "vendor",
          "pool_count",
          "total_capacity",
          "allocated_count",
          "monthly_cost",
          "currency"
        ],
        "properties": {
          "allocated_count": {
            "type": "integer",
            "format": "int64"
          },
          "currency": {
            "type": "string"
          },
          "monthly_cost": {
            "$ref": "#/components/schemas/Decimal"
          },
          "pool_count": {
            "type": "integer",
            "format": "int64"
          },
          "total_capacity": {
            "type": "integer",
            "format": "int64"
          },
          "vendor": {
            "type": "string"
          }
        }
      },
      "VerifyEmailRequest": {
        "type": "object",
        "description": "Verify email request payload.",
        "required": [
          "token"
        ],
        "properties": {
          "token": {
            "type": "string",
            "description": "Email verification token from email."
          }
        }
      },
      "VerifyEmailResponse": {
        "type": "object",
        "description": "Verify email response payload.",
        "required": [
          "message",
          "already_verified"
        ],
        "properties": {
          "already_verified": {
            "type": "boolean",
            "description": "True if email was already verified (idempotent)."
          },
          "message": {
            "type": "string",
            "description": "Success message."
          }
        }
      },
      "VersionComparisonResponse": {
        "type": "object",
        "description": "Response comparing two script versions.",
        "required": [
          "version_a",
          "version_b",
          "diff_lines"
        ],
        "properties": {
          "diff_lines": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DiffLine"
            },
            "description": "Line-by-line diff between the two versions."
          },
          "version_a": {
            "type": "integer",
            "format": "int32",
            "description": "First version number being compared."
          },
          "version_b": {
            "type": "integer",
            "format": "int32",
            "description": "Second version number being compared."
          }
        }
      },
      "VersionListResponse": {
        "type": "object",
        "description": "Paginated list of versions.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/VersionResponse"
            },
            "description": "List of versions."
          },
          "limit": {
            "type": "integer",
            "format": "int64",
            "description": "Current page size."
          },
          "offset": {
            "type": "integer",
            "format": "int64",
            "description": "Current offset."
          },
          "total": {
            "type": "integer",
            "format": "int64",
            "description": "Total count."
          }
        }
      },
      "VersionResponse": {
        "type": "object",
        "description": "Template version response.",
        "required": [
          "id",
          "template_id",
          "version_number",
          "rules_snapshot",
          "scopes_snapshot",
          "created_by",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp."
          },
          "created_by": {
            "type": "string",
            "format": "uuid",
            "description": "User who created this version."
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier."
          },
          "rules_snapshot": {
            "description": "Rules snapshot at this version."
          },
          "scopes_snapshot": {
            "description": "Scopes snapshot at this version."
          },
          "template_id": {
            "type": "string",
            "format": "uuid",
            "description": "Parent template ID."
          },
          "version_number": {
            "type": "integer",
            "format": "int32",
            "description": "Version number."
          }
        }
      },
      "VulnerabilityCheck": {
        "type": "object",
        "description": "Individual vulnerability check result.",
        "required": [
          "id",
          "name",
          "category",
          "status",
          "severity",
          "details"
        ],
        "properties": {
          "category": {
            "$ref": "#/components/schemas/Category"
          },
          "details": {
            "type": "string",
            "description": "Human-readable explanation of the check result."
          },
          "id": {
            "type": "integer",
            "format": "int32",
            "description": "Check identifier (1-14).",
            "minimum": 0
          },
          "name": {
            "$ref": "#/components/schemas/CheckName"
          },
          "severity": {
            "$ref": "#/components/schemas/Severity"
          },
          "status": {
            "$ref": "#/components/schemas/Status"
          }
        }
      },
      "WebAuthnPolicyResponse": {
        "type": "object",
        "description": "Response for `WebAuthn` policy endpoints.",
        "required": [
          "tenant_id",
          "webauthn_enabled",
          "require_attestation",
          "user_verification",
          "max_credentials_per_user"
        ],
        "properties": {
          "allowed_authenticator_types": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Allowed authenticator types (null = all allowed).",
            "nullable": true
          },
          "max_credentials_per_user": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum number of credentials per user."
          },
          "require_attestation": {
            "type": "boolean",
            "description": "Whether attestation is required for credential registration."
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid",
            "description": "The tenant this policy applies to."
          },
          "user_verification": {
            "type": "string",
            "description": "User verification requirement (discouraged, preferred, required)."
          },
          "webauthn_enabled": {
            "type": "boolean",
            "description": "Whether `WebAuthn` is enabled for this tenant."
          }
        }
      },
      "WebhookDeliveryDetailResponse": {
        "type": "object",
        "description": "Full webhook delivery detail (for single delivery endpoint).",
        "required": [
          "id",
          "subscription_id",
          "event_id",
          "event_type",
          "status",
          "attempt_number",
          "max_attempts",
          "request_payload",
          "created_at"
        ],
        "properties": {
          "attempt_number": {
            "type": "integer",
            "format": "int32"
          },
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "error_message": {
            "type": "string",
            "nullable": true
          },
          "event_id": {
            "type": "string",
            "format": "uuid"
          },
          "event_type": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "latency_ms": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "max_attempts": {
            "type": "integer",
            "format": "int32"
          },
          "next_attempt_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "request_headers": {
            "nullable": true
          },
          "request_payload": {},
          "response_body": {
            "type": "string",
            "nullable": true
          },
          "response_code": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "status": {
            "type": "string"
          },
          "subscription_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "WebhookDeliveryListResponse": {
        "type": "object",
        "description": "Paginated list of webhook deliveries.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WebhookDeliveryResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "WebhookDeliveryResponse": {
        "type": "object",
        "description": "A webhook delivery summary (for list endpoint).",
        "required": [
          "id",
          "subscription_id",
          "event_id",
          "event_type",
          "status",
          "attempt_number",
          "created_at"
        ],
        "properties": {
          "attempt_number": {
            "type": "integer",
            "format": "int32"
          },
          "completed_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "error_message": {
            "type": "string",
            "nullable": true
          },
          "event_id": {
            "type": "string",
            "format": "uuid"
          },
          "event_type": {
            "type": "string"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "latency_ms": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "response_code": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "status": {
            "type": "string"
          },
          "subscription_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "WebhookEventType": {
        "type": "string",
        "description": "All supported webhook event types.",
        "enum": [
          "user.created",
          "user.updated",
          "user.deleted",
          "user.disabled",
          "user.enabled",
          "auth.login.success",
          "auth.login.failed",
          "auth.mfa.enrolled",
          "auth.mfa.verified",
          "auth.token.revoked",
          "group.member.added",
          "group.member.removed",
          "group.created",
          "group.deleted",
          "role.assigned",
          "role.unassigned",
          "entitlement.granted",
          "entitlement.revoked",
          "access_request.created",
          "access_request.approved",
          "access_request.denied",
          "certification.completed",
          "provisioning.completed",
          "provisioning.failed",
          "reconciliation.completed",
          "tenant.settings.updated",
          "connector.status.changed",
          "webhook.subscription.disabled",
          "import.started",
          "import.completed",
          "import.failed",
          "scim.sync.started",
          "scim.sync.completed",
          "scim.sync.failed",
          "scim.operation.failed",
          "agent.anomaly.detected"
        ]
      },
      "WebhookSubscriptionListResponse": {
        "type": "object",
        "description": "Paginated list of webhook subscriptions.",
        "required": [
          "items",
          "total",
          "limit",
          "offset"
        ],
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WebhookSubscriptionResponse"
            }
          },
          "limit": {
            "type": "integer",
            "format": "int64"
          },
          "offset": {
            "type": "integer",
            "format": "int64"
          },
          "total": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "WebhookSubscriptionResponse": {
        "type": "object",
        "description": "A webhook subscription response.",
        "required": [
          "id",
          "tenant_id",
          "name",
          "url",
          "event_types",
          "enabled",
          "consecutive_failures",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "consecutive_failures": {
            "type": "integer",
            "format": "int32"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": "string",
            "nullable": true
          },
          "enabled": {
            "type": "boolean"
          },
          "event_types": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "tenant_id": {
            "type": "string",
            "format": "uuid"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "url": {
            "type": "string"
          }
        }
      },
      "AccessItem": {
        "type": "object",
        "description": "Schema for AccessItem."
      },
      "AccessSnapshotSummary": {
        "type": "object",
        "description": "Schema for AccessSnapshotSummary."
      },
      "AddInheritanceBlockRequest": {
        "type": "object",
        "description": "Schema for AddInheritanceBlockRequest."
      },
      "AddRoleEntitlementRequest": {
        "type": "object",
        "description": "Schema for AddRoleEntitlementRequest."
      },
      "AffectedUser": {
        "type": "object",
        "description": "Schema for AffectedUser."
      },
      "AlertSeverity": {
        "type": "object",
        "description": "Schema for AlertSeverity."
      },
      "AnomalyType": {
        "type": "object",
        "description": "Schema for AnomalyType."
      },
      "AnomalyWarning": {
        "type": "object",
        "description": "Schema for AnomalyWarning."
      },
      "AttributeListResponse": {
        "type": "object",
        "description": "Schema for AttributeListResponse."
      },
      "AuditActionType": {
        "type": "object",
        "description": "Schema for AuditActionType."
      },
      "AuditTrailResponse": {
        "type": "object",
        "description": "Schema for AuditTrailResponse."
      },
      "AuthorizationDecisionResponse": {
        "type": "object",
        "description": "Schema for AuthorizationDecisionResponse."
      },
      "BaselineStatus": {
        "type": "object",
        "description": "Schema for BaselineStatus."
      },
      "BaselineType": {
        "type": "object",
        "description": "Schema for BaselineType."
      },
      "BatchImpactSummary": {
        "type": "object",
        "description": "Schema for BatchImpactSummary."
      },
      "BulkCheckRequest": {
        "type": "object",
        "description": "Schema for BulkCheckRequest."
      },
      "BulkCheckResponse": {
        "type": "object",
        "description": "Schema for BulkCheckResponse."
      },
      "BulkFailureResponse": {
        "type": "object",
        "description": "Schema for BulkFailureResponse."
      },
      "BulkOperationDetailResponse": {
        "type": "object",
        "description": "Schema for BulkOperationDetailResponse."
      },
      "BulkOperationListResponse": {
        "type": "object",
        "description": "Schema for BulkOperationListResponse."
      },
      "BulkOperationResponse": {
        "type": "object",
        "description": "Schema for BulkOperationResponse."
      },
      "BulkOperationStatus": {
        "type": "object",
        "description": "Schema for BulkOperationStatus."
      },
      "BulkRemediationError": {
        "type": "object",
        "description": "Schema for BulkRemediationError."
      },
      "CampaignSummary": {
        "type": "object",
        "description": "Schema for CampaignSummary."
      },
      "Category": {
        "type": "object",
        "description": "Schema for Category."
      },
      "ChangeSpec": {
        "type": "object",
        "description": "Schema for ChangeSpec."
      },
      "CheckName": {
        "type": "object",
        "description": "Schema for CheckName."
      },
      "ComplianceReport": {
        "type": "object",
        "description": "Schema for ComplianceReport."
      },
      "ComplianceReportRequest": {
        "type": "object",
        "description": "Schema for ComplianceReportRequest."
      },
      "ConditionEvaluationResult": {
        "type": "object",
        "description": "Schema for ConditionEvaluationResult."
      },
      "ConditionOperator": {
        "type": "object",
        "description": "Schema for ConditionOperator."
      },
      "ConnectorHealthResponse": {
        "type": "object",
        "description": "Schema for ConnectorHealthResponse."
      },
      "CorrelationCaseListResponse": {
        "type": "object",
        "description": "Schema for CorrelationCaseListResponse."
      },
      "CreateBulkOperationRequest": {
        "type": "object",
        "description": "Schema for CreateBulkOperationRequest."
      },
      "CreateDelegationScopeRequest": {
        "type": "object",
        "description": "Schema for CreateDelegationScopeRequest."
      },
      "CreateLifecycleConfigRequest": {
        "type": "object",
        "description": "Schema for CreateLifecycleConfigRequest."
      },
      "CreateLifecycleStateRequest": {
        "type": "object",
        "description": "Schema for CreateLifecycleStateRequest."
      },
      "CreateLifecycleTransitionRequest": {
        "type": "object",
        "description": "Schema for CreateLifecycleTransitionRequest."
      },
      "CreateMappingRequest": {
        "type": "object",
        "description": "Schema for CreateMappingRequest."
      },
      "CreatePolicyRequest": {
        "type": "object",
        "description": "Schema for CreatePolicyRequest."
      },
      "CreateRoleRequest": {
        "type": "object",
        "description": "Schema for CreateRoleRequest."
      },
      "CreateSodExemptionRequest": {
        "type": "object",
        "description": "Schema for CreateSodExemptionRequest."
      },
      "DataProtectionClassification": {
        "type": "object",
        "description": "Schema for DataProtectionClassification."
      },
      "Decimal": {
        "type": "object",
        "description": "Schema for Decimal."
      },
      "DelegationStatus": {
        "type": "object",
        "description": "Schema for DelegationStatus."
      },
      "DepartmentImpact": {
        "type": "object",
        "description": "Schema for DepartmentImpact."
      },
      "DetectionReason": {
        "type": "object",
        "description": "Schema for DetectionReason."
      },
      "DiscoverSchemaRequest": {
        "type": "object",
        "description": "Schema for DiscoverSchemaRequest."
      },
      "DiscoveryStatusResponse": {
        "type": "object",
        "description": "Schema for DiscoveryStatusResponse."
      },
      "EffectiveEntitlementsResponse": {
        "type": "object",
        "description": "Schema for EffectiveEntitlementsResponse."
      },
      "EntitlementImpact": {
        "type": "object",
        "description": "Schema for EntitlementImpact."
      },
      "EntitlementSummary": {
        "type": "object",
        "description": "Schema for EntitlementSummary."
      },
      "ExecuteTransitionRequest": {
        "type": "object",
        "description": "Schema for ExecuteTransitionRequest."
      },
      "FactorBreakdown": {
        "type": "object",
        "description": "Schema for FactorBreakdown."
      },
      "FilterCriteria": {
        "type": "object",
        "description": "Schema for FilterCriteria."
      },
      "GdprLegalBasis": {
        "type": "object",
        "description": "Schema for GdprLegalBasis."
      },
      "GovExemptionStatus": {
        "type": "object",
        "description": "Schema for GovExemptionStatus."
      },
      "GovScheduleStatus": {
        "type": "object",
        "description": "Schema for GovScheduleStatus."
      },
      "GovViolationStatus": {
        "type": "object",
        "description": "Schema for GovViolationStatus."
      },
      "HighRiskOrphan": {
        "type": "object",
        "description": "Schema for HighRiskOrphan."
      },
      "ImpactSummary": {
        "type": "object",
        "description": "Schema for ImpactSummary."
      },
      "InheritanceBlockDetailsResponse": {
        "type": "object",
        "description": "Schema for InheritanceBlockDetailsResponse."
      },
      "InheritanceBlockResponse": {
        "type": "object",
        "description": "Schema for InheritanceBlockResponse."
      },
      "KeyErrorResponse": {
        "type": "object",
        "description": "Schema for KeyErrorResponse."
      },
      "LevelCount": {
        "type": "object",
        "description": "Schema for LevelCount."
      },
      "LicenseIncompatibilityListResponse": {
        "type": "object",
        "description": "Schema for LicenseIncompatibilityListResponse."
      },
      "LifecycleConfigDetailResponse": {
        "type": "object",
        "description": "Schema for LifecycleConfigDetailResponse."
      },
      "LifecycleConfigListResponse": {
        "type": "object",
        "description": "Schema for LifecycleConfigListResponse."
      },
      "LifecycleConfigResponse": {
        "type": "object",
        "description": "Schema for LifecycleConfigResponse."
      },
      "LifecycleObjectType": {
        "type": "object",
        "description": "Schema for LifecycleObjectType."
      },
      "LifecycleStateInfo": {
        "type": "object",
        "description": "Schema for LifecycleStateInfo."
      },
      "LifecycleStateResponse": {
        "type": "object",
        "description": "Schema for LifecycleStateResponse."
      },
      "LifecycleTransitionResponse": {
        "type": "object",
        "description": "Schema for LifecycleTransitionResponse."
      },
      "ListKeysResponse": {
        "type": "object",
        "description": "Schema for ListKeysResponse."
      },
      "LocationImpact": {
        "type": "object",
        "description": "Schema for LocationImpact."
      },
      "ManualTaskListResponse": {
        "type": "object",
        "description": "Schema for ManualTaskListResponse."
      },
      "ManualTaskResponse": {
        "type": "object",
        "description": "Schema for ManualTaskResponse."
      },
      "MappingResponse": {
        "type": "object",
        "description": "Schema for MappingResponse."
      },
      "MatchingPolicyResult": {
        "type": "object",
        "description": "Schema for MatchingPolicyResult."
      },
      "McpErrorCode": {
        "type": "object",
        "description": "Schema for McpErrorCode."
      },
      "MergePaginatedResponse": {
        "type": "object",
        "description": "Schema for MergePaginatedResponse."
      },
      "MetricsTrendDirection": {
        "type": "object",
        "description": "Schema for MetricsTrendDirection."
      },
      "MoveRoleRequest": {
        "type": "object",
        "description": "Schema for MoveRoleRequest."
      },
      "NhiRequestApprovalResponse": {
        "type": "object",
        "description": "Schema for NhiRequestApprovalResponse."
      },
      "NhiRequestSummary": {
        "type": "object",
        "description": "Schema for NhiRequestSummary."
      },
      "NhiTypeCountsResponse": {
        "type": "object",
        "description": "Schema for NhiTypeCountsResponse."
      },
      "NhiUsageOutcome": {
        "type": "object",
        "description": "Schema for NhiUsageOutcome."
      },
      "ObjectClassListResponse": {
        "type": "object",
        "description": "Schema for ObjectClassListResponse."
      },
      "ObjectClassResponse": {
        "type": "object",
        "description": "Schema for ObjectClassResponse."
      },
      "ObjectLifecycleStatusResponse": {
        "type": "object",
        "description": "Schema for ObjectLifecycleStatusResponse."
      },
      "OperationType": {
        "type": "object",
        "description": "Schema for OperationType."
      },
      "PaginatedResponse": {
        "type": "object",
        "description": "Schema for PaginatedResponse."
      },
      "PeerComparisonData": {
        "type": "object",
        "description": "Schema for PeerComparisonData."
      },
      "PeerGroupComparison": {
        "type": "object",
        "description": "Schema for PeerGroupComparison."
      },
      "PeerGroupScore": {
        "type": "object",
        "description": "Schema for PeerGroupScore."
      },
      "PeerGroupType": {
        "type": "object",
        "description": "Schema for PeerGroupType."
      },
      "PolicyListResponse": {
        "type": "object",
        "description": "Schema for PolicyListResponse."
      },
      "PolicyResponse": {
        "type": "object",
        "description": "Schema for PolicyResponse."
      },
      "PreviewMappingRequest": {
        "type": "object",
        "description": "Schema for PreviewMappingRequest."
      },
      "PreviewMappingResponse": {
        "type": "object",
        "description": "Schema for PreviewMappingResponse."
      },
      "Priority": {
        "type": "object",
        "description": "Schema for Priority."
      },
      "ProcessingSummary": {
        "type": "object",
        "description": "Schema for ProcessingSummary."
      },
      "RawDryRunRequest": {
        "type": "object",
        "description": "Schema for RawDryRunRequest."
      },
      "ReasonBreakdown": {
        "type": "object",
        "description": "Schema for ReasonBreakdown."
      },
      "RecomputeResponse": {
        "type": "object",
        "description": "Schema for RecomputeResponse."
      },
      "RefreshScheduleRequest": {
        "type": "object",
        "description": "Schema for RefreshScheduleRequest."
      },
      "RefreshScheduleResponse": {
        "type": "object",
        "description": "Schema for RefreshScheduleResponse."
      },
      "RemediateViolationRequest": {
        "type": "object",
        "description": "Schema for RemediateViolationRequest."
      },
      "RemediationAction": {
        "type": "object",
        "description": "Schema for RemediationAction."
      },
      "ReviewerProgressResponse": {
        "type": "object",
        "description": "Schema for ReviewerProgressResponse."
      },
      "RiskAlertSortOption": {
        "type": "object",
        "description": "Schema for RiskAlertSortOption."
      },
      "RiskScoreHistoryEntry": {
        "type": "object",
        "description": "Schema for RiskScoreHistoryEntry."
      },
      "RoleListResponse": {
        "type": "object",
        "description": "Schema for RoleListResponse."
      },
      "RoleMoveResponse": {
        "type": "object",
        "description": "Schema for RoleMoveResponse."
      },
      "RoleResponse": {
        "type": "object",
        "description": "Schema for RoleResponse."
      },
      "RoleTreeResponse": {
        "type": "object",
        "description": "Schema for RoleTreeResponse."
      },
      "RotateKeyResponse": {
        "type": "object",
        "description": "Schema for RotateKeyResponse."
      },
      "ScanRuleResponse": {
        "type": "object",
        "description": "Schema for ScanRuleResponse."
      },
      "ScheduledTransitionResponse": {
        "type": "object",
        "description": "Schema for ScheduledTransitionResponse."
      },
      "SchemaDiffResponse": {
        "type": "object",
        "description": "Schema for SchemaDiffResponse."
      },
      "SchemaResponse": {
        "type": "object",
        "description": "Schema for SchemaResponse."
      },
      "SchemaVersionListResponse": {
        "type": "object",
        "description": "Schema for SchemaVersionListResponse."
      },
      "ScimCredentials": {
        "type": "object",
        "description": "Schema for ScimCredentials."
      },
      "ScimProvisioningLog": {
        "type": "object",
        "description": "Schema for ScimProvisioningLog."
      },
      "ScimProvisioningState": {
        "type": "object",
        "description": "Schema for ScimProvisioningState."
      },
      "ScimSyncRun": {
        "type": "object",
        "description": "Schema for ScimSyncRun."
      },
      "ScimTargetAttributeMapping": {
        "type": "object",
        "description": "Schema for ScimTargetAttributeMapping."
      },
      "ScoringWeights": {
        "type": "object",
        "description": "Schema for ScoringWeights."
      },
      "ServiceAccountStatus": {
        "type": "object",
        "description": "Schema for ServiceAccountStatus."
      },
      "ServiceProviderConfig": {
        "type": "object",
        "description": "Schema for ServiceProviderConfig."
      },
      "SetLinkEnabledRequest": {
        "type": "object",
        "description": "Schema for SetLinkEnabledRequest."
      },
      "Severity": {
        "type": "object",
        "description": "Schema for Severity."
      },
      "SeverityCount": {
        "type": "object",
        "description": "Schema for SeverityCount."
      },
      "SingleTicketSyncResponse": {
        "type": "object",
        "description": "Schema for SingleTicketSyncResponse."
      },
      "SnapshotContentResponse": {
        "type": "object",
        "description": "Schema for SnapshotContentResponse."
      },
      "SodCheckRequest": {
        "type": "object",
        "description": "Schema for SodCheckRequest."
      },
      "SodCheckResponse": {
        "type": "object",
        "description": "Schema for SodCheckResponse."
      },
      "SodExemptionListResponse": {
        "type": "object",
        "description": "Schema for SodExemptionListResponse."
      },
      "SodExemptionResponse": {
        "type": "object",
        "description": "Schema for SodExemptionResponse."
      },
      "SodViolationListResponse": {
        "type": "object",
        "description": "Schema for SodViolationListResponse."
      },
      "SodViolationResponse": {
        "type": "object",
        "description": "Schema for SodViolationResponse."
      },
      "SodWarningSummary": {
        "type": "object",
        "description": "Schema for SodWarningSummary."
      },
      "StateAffectedEntitlements": {
        "type": "object",
        "description": "Schema for StateAffectedEntitlements."
      },
      "Status": {
        "type": "object",
        "description": "Schema for Status."
      },
      "ThresholdSource": {
        "type": "object",
        "description": "Schema for ThresholdSource."
      },
      "TicketSyncResponse": {
        "type": "object",
        "description": "Schema for TicketSyncResponse."
      },
      "TransitionAuditListResponse": {
        "type": "object",
        "description": "Schema for TransitionAuditListResponse."
      },
      "TransitionAuditResponse": {
        "type": "object",
        "description": "Schema for TransitionAuditResponse."
      },
      "TransitionRequestListResponse": {
        "type": "object",
        "description": "Schema for TransitionRequestListResponse."
      },
      "TransitionRequestResponse": {
        "type": "object",
        "description": "Schema for TransitionRequestResponse."
      },
      "TransitionRequestStatus": {
        "type": "object",
        "description": "Schema for TransitionRequestStatus."
      },
      "TriggerTypeStats": {
        "type": "object",
        "description": "Schema for TriggerTypeStats."
      },
      "UpdateLifecycleConfigRequest": {
        "type": "object",
        "description": "Schema for UpdateLifecycleConfigRequest."
      },
      "UpdateLifecycleStateRequest": {
        "type": "object",
        "description": "Schema for UpdateLifecycleStateRequest."
      },
      "UpdateMappingRequest": {
        "type": "object",
        "description": "Schema for UpdateMappingRequest."
      },
      "UpdateNotesRequest": {
        "type": "object",
        "description": "Schema for UpdateNotesRequest."
      },
      "UpdatePolicyRequest": {
        "type": "object",
        "description": "Schema for UpdatePolicyRequest."
      },
      "UpdateRoleRequest": {
        "type": "object",
        "description": "Schema for UpdateRoleRequest."
      },
      "UserContext": {
        "type": "object",
        "description": "Schema for UserContext."
      },
      "UserSummary": {
        "type": "object",
        "description": "Schema for UserSummary."
      },
      "ValidateCredentialRequest": {
        "type": "object",
        "description": "Schema for ValidateCredentialRequest."
      },
      "ValidateCredentialResponse": {
        "type": "object",
        "description": "Schema for ValidateCredentialResponse."
      },
      "WebhookCallbackRequest": {
        "type": "object",
        "description": "Schema for WebhookCallbackRequest."
      },
      "WebhookCallbackResponse": {
        "type": "object",
        "description": "Schema for WebhookCallbackResponse."
      },
      "crate.error.ErrorResponse": {
        "type": "object",
        "description": "Schema for crate.error.ErrorResponse."
      },
      "crate.models.CreateParametricAssignmentRequest": {
        "type": "object",
        "description": "Schema for crate.models.CreateParametricAssignmentRequest."
      },
      "crate.models.ParametricAssignmentListResponse": {
        "type": "object",
        "description": "Schema for crate.models.ParametricAssignmentListResponse."
      },
      "crate.models.ParametricAssignmentResponse": {
        "type": "object",
        "description": "Schema for crate.models.ParametricAssignmentResponse."
      }
    },
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  },
  "tags": [
    {
      "name": "Health",
      "description": "Service health and status"
    },
    {
      "name": "Authentication",
      "description": "Login, logout, password operations"
    },
    {
      "name": "MFA",
      "description": "Multi-factor authentication (TOTP, WebAuthn)"
    },
    {
      "name": "WebAuthn MFA",
      "description": "WebAuthn/FIDO2 registration and authentication"
    },
    {
      "name": "Admin - WebAuthn Policy",
      "description": "Tenant WebAuthn policy management"
    },
    {
      "name": "Admin - WebAuthn Credentials",
      "description": "Admin WebAuthn credential management"
    },
    {
      "name": "IP Restrictions",
      "description": "IP-based access control"
    },
    {
      "name": "Delegated Admin",
      "description": "Role-based permission management"
    },
    {
      "name": "Branding",
      "description": "Tenant branding configuration"
    },
    {
      "name": "Branding Assets",
      "description": "Logo and asset management"
    },
    {
      "name": "Email Templates",
      "description": "Email template customization"
    },
    {
      "name": "Public",
      "description": "Public endpoints (no authentication)"
    },
    {
      "name": "OAuth2",
      "description": "OAuth2/OIDC provider endpoints"
    },
    {
      "name": "OAuth2 Device Code",
      "description": "RFC 8628 Device Authorization Grant"
    },
    {
      "name": "OAuth2 Admin",
      "description": "OAuth2 client management"
    },
    {
      "name": "OIDC Discovery",
      "description": "OpenID Connect discovery"
    },
    {
      "name": "Users",
      "description": "User management"
    },
    {
      "name": "SAML",
      "description": "SAML SSO operations"
    },
    {
      "name": "SAML Admin",
      "description": "SAML service provider management"
    },
    {
      "name": "SCIM",
      "description": "SCIM user provisioning"
    },
    {
      "name": "OIDC Federation",
      "description": "External IdP federation"
    },
    {
      "name": "Social Login",
      "description": "Social identity provider authentication"
    },
    {
      "name": "User Profile",
      "description": "User profile management"
    },
    {
      "name": "User Security",
      "description": "User security overview and MFA status"
    },
    {
      "name": "User Sessions",
      "description": "User session management"
    },
    {
      "name": "User Devices",
      "description": "User device management and trust"
    },
    {
      "name": "Audit",
      "description": "User audit and login history"
    },
    {
      "name": "Security Alerts",
      "description": "User security alerts"
    },
    {
      "name": "Governance - Applications",
      "description": "IGA application registry management"
    },
    {
      "name": "Governance - Entitlements",
      "description": "IGA entitlement definitions"
    },
    {
      "name": "Governance - Assignments",
      "description": "IGA entitlement assignments to users/groups"
    },
    {
      "name": "Governance - Role Entitlements",
      "description": "IGA role-to-entitlement mappings"
    },
    {
      "name": "Governance - Entitlement Owners",
      "description": "IGA entitlement ownership management"
    },
    {
      "name": "Governance - Effective Access",
      "description": "IGA effective user access query"
    },
    {
      "name": "Governance - SoD Rules",
      "description": "Separation of Duties rule management"
    },
    {
      "name": "Governance - SoD Violations",
      "description": "SoD violation detection and management"
    },
    {
      "name": "Governance - SoD Exemptions",
      "description": "SoD exemption management for approved exceptions"
    },
    {
      "name": "Governance - Access Requests",
      "description": "Self-service access request submission and management"
    },
    {
      "name": "Governance - Approvals",
      "description": "Access request approval workflow"
    },
    {
      "name": "Governance - Approval Workflows",
      "description": "Multi-level approval workflow configuration"
    },
    {
      "name": "Governance - Delegations",
      "description": "Approval authority delegation management"
    },
    {
      "name": "Governance - Certification Campaigns",
      "description": "Access certification campaign management"
    },
    {
      "name": "Governance - Certification Items",
      "description": "Certification item review and decisions"
    },
    {
      "name": "Governance - Lifecycle",
      "description": "Joiner-Mover-Leaver lifecycle events and actions"
    },
    {
      "name": "Governance - Risk Factors",
      "description": "Risk factor configuration and management"
    },
    {
      "name": "Governance - Risk Scoring",
      "description": "User risk score calculation and tracking"
    },
    {
      "name": "Governance - Peer Groups",
      "description": "Peer group management for outlier detection"
    },
    {
      "name": "Governance - Risk Alerts",
      "description": "Risk-based alert management"
    },
    {
      "name": "Governance - Orphan Detection",
      "description": "Orphan account detection and remediation"
    },
    {
      "name": "Governance - Detection Rules",
      "description": "Detection rule configuration"
    },
    {
      "name": "Governance - Compliance Reporting",
      "description": "Report templates, generation, and scheduling for compliance audits"
    },
    {
      "name": "Governance - Role Mining",
      "description": "Role mining jobs, candidate discovery, pattern analysis, and role optimization"
    },
    {
      "name": "Governance - Role Hierarchy",
      "description": "Business role hierarchy with parent-child relationships, entitlement inheritance, and impact analysis"
    },
    {
      "name": "Governance - Lifecycle Config",
      "description": "Lifecycle configuration management for object state machines"
    },
    {
      "name": "Governance - State Transitions",
      "description": "Object state transition execution, rollback, and audit"
    },
    {
      "name": "Governance - Scheduled Transitions",
      "description": "Scheduled state transition management"
    },
    {
      "name": "Governance - Bulk Operations",
      "description": "Bulk state transition operations for organizational changes"
    },
    {
      "name": "Connectors",
      "description": "Connector configuration and management for external system provisioning"
    },
    {
      "name": "Connector Operations",
      "description": "Provisioning operation queue, retries, dead letter queue, and conflict resolution"
    },
    {
      "name": "Connector Sync",
      "description": "Live synchronization configuration, delta sync, change tracking, and conflict management"
    },
    {
      "name": "Connector Reconciliation",
      "description": "Full reconciliation runs, discrepancy detection, remediation, and scheduling"
    },
    {
      "name": "Governance - Workflow Escalation",
      "description": "Escalation policies, approval groups, and step escalation configuration"
    },
    {
      "name": "Governance - Micro-certification",
      "description": "Event-triggered micro-certifications, trigger rules, and just-in-time access review"
    },
    {
      "name": "Governance - Meta-roles",
      "description": "Meta-role management, criteria matching, inheritance, and conflict resolution"
    },
    {
      "name": "Governance - Parametric Roles",
      "description": "Role parameter definitions, parametric assignments, and parameter audit"
    },
    {
      "name": "Governance - Object Templates",
      "description": "Object template management, rules, scopes, versions, and application events"
    },
    {
      "name": "Governance - Outlier Detection",
      "description": "Outlier detection configuration, analyses, results, dispositions, and alerts"
    },
    {
      "name": "Governance - Enhanced Simulation",
      "description": "Batch simulation management for policy and role change impact analysis"
    },
    {
      "name": "Governance - NHIs",
      "description": "Non-human identity lifecycle, credentials, usage, risk scoring, certification, and access requests"
    },
    {
      "name": "Governance - Identity Merge",
      "description": "Duplicate identity detection, merge preview, and merge execution"
    },
    {
      "name": "Governance - Persona Management",
      "description": "Persona archetypes, persona lifecycle, context switching, and audit"
    },
    {
      "name": "Governance - Semi-manual Resources",
      "description": "Semi-manual provisioning, manual tasks, ticketing integration, and SLA policies"
    },
    {
      "name": "Governance - License Management",
      "description": "License pool management, assignments, entitlement links, incompatibilities, reclamation, and analytics"
    },
    {
      "name": "Governance - Provisioning Scripts",
      "description": "Provisioning script management, templates, hook bindings, testing, and analytics"
    },
    {
      "name": "Governance - Correlation Engine",
      "description": "Identity-to-account correlation rules, thresholds, cases, audit, and statistics"
    },
    {
      "name": "Governance - Audit Export",
      "description": "SIEM destination management, connectivity testing, and audit log export"
    },
    {
      "name": "Governance - Risk Management",
      "description": "Risk enforcement policy configuration for adaptive authentication"
    },
    {
      "name": "Token Revocation",
      "description": "JWT access token revocation for security hardening"
    },
    {
      "name": "Key Management",
      "description": "Admin endpoints for JWT signing key rotation and revocation"
    },
    {
      "name": "Attribute Definitions",
      "description": "Custom attribute schema definition management per tenant"
    },
    {
      "name": "User Custom Attributes",
      "description": "User custom attribute storage, retrieval, and patching"
    },
    {
      "name": "Bulk Operations",
      "description": "Bulk custom attribute update operations"
    },
    {
      "name": "Attribute Audit",
      "description": "Audit custom attribute compliance across users"
    },
    {
      "name": "Group Hierarchy",
      "description": "Manage group parent-child relationships, tree traversal, and subtree membership"
    },
    {
      "name": "Observability",
      "description": "OpenTelemetry tracing, Prometheus metrics, and Kubernetes health probes"
    },
    {
      "name": "Passwordless Authentication",
      "description": "Magic link and email OTP passwordless login"
    },
    {
      "name": "Passwordless Policy",
      "description": "Tenant passwordless authentication policy management"
    },
    {
      "name": "Authorization - Policies",
      "description": "Authorization policy CRUD for PDP configuration"
    },
    {
      "name": "Authorization - Mappings",
      "description": "Entitlement-to-action mapping management"
    },
    {
      "name": "Authorization - Query",
      "description": "Authorization decision queries (can-i, admin check, bulk check)"
    },
    {
      "name": "Webhooks",
      "description": "Webhook subscription management and delivery tracking"
    },
    {
      "name": "Import",
      "description": "Bulk user CSV import, job tracking, and invitation management"
    },
    {
      "name": "SCIM Targets",
      "description": "SCIM 2.0 outbound provisioning target management, health checks, and configuration"
    },
    {
      "name": "SCIM Target Mappings",
      "description": "SCIM 2.0 outbound attribute mapping configuration"
    },
    {
      "name": "SCIM Target Sync",
      "description": "SCIM 2.0 outbound sync triggering and run history"
    },
    {
      "name": "SCIM Target Provisioning",
      "description": "SCIM 2.0 outbound provisioning state and retry management"
    },
    {
      "name": "SCIM Target Logs",
      "description": "SCIM 2.0 outbound provisioning operation logs"
    },
    {
      "name": "AI Agents",
      "description": "AI agent registry and lifecycle management"
    },
    {
      "name": "AI Agent Tools",
      "description": "AI tool registry and schema management"
    },
    {
      "name": "AI Agent Permissions",
      "description": "Agent-tool permission grants and revocation"
    },
    {
      "name": "AI Agent Authorization",
      "description": "Real-time authorization decisions for agent tool invocations"
    },
    {
      "name": "AI Agent Audit",
      "description": "Agent activity audit trail queries"
    },
    {
      "name": "AI Agent Discovery",
      "description": "A2A Protocol AgentCard discovery"
    },
    {
      "name": "MCP Tools",
      "description": "Model Context Protocol tool discovery and invocation"
    },
    {
      "name": "A2A Tasks",
      "description": "Agent-to-Agent Protocol task management"
    },
    {
      "name": "AI Agent Approvals",
      "description": "Human-in-the-loop approval workflow for AI agent tool invocations"
    },
    {
      "name": "Tenant Provisioning",
      "description": "Self-service tenant creation for authenticated users"
    },
    {
      "name": "Unified NHI",
      "description": "Unified Non-Human Identity view spanning service accounts and AI agents"
    },
    {
      "name": "Unified NHI Certification",
      "description": "Cross-type certification campaigns for unified NHI governance"
    },
    {
      "name": "NHI - Service Accounts",
      "description": "Service account lifecycle, credentials, usage, risk, and self-service requests"
    },
    {
      "name": "NHI - Agents",
      "description": "AI agent management, permissions, authorization, audit, and anomaly detection"
    },
    {
      "name": "NHI - Tools",
      "description": "Tool registry for AI agent capabilities"
    },
    {
      "name": "NHI - Approvals",
      "description": "Human-in-the-loop approval workflow for agent tool invocations"
    }
  ]
}