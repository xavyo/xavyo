{"responses":{"200":{"description":"SoD check result","content":{"application/json":{"schema":{"type":"object","description":"Result of an `SoD` check.","required":["allowed","violations"],"properties":{"allowed":{"type":"boolean","description":"Whether the assignment would be allowed."},"violations":{"type":"array","items":{"type":"object","description":"A potential violation found during `SoD` check.","required":["rule_id","rule_name","severity","conflicting_entitlement_id","has_exemption"],"properties":{"conflicting_entitlement_id":{"type":"string","format":"uuid","description":"Conflicting entitlement the user already has."},"has_exemption":{"type":"boolean","description":"Whether an active exemption exists."},"rule_id":{"type":"string","format":"uuid","description":"Rule that would be violated."},"rule_name":{"type":"string","description":"Rule name."},"severity":{"type":"string","description":"Severity levels for `SoD` rules.","enum":["low","medium","high","critical"],"title":"GovSodSeverity"},"source":{"allOf":[{"oneOf":[{"type":"object","required":["type"],"properties":{"type":{"type":"string","enum":["direct"]}}},{"type":"object","description":"Inherited from group membership.","required":["group_id","group_name","type"],"properties":{"group_id":{"type":"string","format":"uuid","description":"Group ID."},"group_name":{"type":"string","description":"Group name."},"type":{"type":"string","enum":["group"]}}},{"type":"object","description":"Inherited from legacy string-based role.","required":["role_name","type"],"properties":{"role_name":{"type":"string","description":"Role name."},"type":{"type":"string","enum":["role"]}}},{"type":"object","description":"From governance role hierarchy (F088).","required":["role_id","role_name","source_role_id","source_role_name","is_inherited","type"],"properties":{"is_inherited":{"type":"boolean","description":"Whether entitlement is inherited from an ancestor role."},"role_id":{"type":"string","format":"uuid","description":"The role ID the user is assigned to."},"role_name":{"type":"string","description":"The role name the user is assigned to."},"source_role_id":{"type":"string","format":"uuid","description":"The source role ID that grants the entitlement (may be ancestor)."},"source_role_name":{"type":"string","description":"The source role name."},"type":{"type":"string","enum":["gov_role"]}}}],"description":"Information about how an entitlement was obtained (F088).","discriminator":{"propertyName":"type"},"title":"EntitlementSourceInfo"}],"nullable":true}},"title":"SodCheckViolation"},"description":"Violations that would be created (empty if allowed)."}},"title":"SodCheckResponse"}}}},"400":{"description":"Invalid request"},"401":{"description":"Unauthorized"},"500":{"description":"Internal server error"}}}