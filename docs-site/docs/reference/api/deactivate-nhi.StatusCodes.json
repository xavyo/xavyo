{"responses":{"200":{"description":"NHI deactivated successfully","content":{"application/json":{"schema":{"type":"object","description":"A unified NHI identity record.","required":["id","tenant_id","nhi_type","name","lifecycle_state","created_at","updated_at"],"properties":{"backup_owner_id":{"type":"string","format":"uuid","nullable":true},"created_at":{"type":"string","format":"date-time"},"created_by":{"type":"string","format":"uuid","nullable":true},"description":{"type":"string","nullable":true},"expires_at":{"type":"string","format":"date-time","nullable":true},"grace_period_ends_at":{"type":"string","format":"date-time","nullable":true},"id":{"type":"string","format":"uuid"},"inactivity_threshold_days":{"type":"integer","format":"int32","nullable":true},"last_activity_at":{"type":"string","format":"date-time","nullable":true},"last_certified_at":{"type":"string","format":"date-time","nullable":true},"last_certified_by":{"type":"string","format":"uuid","nullable":true},"last_rotation_at":{"type":"string","format":"date-time","nullable":true},"lifecycle_state":{"type":"string","description":"Lifecycle state for non-human identities.\n\nModels a state machine with defined valid transitions:\n\n- `Active` -> `Inactive`, `Suspended`, `Deprecated`\n- `Inactive` -> `Active`\n- `Suspended` -> `Active`\n- `Deprecated` -> `Archived`\n- `Archived` -> (terminal, no transitions out)\n\n# Serialization\n\n```rust\nuse xavyo_nhi::NhiLifecycleState;\n\nassert_eq!(serde_json::to_string(&NhiLifecycleState::Active).unwrap(), \"\\\"active\\\"\");\nassert_eq!(serde_json::to_string(&NhiLifecycleState::Deprecated).unwrap(), \"\\\"deprecated\\\"\");\n\nlet state: NhiLifecycleState = serde_json::from_str(\"\\\"suspended\\\"\").unwrap();\nassert_eq!(state, NhiLifecycleState::Suspended);\n```\n\n# State Helpers\n\n```rust\nuse xavyo_nhi::NhiLifecycleState;\n\nassert!(NhiLifecycleState::Active.is_usable());\nassert!(!NhiLifecycleState::Suspended.is_usable());\nassert!(NhiLifecycleState::Archived.is_terminal());\nassert!(!NhiLifecycleState::Active.is_terminal());\nassert!(NhiLifecycleState::Active.can_transition_to(NhiLifecycleState::Suspended));\nassert!(!NhiLifecycleState::Archived.can_transition_to(NhiLifecycleState::Active));\n```","enum":["active","inactive","suspended","deprecated","archived"],"title":"NhiLifecycleState"},"name":{"type":"string"},"next_certification_at":{"type":"string","format":"date-time","nullable":true},"nhi_type":{"type":"string","description":"Type of non-human identity.\n\nDistinguishes between different categories of automated identities\nthat require governance and lifecycle management. Each type has\ndifferent risk profiles and compliance requirements.\n\n# Variants\n\n- `ServiceAccount`: Traditional machine-to-machine credentials\n- `Agent`: AI/ML agent with tool access permissions\n- `Tool`: An invocable tool that agents can use\n\n# Serialization\n\nSerializes to `snake_case` strings for JSON/database storage:\n\n```rust\nuse xavyo_nhi::NhiType;\n\nassert_eq!(serde_json::to_string(&NhiType::ServiceAccount).unwrap(), \"\\\"service_account\\\"\");\nassert_eq!(serde_json::to_string(&NhiType::Agent).unwrap(), \"\\\"agent\\\"\");\nassert_eq!(serde_json::to_string(&NhiType::Tool).unwrap(), \"\\\"tool\\\"\");\n```\n\n# Parsing\n\nParses from strings with multiple aliases (case-insensitive):\n\n```rust\nuse xavyo_nhi::NhiType;\n\nassert_eq!(\"service_account\".parse::<NhiType>().unwrap(), NhiType::ServiceAccount);\nassert_eq!(\"agent\".parse::<NhiType>().unwrap(), NhiType::Agent);\nassert_eq!(\"ai_agent\".parse::<NhiType>().unwrap(), NhiType::Agent); // backward compat\nassert_eq!(\"tool\".parse::<NhiType>().unwrap(), NhiType::Tool);\nassert_eq!(\"SERVICE_ACCOUNT\".parse::<NhiType>().unwrap(), NhiType::ServiceAccount);\nassert!(\"invalid\".parse::<NhiType>().is_err());\n```","enum":["service_account","agent","tool"],"title":"NhiType"},"owner_id":{"type":"string","format":"uuid","nullable":true},"risk_score":{"type":"integer","format":"int32","nullable":true},"rotation_interval_days":{"type":"integer","format":"int32","nullable":true},"suspension_reason":{"type":"string","nullable":true},"tenant_id":{"type":"string","format":"uuid"},"updated_at":{"type":"string","format":"date-time"}},"title":"NhiIdentity"}}}},"401":{"description":"Authentication required"},"403":{"description":"Forbidden"},"404":{"description":"NHI identity not found"},"409":{"description":"Invalid lifecycle transition"}}}